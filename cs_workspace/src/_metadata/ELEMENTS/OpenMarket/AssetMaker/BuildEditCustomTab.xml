<?xml version="1.0" ?>
<!DOCTYPE ftcs SYSTEM "futuretense_cs.dtd">
<ftcs version="1.2">
<!-- OpenMarket/AssetMaker/BuildEditCustomTab
-
            This element can be used to create the custom tabs in case of basic asset type.   

-INPUT --  It accepts the comma separated list of the fields to display under a custom tab. The input fields must be part of the ADF.

---OUTPUT   it displays the Fields on  basic asset CREATE/EDIT screen in a new tab.
-
-->


<!-- editpropertylist - a list of property fields
             editpropertylist: if
             specified, then contains
             a list of properties
             for which the form is
             to be built
-->
<link href="Variables.cs_imagedir/../js/fw/css/ui/FormUploader.css" rel="stylesheet" type="text/css" REPLACEALL="Variables.cs_imagedir,Variables.locale"/>
<SCRIPT TYPE="text/javascript">
	<![CDATA[
		dojo.addOnLoad(function(){
			var fwImgNodes = [];
			fwImgNodes = dojo.query('img', document.forms[0]);
			dojo.forEach(fwImgNodes, function(node){
				if(dojo.attr(node, 'src') === ']]> <REPLACE STR="Variables.cs_imagedir">Variables.cs_imagedir/graphics/common/icon/help_new.png</REPLACE> <![CDATA[' 
					&& (!dojo.attr(node, 'id') || dojo.attr(node, 'id').indexOf('_fwTypeAheadHelpImg') < 0)){
					if(dojo.attr(node, 'title') != ""){
						var dijitTooltip = new fw.ui.dijit.HoverableTooltip({
							connectedNodes: [node], 
							content: dojo.attr(node, 'title'),
							position:'below'
						});
					}
				}
				dojo.attr(node, 'title', "");				
			});			
		});
	
	]]>
</SCRIPT>
<!-- Track whether asset form has been reposted, and determine the appropriate prefix for filling in form variables -->
<IF COND="IsVariable.assetmaker/property/name/storage/type!=true">
<THEN>
	<!-- check the version so we know the length of the name field (processor < 4.0 = 32, otherwise 64 )-->
	<CALLJAVA CLASS="com.openmarket.assetmaker.asset.AssetMaker">
	   <ARGUMENT NAME="command" VALUE="parseasset"/>
		<ARGUMENT NAME="assettype" VALUE="Variables.AssetType"/>
	</CALLJAVA>
	
	<setvar NAME="sizeofnamefield" VALUE="64"/>
	<BEGINS STR="Variables.assetmaker/assettags/processor" WHAT="3"/>
	<if COND="Variables.errno=1">
	<then>
		<setvar NAME="sizeofnamefield" VALUE="32"/>
	</then>
	<else>
		<BEGINS STR="Variables.assetmaker/assettags/processor" WHAT="2"/>
		<if COND="Variables.errno=1">
		<then>
			<setvar NAME="sizeofnamefield" VALUE="32"/>
		</then>
		</if>
	</else>
	</if>
	
</THEN>
</IF>		



<SETVAR NAME="currentformprefix" VALUE="ContentDetails"/>

<DEBABBLE VALUE="false"/>
<if COND="IsVariable.assetmaker/assettags/markertext=false">
<then>
	<CALLJAVA CLASS="com.openmarket.assetmaker.asset.AssetMaker">
	   <ARGUMENT NAME="command" VALUE="parseasset"/>
		<ARGUMENT NAME="assettype" VALUE="Variables.AssetType"/>
	</CALLJAVA>
</then>
</if>
<setvar NAME="markertext" VALUE="Variables.assetmaker/assettags/markertext"/>
<setvar NAME="markerimage" VALUE="Variables.assetmaker/assettags/markerimage"/>
<if COND="IsVariable.editpropertylist=true">
<then>
    <stringlist NAME="Proplist" STR="Variables.editpropertylist" DELIM=","/>
</then>
<else>
	<if COND="IsVariable.assetmaker/propertylist=true">
	<then>
	    <stringlist NAME="Proplist" STR="Variables.assetmaker/propertylist" DELIM=","/>
	</then>
	</if>
</else>
</if>

<if COND="IsList.Proplist=true">
<then>
	<loop LIST="Proplist">
		<SETVAR NAME="fieldname" VALUE="Variables.empty"/>
		<SETVAR NAME="fieldvalue" VALUE="Variables.empty"/>
		<setvar NAME="formfieldtype" VALUE="Variables.assetmaker/property/Proplist.ITEM/inputform/type"/>
		<setvar NAME="formfielddefault" VALUE="Variables.empty"/>
	
		<if COND="IsVariable.Variables.currentformprefix:Proplist.ITEM=true">
		<then>
			<setvar NAME="tmpITEM" VALUE="Variables.Variables.currentformprefix:Proplist.ITEM"/>
		</then>
		<else>
			<setvar NAME="tmpITEM" VALUE="Variables.empty"/>
		</else>
		</if>
		
		<if COND="Variables.tmpITEM=Variables.empty">
		<then>
			<if COND="Variables.formfunction=setformdefaults">
			<then>
				<if COND="IsVariable.assetmaker/property/Proplist.ITEM/inputform/default=true">
				<then>
					<setvar NAME="formfielddefault" VALUE="Variables.assetmaker/property/Proplist.ITEM/inputform/default"/>
				</then>
				</if>
			</then>
			</if>
		</then>
		</if>
			
		<if COND="Variables.formfielddefault=Variables.empty">
		<then>
			<!-- for url fields, we need to get the contents of the file, all others we can hanlde directly-->
			<BEGINS STR="Proplist.ITEM" WHAT="url"/>
			<if COND="Variables.errno=0"><!-- begins returned false -->
			<then>
				<setvar NAME="storagetype" VALUE="Variables.assetmaker/property/Proplist.ITEM/storage/type"/>
				<if COND="Variables.storagetype!=BINARY">
				<then>
					<if COND="IsVariable.Variables.currentformprefix:Proplist.ITEM=true">
					<then>
						<if COND="Variables.formfieldtype=UPLOAD">
						<then>
							<setvar NAME="formfielddefault" VALUE="Variables.Variables.currentformprefix:Proplist.ITEM"/>
						</then>
						<else>
							<ics.getvar name="Variables.currentformprefix:Proplist.ITEM" encoding="default" output="formfielddefault"/> 
						</else>
						</if>
					</then>
					<else>
						<setvar NAME="formfielddefault" VALUE="Variables.empty"/>
					</else>
					</if>
				</then>
				<else>
					<!-- this section applies to BINARY -->
					<if COND="Variables.formfieldtype=UPLOAD">
					<then>
						<ics.getvar name="Variables.currentformprefix:Proplist.ITEM" encoding="default" output="formfielddefault"/> 
						<if COND="Variables.formfielddefault!=Variables.empty">
						<then>
							<!--This is to reduce usage of memory by formfielddefault which has the binary data of the blob-->
							<setvar NAME="formfielddefault" VALUE="hasbinarydata"/>
						</then>
						</if>
					</then>
					<else>
						<ics.getvar name="Variables.currentformprefix:Proplist.ITEM" encoding="default" output="formfielddefault"/>						 
					</else>
					</if>
				</else>
				</if>
			</then>
			<else>
				<ics.getvar name="Variables.currentformprefix:Proplist.ITEM" encoding="default" output="formfielddefault"/> 
				<if COND="Variables.formfieldtype=UPLOAD">
				<then>
					<if COND="Variables.formfielddefault!=Variables.empty">
					<then>
						<!--This is to reduce usage of memory by formfielddefault which has the binary data of the blob-->
						<setvar NAME="formfielddefault" VALUE="hasbinarydata"/>
					</then>
					</if>
				</then>
				</if>
			</else>
			</if>
		</then>
		</if>
		
		<setvar NAME="ishidden" VALUE="Variables.assetmaker/property/Proplist.ITEM/inputform/hidden"/>
		<if COND="Variables.ishidden!=YES">
		<then>
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
			<tr>
			
			<!-- If the field name is either of the criteria fields, put the label inside a div-->
				<setvar name="criteriapropertylist" value="useragent,capabilities,screendimensions,customfilters"/>
				<stringlist NAME="criterionPropList" STR="Variables.criteriapropertylist" DELIM=","/>
                <loop LIST="criterionPropList" >				
					<if cond="Proplist.ITEM=criterionPropList.ITEM">
						<then>										
							<setvar name="criteriaDivName" value="criteriaSection" />
						</then>						
					</if>										
				</loop>
                     
										<td  CLASS="form-label-text">
										<div name="Variables.criteriaDivName" REPLACEALL="Variables.criteriaDivName" >
														<setvar NAME="isrequired" VALUE="Variables.assetmaker/property/Proplist.ITEM/inputform/required"/>
														<if COND="Variables.isrequired=YES">
														<then>
															<if COND="IsVariable.assetmaker/assettags/markertext=true">
															<then>
																<span class="alert-color"><STRING.STREAM VARIABLE="markertext"/></span>
															</then>
															<else>
																<if COND="IsVariable.assetmaker/assettags/markerimage=true">
																<then>
																	<IMG SRC="Variables.markerimage" REPLACEALL="Variables.markerimage"/>
																</then>
																</if>
															</else>
															</if>
														</then>
														</if>
														<setvar NAME="fielddesc" VALUE="Variables.assetmaker/property/Proplist.ITEM/description"/>
														<xlat.lookup KEY="Variables.fielddesc" VARNAME="fielddescription"/>
														<IF COND="Variables._missingkey_=-1">
														<THEN>
															<setvar NAME="fielddescription" VALUE="Variables.fielddesc"/>
															<removevar NAME="_missingkey_"/>
														</THEN>
														</IF>
														<removevar NAME="fielddesc"/>
														<STRING.STREAM VARIABLE="fielddescription"/>:
											</div>
										</td>							
					<setvar name="criteriaDivName" value="nonCriteriaSection" />					 
					
					<td></td>
					<td class="form-inset">
			
					<!-- check to see if it is an input field -->
					<if COND="Variables.formfieldtype=TEXT">
					<then>

						<callelement NAME="OpenMarket/AssetMaker/BuildEditInputField">
							<argument NAME="fieldname" VALUE="Proplist.ITEM"/>
							<argument NAME="fieldvalue" VALUE="Variables.formfielddefault"/>
						</callelement>
						<SETVAR NAME="formfieldlist" VALUE="Variables.formfieldlist,Variables.fieldname"/>
					</then>
					</if>

					<!-- check to see if it is a password field -->
					<if COND="Variables.formfieldtype=PASSWORD">
					<then>

						<callelement NAME="OpenMarket/AssetMaker/BuildEditPasswordField">
							<argument NAME="fieldname" VALUE="Proplist.ITEM"/>
							<argument NAME="fieldvalue" VALUE="Variables.formfielddefault"/>
						</callelement>
						<SETVAR NAME="formfieldlist" VALUE="Variables.formfieldlist,Variables.fieldname"/>
					</then>
					</if>

					<!-- check to see if it is a TextArea -->
					<if COND="Variables.formfieldtype=TEXTAREA">
					<then>

						<callelement NAME="OpenMarket/AssetMaker/BuildEditTextArea">
							<argument NAME="fieldname" VALUE="Proplist.ITEM"/>
							<argument NAME="fieldvalue" VALUE="Variables.formfielddefault"/>
						</callelement>
						<SETVAR NAME="formfieldlist" VALUE="Variables.formfieldlist,Variables.fieldname"/>
					</then>
					</if>
			
					<!-- check to see if it is an upload field -->
					<if COND="Variables.formfieldtype=UPLOAD">
					<then>
						<callelement NAME="OpenMarket/AssetMaker/BuildEditUpload">
							<argument NAME="fieldname" VALUE="Proplist.ITEM"/>
							<argument NAME="fieldvalue" VALUE="Variables.formfielddefault"/>
						</callelement>
					</then>
					</if>
			
					<!-- check to see if it is a select field -->
					<if COND="Variables.formfieldtype=SELECT">
					<then>

						<callelement NAME="OpenMarket/AssetMaker/BuildEditSelect">
							<argument NAME="fieldname" VALUE="Proplist.ITEM"/>
							<argument NAME="fieldvalue" VALUE="Variables.formfielddefault"/>
						</callelement>
						<SETVAR NAME="formfieldlist" VALUE="Variables.formfieldlist,Variables.fieldname"/>
					</then>
					</if>
			
					<!-- check to see if it is a checkbox field -->
					<if COND="Variables.formfieldtype=CHECKBOX">
					<then>

						<callelement NAME="OpenMarket/AssetMaker/BuildEditChkBox">
							<argument NAME="fieldname" VALUE="Proplist.ITEM"/>
							<argument NAME="fieldvalue" VALUE="Variables.formfielddefault"/>
						</callelement>
						<SETVAR NAME="formfieldlist" VALUE="Variables.formfieldlist,Variables.fieldname"/>
					</then>
					</if>
			
					<!-- check to see if it is a radio button field -->
					<if COND="Variables.formfieldtype=RADIO">
					<then>
						<callelement NAME="OpenMarket/AssetMaker/BuildEditRadioButton">
							<argument NAME="fieldname" VALUE="Proplist.ITEM"/>
							<argument NAME="fieldvalue" VALUE="Variables.formfielddefault"/>
						</callelement>
						<SETVAR NAME="formfieldlist" VALUE="Variables.formfieldlist,Variables.fieldname"/>
					</then>
					</if>
			
					<!-- check to see if it is an element field -->
					<if COND="Variables.formfieldtype=ELEMENT">
					<then>
						<callelement NAME="OpenMarket/AssetMaker/BuildElement">
							<argument NAME="fieldname" VALUE="Proplist.ITEM"/>
							<argument NAME="fieldvalue" VALUE="Variables.formfielddefault"/>
						</callelement>
						<SETVAR NAME="formfieldlist" VALUE="Variables.formfieldlist,Variables.fieldname"/>
					</then>
					</if>

					<!-- check to see if it is a EWEBEDITPRO field -->
					<if COND="Variables.formfieldtype=EWEBEDITPRO">
					<then>

						<callelement NAME="OpenMarket/AssetMaker/BuildEWebEditPro">
							<argument NAME="fieldname" VALUE="Proplist.ITEM"/>
							<argument NAME="fieldvalue" VALUE="Variables.formfielddefault"/>
						</callelement>
						<SETVAR NAME="formfieldlist" VALUE="Variables.formfieldlist,Variables.fieldname"/>
					</then>
					</if>
					
					<!-- check to see if it is a CKEDITOR field -->

					<!-- FCKEditor has been deprecated in Oracle Sites 11gR1 release and will be removed from here in future-->
					<SETVAR NAME="CK_FCK_EDITOR" VALUE="false"/>
					<IF COND="Variables.formfieldtype=CKEDITOR">
					<THEN>
						<SETVAR NAME="CK_FCK_EDITOR" VALUE="true"/>
					</THEN>
					</IF>
					<IF COND="Variables.formfieldtype=FCKEDITOR">
					<THEN>
						<SETVAR NAME="CK_FCK_EDITOR" VALUE="true"/>
					</THEN>
					</IF>
					<if COND="Variables.CK_FCK_EDITOR=true">
					<then>
						<callelement NAME="OpenMarket/AssetMaker/BuildCKEditor">
							<argument NAME="fieldname" VALUE="Proplist.ITEM"/>
							<argument NAME="fieldvalue" VALUE="Variables.formfielddefault"/>
						</callelement>
						<SETVAR NAME="formfieldlist" VALUE="Variables.formfieldlist,Variables.fieldname"/>
					</then>
					</if>


					<removevar NAME="formfielddefault"/>
					
					
					
				</td>
			</tr>
			<if cond="devicenamelist=Proplist.ITEM">
					<then>
					<tr><td colspan="3"><div style="height:10px;"></div></td></tr>
					
					<tr><td colspan="3">
					<br/>
					<!-- //show an arrow to hide/show other sections on this page. -->
					    <xlat.lookup KEY="dvin/AdminForms/HideCriteria" VARNAME="hideCriteria" />
						<div id="criteriaToggler" style="background-color:#b0c4de;height:3px;vertical-align: top;">
						<div style="margin: auto; height: 8px; width: 5px;">
						<img  alt="Variables.hideCriteria" title="Variables.hideCriteria" id="criteriaDividerId" align="center"  src='Variables.cs_imagedir/graphics/common/icon/drop-down-arrow-up.png'  style="cursor: pointer;" onClick="javascript:showHideCriteriaSections()" REPLACEALL="Variables.cs_imagedir,Variables.hideCriteria"/>
						</div>
						</div>
						<br/>
					</td></tr>
					
					</then>
					</if>
					
		</then>
		<else>
			<SETVAR NAME="fieldname" VALUE="Proplist.ITEM"/>
			<SETVAR NAME="fieldvalue" VALUE="Variables.formfielddefault"/>
			<SETVAR NAME="formfieldlist" VALUE="Variables.formfieldlist,Variables.fieldname"/>
			<INPUT TYPE="hidden" NAME="Variables.AssetType:Variables.fieldname" VALUE="Variables.fieldvalue" REPLACEALL="Variables.fieldvalue,Variables.fieldname,Variables.AssetType"/>
		</else>
		</if>
	</loop>
</then>
</if>
<DEBABBLE VALUE="true"/>
</ftcs> 
