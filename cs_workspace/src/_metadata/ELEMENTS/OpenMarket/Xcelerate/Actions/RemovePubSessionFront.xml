<?xml version="1.0" ?>
<!DOCTYPE FTCS SYSTEM "futuretense_cs.dtd">
<FTCS Version="1.1">
<!-- OpenMarket/Xcelerate/Actions/RemovePubSessionFront
-
- INPUT
-
- OUTPUT
-
-->
<STRING.ENCODE VARIABLE="cs_imagedir" VARNAME="cs_imagedir"/>
<!-- Continue only if conditions from prologactions are satisfied -->
<if COND="Variables.doproceed=true">
<then>
<SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Actions/PublishConsoleFront" outstring="urlpubconsfront">
    <satellite.argument name="cs_environment" value="Variables.cs_environment"/>
    <satellite.argument name="cs_formmode" value="Variables.cs_formmode"/>
	<satellite.argument name="rows" value="Variables.rows"/>
	<satellite.argument name="defaultTab" value="_t3"/>
</SATELLITE.LINK>
<SCRIPT LANGUAGE="JavaScript">
<replaceall LIST="Variables.urlpubconsfront">

<![CDATA[
function SetCancelFlag () {
	var pURL = "Variables.urlpubconsfront";
	]]>
    <if cond="Variables.cs_environment=portal">
    <then>
        window.close();
    </then>
    <else>
	    parent.frames['XcelAction'].location=pURL;
    </else>
    </if> <![CDATA[
    return false;
}
]]>

</replaceall>
</SCRIPT>
<setvar NAME="all_valid" VALUE="true" />
<setvar name="ConfirmDeletePublishSession" value="false"/>
<STRINGLIST NAME="pubSessionIds" STR="Variables.id" DELIM="%20"/>
<LOOP LIST="pubSessionIds">
<if COND="pubSessionIds.#numRows=1" >
<then>
<PUBSESSIONMANAGER.LOAD ID="Variables.id" OBJVARNAME="pubsess"/>
<table cellpadding="0" cellspacing="0" border="0" class="width-outer-70"><tr><td>
<if COND="IsError.Variables.errno=true">
<then>
	<STRING.STREAM VALUE="Variables.errno"/>
	<setvar NAME="id_valid" VALUE="false" />
</then>
<else>
   <setvar NAME="id_valid" VALUE="true" />
<XLAT.LOOKUP KEY="dvin/UI/Publish/ConfirmDeletePublishSession" VARNAME="_XLAT_"/> 
<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/ShowMessage">
	<argument NAME="msgtext" VALUE="Variables._XLAT_"/>
	<argument NAME="severity" VALUE="warning"/>
</callelement>
</else>
</if>
</td></tr>
<callelement name="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
<tr>
    <td><span class="title-text"><XLAT.STREAM KEY="dvin/UI/DeletePublishSession"/>: </span><span class="title-value-text"><STRING.STREAM VALUE="Variables.id"/></span></td>
</tr>
    
<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/TitleBar">
    <argument NAME="SpaceBelow" VALUE="No"/>
</callelement>

<if COND="Variables.id_valid=true" >
<then>
    <!-- get target name -->
    <PUBSESSION.GETTARGET NAME="pubsess" VARNAME="targetid"/>
	 <PUBTARGETMANAGER.LOAD ID="Variables.targetid" OBJVARNAME="pubtgt"/>
	 <PUBTARGET.GETNAME NAME="pubtgt" VARNAME="pubtgt:name"/>
    
    <!-- Verifies if user has access to specific pub session -->
    <CALLELEMENT NAME="OpenMarket/Xcelerate/Actions/Security/PublishAccessCheck">
        <ARGUMENT NAME="targetid" VALUE="Variables.targetid"/>
    </CALLELEMENT>
    <if COND="Variables.doproceed=true">
    <then>
    <tr>
        <td>
			<table cellpadding="0" cellspacing="0" border="0">
            <tr>
                <td class="form-label-text"><XLAT.STREAM KEY="dvin/Common/Destination"/>:</td>
                <td><img height="1" width="5" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>
                <td class="form-inset"><STRING.STREAM VALUE="Variables.pubtgt:name"/></td>
            </tr>       
            
            <callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
            <tr>
                <td class="form-label-text"><XLAT.STREAM KEY="dvin/UI/PublishTime"/>:</td>
                <td><img height="1" width="5" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>
                <td class="form-inset">
                <PUBSESSION.GETSTARTDATE NAME="pubsess" VARNAME="pubsess:startdate"/>
                <DATEFORMAT.GETDATETIME NAME="_FormatDate_" VALUE="Variables.pubsess:startdate" VALUETYPE="jdbcdate"  VARNAME="publishdate"/>
					 <STRING.STREAM VALUE="Variables.publishdate"/></td>
            </tr>
            
            <callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
            <tr>
                <td class="form-label-text"><XLAT.STREAM KEY="dvin/AT/Common/Status"/>:</td>
                <td></td>
                <td class="form-inset">
                	  <PUBSESSION.GETSTATUS NAME="pubsess" VARNAME="pubsess:status"/>
                    <if COND="Variables.pubsess:status=done">
                    <then>
            		     <XLAT.STREAM KEY="dvin/Common/Done"/>
            		</then>
                    <else>
            		     <if COND="Variables.pubsess:status=running">
            		     <then>
            		          <XLAT.STREAM KEY="dvin/Common/Running"/>    
            		     </then>
            		     <else>
            		          <XLAT.STREAM KEY="dvin/Common/Failed"/>
            		     </else>
            		     </if>
            		</else>
            		</if>
                </td>
            </tr>
            
            <callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
            <tr>
                <td class="form-label-text"><XLAT.STREAM KEY="dvin/Common/Publishedby"/>:</td>
                <td><img height="1" width="5" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>
                <td class="form-inset">
                <PUBSESSION.GETUSER NAME="pubsess" VARNAME="pubsess:user"/>
                <STRING.STREAM VALUE="Variables.pubsess:user"/></td>
            </tr>       
            </table>
        </td>
    </tr>
    <callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/FooterBar"/>      
    <tr>
        <td colspan="5" height="5"><img height="5" width="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>
    </tr>
    </then>
    <else>
        <setvar NAME="id_valid" VALUE="false"/>
    </else>
    </if>
</then>

<else>
        <setvar NAME="id_valid" VALUE="false"/>
    <tr>
        <td> <XLAT.LOOKUP KEY="dvin/UI/Publish/PublishSessionDeletedAlready" VARNAME="_XLAT_"/> 
             <callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/ShowMessage">
                <argument NAME="msgtext" VALUE="Variables._XLAT_"/>
                <argument NAME="severity" VALUE="warning"/>
             </callelement>
        </td>
    </tr>
</else>
</if>

<tr>
    <td align="right"><XLAT.LOOKUP KEY="dvin/UI/CancelDelete" VARNAME="_XLAT_" ESCAPE="true"/>
    <A HREF="javascript:void(0)" onclick="return SetCancelFlag()" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true;" REPLACEALL="Variables._XLAT_"><CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/Cancel"/></CALLELEMENT></A>
    
    <if COND="Variables.id_valid=true">
    <then>
        <XLAT.LOOKUP KEY="dvin/UI/Deletethisitem" VARNAME="_XLAT_" ESCAPE="true"/>
        <A HREF="javascript:void(0)" onclick="document.forms[0].submit();return false;" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true;" REPLACEALL="Variables._XLAT_"><CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/Delete"/></CALLELEMENT></A>
    </then>
    </if>
    </td>    
</tr>
</table>
</then>
<else>
<table cellpadding="0" cellspacing="0" border="0" class="width-outer-70">
<tr><td>
<setvar NAME="_multiDel" VALUE="true" />
<PUBSESSIONMANAGER.LOAD ID="pubSessionIds.ITEM" OBJVARNAME="pubsess"/>
<if COND="IsError.Variables.errno=true">
<then>
	<STRING.STREAM VALUE="Variables.errno"/>
	<setvar NAME="id_valid" VALUE="false" />
	<setvar NAME="all_valid" VALUE="false" />
</then>
<else>
   <setvar NAME="id_valid" VALUE="true" />
   <if cond="Variables.ConfirmDeletePublishSession=false">
	<then>
	<XLAT.LOOKUP KEY="dvin/UI/Publish/ConfirmDeletePublishSession" VARNAME="_XLAT_"/>
	<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/ShowMessage">
		<argument NAME="msgtext" VALUE="Variables._XLAT_"/>
		<argument NAME="severity" VALUE="warning"/>
	</callelement>
	<setvar name="ConfirmDeletePublishSession" value="true"/>
	</then>
	</if>
</else>
</if>
</td></tr>
</table>
<table cellpadding="0" cellspacing="0" border="0" class="width-outer-70">
<tr>
    <td><span class="title-text"><XLAT.STREAM KEY="dvin/UI/DeletePublishSession"/>: </span><span class="title-value-text"><STRING.STREAM VALUE="pubSessionIds.ITEM"/></span></td>
</tr>
    
<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/TitleBar">
    <argument NAME="SpaceBelow" VALUE="No"/>
</callelement>

<if COND="Variables.id_valid=true" >
<then>
    <!-- get target name -->
    <PUBSESSION.GETTARGET NAME="pubsess" VARNAME="targetid"/>
	 <PUBTARGETMANAGER.LOAD ID="Variables.targetid" OBJVARNAME="pubtgt"/>
	 <PUBTARGET.GETNAME NAME="pubtgt" VARNAME="pubtgt:name"/>
    <!-- Verifies if user has access to specific pub session -->
     <CALLELEMENT NAME="OpenMarket/Xcelerate/Actions/Security/PublishAccessCheck">
         <ARGUMENT NAME="targetid" VALUE="Variables.targetid"/>
     </CALLELEMENT>
    <if COND="Variables.doproceed=true">
    <then>
    <tr>
        <td>
		    <table cellpadding="0" cellspacing="0" border="0">
            <tr>
				<td class="form-label-text"><XLAT.STREAM KEY="dvin/Common/Destination"/>:</td>
                <td><img height="1" width="5" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>
                <td class="form-inset"><STRING.STREAM VALUE="Variables.pubtgt:name"/></td>
            </tr>       
            
            <callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
            <tr>
                <td class="form-label-text"><XLAT.STREAM KEY="dvin/UI/PublishTime"/>:</td>
                <td><img height="1" width="5" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>
                <td class="form-inset">
                <PUBSESSION.GETSTARTDATE NAME="pubsess" VARNAME="pubsess:startdate"/>
                <DATEFORMAT.GETDATETIME NAME="_FormatDate_" VALUE="Variables.pubsess:startdate" VALUETYPE="jdbcdate"  VARNAME="publishdate"/>
					 <STRING.STREAM VALUE="Variables.publishdate"/></td>
            </tr>
            
            <callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
            <tr>
                <td class="form-label-text"><XLAT.STREAM KEY="dvin/AT/Common/Status"/>:</td>
                <td></td>
                <td class="form-inset">
                	  <PUBSESSION.GETSTATUS NAME="pubsess" VARNAME="pubsess:status"/>
                    <if COND="Variables.pubsess:status=done">
                    <then>
            		     <XLAT.STREAM KEY="dvin/Common/Done"/>
            		</then>
                    <else>
            		     <if COND="Variables.pubsess:status=running">
            		     <then>
            		          <XLAT.STREAM KEY="dvin/Common/Running"/>    
            		     </then>
            		     <else>
            		          <XLAT.STREAM KEY="dvin/Common/Failed"/>
            		     </else>
            		     </if>
            		</else>
            		</if>
                </td>
            </tr>
            
            <callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
            <tr>
                <td class="form-label-text"><XLAT.STREAM KEY="dvin/Common/Publishedby"/>:</td>
                <td><img height="1" width="5" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>
                <td class="form-inset">
                <PUBSESSION.GETUSER NAME="pubsess" VARNAME="pubsess:user"/>
                <STRING.STREAM VALUE="Variables.pubsess:user"/></td>
            </tr>       
            </table>
        </td>
    </tr>
    <tr>
        <td colspan="5" height="5"><img height="5" width="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>
    </tr>
	<!--<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacerBar"/>-->
    <callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
    <callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
    </then>
    <else>
        <setvar NAME="all_valid" VALUE="false"/>
    </else>
    </if>
</then>

<else>
        <setvar NAME="all_valid" VALUE="false"/>
    <tr>
        <td> <XLAT.LOOKUP KEY="dvin/UI/Publish/PublishSessionDeletedAlready" VARNAME="_XLAT_"/> 
             <callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/ShowMessage">
                <argument NAME="msgtext" VALUE="Variables._XLAT_"/>
                <argument NAME="severity" VALUE="warning"/>
             </callelement>
        </td>
    </tr>
</else>
</if>
</table>

</else>
</if>
</LOOP>
<STRING.ENCODE VARIABLE="PostPage" VARNAME="PostPage"/>
<INPUT type="hidden" name="pagename" value="OpenMarket/Xcelerate/Actions/Variables.PostPage"  REPLACEALL="Variables.PostPage"/>
<STRING.ENCODE VARIABLE="id" VARNAME="id"/>
<INPUT type="hidden" name="id" VALUE="Variables.id" REPLACEALL="Variables.id"/> 
<if cond="Variables._multiDel=true">
<then>
<table cellpadding="0" cellspacing="0" border="0" class="width-outer-70">
<tr>
    <td align="right"><XLAT.LOOKUP KEY="dvin/UI/CancelDelete" VARNAME="_XLAT_" ESCAPE="true"/>
    <A HREF="javascript:void(0)" onclick="return SetCancelFlag()" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true;" REPLACEALL="Variables._XLAT_"><CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/Cancel"/></CALLELEMENT></A>
    
    <if COND="Variables.all_valid=true">
    <then>
		<XLAT.LOOKUP KEY="dvin/UI/Deletethisitem" VARNAME="_XLAT_" ESCAPE="true"/>
        <A HREF="javascript:void(0)" onclick="document.forms[0].submit();return false;" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true;" REPLACEALL="Variables._XLAT_"><CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/Delete"/></CALLELEMENT></A>
    </then>
    </if>
    </td>    
</tr>
</table>
</then>
</if>
</then></if>
</FTCS> 
