<?xml version="1.0" ?>
<!DOCTYPE FTCS SYSTEM "futuretense_cs.dtd">
<FTCS Version="1.1">
<!-- OpenMarket/Xcelerate/Actions/UserProfileFront

 INPUT

 OUTPUT

-->
<STRING.ENCODE VARIABLE="cs_imagedir" VARNAME="cs_imagedir"/> 
<STRING.ENCODE VARIABLE="id" VARNAME="id"/> 

	<table class="width-outer-70" cellspacing="0" cellpadding="0" border="0">
		<tr><td>
			<span class="title-text"><XLAT.STREAM KEY="dvin/UI/UserProfileManager"/></span>
		</td></tr>
		<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/TitleBar"/>
	</table>

	<!-- get the currently logged in user object and display their locale preference -->
	<USERMANAGER.GETLOGINUSER VARNAME="loginuser"/>
	<USERMANAGER.GETUSER USER="Variables.loginuser" OBJVARNAME="userobj"/>
	<CCUSER.GETLOCALE NAME="userobj" VARNAME="userLocalePref"/>
	<IF COND="IsVariable.action=false">
	<THEN>
		<SETVAR NAME="action" VALUE="details"/>
	</THEN>
	</IF>

   <TABLE BORDER="0" CELLSPACING="0" CELLPADDING="0">
		<TR>
			<TD></TD>
			<TD CLASS="tile-dark" VALIGN="TOP" HEIGHT="1">
				<IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/>
			</TD>
			<TD></TD>
		</TR>
		<TR>
			<TD CLASS="tile-dark" VALIGN="top" WIDTH="1">
				<BR />
			</TD>
			<TD>
				<TABLE WIDTH="100%" CELLPADDING="0" CELLSPACING="0" BORDER="0" BGCOLOR="#ffffff">
					<TR>
						<TD COLSPAN="3" CLASS="tile-highlight">
							<IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/>
						</TD>
					</TR>
					<TR>
						<TD HEIGHT="16" CLASS="tile-a" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;</TD>
						<TD CLASS="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;
							<BR />
						</TD>
						<TD CLASS="tile-c" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;</TD>
					</TR>
					<TR>
						<TD COLSPAN="3" CLASS="tile-dark">
							<IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/>
						</TD>
					</TR>
					<TR>
						<TD CLASS="form-label-text" COLSPAN="3">
							<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0">
								<TR>
									<TD>
										<XLAT.LOOKUP KEY="dvin/Common/Inspect" VARNAME="_XLAT_" ESCAPE="true"/>
										<XLAT.LOOKUP KEY="dvin/UI/Admin/InspectThisFunction" VARNAME="_ALT_"/>
                                            <SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Actions/UserProfileFront" outstring="urlusrproffront">
                                                <satellite.argument name="cs_environment" value="Variables.cs_environment"/>
                                               <satellite.argument name="cs_formmode" value="Variables.cs_formmode"/>
                                             <satellite.argument name="action" value="details"/>
                                              </SATELLITE.LINK>
										<A HREF="Variables.urlusrproffront" ONMOUSEOVER="window.status='Variables._XLAT_';return true;" ONMOUSEOUT="window.status='';return true" REPLACEALL="Variables.urlusrproffront,Variables.id,Variables._XLAT_">
											<IMG HEIGHT="14" WIDTH="14" HSPACE="2" vspace="4" src="Variables.cs_imagedir/graphics/common/icon/iconInspectContent.gif"  BORDER="0" ALT="Variables._ALT_" title="Variables._ALT_" REPLACEALL="Variables.cs_imagedir,Variables._ALT_"/>
										</A>
									</TD>
									<TD>
										<A HREF="Variables.urlusrproffront" ONMOUSEOVER="window.status='Variables._XLAT_';return true;" ONMOUSEOUT="window.status='';return true" REPLACEALL="Variables.urlusrproffront,Variables.id,Variables._XLAT_">
											<SPAN CLASS="action-text">
												<XLAT.STREAM KEY="dvin/Common/Inspect"/>
											</SPAN>
										</A>
									</TD>

									<TD>&nbsp;&nbsp;&nbsp;&nbsp;</TD>

									<TD>
										<XLAT.LOOKUP KEY="dvin/Common/Edit" VARNAME="_XLAT_" ESCAPE="true"/>
										<XLAT.LOOKUP KEY="dvin/UI/Admin/EditThisFunction" VARNAME="_ALT_"/>
                                           <SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Actions/UserProfileFront" outstring="urlusrproffront">
                                               <satellite.argument name="cs_environment" value="Variables.cs_environment"/>
                                               <satellite.argument name="cs_formmode" value="Variables.cs_formmode"/>
                                             <satellite.argument name="action" value="edit"/>
                                              </SATELLITE.LINK>
										<A HREF="Variables.urlusrproffront" ONMOUSEOVER="window.status='Variables._XLAT_';return true;" ONMOUSEOUT="window.status='';return true" REPLACEALL="Variables.urlusrproffront,Variables.id,Variables._XLAT_">
											<IMG HEIGHT="14" WIDTH="14" src="Variables.cs_imagedir/graphics/common/icon/iconEditContentUp.gif" HSPACE="2" BORDER="0" ALT="Variables._ALT_" title="Variables._ALT_" REPLACEALL="Variables.cs_imagedir,Variables._ALT_"/>
										</A>
									</TD>
									<TD>
										<A HREF="Variables.urlusrproffront" ONMOUSEOVER="window.status='Variables._XLAT_';return true;" ONMOUSEOUT="window.status='';return true" REPLACEALL="Variables.urlusrproffront,Variables.id,Variables._XLAT_">
											<SPAN CLASS="action-text">
												<XLAT.STREAM KEY="dvin/Common/Edit"/>
											</SPAN>
										</A>
									</TD>
									<TD>&nbsp;&nbsp;&nbsp;&nbsp;</TD>
								</TR>
							</TABLE>
						</TD>
					</TR>
				</TABLE>
				<TABLE WIDTH="100%" CELLPADDING="0" CELLSPACING="0" BORDER="0" BGCOLOR="#ffffff">
					<TR>
						<!--<TD COLSPAN="2" CLASS="light-line-color">
							<IMG HEIGHT="1" WIDTH="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/>
						</TD>-->
					</TR>
					<TR>
						<TD CLASS="form-label-text" WIDTH="30%">
							<XLAT.STREAM KEY="dvin/UI/Languagepreference"/>:
						</TD>
						<TD CLASS="form-inset" WIDTH="70%">
								<NOBR>
									<SETVAR NAME="errno" VALUE="0"/>
									<SETVAR NAME="tablename" VALUE="LocaleMap"/>
									
									<IF COND="Variables.action=details">
									<THEN>
										<!-- get list of available server locales -->
										<IF COND="IsVariable.userLocalePref=true">
										<THEN>
											<CALLELEMENT NAME="OpenMarket/Xcelerate/Util/validateFields">
												<ARGUMENT NAME="columnvalue" VALUE="Variables.userLocalePref"/>
												<ARGUMENT NAME="type" VALUE="String"/>
											</CALLELEMENT>
											<IF COND="Variables.validatedstatus=true">
											<THEN>
												<EXECSQL SQL="SELECT * FROM LocaleMap WHERE id='Variables.userLocalePref'" LIST="lUserPref"/>
											</THEN>
											</IF>
											<STRING.STREAM LIST="lUserPref" COLUMN="language"/>
										</THEN>
										<ELSE>
											<XLAT.STREAM KEY="dvin/UI/Admin/Nopreference"/>
										</ELSE>
										</IF>
									</THEN>
									<ELSE>
										<PROPERTY.GET PARAM="xcelerate.localeattr" INIFILE="futuretense_xcel.ini" VARNAME="proplocaleattr"/>
										<IF COND="Variables.proplocaleattr=Variables.empty">
										<THEN>
											<XLAT.STREAM KEY="dvin/UI/Admin/Error/PreferenceNotEnabled"/>
										</THEN>
										<ELSE>
											<EXECSQL SQL="SELECT * FROM LocaleMap ORDER BY language" LIST="lServerLocales"/>
											<SELECT NAME="selectedLocale" SIZE="1">
												<OPTION VALUE="None"><XLAT.STREAM KEY="dvin/UI/Admin/Nopreference"/></OPTION>
												<LOOP LIST="lServerLocales">
													<IF COND="lServerLocales.id=Variables.userLocalePref">
														<THEN>
															<OPTION VALUE="lServerLocales.id" SELECTED="yes" REPLACEALL="lServerLocales.id">
																<STRING.STREAM LIST="lServerLocales" COLUMN="language"/>
															</OPTION>
														</THEN>
														<ELSE>
															<OPTION VALUE="lServerLocales.id" REPLACEALL="lServerLocales.id">
																<STRING.STREAM LIST="lServerLocales" COLUMN="language"/>
															</OPTION>
														</ELSE>
													</IF>
												</LOOP>
											</SELECT>
										</ELSE>
										</IF>
									</ELSE>
									</IF>
								</NOBR>
						</TD>
					</TR>
				</TABLE>
			</TD>
			<TD CLASS="tile-dark" VALIGN="top" WIDTH="1">
				<BR />
			</TD>
		</TR>
		<TR>
			<TD COLSPAN="3" CLASS="tile-dark" VALIGN="TOP" HEIGHT="1">
				<IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/>
			</TD>
		</TR>
		<TR>
			<TD></TD>
			<TD background="Variables.cs_imagedir/graphics/common/screen/shadow.gif" REPLACEALL="Variables.cs_imagedir">
				<IMG WIDTH="1" HEIGHT="5" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/>
			</TD>
			<TD></TD>
		</TR>
	</TABLE>
	

	<BR/>
	<IF COND="Variables.action=edit">
	<THEN>
		<IF COND="Variables.proplocaleattr!=Variables.empty">
		<THEN>
			<INPUT TYPE="SUBMIT" VALUE="Save profile"/>
		</THEN>
		</IF>
	</THEN>
	</IF>
	<STRING.ENCODE VARIABLE="PostPage" VARNAME="PostPage"/> 
	<INPUT TYPE="HIDDEN" NAME="pagename" VALUE="OpenMarket/Xcelerate/Actions/Variables.PostPage" REPLACEALL="Variables.PostPage"/>

</FTCS> 
