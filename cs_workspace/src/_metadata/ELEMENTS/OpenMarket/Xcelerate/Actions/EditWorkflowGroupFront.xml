<?xml version="1.0" ?>
<!DOCTYPE FTCS SYSTEM "futuretense_cs.dtd">
<FTCS Version="1.1">
<!-- OpenMarket/Xcelerate/Actions/EditWorkflowGroupFront
-
- INPUT
-
- OUTPUT
-
-->
<STRING.ENCODE VARIABLE="id" VARNAME="id"/> 
<STRING.ENCODE VARIABLE="cs_imagedir" VARNAME="cs_imagedir"/> 
<STRING.ENCODE VARIABLE="WorkflowFrontURL" VARNAME="WorkflowFrontURL"/> 
<STRING.ENCODE VARIABLE="PostPage" VARNAME="PostPage"/> 

<CALLELEMENT NAME="OpenMarket/Xcelerate/Scripts/FormatDate" />
<callelement NAME="OpenMarket/Xcelerate/Util/ClientoffsetInMillis"/>
<SCRIPT LANGUAGE="JavaScript" DEFER="DEFER">
var clientOffset = <CSVAR NAME="Variables.clientOffset" />
<![CDATA[
var obj;
function SaveGroup() 
{ 
 obj = document.forms[0].elements[0];
	
	//Since you can not specify a name remove name validation (which was otherwise wrong) Josiah
	
	if (obj.form.elements['description'].value=="")
	{
	    ]]>
        alert("<XLAT.STREAM KEY="dvin/UI/Error/YouMustSpecifyGroupDescription" ESCAPE="true" ENCODE="false"/>");
        <![CDATA[
		obj.form.description.focus();
		return false;
	}
if (obj.form.process.options.selectedIndex=="-1" || obj.form.process.options.selectedIndex=="0")
	{
		]]>
		alert("<XLAT.STREAM KEY="dvin/UI/Error/specifyworkflowprocessgroup" ESCAPE="true" ENCODE="false"/>");
		<![CDATA[
		obj.form.process.focus();
		return false;
	}
	if (obj.form.elements['addremove'][1].checked==true && obj.form.editroles.options.selectedIndex=="-1")
	{
		]]>
		alert("<XLAT.STREAM KEY="dvin/UI/Error/specifyrolesaddremoveassetsgroup" ESCAPE="true" ENCODE="false"/>");
		<![CDATA[
		obj.form.editroles.focus();
		return false;
	}	
	if (obj.form.editdelete[1].checked==true && obj.form.removeroles.options.selectedIndex=="-1")
	{
		]]>
		alert("<XLAT.STREAM KEY="dvin/UI/Error/specifyroleseditdeletegroup" ESCAPE="true" ENCODE="false"/>");
		<![CDATA[
		obj.form.removeroles.focus();
		return false;
	}
	if (obj.form.elements['allRoles'].value=="")
	{
		]]>
		alert("<XLAT.STREAM KEY="dvin/UI/Error/specifyparticipantsgroupClickcont" ENCODE="false" ESCAPE="true"/>");
		<![CDATA[
		return false;
	}
    if(obj.form.elements['dosetpdeadline'].value=="true")
    {
        if (obj.form.elements['donotsetProcessDeadline'][0].checked) {
            obj.form.elements['pdeadline'].value = 0;
        } else {  // obj.form.elements['donotsetProcessDeadline'][1].checked
            var deadline_date = document.getElementById('deadlineFieldDiv').innerHTML;
            if (deadline_date == "" || deadline_date=="0")
            {
                ]]>
                alert("<XLAT.STREAM KEY="dvin/UI/Error/processdeadlineenterednotvaliddate" ESCAPE="true" ENCODE="false"/>");
                <![CDATA[
                return false;
            }

            var now = new Date();
			var cur_date = new Date(now.getTime() + clientOffset + now.getTimezoneOffset()*60*1000 );
            pdeadlineVal = dateToObject(deadline_date).valueOf();
            if (pdeadlineVal < cur_date.valueOf())
            {
               ]]>
               alert("<XLAT.STREAM KEY="dvin/UI/Error/processdeadlineearliercurrenttime" ESCAPE="true" ENCODE="false"/>");
               <![CDATA[
               return false;
            }

            obj.form.elements['pdeadline'].value = pdeadlineVal;
        }
    }


	obj.form.elements['pagename'].value = "OpenMarket/Xcelerate/Actions/EditWorkflowGroupPost";
	obj.form.elements['action'].value = "save";
}

function SetParticipants()
{
 obj = document.forms[0].elements[0];
	if ( ( obj.form.elements['name'].value.search(/['"?;:]/) != -1 ) ||
			 ( obj.form.elements['name'].value.length == 0 ) ||
       ( obj.form.elements['name'].value.match(/^[\s]/) != null ) ) {

	//Here means something is wrong, let us figure out what

			if ( ( obj.form.elements['name'].value.search(/['"?;:]/) != -1 ) ) {
                ]]>
                alert("<XLAT.STREAM KEY="dvin/UI/Error/InvalidCharacterInGroupName" ENCODE="false" ESCAPE="true"/>");
                <![CDATA[
			}
	
			if (obj.form.elements['name'].value.length == 0) {
                ]]>
                alert("<XLAT.STREAM KEY="dvin/UI/Error/specifygroupname" ESCAPE="true" ENCODE="false"/>");
                <![CDATA[
				
			}
			
			if ( obj.form.elements['name'].value.match(/^[\s]/) != null ) {
                ]]>
                alert("<XLAT.STREAM KEY="dvin/UI/Error/GroupNameCanNotStartWithSpace" ESCAPE="true" ENCODE="false"/>");
                <![CDATA[
			}

			obj.form.name.focus();
			return false;
	}
	if (obj.form.elements['description'].value=="")
	{
		]]>
        alert("<XLAT.STREAM KEY="dvin/UI/Error/YouMustSpecifyGroupDescription" ESCAPE="true" ENCODE="false"/>");
        <![CDATA[
		obj.form.description.focus();
		return false;
	}
//
	if (obj.form.pdlinetype.value=="ask")
	{
		if (obj.form.elements['donotsetProcessDeadline'][1].checked) 
		{
			var deadline_date = document.getElementById('deadlineFieldDiv').innerHTML;
            if (deadline_date == "" || deadline_date=="0")
			{
				]]>
				alert("<XLAT.STREAM KEY="dvin/UI/Error/processdeadlineenterednotvaliddate" ESCAPE="true" ENCODE="false"/>");
				<![CDATA[
				return false;
			}

            var now = new Date();
			var cur_date = new Date(now.getTime() + clientOffset + now.getTimezoneOffset()*60*1000 );
			pdeadlineVal = dateToObject(deadline_date).valueOf();
            if (pdeadlineVal < cur_date.valueOf())
			{
				]]>
				alert("<XLAT.STREAM KEY="dvin/UI/Error/processdeadlineearliercurrenttime" ESCAPE="true" ENCODE="false"/>");
				<![CDATA[
				return false;
			}
			obj.form.elements['pdeadline'].value = pdeadlineVal;
		} else {
            obj.form.elements['pdeadline'].value = 0;
        }
	} else { // deadline type is "none"
		obj.form.elements['pdeadline'].value = 0;
	}
	
//
	if (obj.form.process.options.selectedIndex=="-1" || obj.form.process.options.selectedIndex=="0")
	{
		]]>
		alert("<XLAT.STREAM KEY="dvin/UI/Error/specifyworkflowprocessgroup" ESCAPE="true" ENCODE="false"/>");
		<![CDATA[
		obj.form.process.focus();
		return false;
	}
	obj.form.elements['pagename'].value = "OpenMarket/Xcelerate/Actions/SetGroupParticipants";
	obj.form.elements['action'].value = "update";
	
	return true;
}

function donotsetPDeadline()
{
    var obj = document.getElementById('pdeadline_div');
    obj.style.visibility='hidden';
}

function setProcessDeadline()
{
    var obj = document.getElementById('pdeadline_div');
    obj.style.visibility='visible';
}
function chooseNewParticipants(obj)
{
	if (SetParticipants())
	{
	obj.form.submit();
	}
	return true;
}
]]>
</SCRIPT>
<callelement NAME="OpenMarket/Xcelerate/Actions/Workflow/WorkflowGroupParticipantScript"/>

<table class="width-outer-70" cellspacing="0" cellpadding="0" border="0">
	<tr><td>
	<IF COND="Variables.actionTitle=Edit">
		<THEN>  
	    <span class="title-text"><XLAT.STREAM KEY="dvin/UI/EditWorkflowGroup"/></span>
		</THEN>
		</IF>
		
		<IF COND="Variables.actionTitle=Create">
		<THEN>
		<span class="title-text"><XLAT.STREAM KEY="dvin/UI/CreateWorkflowGroup"/></span>    
		</THEN>
		</IF>
		
	</td></tr>
	<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/TitleBar"/>
</table>

<if COND="IsVariable.pdeadline=true">
<then>
	<setvar NAME="ProcessDeadline" VALUE="Variables.pdeadline"/>
</then>
</if>
<STRING.ENCODE VARIABLE="new" VARNAME="new"/> 
<INPUT TYPE="HIDDEN" NAME="new" VALUE="Variables.new" REPLACEALL="Variables.new"/>

<IF COND="IsVariable.id=true">
<THEN>
	<INPUT TYPE="HIDDEN" NAME="id" VALUE="Variables.id" REPLACEALL="Variables.id"/>
</THEN>
</IF>

<!-- Table header -->
<table class="width-outer-50" BORDER="0" CELLSPACING="0" CELLPADDING="0">
	<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
	<tr>
		<td class="form-label-text">
			<span class="alert-color">*</span><XLAT.STREAM KEY="dvin/Common/GroupName"/>:
		</td>
		<td class="form-inset">
			<IF COND="Variables.new=true">
			<THEN>
				<STRING.ENCODE VARIABLE="wfg:name" VARNAME="wfg:name"/> 
				<INPUT TYPE="TEXT" SIZE="32" MAXLENGTH="24" NAME="name" VALUE="Variables.wfg:name" REPLACEALL="Variables.wfg:name"/>
			</THEN>
			<ELSE>
				<STRING.STREAM VALUE="Variables.wfg:name"/>
				<STRING.ENCODE VARIABLE="wfg:name" VARNAME="OutputQString"/>
				<INPUT TYPE="HIDDEN" VALUE="Variables.OutputQString" NAME="name" REPLACEALL="Variables.OutputQString"/><BR />
			</ELSE>
			</IF>
		</td>
	</tr>
	<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
	<tr>
		<td class="form-label-text">
			<span class="alert-color">*</span><XLAT.STREAM KEY="dvin/AT/Common/Description"/>:
		</td>
		<td class="form-inset">
			<SETVAR NAME="OutputQString" VALUE="Variables.empty"/>
			<STRING.ENCODE VARIABLE="wfg:description" VARNAME="OutputQString"/>
			<INPUT TYPE="TEXT" SIZE="32" MAXLENGTH="64" NAME="description" VALUE="Variables.OutputQString" REPLACEALL="Variables.OutputQString"/>
		</td>
	</tr>
	<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>

	<tr>
		<td class="form-label-text">
			<span class="alert-color">*</span><XLAT.STREAM KEY="dvin/Common/WorkflowProcess"/>:
		</td>
		<td class="form-inset">
			<SELECT NAME="process" SIZE="1" ONCHANGE="return chooseNewParticipants(this);">
				<OPTION VALUE=""/>--<XLAT.STREAM KEY="dvin/Common/SelectWorkflowProcess"/>--
			<WORKFLOWENGINE.GETALLPROCESSES PUBID="SessionVariables.pubid" NAME="processes" PREFIX="wfe:"/>
			<setcounter NAME="NPROCESSES" VALUE="0"/>
			<if COND="IsVariable.wfe:Total=true">
			<then>
			<if COND="Variables.wfe:Total!=0">
			<then>
				<loop FROM="0" COUNT="Variables.wfe:Total">
					<WORKFLOWPROCESS.GETPROCESSNAME NAME="wfe:Counters.NPROCESSES" VARNAME="processname"/>
					<WORKFLOWPROCESS.GETID NAME="wfe:Counters.NPROCESSES" VARNAME="processid"/>

					<if COND="Variables.wfg:process=Variables.processid">
					<then>
						<setvar NAME="cancel_process" VALUE="Variables.processid" />
						
						<OPTION VALUE="Variables.processid" SELECTED="yes" REPLACEALL="Variables.processid"/><STRING.STREAM VALUE="Variables.processname"/>
						<WORKFLOWPROCESS.GETDEADLINETYPE NAME="wfe:Counters.NPROCESSES" VARNAME="pdlinetype"/>								
						<!-- determine if user is workflowadmin for the process selected -->
						<setvar NAME="userisworkflowadmin" VALUE="false"/>
						<WorkflowProcess.GetAdminRoles NAME="wfe:Counters.NPROCESSES" OBJVARNAME="adminrolesobj"/>
						<ROLELIST.ISALL NAME="adminrolesobj" VARNAME="roleisall"/>
						<!-- roleisall=true means Any role -->

						<if COND="Variables.roleisall=true">
						<then>
							<setvar NAME="userisworkflowadmin" VALUE="true"/>
						</then>
						<else>
							<ROLELIST.GETALL NAME="adminrolesobj" VARNAME="admnroles"/>
							<if COND="Variables.admnroles!=Variables.empty">
							<then>
								<STRINGLIST NAME="rlist" STR="Variables.admnroles" DELIM=","/>
								<loop LIST="rlist">
									<setvar NAME="errno" VALUE="0"/>
									<isinlist STR="SessionVariables.currentpubACLs" ITEM="rlist.ITEM"/>
									<if COND="Variables.errno=1">
									<then>
										<setvar NAME="userisworkflowadmin" VALUE="true"/>
									</then>
									</if>
								</loop>
							</then>
							</if>
						</else>
						</if> <!-- userisadmin-->
						
						<if COND="Variables.userisworkflowadmin=false">
						<then>
							  <setvar NAME="pdlinetype" VALUE="none" />
						</then>
						</if>

					</then>
					<else>
						<OPTION VALUE="Variables.processid" REPLACEALL="Variables.processid"/><STRING.STREAM VALUE="Variables.processname"/>
					</else>
					</if>
					<inccounter NAME="NPROCESSES" VALUE="1"/>
				</loop>
				
			</then>
			</if>
			</then>
			</if>		
			</SELECT>
			
				<if COND="IsVariable.cancel_process=true">
					<then>
					    <STRING.ENCODE VARIABLE="cancel_process" VARNAME="cancel_process"/> 
						<INPUT TYPE="hidden" NAME="cancel_process" VALUE="Variables.cancel_process" REPLACEALL="Variables.cancel_process"/>
					</then>
				</if>
		   
				<XLAT.LOOKUP KEY="dvin/UI/SetParticipantsforthisworkflowprocess" VARNAME="_XLAT_" ESCAPE="true"/>
				<A class="inline-right" HREF="javascript:void(0);" onClick="if(SetParticipants()!=false){document.forms['AppForm'].submit(); return false;}" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true;" REPLACEALL="Variables._XLAT_"><CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/SetParticipants_"/></CALLELEMENT></A>
		</td>
	</tr>
	

	<INPUT TYPE="hidden" NAME="pdlinetype" VALUE="Variables.pdlinetype" REPLACEALL="Variables.pdlinetype"/>
	<setvar NAME="dosetpdeadline" VALUE="false"/>
	<if COND="Variables.pdlinetype=ask">
	<then>
		<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
		
		<setvar NAME="dosetpdeadline" VALUE="true"/>
		<tr>
			<td class="form-label-text">
				<XLAT.STREAM KEY="dvin/UI/Common/ProcessDeadline"/>:
			</td>
			<td class="form-inset" nowrap="nowrap">
			   <setvar NAME="IsProcessDeadline" VALUE="false"/>
				   <IMG WIDTH="4" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/>
			   <WORKFLOWENGINE.GETGROUPNAME OBJVARNAME="groupobj" NAME="Variables.wfg:name"/>
				   <if COND="IsVariable.pdeadline!=true">
				   <then>
				<WorkflowGroup.GetAbsDeadline NAME="groupobj" VARNAME="ProcessDeadline"/>
				   </then>
				   </if>
				   <if COND="Variables.ProcessDeadline=0">
				   <then> 
						<INPUT  style="margin-left:0px" TYPE="RADIO" ID="id-PDNoSet" NAME="donotsetProcessDeadline" VALUE="true" CHECKED="true" OnClick="donotsetPDeadline();"/><label for="id-PDNoSet"><XLAT.STREAM KEY="dvin/Common/Donotset"/></label>
						<br/>
						<INPUT  style="margin-left:0px" TYPE="RADIO" ID="id-PDSet" NAME="donotsetProcessDeadline" VALUE="false" OnClick="setProcessDeadline();"/><label for="id-PDSet"><XLAT.STREAM KEY="dvin/Common/Set"/></label>
						<setvar NAME="pdeadline_vis" VALUE="hidden"/>
				   </then>
				   <else>
						<INPUT  style="margin-left:0px" TYPE="RADIO" ID="id-PDNoSet" NAME="donotsetProcessDeadline" VALUE="true" OnClick="donotsetPDeadline();"/><label for="id-PDNoSet"><XLAT.STREAM KEY="dvin/Common/Donotset"/></label>
						<br/>
						<INPUT  style="margin-left:0px" TYPE="RADIO" ID="id-PDSet" NAME="donotsetProcessDeadline" VALUE="false" CHECKED="true" OnClick="setProcessDeadline();"/><label for="id-PDSet"><XLAT.STREAM KEY="dvin/Common/Set"/></label>
						<setvar NAME="pdeadline_vis" VALUE="visible"/>
				   </else>
				   </if>     
	
				   <IMG WIDTH="4" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/>

			<if COND="Variables.ProcessDeadline!=0">
			<then>
				<setvar NAME="IsProcessDeadline" VALUE="true"/>
				
				<CALLELEMENT NAME="OpenMarket/Xcelerate/Util/ConvertJDBCDateTimeZone">
		  		<ARGUMENT NAME="inputDate" VALUE="Variables.ProcessDeadline" />
				<ARGUMENT NAME="inputDateType" VALUE="millis"/>
		  		<ARGUMENT NAME="fromTimeZone" VALUE="server"/>
		  		<ARGUMENT NAME="toTimeZone" VALUE="client"/>
		  </CALLELEMENT>
		  
		   <SETVAR NAME="pdeadline" VALUE="Variables.outputDate"/>

			</then>
			<else>
				<SETVAR NAME="pdeadline" VALUE="0" />
			</else>
			</if>
				<XLAT.LOOKUP KEY="fatwire/Alloy/UI/PickADate" VARNAME="pickADateString" />
				<CALLELEMENT NAME="OpenMarket/Xcelerate/Util/GetLocalizedDate">
					<ARGUMENT NAME="inputDate" VALUE="Variables.pdeadline" />
					<ARGUMENT NAME="outputVar" VALUE="localizedDeadlineValue" />
				</CALLELEMENT>
					<span ID="pdeadline_div" style="visibility:Variables.pdeadline_vis" REPLACEALL="Variables.pdeadline_vis">
					<STRING.ENCODE VARIABLE="localizedDeadlineValue" VARNAME="localizedDeadlineValue"/> 
						<div id="deadlineFieldId" name="deadlineField" dojoType="fw.dijit.UIInput"  clearButton="true" readonly="true" VALUE="Variables.localizedDeadlineValue" REPLACEALL="Variables.localizedDeadlineValue"></div>
						<DIV ID="deadlineFieldDiv" STYLE="display:none"><ICS.GETVAR NAME="pdeadline"/></DIV>
						<CALLELEMENT NAME="OpenMarket/Xcelerate/Scripts/DateTimeWidget">
							<ARGUMENT NAME="inputFieldId" value="deadlineFieldId"/>
							<ARGUMENT NAME="inputDivId" value="deadlineFieldDiv"/>
						</CALLELEMENT>
					</span>
			</td>
		</tr>
	</then>
	<else>
		<setvar NAME="pdeadline" VALUE="0"/>
	</else>
	</if>
	
	<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
	<tr>
		<td class="form-label-text">
			<XLAT.STREAM KEY="dvin/Common/Participants"/>:
		</td>
		<td class="form-inset">
			<SETVAR NAME="allRoles" VALUE="Variables.empty"/>
			<if COND="Variables.wfg:participantsroleTotal!=0">
			<then>
				<setcounter NAME="RCOUNT" VALUE="0"/>
				
				<table BORDER="0" CELLSPACING="0" CELLPADDING="0">
				<tr>
					<td></td><td class="tile-dark" HEIGHT="1"><IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td><td></td>
				</tr>
				<tr>
					<td class="tile-dark" VALIGN="top" WIDTH="1" NOWRAP="nowrap"><BR /></td>
					<td >
					<table width="100%" cellpadding="0" cellspacing="0" border="0" bgcolor="#ffffff"><tr><td colspan="6" class="tile-highlight"><IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td></tr>
					<tr><td class="tile-a" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;</td>
						<td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;</td><td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir"><DIV class="new-table-title"><XLAT.STREAM KEY="dvin/Common/Role"/></DIV></td>
						<td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;&nbsp;&nbsp;&nbsp;</td><td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir"><DIV class="new-table-title"><XLAT.STREAM KEY="dvin/Common/Users"/></DIV></td>
						<td class="tile-c" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;</td>
					</tr>
					<tr><td colspan="6" class="tile-dark"><IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td></tr>
					<!-- Loop over all search results. -->
						<setvar NAME="rowStyle" VALUE="tile-row-normal"/>
						<SETVAR NAME="separatorLine" VALUE="0"/>

						<loop FROM="0" COUNT="Variables.wfg:participantsroleTotal">
							<IF COND="Variables.separatorLine=1">
							<THEN>
								<tr>
									<!--<td colspan="6" class="light-line-color"><img height="1" width="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>-->
								</tr>
							</THEN>
							</IF>
							<SETVAR NAME="separatorLine" VALUE="1"/>
							<SETVAR NAME="currentRole" VALUE="Variables.wfg:participantsroleCounters.RCOUNT"/>
							<STRING.ENCODE VARIABLE="currentRole" VARNAME="currentRole"/>
							<IF COND="Variables.allRoles=Variables.empty">
							<THEN>
								<SETVAR NAME="allRoles" VALUE="Variables.currentRole"/>
							</THEN>
							<ELSE>
								<SETVAR NAME="allRoles" VALUE="Variables.allRoles,Variables.currentRole"/>
							</ELSE>
							</IF>
							<setcounter NAME="UCOUNT" VALUE="0"/>
							<SETVAR NAME="currentUsers" VALUE="Variables.empty"/>
							<SETVAR NAME="numUsers" VALUE="Variables.wfg:participantsroleCounters.RCOUNTuserTotal"/>
							<tr class="Variables.rowStyle"  REPLACEALL="Variables.rowStyle"><td><BR /></td>
							<td><BR /></td><td VALIGN="TOP" NOWRAP="NOWRAP" ALIGN="LEFT">
								<DIV class="small-text-inset">
								<CSVAR NAME="Variables.currentRole:"/>
								</DIV>
							</td>
							<td><BR /></td><td VALIGN="TOP" ALIGN="LEFT">
								<DIV class="small-text-inset">
								<XLAT.LOOKUP KEY="dvin/UI/ShowSelectedUsers" VARNAME="_XLAT_"/>
								<span id="linkVariables.currentRole" REPLACEALL="Variables.currentRole">
								<A HREF="javascript:showUsers('Variables.currentRole','linkVariables.currentRole');" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true;"
									   REPLACEALL="Variables.currentRole,Variables._XLAT_"><CSVAR NAME="Variables._XLAT_"/></A>
								</span>
									<loop COUNT="Variables.numUsers">
										<setvar NAME="tmp" VALUE="Variables.wfg:participantsroleCounters.RCOUNTuserCounters.UCOUNT"/>
										<STRING.ENCODE VARIABLE="tmp" VARNAME="tmp"/>
										<INPUT TYPE="hidden" NAME="Variables.currentRole" VALUE="Variables.tmp" REPLACEALL="Variables.currentRole,Variables.tmp"/>
										<inccounter NAME="UCOUNT" VALUE="1"/>
								</loop>
								</DIV>
							</td>
						<td><BR /></td></tr>
						<IF COND="Variables.rowStyle=tile-row-normal">
						<THEN><SETVAR NAME="rowStyle" VALUE="tile-row-highlight"/>
						</THEN>
						<ELSE><SETVAR NAME="rowStyle" VALUE="tile-row-normal"/>
						</ELSE>
						</IF>
						<inccounter NAME="RCOUNT" VALUE="1"/>
					</loop>
					</table>
				</td>
				<td class="tile-dark" VALIGN="top" WIDTH="1" NOWRAP="nowrap"><BR /></td>
			</tr>
			<tr>
				<td colspan="3" class="tile-dark" VALIGN="TOP" HEIGHT="1"><IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>
			</tr>
			<tr>
				<td></td><td background="Variables.cs_imagedir/graphics/common/screen/shadow.gif" REPLACEALL="Variables.cs_imagedir"><IMG WIDTH="1" HEIGHT="5" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td><td></td>
			</tr>
			</table>                 
			<INPUT TYPE="hidden" NAME="cancel_allRoles" VALUE="Variables.allRoles" REPLACEALL="Variables.allRoles"/>
		</then>
		<else>
			&nbsp;	
		</else>
		</if>
		
		<INPUT TYPE="hidden" NAME="allRoles" VALUE="Variables.allRoles" REPLACEALL="Variables.allRoles"/>
		</td>
	</tr>
	<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
	<tr>
		<td class="form-label-text"><XLAT.STREAM KEY="dvin/UI/AddRemoveAssets"/>:</td>
		<td class="form-inset">
			<IF COND="Variables.addremove=any">
			<THEN>
				<INPUT  style="margin-left:0px" TYPE="radio" ID="addremove-any" NAME="addremove" VALUE="any" checked="checked"/><label for="addremove-any"><XLAT.STREAM KEY="dvin/Common/AnyUser"/></label><BR/>
				<INPUT  style="margin-left:0px" TYPE="radio" ID="addremove-role" NAME="addremove" VALUE="role" onClick="editroles.selectedIndex==-1 ? editroles.options[0].selected=true : void(0)"/><label for="addremove-role"><XLAT.STREAM KEY="dvin/Common/AllUsersFollowingRoles"/></label>:<BR/>
			</THEN>
			<ELSE>
				<INPUT  style="margin-left:0px" TYPE="radio" ID="addremove-any" NAME="addremove" VALUE="any"/><label for="addremove-any"><XLAT.STREAM KEY="dvin/Common/AnyUser"/></label><BR/>
				<INPUT  style="margin-left:0px" TYPE="radio" ID="addremove-role" NAME="addremove" VALUE="role" checked="checked" onClick="editroles.selectedIndex==-1 ? editroles.options[0].selected=true : void(0)"/><label for="addremove-role"><XLAT.STREAM KEY="dvin/Common/AllUsersFollowingRoles"/></label>:<BR/>
			</ELSE>
			</IF>
				 <ROLEMANAGER.GETROLENAMES LISTVARNAME="ACLList"/>

				<SELECT NAME="editroles" MULTIPLE="yes" SIZE="5" onChange="this.form.elements['addremove'][1].checked=true">
			  <LOOP LIST="ACLList">
			  <IF COND="Variables.addremove=role">
			  <THEN>
				<setvar NAME="errno" VALUE="0"/>
				<STRINGLIST NAME="roles" STR="Variables.wfg:rolesroles" DELIM=","/>
				<isinlist LIST="editroles" ITEM="ACLList.aclname"/>
				<if COND="Variables.errno=1">
				<then>
					<OPTION VALUE="ACLList.aclname" REPLACEALL="ACLList.aclname" SELECTED="yes"/><STRING.STREAM VALUE="ACLList.aclname"/>
				</then>
				<else>
					<OPTION VALUE="ACLList.aclname" REPLACEALL="ACLList.aclname"/><STRING.STREAM VALUE="ACLList.aclname"/>				
				</else>
				</if>
				</THEN>
				<ELSE>
					<OPTION VALUE="ACLList.aclname" REPLACEALL="ACLList.aclname"/><STRING.STREAM VALUE="ACLList.aclname"/>				
				</ELSE>
				</IF>
				 </LOOP>
				</SELECT>
		</td>
	</tr>
	<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
	<tr>
		<td class="form-label-text"><XLAT.STREAM KEY="dvin/UI/EditDeleteGroup"/>:</td>
		<td class="form-inset">
			<IF COND="Variables.editdelete=any">
			<THEN>
				<INPUT  style="margin-left:0px" TYPE="radio" ID="editdel-any" NAME="editdelete" VALUE="any" checked="checked"/><label for="editdel-any"><XLAT.STREAM KEY="dvin/Common/AnyUser"/></label><BR/>
				<INPUT  style="margin-left:0px" TYPE="radio" ID="editdel-role" NAME="editdelete" VALUE="role" onClick="removeroles.selectedIndex==-1 ? removeroles.options[0].selected=true : void(0)"/><label for="editdel-role"><XLAT.STREAM KEY="dvin/Common/AllUsersFollowingRoles"/></label>:<BR/>
			</THEN>
			<ELSE>
				<INPUT  style="margin-left:0px" TYPE="radio" ID="editdel-any" NAME="editdelete" VALUE="any"/><label for="editdel-any"><XLAT.STREAM KEY="dvin/Common/AnyUser"/></label><BR/>
				<INPUT  style="margin-left:0px" TYPE="radio" ID="editdel-role" NAME="editdelete" VALUE="role" checked="checked" onClick="removeroles.selectedIndex==-1 ? removeroles.options[0].selected=true : void(0)"/><label for="editdel-role"><XLAT.STREAM KEY="dvin/Common/AllUsersFollowingRoles"/></label>:<BR/>
			</ELSE>
			</IF>
		<SELECT NAME="removeroles" MULTIPLE="yes" SIZE="5" onChange="this.form.elements['editdelete'][1].checked=true">
			<LOOP LIST="ACLList">
			<IF COND="Variables.editdelete=role">
			<THEN>
				<setvar NAME="errno" VALUE="0"/>
				<STRINGLIST NAME="roles" STR="Variables.wfg:rolesroles" DELIM=","/>
				<isinlist LIST="removeroles" ITEM="ACLList.aclname"/>
				<if COND="Variables.errno=1">
				<then>
					<OPTION VALUE="ACLList.aclname" REPLACEALL="ACLList.aclname" SELECTED="yes"/><STRING.STREAM VALUE="ACLList.aclname"/>
				</then>
				<else>
					<OPTION VALUE="ACLList.aclname" REPLACEALL="ACLList.aclname"/><STRING.STREAM VALUE="ACLList.aclname"/>				
				</else>
				</if>
			</THEN>
			<ELSE>
				<OPTION VALUE="ACLList.aclname" REPLACEALL="ACLList.aclname"/><STRING.STREAM VALUE="ACLList.aclname"/>
			</ELSE>
			</IF>
			</LOOP>
		</SELECT>
		</td>
	</tr>
	<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
	<tr>
		<td class="form-label-text"><XLAT.STREAM KEY="dvin/UI/GroupDeadlockActions"/>:</td>
		<td class="form-inset">
			<WORKFLOWENGINE.GETAVAILABLEGROUPACTIONS PREFIX="wfgrpact:"/>
			<setcounter NAME="GRPACTCOUNT" VALUE="0"/>
			<if COND="IsVariable.wfgrpact:Total=true">
			<then>
				<if COND="Variables.wfgrpact:Total!=0">
				<then>
				<SELECT NAME="grpactions" MULTIPLE="yes" SIZE="3">
					<loop FROM="0" COUNT="Variables.wfgrpact:Total">
					<setvar NAME="tmp" VALUE="wfgrpact:Counters.GRPACTCOUNT"/>
					<WORKFLOWACTION.GETNAME NAME="Variables.tmp" VARNAME="grpactname"/> 
					<WORKFLOWACTION.GETID NAME="Variables.tmp" VARNAME="grpactid"/> 
					<setvar NAME="errno" VALUE="0"/>
					<isinlist LIST="grpactions" ITEM="Variables.grpactid"/>
					<if COND="Variables.errno=1">
					<then>
						<OPTION VALUE="Variables.grpactid" SELECTED="SELECTED" REPLACEALL="Variables.grpactid" /><STRING.STREAM VALUE="Variables.grpactname"/>
					</then>
					<else>
						<OPTION VALUE="Variables.grpactid" REPLACEALL="Variables.grpactid" /><STRING.STREAM VALUE="Variables.grpactname"/>
					</else>
					</if>
					<inccounter NAME="GRPACTCOUNT" VALUE="1"/>
					</loop>
				</SELECT>
				</then>
				<else>
					<XLAT.STREAM KEY="dvin/UI/Nogroupdeadlockactionsavailable"/>
				</else>
				</if>
			</then>
			<else>
					<XLAT.STREAM KEY="dvin/UI/Nogroupdeadlockactionsavailable"/>
			</else>
			</if>
		</td>
	</tr>
	<if COND="IsVariable.dosetpdeadline!=true">
	<then>
		<setvar NAME="dosetpdeadline" VALUE="false"/>
	</then>
	</if>
	
	<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/FooterBar" />
	<tr><td><br/></td><td>

	<INPUT TYPE="hidden" NAME="dosetpdeadline" VALUE="Variables.dosetpdeadline" REPLACEALL="Variables.dosetpdeadline"/>
	<INPUT TYPE="hidden" NAME="pdeadline" VALUE="Variables.pdeadline" REPLACEALL="Variables.pdeadline"/>
	<INPUT TYPE="hidden" NAME="action" VALUE="save"/>
	<XLAT.LOOKUP KEY="dvin/UI/CancelEditingGroup" VARNAME="alt_cancel" ESCAPE="true"/>
	<A HREF="Variables.WorkflowFrontURL&#38;id=Variables.id" REPLACEALL="Variables.WorkflowFrontURL,Variables.id"><CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/Cancel"/></CALLELEMENT></A>
	
	<IF COND="Variables.actionTitle=Edit">
	<THEN>  
	    <XLAT.LOOKUP KEY="dvin/UI/EditWorkflowGroup" VARNAME="_XLAT_" ESCAPE="true"/>
	</THEN>
	</IF>
	
	<IF COND="Variables.actionTitle=Create">
	<THEN>
		<XLAT.LOOKUP KEY="dvin/UI/CreateWorkflowGroup" VARNAME="_XLAT_" ESCAPE="true"/>    
	</THEN>
	</IF>

	<A HREF="javascript:void(0);" onClick="if(SaveGroup()!=false){document.forms['AppForm'].submit(); return false;}" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true;" ALT="Variables._XLAT_" REPLACEALL="Variables._XLAT_"><CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/Save"/></CALLELEMENT></A>
	</td></tr>
	
</table>

<INPUT type="hidden" name="pagename" value="OpenMarket/Xcelerate/Actions/Variables.PostPage" REPLACEALL="Variables.PostPage"/>

</FTCS> 
