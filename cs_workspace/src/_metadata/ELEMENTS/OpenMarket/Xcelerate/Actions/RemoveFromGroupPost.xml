<?xml version="1.0" ?>
<!DOCTYPE FTCS SYSTEM "futuretense_cs.dtd">
<FTCS Version="1.1">
<!-- OpenMarket/Xcelerate/Actions/RemoveFromGroupPost
-
- INPUT
-
- OUTPUT
-
-->
<STRING.ENCODE VARIABLE="id" VARNAME="id"/>
<STRING.ENCODE VARIABLE="AssetType" VARNAME="AssetType" />
<STRING.ENCODE VARIABLE="groupid" VARNAME="groupid"/>
<WorkflowAsset.Load ASSETTYPE="Variables.AssetType" ID="Variables.id" OBJVARNAME="workflowasset" />

<ASSET.LOAD TYPE="Variables.AssetType" OBJECTID="Variables.id" NAME="theAsset"/>
<ASSET.GET NAME="theAsset" FIELD="name" OUTPUT="assetname"/>

<WorkflowEngine.GetGroupID ID="Variables.groupid" OBJVARNAME="groupobj" />
<WorkflowGroup.GetName NAME="groupobj" VARNAME="groupname" />

<if COND="IsVariable.removecomment!=true">
<then>
    <setvar NAME="removecomment" VALUE=""/>
</then>
<else>
     <!-- Make unsafe characters safe again (late fix) -->
     <substitute STR="Variables.removecomment" WHAT="%26" WITH=" AND " OUTSTR="removecomment"/>
     <substitute STR="Variables.removecomment" WHAT="'" WITH=" " OUTSTR="removecomment"/>
     <substitute STR="Variables.removecomment" WHAT="%22" WITH=" " OUTSTR="removecomment"/>
</else>
</if>

<!--WorkflowEngine.RemoveObjectFromGroup OBJECT="workflowasset" COMMENT="Variables.removecomment" SITE="SessionVariables.pubid" /-->
<WorkflowEngine.RemoveObjectFromGroup OBJECT="workflowasset" SITE="SessionVariables.pubid" />
<if COND="Variables.errno!=0">
<then>
     <callelement NAME="OpenMarket/Xcelerate/Actions/Util/ShowError">
	    <argument NAME="error" VALUE="RemoveFromGroupFailed"/>
        <argument NAME="groupname" VALUE="Variables.groupname"/>
     </callelement>
</then>
<else>
     <ASSETTYPE.LOAD NAME="type" TYPE="Variables.AssetType"/>
     <ASSETTYPE.GET NAME="type" FIELD="description" OUTPUT="ATdesc"/>
     <XLAT.LOOKUP KEY="dvin/UI/AssetRemovedFromWorkflowGroup" VARNAME="_XLAT_"/>
     <callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/ShowMessage">
        <argument NAME="msgtext" VALUE="Variables._XLAT_"/>
	    <argument NAME="severity" VALUE="info"/>
     </callelement>     
		 <PROPERTY.GET PARAM="xcelerate.treeType" INIFILE="futuretense_xcel.ini" VARNAME="proptreetype"/>
		 <IF  COND="IsElement.OpenMarket/Xcelerate/UIFramework/UpdateTreeVariables.proptreetype=true">
			 <THEN>
				 <CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/UpdateTreeVariables.proptreetype">
					 <ARGUMENT NAME="__TreeRefreshKeys__" VALUE="Self:Variables.groupid"/>
				 </CALLELEMENT>
			 </THEN>
		 </IF>
		 <if COND="Variables.cs_environment=ucform">
		<then>
			<SCRIPT TYPE="text/javascript">
				dojo.addOnLoad(function(){
					SitesApp.notifyModelUpdate('workflowStatus');
				});
			</SCRIPT>
		</then>
		</if>
</else>
</if>

<callelement NAME="OpenMarket/Xcelerate/Actions/StatusDetailsFront">
	<argument NAME="AssetType" VALUE="Variables.AssetType"/>
	<argument NAME="id"        VALUE="Variables.id"/>
</callelement>

</FTCS> 
