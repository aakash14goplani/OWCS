<?xml version="1.0" ?>
<!DOCTYPE FTCS SYSTEM "futuretense_cs.dtd">

<FTCS Version="1.1">
<!-- 
$Logfile: /VerticalApps/XcelerateC/install/Xcelerate/Populate/ElementCatalog/OpenMarket/Xcelerate/Actions/SendEmailFront.xml $ 
$Revision: 20 $ 
$Modtime: 2/27/04 2:46p $ 
-->

<!--
- Confidential and Proprietary Information of FutureTense Inc.
-					All Rights Reserved.
-
- SendEmailFront.xml
-
- DESCRIPTION
-	Send eMail to users
-
- HISTORY 
- 5/8/1999 - Created
-->
<STRING.ENCODE VARIABLE="cs_imagedir" VARNAME="cs_imagedir"/>
<SCRIPT LANGUAGE="JavaScript">
<![CDATA[
	function resetme(obj) {
		obj['subject'].value = "";
		obj['theBody'].value = "";
		obj['toList'].selectedIndex = -1;
		}
	function checkme(obj) {
		if (obj['subject'].value == "") {
			]]>
			alert("<XLAT.STREAM KEY="dvin/UI/Error/Youmustenterasubject" ESCAPE="true" ENCODE="false"/>");
			<![CDATA[
			return false;
		} else {
		if (obj['theBody'].value == "") {
			]]>
			alert("<XLAT.STREAM KEY="dvin/UI/Error/Youmustenteramessage" ESCAPE="true" ENCODE="false"/>");
			<![CDATA[
			return false;
		} else {
		cnt = obj['toList'].length;
		for (i=0; (i<cnt) && (!obj['toList'].options[i].selected); i++)
			;
		if (i==cnt) {
			]]>
			alert("<XLAT.STREAM KEY="dvin/UI/Error/Youmusthaveonerecipient" ESCAPE="true" ENCODE="false"/>");
			<![CDATA[
			return false;
			}
			else { return true; }
		}
		}
		}
	
]]>
</SCRIPT>
<setvar NAME="errno" VALUE="0"/>
<PROPERTY.GET PARAM="xcelelem.manageuserpub" INIFILE="futuretense_xcel.ini" VARNAME="propmanageuserpub"/>
<callelement NAME="Variables.propmanageuserpub">
	<argument NAME="upcommand" VALUE="GetEMailUsers"/>
	<argument NAME="name" VALUE="SessionVariables.PublicationName"/>
	<argument NAME="qryprefix" VALUE="SendMailList"/>
</callelement>

<TABLE BORDER="0">
	<TR>
		<TD ALIGN="RIGHT" class="form-label-text">
			<XLAT.STREAM KEY="dvin/UI/Sendemailto"/>:
		</TD>
		<TD class="form-inset">
			<SELECT NAME="toList" SIZE="5" MULTIPLE="yes">
				<LOOP LIST="SendMailList">
					<setvar NAME="recipient" VALUE="SendMailList.Variables.SendMailList_qrycol"/>
					<OPTION VALUE="Variables.recipient" REPLACEALL="Variables.recipient"/><STRING.STREAM VALUE="Variables.recipient"/>
				</LOOP>
			</SELECT>
		</TD>
	</TR>
	<TR>
		<TD ALIGN="RIGHT" class="form-label-text">
			<XLAT.STREAM KEY="dvin/Common/Subject"/>:
		</TD>
		<TD class="form-inset">
			<INPUT TYPE="TEXT" SIZE="32" MAXSIZE="255" NAME="subject" VALUE=""/>
		</TD>
	</TR>
	<TR>
		<TD ALIGN="RIGHT" class="form-label-text">
			<XLAT.STREAM KEY="dvin/Common/Message"/>:
		</TD>
		<TD class="form-inset">
			<TEXTAREA ROWS="10" COLS="40" WRAP="VIRTUAL" NAME="theBody"></TEXTAREA>
		</TD>
	</TR>
	<TR>
		<TD ALIGN="RIGHT" class="form-label-text">
		</TD>
		<TD class="form-inset">
			<STRING.ENCODE VARIABLE="PostPage" VARNAME="PostPage"/>
			<INPUT TYPE="hidden" NAME="pagename" VALUE="OpenMarket/Xcelerate/Actions/Variables.PostPage" REPLACEALL="Variables.PostPage"/>
			<INPUT TYPE="SUBMIT" VALUE="Send" onClick="return checkme(this.form)"/>
			<IMG src="Variables.cs_imagedir/data/empty.gif" WIDTH="20" HEIGHT="1" BORDER="0" REPLACEALL="Variables.cs_imagedir"/>
			<INPUT TYPE="BUTTON" VALUE="Reset" onClick="resetme(this.form)"/>
		</TD>
	</TR>
    </TABLE>

</FTCS>
