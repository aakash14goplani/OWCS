<?xml version="1.0" ?>
<!DOCTYPE FTCS SYSTEM "futuretense_cs.dtd">
<FTCS Version="1.1">
<!-- OpenMarket/Xcelerate/Actions/PublishPointsFront
-
- INPUT
-
- OUTPUT
-
-->
<STRING.ENCODE VARIABLE="cs_imagedir" VARNAME="cs_imagedir"/>
<!-- Continue only if conditions from prologactions are satisfied -->
<if COND="Variables.doproceed=true">
<then>
<SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Actions/PublishFront" outstring="urlpubfront">
    <satellite.argument name="cs_environment" value="Variables.cs_environment"/>
    <satellite.argument name="cs_formmode" value="Variables.cs_formmode"/>
                                                               <satellite.argument name="target" value="Variables.target"/>
                                                               </SATELLITE.LINK>

<SCRIPT LANGUAGE="JavaScript">
<replaceall LIST="Variables.urlpubfront">
<![CDATA[
function BackHandler()
{
    var pURL = "Variables.urlpubfront"; ]]>
    <if cond="Variables.cs_environment=portal">
    <then>
        window.location=pURL;
    </then>
    <else>
        parent.frames['XcelAction'].location=pURL;
    </else>
    </if>
    <![CDATA[
    return false;
}
]]>
</replaceall>
</SCRIPT>

<PUBTARGETMANAGER.LOAD ID="Variables.target" OBJVARNAME="pubtgt"/>
<PUBTARGET.SCATTER NAME="pubtgt" PREFIX="pubtgt:"/>
<PUBTARGET.GETFACTORS NAME="pubtgt" VARNAME="pubtgt:factors"/>
<PUBTARGET.UNPACK NAME="pubtgt" PREFIX="pubtgt:" FIELD="factors"/>
<if COND="IsError.Variables.errno=false">
<then>
     <DELIVERYTYPE.LOAD NAME="pubdt" OBJECTID="Variables.pubtgt:type"/>
     <DELIVERYTYPE.GET NAME="pubdt" FIELD="path" OUTPUT="pubdt:path"/>
     <DELIVERYTYPE.GET NAME="pubdt" FIELD="name" OUTPUT="pubdt:name"/>
     <if COND="IsError.Variables.errno=true">
     <then>
          <P><XLAT.STREAM KEY="dvin/UI/notloadgetpatpublishingdeliverytypeerrno2" errno="Variables.errno" EVALALL="false"/>
          </P>
     </then>
     </if>
</then>
</if>

<table border="0" cellpadding="0" cellspacing="0">
<tr>
    <td><span class="title-text"><XLAT.STREAM KEY="dvin/UI/Publishdestination"/>:  </span><span class="title-value-text"><STRING.STREAM VALUE="Variables.pubtgt:name"/></span></td>
</tr>

<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/TitleBar">
    <argument NAME="SpaceBelow" VALUE="No"/>
</callelement>

<tr>
    <td>
    
    <table border="0" cellpadding="0" cellspacing="0">
    <tr>
        <td class="form-label-text"><XLAT.STREAM KEY="dvin/Common/Destination"/>:</td>
        <td><img height="1" width="5" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>
        <td class="form-inset"><XLAT.STREAM KEY="dvin/UI/Publish/pubtgtnameusingpubdtname"/></td>
    </tr>
    
    <callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
    <tr>
        <td class="form-label-text"><XLAT.STREAM KEY="dvin/Common/Arguments"/>:</td>
        <td><img height="1" width="5" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>
        <td class="form-inset"><string.stream VARIABLE="pubtgt:factors"/></td>
    </tr>
    
    <!--<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacerBar"/>-->
    
    </table>
    </td>
</tr>
<tr>
    <td>
    <ApprovedAssets.GetPerm TARGET="Variables.target" OBJVARNAME="publishpoints" />
    <PUBLISHPOINTS.GetAll NAME="publishpoints" PREFIX="refs" />
    <if COND="Variables.refsTotal=0">
    <then>
    	<p><XLAT.STREAM KEY="dvin/UI/Error/Nopublishstartingpointsdefinedexportdest"/></p>
    </then>
    <else>
           <if COND="Variables.refsTotal=1">
           <then>
                <XLAT.STREAM KEY="dvin/UI/PublishPointIsDefinedForExportDest"/>
           </then>
           <else>
    	        <XLAT.STREAM KEY="dvin/UI/PublishPointsAreDefinedForExportDest"/>
           </else>
           </if>
           
           <callelement NAME="OpenMarket/Xcelerate/Actions/AssetMgt/ReferencesTile">
                 <argument NAME="PREFIX" VALUE="refs"/>
                 <argument NAME="command" VALUE="preview"/>
           </callelement>
    </else>
    </if>    
    </td>
</tr>

<USERISMEMBER GROUP="xcelpublish"/>
<IF COND="Variables.errno=1">
<THEN>
<tr>
   <td align="right"><XLAT.LOOKUP KEY="dvin/UI/Back" VARNAME="_XLAT_" ESCAPE="true"/>
   <A HREF="javascript:void(0)" onclick="return BackHandler()" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true;" REPLACEALL="Variables._XLAT_"><CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/Back"/></CALLELEMENT></A>
   </td>
</tr>
</THEN>
</IF>
</table>
</then></if>
</FTCS> 
