<?xml version="1.0" ?>
<!DOCTYPE FTCS SYSTEM "futuretense_cs.dtd">

<FTCS Version="1.1">
<!-- 
$Logfile: /VerticalApps/XcelerateB/install/Xcelerate/Populate/ElementCatalog/OpenMarket/Xcelerate/Actions/Security/SetPublicationName.xml $ 
$Revision: 27 $ 
$Modtime: 6/11/02 2:08p $ 
-->

<!--
- Confidential and Proprietary Information of Open Market, Inc.
-					All Rights Reserved.
-
- DESCRIPTION
-	Set the publication name
-->


<!-- Load the publication record -->

	<PUBLICATION.LOAD NAME="site" OBJECTID="SessionVariables.pubid"/>

    <!-- start #16320 -->
    <!-- Get the publication name & description and save it to a session variable -->
	<PUBLICATION.GET NAME="site" FIELD="name"/>
    <SETSSVAR NAME="PublicationName" VALUE="Variables.name"/>
    <PUBLICATION.GET NAME="site" FIELD="description"/>
    <!-- attempts to truncate description. On fail an errno is set -->
    <!-- if there is an errno use original description, else use truncated -->
 
    <SUBSTRING STR="Variables.description" OUTSTR="outDescription" ENDINDEX="20"/>
    <IF COND="IsError.Variables.errno=true">
        <THEN>
            <SETSSVAR NAME="PublicationDesc" VALUE="Variables.description" />
        </THEN>
        <ELSE>
            <SETSSVAR NAME="PublicationDesc" VALUE="Variables.outDescription"/>
        </ELSE>
    </IF>
    <!-- end #16320 -->

<removessvar NAME="currentpubACLs"/>
<PROPERTY.GET PARAM="xcelelem.manageuserpub" INIFILE="futuretense_xcel.ini" VARNAME="propmanageuserpub"/>
<USERMANAGER.GETLOGINUSER VARNAME="userid"/>
<callelement NAME="Variables.propmanageuserpub">
    <argument NAME="upcommand" VALUE="GetACLs"/>
    <argument NAME="username" VALUE="Variables.userid"/>
    <argument NAME="publication" VALUE="Variables.name"/>
    <argument NAME="aclname" VALUE="pubacls"/>
    <argument NAME="forceACLFetch" VALUE="true"/>
</callelement>
<setssvar NAME="currentpubACLs" VALUE="Variables.pubacls"/>



<!-- if any blob data is being served in this environment
     needs a csblobid session variable to be set -->
<if COND="IsSessionVariable.csblobid!=true">
<then>
    <setssvar NAME="csblobid" VALUE="CS.UniqueID"/>
</then>
</if>

</FTCS>

