<?xml version="1.0" ?>
<!DOCTYPE FTCS SYSTEM "futuretense_cs.dtd">
<FTCS Version="1.1">
<!-- OpenMarket/Xcelerate/Actions/RemoveFromGroupFront
-
- INPUT
-
- OUTPUT
-
-->
<STRING.ENCODE VARIABLE="id" VARNAME="id"/>
<STRING.ENCODE VARIABLE="AssetType" VARNAME="AssetType" />
<STRING.ENCODE VARIABLE="cs_imagedir" VARNAME="cs_imagedir"/>
<WorkflowAsset.Load ASSETTYPE="Variables.AssetType" ID="Variables.id" OBJVARNAME="workflowasset" />

<ASSET.LOAD TYPE="Variables.AssetType" OBJECTID="Variables.id" NAME="theAsset"/>
<ASSET.GET NAME="theAsset" FIELD="id" OUTPUT="id"/>
<ASSET.GET NAME="theAsset" FIELD="name" OUTPUT="assetname"/>
<ASSET.GET NAME="theAsset" FIELD="description" OUTPUT="assetdesc" />
<ASSET.GETASSETTYPE NAME="theAsset" OUTNAME="type"/>
<ASSETTYPE.GET NAME="type" FIELD="description" OUTPUT="atDescription"/>

<setvar NAME="AbortFlag" VALUE="false"/>
<WorkflowEngine.isFunctionLegal OBJECT="workflowasset" FUNCTIONNAME="removefromgroup" SITE="SessionVariables.pubid" VARNAME="isLegal" REASONVARNAME="denialreason" MUSTBEASSIGNED="false"/>
<if COND="Variables.isLegal=false">
<then>
     <setvar NAME="AbortFlag" VALUE="true"/>
     <setvar NAME="ErrorName" VALUE="IllegalTransition"/>
     <setvar NAME="severity" VALUE="info"/>
</then>
</if>

<if COND="Variables.AbortFlag!=true">
<then>
     <WorkflowEngine.GetGroupMembership OBJECT="workflowasset" VARNAME="groupid" />
     <if COND="IsVariable.groupid!=true">
     <then>
          <SETVAR NAME="AbortFlag" VALUE="true"/>
          <SETVAR NAME="ErrorName" VALUE="AssetNotInGroup"/>
          <SETVAR NAME="severity" VALUE="info"/>
     </then>
     <else>
          <WorkflowEngine.GetGroupID ID="Variables.groupid" OBJVARNAME="groupobj" />
          <WorkflowGroup.GetName NAME="groupobj" VARNAME="groupname" />
     </else>
     </if>
</then>
</if>

<if COND="Variables.AbortFlag!=true">
<then>
	<table class="width-outer-70" cellspacing="0" cellpadding="0" border="0">
		<tr><td>
			<span class="title-text"><XLAT.STREAM KEY="dvin/UI/RemovefromWorkflowGroupAssetTypeassetname"/></span>
		</td></tr>
		<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/TitleBar"/>
	</table>
    
    <table class="width-outer-50" BORDER="0" CELLSPACING="0" CELLPADDING="0">
    <tr>
        <td></td><td class="tile-dark" VALIGN="TOP" HEIGHT="1"><IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td><td></td>
    </tr>
    <tr>
        <td class="tile-dark" VALIGN="top" WIDTH="1" NOWRAP="nowrap"><BR /></td>
        <td>
        <table class="width-inner-100" cellpadding="0" cellspacing="0" border="0" bgcolor="#ffffff"><tr><td colspan="3" class="tile-highlight"><IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td></tr>
        <tr><td HEIGHT="16" class="tile-a" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;</td>
            <td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;<BR /></td>
            <td class="tile-c" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;</td>
        </tr>
        <tr><td colspan="3" class="tile-dark"><IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td></tr>
        <tr>
            <td class="form-label-text">
                <STRING.STREAM VALUE="Variables.atDescription "/> <XLAT.STREAM KEY="dvin/AT/Common/Name"/>:
            </td>
            <td class="form-inset">
            	<STRING.STREAM VALUE="Variables.assetname" />
            </td>
        </tr>
        <tr>
            <!--<td colspan="3" class="light-line-color"><img height="1" width="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>-->
        </tr>
        <tr>
            <td class="form-label-text">
                <XLAT.STREAM KEY="dvin/AT/Common/Description"/>:
            </td>
            <td class="form-inset">
            	<STRING.STREAM VALUE="Variables.assetdesc" />
            </td>
        </tr>
        
        <tr>
            <!--<td colspan="3" class="light-line-color"><img height="1" width="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>-->
        </tr>
        <tr>
            <td class="form-label-text">
                <XLAT.STREAM KEY="dvin/Common/WorkflowProcess"/>:
            </td>
            <td class="form-inset">
                <WorkflowGroup.GetWorkflowProcessID NAME="groupobj" VARNAME="workflowid" />
                <WorkflowEngine.GetProcessID ID="Variables.workflowid" OBJVARNAME="workflow"/>
                <WorkflowProcess.GetProcessName NAME="workflow" VARNAME="workflowname" />
                
                <WORKFLOWENGINE.GETFILTEREDASSIGNMENTS PREFIX="assignments" NOTSTATUS="notactive" GROUPID="Variables.groupid" EXCLUDECOMMENTS="true"/>
                <if COND="Variables.assignmentsTotal=0">
                <then>
                    <setvar NAME="statedesc" VALUE="Variables.empty" />
                </then>
                <else>
                    <WorkflowAssignment.GetStateID NAME="assignments0" VARNAME="workflow_stateid" />
                    <WorkflowEngine.GetStateID ID="Variables.workflow_stateid" OBJVARNAME="workflow_state" />
                    <WorkflowState.GetStateDescription NAME="workflow_state" VARNAME="statedesc" />
                </else>
                </if>
             	<STRING.STREAM VALUE="Variables.workflowname" /> - <STRING.STREAM VALUE="Variables.statedesc" />       
            </td>
        </tr>
        
        <tr>
            <!--<td colspan="3" class="light-line-color"><img height="1" width="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>-->
        </tr>
        <tr>
            <td class="form-label-text">
                <XLAT.STREAM KEY="dvin/UI/WorkflowGroup"/>:
            </td>
            <td class="form-inset">
                <SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Actions/WorkflowGroupDetailsFront" outstring="urlwfgrpdetfront">
                    <satellite.argument name="cs_environment" value="Variables.cs_environment"/>
                    <satellite.argument name="cs_formmode" value="Variables.cs_formmode"/>
                                                              <satellite.argument name="id" value="Variables.groupid"/>
                                                               </SATELLITE.LINK>
                <A HREF="Variables.urlwfgrpdetfront" REPLACEALL="Variables.urlwfgrpdetfront">
                    <STRING.STREAM VALUE="Variables.groupname"/>       
                </A>
            </td>
        </tr>
        </table>
    
        </td>
        <td class="tile-dark" VALIGN="top" WIDTH="1" NOWRAP="nowrap"><BR /></td>
    </tr>
    <tr>
        <td colspan="3" class="tile-dark" VALIGN="TOP" HEIGHT="1"><IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>
    </tr>
    <tr>
        <td></td><td background="Variables.cs_imagedir/graphics/common/screen/shadow.gif" REPLACEALL="Variables.cs_imagedir"><IMG WIDTH="1" HEIGHT="5" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td><td></td>
    </tr>
    </table>
    <STRING.ENCODE VARIABLE="PostPage" VARNAME="PostPage"/>
    <INPUT type="hidden" name="pagename" value="OpenMarket/Xcelerate/Actions/Variables.PostPage" REPLACEALL="Variables.PostPage"/>
	<INPUT type="hidden" name="AssetType" VALUE="Variables.AssetType" REPLACEALL="Variables.AssetType"/>
	<INPUT type="hidden" name="id" VALUE="Variables.id"  REPLACEALL="Variables.id"/>
	<STRING.ENCODE VARIABLE="groupid" VARNAME="groupid"/>
    <INPUT type="hidden" name="groupid" VALUE="Variables.groupid"  REPLACEALL="Variables.groupid"/>
    <XLAT.LOOKUP KEY="dvin/UI/Cancel" VARNAME="_XLAT_"/>
    <XLAT.LOOKUP KEY="dvin/UI/Cancel" VARNAME="mouseover" ESCAPE="true"/>
    <SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Actions/StatusDetailsFront" outstring="urlstatusdetfront">
        <satellite.argument name="cs_environment" value="Variables.cs_environment"/>
        <satellite.argument name="cs_formmode" value="Variables.cs_formmode"/>
                                                               <satellite.argument name="AssetType" value="Variables.AssetType"/>
                                                              <satellite.argument name="id" value="Variables.id"/>
                                                               </SATELLITE.LINK>
<div class="width-outer-70">
<table><tr><td>
    <A HREF="Variables.urlstatusdetfront" onmouseover="window.status='Variables.mouseover';return true;" onmouseout="window.status='';return true;"  REPLACEALL="Variables.urlstatusdetfront,Variables.mouseover"><CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/Cancel"/></CALLELEMENT></A>   
    </td><td>
    <XLAT.LOOKUP KEY="dvin/UI/RemoveFromWorkflowGroup" VARNAME="_XLAT_"/>
    <A HREF="javascript:void(0)" onclick="javascript:document.AppForm.submit();"><CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/RemoveFromGroup"/></CALLELEMENT></A>
</td></tr></table>
</div>
</then>
<else>
	<div class="width-outer-70">
     <callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/ShowMessage">
       	<argument NAME="elem" VALUE="Variables.ErrorName"/>
       	<argument NAME="severity" VALUE="Variables.severity"/>
     </callelement>
	 </div>
     <callelement NAME="OpenMarket/Xcelerate/Actions/StatusDetailsFront">
    	 <argument NAME="AssetType" VALUE="Variables.AssetType"/>
    	 <argument NAME="id"        VALUE="Variables.id"/>
     </callelement>
</else>
</if>

</FTCS> 
