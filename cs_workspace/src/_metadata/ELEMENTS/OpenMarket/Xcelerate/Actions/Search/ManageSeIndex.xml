<?xml version="1.0" ?>
<!DOCTYPE FTCS SYSTEM "futuretense_cs.dtd">

<FTCS Version="1.1">
<!-- 
$Logfile: /VerticalApps/Xcelerate36/install/Populate/ElementCatalog/OpenMarket/Xcelerate/Actions/Search/ManageSeIndex.xml $ 
$Revision: 10 $ 
$Modtime: 3/02/01 5:52p $ 
-->

<!--
- Confidential and Proprietary Information of FutureTense Inc.
-					All Rights Reserved.
-
- ManageSeIndex.xml
-
- DESCRIPTION
-   Add, replace, or remove an asset in its search engine index.  Does
-   nothing if the content category is not using a search engine.
-
- ENVIRONMENT
-   Input:
-       Variables.msicommand = "Add", "Replace", or "Remove"
-	Variables.AssetType
-	Variables.id = asset id
-   Output:
-       Variables.errno = result of INDEXADD, INDEXREPLACE, or INDEXREMOVE.
-->

<!-- Load the asset type information -->

	<ASSETTYPE.LOAD NAME="type" TYPE="Variables.AssetType"/>
	<ASSETTYPE.SCATTER NAME="type" PREFIX="AssetTypeObj"/>

<!-- Check to see if the asset type uses a search index -->

<if COND="Variables.AssetTypeObj:usesearchindex=1">
<then>
    <if COND="Variables.msicommand=Remove">
    <then>
        <!--
	-   Remove asset from index
	-->
        <indexremove ENTRY="Variables.id" INDEX="Variables.AssetTypeObj:indexfile"/>
    </then>
    <else>
    
<!-- Load the asset into a list -->
<!-- ATTENTION: should change this to load 
     This will only return the values from an asset's primary table.
     Large compound assets should do a LOAD and SCATTER to retrieve all values
-->

		<ASSET.LIST TYPE="Variables.AssetType" LIST="asset" FIELD1="id" VALUE1="Variables.id"/>

	<!-- Index the asset -->
	<callelement NAME="OpenMarket/Xcelerate/AssetType/Variables.AssetType/IndexVariables.msicommand">
	    <argument NAME="seindex" VALUE="Variables.AssetTypeObj:indexfile"/>
	    <argument NAME="detailArg" VALUE="fnord"/><!--AV: can't be empty-->
	</callelement>
    </else>
    </if>
</then>
</if>

</FTCS>