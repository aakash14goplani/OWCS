<?xml version="1.0" ?>
<!DOCTYPE FTCS SYSTEM "futuretense_cs.dtd">
<FTCS Version="1.1">
<!--
$Logfile: /VerticalApps/Xcelerate36/install/Populate/ElementCatalog/OpenMarket/Xcelerate/Installation/Install.xml $
$Revision: 23 $
$Modtime: 3/02/01 6:04p $
-->

<!--
- Confidential and Proprietary Information of FutureTense Inc.
-					All Rights Reserved.
-
- DESCRIPTION
-    Root element used to create Xcelerate catalogs.
-
- INPUT
-    command - command to process (deinstall, install, reinstall)
-    catalog - name of catalog
-	  element - name of element to call (optional, if not provided assume catalog is element name)
- 	other variables are passed along to the elemnts i.e., elements are called with global scope
-->


<!-- Initialize the result -->
	
	<SETVAR NAME="result" VALUE="Variables.empty"/>

<!-- Set the name of the installation element -->
	<IF COND="IsVariable.element=true">
		<THEN>
			<SUBSTITUTE STR="Variables.pagename" WHAT="Installation/Install" WITH="Installation/Variables.element" OUTSTR="element"/>
		</THEN>
		<ELSE>
			<SUBSTITUTE STR="Variables.pagename" WHAT="Installation/Install" WITH="Installation/Variables.catalog" OUTSTR="element"/>
		</ELSE>
	</IF>
	
<!-- Check to see if there is an element to manage the catalog -->

	<IF COND="IsElement.Variables.element=true">
		<THEN>

<!-- Check to see if the catalog already exists -->

			<SETVAR NAME="errno" VALUE="0"/>
			<CATALOGDEF FROM="Variables.catalog" LIST="ColumnList"/>
			<IF COND="Variables.errno=0">
				<THEN>

<!-- Check for a deinstall command -->

					<IF COND="Variables.command=deinstall">
						<THEN>
							<CALLELEMENT NAME="Variables.element">
								<ARGUMENT NAME="command" VALUE="Variables.command"/>
								<ARGUMENT NAME="catalog" VALUE="Variables.catalog"/>
								<ARGUMENT NAME="result" VALUE="Variables.empty"/>
							</CALLELEMENT>
						</THEN>

<!-- Otherwise, check for an install command -->

					<ELSE> <IF COND="Variables.command=install">
						<THEN>
							<CALLELEMENT NAME="Variables.element">
								<ARGUMENT NAME="command" VALUE="Variables.command"/>
								<ARGUMENT NAME="catalog" VALUE="Variables.catalog"/>
								<ARGUMENT NAME="result" VALUE="Variables.empty"/>
							</CALLELEMENT>
						</THEN>

<!-- Otherwise, check for a reinstall command -->

					<ELSE> <IF COND="Variables.command=reinstall">
						<THEN>
							<CALLELEMENT NAME="Variables.element">
								<ARGUMENT NAME="command" VALUE="deinstall"/>
								<ARGUMENT NAME="catalog" VALUE="Variables.catalog"/>
								<ARGUMENT NAME="result" VALUE="Variables.empty"/>
							</CALLELEMENT>
							<IF COND="Variables.result=Variables.empty">
								<THEN>
									<CALLELEMENT NAME="Variables.element">
										<ARGUMENT NAME="command" VALUE="install"/>
										<ARGUMENT NAME="catalog" VALUE="Variables.catalog"/>
										<ARGUMENT NAME="result" VALUE="Variables.empty"/>
									</CALLELEMENT>
								</THEN>
							</IF>
						</THEN>
						<ELSE>
						</ELSE>
					</IF> </ELSE> </IF> </ELSE> </IF>
				</THEN>
				<ELSE>

<!-- Check for a deinstall command -->

					<IF COND="Variables.command=deinstall">
						<THEN>
							<CALLELEMENT NAME="Variables.element">
								<ARGUMENT NAME="command" VALUE="Variables.command"/>
								<ARGUMENT NAME="catalog" VALUE="Variables.catalog"/>
								<ARGUMENT NAME="result" VALUE="Variables.empty"/>
							</CALLELEMENT>
						</THEN>

<!-- Otherwise, check for an install command -->

					<ELSE> <IF COND="Variables.command=install">
						<THEN>
							<CALLELEMENT NAME="Variables.element">
								<ARGUMENT NAME="command" VALUE="Variables.command"/>
								<ARGUMENT NAME="catalog" VALUE="Variables.catalog"/>
								<ARGUMENT NAME="result" VALUE="Variables.empty"/>
							</CALLELEMENT>
						</THEN>

<!-- Otherwise, check for a reinstall command -->

					<ELSE> <IF COND="Variables.command=reinstall">
						<THEN>
							<CALLELEMENT NAME="Variables.element">
								<ARGUMENT NAME="command" VALUE="install"/>
								<ARGUMENT NAME="catalog" VALUE="Variables.catalog"/>
								<ARGUMENT NAME="result" VALUE="Variables.empty"/>
							</CALLELEMENT>
						</THEN>
						<ELSE>
						</ELSE>
					</IF> </ELSE> </IF> </ELSE> </IF>
				</ELSE>
			</IF>
		</THEN>
		<ELSE>
			<SETVAR NAME="result" VALUE="invalid element Variables.element"/>
		</ELSE>
	</IF>

<!-- Check for error -->

	<IF COND="Variables.result!=Variables.empty">
		<THEN>
			<LOGMSG STR="Xcelerate Installation Error: Variables.result"/>
			##ERROR## <CSVAR NAME="Variables.result"/><BR/>
		</THEN>
		<ELSE>
			##SUCCESS## <CSVAR NAME="Variables.result"/><BR/>
		</ELSE>
	</IF>
	
	<REMOVEVAR NAME="element"/>
</FTCS>
