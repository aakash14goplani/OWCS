<?xml version="1.0" ?>
<!DOCTYPE FTCS SYSTEM "futuretense_cs.dtd">
<FTCS Version="1.2">
<!-- OpenMarket/Xcelerate/PrologActions/SBMultiSelectSearchPost
-
- INPUT
-
- OUTPUT
-
-->

<DEBABBLE VALUE="false"/>

<!--  The following are enhancements needed for supporting the Saved Searches -->
<!-- Make this into a seperate element -->


<setvar NAME="doproceed" VALUE="true"/>
<!-- Load the search engine specific strings -->

	<!--CALLELEMENT NAME="OpenMarket/Xcelerate/Actions/Search/seDescription"/-->

<!-- Load the asset type -->

	<!--ASSETTYPE.LOAD NAME="type" TYPE="Variables.AssetType"/>
	<ASSETTYPE.SCATTER NAME="type" PREFIX="AssetTypeObj"/-->

<!-- 
	If the Asset has an element to construct the search, call it,
	otherwise use the search search specified in the AssetType
	(0 - for SQL search; 1 for search index search )
-->

<!--
    Construct the engine-specific query (SQL, or SE)
    Perform one (SQL) or two (SE) step search.
    Display results.
-->
<IF COND="IsVariable.ResultLimit!=true">
<THEN>
	<SETVAR NAME="ResultLimit" VALUE="20"/>
</THEN>
</IF>
<IF COND="IsVariable.TotalResultLimit!=true">
<THEN>
	<setvar NAME="TotalResultLimit"  VALUE="1000"/>
</THEN>
</IF>
<!--
    SQL Search being used.
-->
       
<!--  Need to Restore the Search Variables for Execute , Edit and Saving Searches -->
<XLAT.LOOKUP KEY="dvin/FlexibleAssets/Common/Filter" VARNAME="_XLAT_Filter"/>
<SETVAR NAME="filterstring" VALUE="Variables._XLAT_Filter"/>
<SETVAR NAME="queryend" VALUE="Variables.empty"/>

<CALLELEMENT NAME="OpenMarket/Xcelerate/AssetType/Variables.AssetType/AppendSelectDetails"/>
<IF COND="Variables.filterstring=Variables._XLAT_Filter">
<THEN>
    <XLAT.LOOKUP KEY="dvin/UI/Search/FilterAll" VARNAME="filterstring"/>
</THEN>
</IF>
<IF COND="IsVariable.OrderBy=true">
  <THEN>
    <!--V1.0 customers might hold on to old hardcoded ordering-->
    <SETVAR NAME="queryend" VALUE="Variables.queryend ORDER BY Variables.OrderBy"/>
  </THEN>
</IF>
<SETVAR NAME="errno" VALUE="0"/>

<!-- Call an asset element to do the search or else just execute the search -->
<IF COND="IsElement.OpenMarket/Xcelerate/AssetType/Variables.AssetType/ExecuteSearch=true">
<THEN>
    <CALLELEMENT NAME="OpenMarket/Xcelerate/AssetType/Variables.AssetType/ExecuteSearch"/>
</THEN>
<ELSE>
        <CALLSQL LIST="Content" QRYNAME="OpenMarket/Xcelerate/AssetType/Variables.AssetType/SelectSummary" 
        LIMIT="Variables.TotalResultLimit"/>
</ELSE>
</IF>

<IF COND="IsVariable.pagenum!=true">
<THEN> 
	<SETVAR NAME="pagenum" VALUE="1"/>
</THEN>
</IF>
<DEBABBLE VALUE="true"/>


</FTCS>
