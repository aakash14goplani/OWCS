<?xml version="1.0" ?>
<!DOCTYPE FTCS SYSTEM "futuretense_cs.dtd">
<FTCS Version="1.1">
<!-- OpenMarket/Xcelerate/Admin/Publish/PublishEventEdit
-
- INPUT
-
- OUTPUT
-
-->

<SCRIPT LANGUAGE="JavaScript">
function setCheck(obj, message)
{
   if (confirm(message)) {
      return true;
   }
   return false;
}
</SCRIPT>

<!-- get PubTarget name -->
<STRING.ENCODE VARIABLE="cs_environment" VARNAME="cs_environment"/>
<CALLELEMENT NAME="OpenMarket/Xcelerate/Util/SetServerTimeZoneVar" />
<XLAT.LOOKUP KEY='UI/Forms/datesInServerTime' VARNAME="datesInServerTime"/>
<DIV class="width-outer-70">
			<CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/ShowMessage">
				<ARGUMENT NAME="msgtext" VALUE='Variables.datesInServerTime'/>
				<ARGUMENT NAME="severity" VALUE="info" />
			</CALLELEMENT>
</DIV>
<PUBTARGETMANAGER.LOAD ID="Variables.target" OBJVARNAME="pubtgt"/>
<STRING.ENCODE VARIABLE="target" VARNAME="target"/>
<if COND="IsError.Variables.errno=false">
<then>
<IF COND="Variables.action=edit">
<THEN>

	<PUBTARGET.GETNAME NAME="pubtgt" VARNAME="pubtgt:name"/>
	<table class="width-outer-70" cellspacing="0" cellpadding="0" border="0">
	<tr><td>
		<span class="title-text"><XLAT.STREAM KEY="dvin/UI/Admin/EditPublishEventForDestination"/>: <STRING.STREAM VALUE="Variables.pubtgt:name" /></span>
	</td></tr>
	<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/TitleBar"/>
	</table>

	<setvar NAME="errno" VALUE="0"/>
	<setvar NAME="existEvent" VALUE="false"/>
	<div class="width-outer-70">
	<div class="sectionhead">
		<span class="sectionname"><XLAT.STREAM KEY="dvin/UI/Admin/EnabledDatesandTimes"/></span>
	</div>
	<div class="sectionbody">
		<div class="sectionbox" id="eventenabled">
			<div class="content" style="padding-top: 6px; padding-bottom: 6px;">
			<!--this table will be filled in by javascript in EventForm-->
			<table id="eventdetail" class="eventdetail" cellspacing="0" cellpadding="0">
				<tr>
					<td class="label">
						<XLAT.STREAM KEY="dvin/UI/Util/Hours"/>:
					</td><td id="hrstr">
					</td>
				</tr>
				<tr>
					<td class="label">
						<XLAT.STREAM KEY="dvin/UI/Util/Minutes"/>:
					</td><td id="minstr">
					</td>
				</tr>
				<tr>
					<td class="label">
						<XLAT.STREAM KEY="dvin/Common/Dates"/>:
					</td><td id="domstr">
					</td>
				</tr>
				<tr>
					<td class="label">
						<XLAT.STREAM KEY="dvin/Common/Days"/>:
					</td><td id="dowstr">
					</td>
				</tr>
				<tr>
					<td class="label">
						<XLAT.STREAM KEY="dvin/UI/Util/Months"/>:
					</td><td id="moystr">
					</td>
				</tr>
			</table>
			</div>
			<div class="feedback" style="text-align: center; padding-top: 4em;">
			 <span style="padding: 4px 0 2px;">
			<!-- read SystemEvents table -->
			<ICS.QUERYEVENTS LIST="publishevent" NAME="PublishEvent_Variables.target%"/>
				<if COND="publishevent.enabled!=false">
				<then>
					<label><input type="radio" name="enabled" value="yes" checked="checked"/><XLAT.STREAM KEY="dvin/UI/Admin/Enabled"/></label>&nbsp;&nbsp;
					<label><input type="radio" name="enabled" value="no"/><XLAT.STREAM KEY="dvin/UI/Admin/Disabled"/></label>
				</then>
				<else>
					<label><input type="radio" name="enabled" value="yes"/><XLAT.STREAM KEY="dvin/UI/Admin/Enabled"/></label>&nbsp;&nbsp;
					<label><input type="radio" name="enabled" value="no" checked="checked"/><XLAT.STREAM KEY="dvin/UI/Admin/Disabled"/></label>
				</else>
				</if>
			 &nbsp;</span>
			</div>
			<br clear="all" />
		</div>
		<div class="sectionshadow"></div>
	</div>
	<br clear="all"/>
		<IF COND="IsError.Variables.errno=true">
		<THEN>
			<CALLELEMENT NAME="OpenMarket/Xcelerate/Actions/Util/EventFront"/>
		</THEN>
		<ELSE>
			<SETVAR NAME="existEvent" VALUE="true"/>
			<CALLELEMENT NAME="OpenMarket/Xcelerate/Actions/Util/EventFront">
				<ARGUMENT NAME="eventtime" VALUE="publishevent.time"/>
			</CALLELEMENT>
		</ELSE>
		</IF>
<p/>
<INPUT TYPE="HIDDEN" NAME="pagename" VALUE="OpenMarket/Xcelerate/Admin/Publish/PublishEventPost"/>
<INPUT TYPE="HIDDEN" NAME="target" VALUE="Variables.target" REPLACEALL="Variables.target" />
<INPUT TYPE="hidden" NAME="action" VALUE="save"/>
<XLAT.LOOKUP KEY="dvin/UI/Save" VARNAME="_XLAT_" ESCAPE="true"/>
<XLAT.LOOKUP KEY="dvin/UI/Cancel" VARNAME="_status_" ESCAPE="true"/>
<if cond="Variables.cs_environment=portal">
<then>
    <A HREF="javascript:void(0);" ONCLICK="window.close();">
        <CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/Cancel"/></CALLELEMENT>
    </A>
</then>
<else>
    <A HREF="javascript:parent.XcelAction.history.go(-1)" onmouseover="window.status='Variables._status_';return true;" onmouseout="window.status='';return true;" REPLACEALL="Variables._status_">
        <CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/Cancel"/></CALLELEMENT>
   </A>
</else>
</if>
<A HREF="javascript:void(0);" onClick="if(preSave()){document.forms['AppForm'].submit(); return false;}" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true;" REPLACEALL="Variables._XLAT_"><CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/Save"/></CALLELEMENT></A>
</div>
</THEN>
</IF>


<IF COND="Variables.action=confirmdelete">
<THEN>
	<PUBTARGET.GETNAME NAME="pubtgt" VARNAME="pubtgt:name"/>
	<table class="width-outer-70" cellspacing="0" cellpadding="0" border="0">
	<tr><td>
		<span class="title-text"><XLAT.STREAM KEY="dvin/UI/Admin/DeletePublishEventforDestinationName" pubtgt:name="Variables.pubtgt:name"/></span>
	</td></tr>
	<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/TitleBar"/>
	</table>
	<P/>
	<ICS.QUERYEVENTS LIST="publishevent" NAME="PublishEvent_Variables.target%"/>
	<IF COND="Variables.errno=-203">
	<THEN>
		<XLAT.STREAM KEY="dvin/UI/Admin/Noexistingpublishevent"/>
	</THEN>
	<ELSE>
	<SETVAR NAME="existEvent" VALUE="true"/>
	<XLAT.LOOKUP KEY="dvin/UI/Admin/ConfirmDestroyPublishEvent" VARNAME="msgtext"/>
	<div class="width-outer-70">
	<CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/ShowMessage">
		<ARGUMENT NAME="msgtext" VALUE="Variables.msgtext"/>
		<ARGUMENT NAME="severity" VALUE="warning"/>
	</CALLELEMENT>
	</div>
	<P/>
   <table class="width-outer-70" BORDER="0" CELLSPACING="0" CELLPADDING="0">
	<tr><td>
		<table cellpadding="0" cellspacing="0" border="0" bgcolor="#ffffff">
			<tr>
				<td class="form-label-text">
					<XLAT.STREAM KEY="dvin/Common/Name"/>:
				</td>
				<td class="form-inset">
			 		<STRING.STREAM VALUE="Variables.pubtgt:name"/>
				</td><td></td>
			</tr>
			<tr>
				<!--<td colspan="3" class="light-line-color"><img height="1" width="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>-->
			</tr>
			<tr>
				<td class="form-label-text">
					<XLAT.STREAM KEY="dvin/UI/Admin/Times"/>:
				</td>
				<td class="form-inset" WIDTH="200">
					<CSVAR NAME="publishevent.time"/>	<BR/>
					<CALLELEMENT NAME="OpenMarket/Xcelerate/Admin/Util/DecodeTimedEvent">
						<ARGUMENT NAME="eventtime" VALUE="publishevent.time"/>
					</CALLELEMENT>
				</td><td></td>
			</tr>
			<tr>
				<!--<td colspan="3" class="light-line-color"><img height="1" width="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>-->
			</tr>
				<tr>
				<td class="form-label-text">
					<XLAT.STREAM KEY="dvin/UI/Admin/Enabled"/>:
				</td>
				<td class="form-inset">
					<if COND="publishevent.enabled=true">
					<then>
						<XLAT.STREAM KEY="dvin/Common/lcyes"/>
					</then>
					<else>
						<span class="alert-color"><XLAT.STREAM KEY="dvin/Common/lcno"/></span>
					</else>
					</if>
				</td><td><BR /></td>
			</tr>
		</table>
	</td></tr>
</table>

<INPUT TYPE="HIDDEN" NAME="pagename" VALUE="OpenMarket/Xcelerate/Admin/Publish/PublishEventPost"/>
<INPUT TYPE="HIDDEN" NAME="action" VALUE="destroy"/>
<INPUT TYPE="HIDDEN" NAME="target" VALUE="Variables.target" REPLACEALL="Variables.target"/>
<XLAT.LOOKUP KEY="dvin/UI/Admin/DeletePublishEventforDestinationName" VARNAME="_XLAT_" ESCAPE="true"/>
<XLAT.LOOKUP KEY="dvin/UI/Cancel" VARNAME="_status_" ESCAPE="true"/>
<XLAT.LOOKUP KEY="dvin/Common/Delete" VARNAME="_alt_"/>
<div class="width-outer-70">
<if cond="Variables.cs_environment=portal">
<then>
    <A HREF="javascript:void(0);" ONCLICK="window.close();">
       <CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/Cancel"/></CALLELEMENT>
    </A>
</then>
<else>
    <A HREF="javascript:parent.XcelAction.history.go(-1)" onmouseover="window.status='Variables._status_';return true;" onmouseout="window.status='';return true;" REPLACEALL="Variables._status_">
        <CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/Cancel"/></CALLELEMENT>
    </A>
</else>
</if>
<A HREF="javascript:void(0);" onclick="document.forms['AppForm'].submit(); return false;" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true;" REPLACEALL="Variables._XLAT_"><CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/DeleteEvent"/></CALLELEMENT></A>
</div>
	</ELSE>
	</IF>
</THEN>
</IF>


</then>
<else>
	<XLAT.STREAM KEY="dvin/Common/Error"/> = <CSVAR NAME="Variables.errno"/><br/>
   <callelement NAME="OpenMarket/Xcelerate/Actions/Util/ShowError">
      <argument NAME="error" VALUE="NoPublishDest"/>
  	</callelement>
  	<setvar NAME="upcommand" value="cancel"/>
</else>
</if>


</FTCS>
