<?xml version="1.0" ?>
<!DOCTYPE FTCS SYSTEM "futuretense_cs.dtd">
<FTCS Version="1.1">
<!-- OpenMarket/Xcelerate/Admin/User/Show
-
- INPUT
-
- OUTPUT
-
-->
	   <STRING.ENCODE VARIABLE="pubid" VARNAME="pubid" />
       <INPUT TYPE="HIDDEN" NAME="pubid" VALUE="Variables.pubid" REPLACEALL="Variables.pubid"/>
       <!--
       <if COND="Variables.action=list">
       <then>
          <INPUT TYPE="HIDDEN" NAME="pagename" VALUE="OpenMarket/Xcelerate/Admin/User/Front"/>
          <if COND="IsVariable.pattern=true">
          <then>
              <INPUT TYPE="HIDDEN" NAME="pattern" VALUE="Variables.pattern" 
                     REPLACEALL="Variables.pattern"/>
          </then>
          </if>
       </then>
       <else>
            -- assume action is edit -- 
          <INPUT TYPE="HIDDEN" NAME="pagename" VALUE="OpenMarket/Xcelerate/Admin/User/Post"/>
          <INPUT TYPE="SUBMIT" NAME="Submit" VALUE="Save"/>
          <setcounter NAME="checkers" VALUE="0"/>
        </else>
       </if>
       -->
 <IF COND="Variables.ValidUser=yes">
 <THEN>

	
 <if COND="Variables.singleUser=no">
        <then>
            <!-- Get all users authorized for this publication -->
            <callelement NAME="Variables.propmanageuserpub">
                <argument NAME="upcommand" VALUE="GetPubUsers"/>
				<argument NAME="getusername" VALUE="true"/>
                <argument NAME="qryprefix" VALUE="PubUsers"/>
            </callelement>
        </then>
        <else>
                <USERMANAGER.GETUSERROLES OBJVARNAME="rolelist" USER="Variables.useridvarname" SITE="Variables.pubid"/>
                <ROLELIST.GETALL NAME="rolelist" VARNAME="useraclname"/>
                <STRINGLIST NAME="PubUsers" STR="Variables.pattern" DELIM=";"/>
				
		</else>
		</if>
            <IF COND="IsList.PubUsers=true">
            <THEN>
				<!-- check if logged in user has GeneralAdmin role -->
				<USERMANAGER.GETLOGINUSER VARNAME="loginuser" />
				<USERMANAGER.GETUSER USER="Variables.loginuser" OBJVARNAME="myUserObj" />
				<CCUSER.GETSITEROLES NAME="myUserObj" SITE="SessionVariables.pubid" OBJVARNAME="loginuserroleobject"/>
				<ROLELIST.GETALL NAME="loginuserroleobject" VARNAME="roles"/>
				<ROLELIST.HASROLE NAME="loginuserroleobject" ROLE="GeneralAdmin" VARNAME="generalAdminExists"/> 
				
               
            <table BORDER="0" CELLSPACING="0" CELLPADDING="0" class="width-outer-70">
			<tr>
				<td colspan="3"><b><XLAT.STREAM KEY="dvin/UI/Admin/Selecttheusertomodify"/></b></td>
			</tr>
			<tr>
				<td></td><td class="tile-dark" HEIGHT="1"><IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td><td></td>
			</tr>
			<tr>
			<td class="tile-dark" VALIGN="top" WIDTH="1" NOWRAP="nowrap"><BR /></td>
			<td >
				<table width="100%" cellpadding="0" cellspacing="0" border="0" bgcolor="#ffffff"><tr><td colspan="7" class="tile-highlight"><IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td></tr>
					<tr><td class="tile-a" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;</td>
						<td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;</td>
						<td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;</td><td class="tile-b" nowrap="nowrap" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir"><DIV class="new-table-title"><XLAT.STREAM KEY="dvin/UI/UserName"/></DIV></td>
						<td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;&nbsp;&nbsp;&nbsp;</td><td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir"><DIV class="new-table-title"><XLAT.STREAM KEY="dvin/Common/Roles"/></DIV></td>
						<td class="tile-c" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;</td>
					</tr>
					<tr><td colspan="7" class="tile-dark"><IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td></tr>
						<!-- Loop over all search results. -->
			   			<SETVAR NAME="rowStyle" VALUE="tile-row-normal"/>
						<SETVAR NAME="separatorLine" VALUE="0"/>
						<LOOP LIST="PubUsers">

							<IF COND="Variables.separatorLine=1">
							<THEN>
								<tr>
									<!--<td colspan="7" class="light-line-color"><img height="1" width="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>-->
								</tr>
							</THEN>
							</IF>
							<SETVAR NAME="separatorLine" VALUE="1"/>
							<callelement NAME="OpenMarket/Xcelerate/Admin/User/ShowSingle">
								<argument NAME="pUser"  VALUE="PubUsers.ITEM"/>
								<argument NAME="pGenAdm" VALUE="Variables.generalAdminExists"/>
							</callelement>
					            <IF COND="Variables.rowStyle=tile-row-normal">
					            <THEN><SETVAR NAME="rowStyle" VALUE="tile-row-highlight"/>
					            </THEN>
					            <ELSE><SETVAR NAME="rowStyle" VALUE="tile-row-normal"/>
					            </ELSE>
					            </IF>
							</LOOP>
							</table>
						</td>
						<td class="tile-dark" VALIGN="top" WIDTH="1" NOWRAP="nowrap"><BR /></td>
						</tr>
					<tr>
					<td colspan="3" class="tile-dark" VALIGN="TOP" HEIGHT="1"><IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>
					</tr>
					<tr>
					<td></td><td background="Variables.cs_imagedir/graphics/common/screen/shadow.gif" REPLACEALL="Variables.cs_imagedir"><IMG WIDTH="1" HEIGHT="5" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td><td></td>
					</tr>
					<tr>
					<td colspan="3"><DIV class="form-inset">
                        <SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Admin/User/List" outstring="urluserlist">
                            <satellite.argument name="cs_environment" value="Variables.cs_environment"/>
                            <satellite.argument name="cs_formmode" value="Variables.cs_formmode"/>
                                                         <satellite.argument name="action" value="ask"/>
                                                         <satellite.argument name="pubid" value="Variables.pubid"/>
                                                          </SATELLITE.LINK>
						<A HREF="Variables.urluserlist" REPLACEALL="Variables.urluserlist"><IMG src="Variables.cs_imagedir/graphics/common/icon/doubleArrow.gif" WIDTH="15" HEIGHT="12" BORDER="0" REPLACEALL="Variables.cs_imagedir"/><XLAT.STREAM KEY="dvin/UI/Admin/Manageusersforthissite"/></A>
					</DIV>
				</td>
				</tr>
            </table> 
			</THEN>
            <ELSE>
                 <XLAT.STREAM KEY="dvin/UI/Admin/NoUserfoundintheChosenPublication"/> 
                <BR/><BR/>
                <SATELLITE.FORM ASSEMBLER="query">
				<STRING.ENCODE VARIABLE="charset" VARNAME="charsetEnc"/>
		<INPUT TYPE="HIDDEN" NAME="_charset_" VALUE="Variables.charsetEnc" REPLACEALL="Variables.charsetEnc"/>
		<STRING.ENCODE VARIABLE="cs_environment" VARNAME="cs_environmentEnc"/>
		<INPUT TYPE="hidden"  NAME="cs_environment" VALUE="Variables.cs_environmentEnc" REPLACEALL="Variables.cs_environmentEnc"/>
		<STRING.ENCODE VARIABLE="cs_formmode" VARNAME="cs_formmodeEnc"/>
		<INPUT TYPE="hidden"  NAME="cs_formmode" VALUE="Variables.cs_formmodeEnc" REPLACEALL="Variables.cs_formmodeEnc"/>
		<input type="button" value="Back" onClick="javascript:history.go(-1)"/>
		</SATELLITE.FORM> 
             </ELSE>
            </IF>
      

	

       
       
  </THEN>
  <ELSE>
      <XLAT.STREAM KEY="dvin/UI/Admin/NoUsersmatchpattern"/>
      <BR/><BR/>
      <input type="button" value="Back" onClick="javascript:history.go(-1)"/>
  </ELSE>
  </IF>
</FTCS> 
