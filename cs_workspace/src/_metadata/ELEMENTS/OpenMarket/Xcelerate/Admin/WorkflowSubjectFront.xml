<?xml version="1.0" ?>
<!DOCTYPE FTCS SYSTEM "futuretense_cs.dtd">
<FTCS Version="1.1">
<!-- OpenMarket/Xcelerate/Admin/WorkflowSubjectFront

 INPUT

 OUTPUT

-->
<!--
 [2007-09-17 KGF]
 * XSS fixes (adapted from 6.3 fixes):
   * isCleanString function usage
   * CSVAR NAME -> STRING.STREAM VALUE
 * changed definitions of 'obj' to just forms[0] (not .elements[0])
 [2007-10-09 KGF]
 * XSS revision: minimized set of restricted characters.
 [2008-02-26 KGF]
 * further XSS fix: encode HTML special chars in description/subject.
-->
<CALLELEMENT NAME="OpenMarket/Xcelerate/Scripts/ValidateInputForXSS" />
<SCRIPT LANGUAGE="JavaScript">
<![CDATA[
function checkfields()
{
	var obj = document.forms[0];
	if (obj.elements['name'].value.search(/\S/) == -1)
	{
		]]>
		alert("<XLAT.STREAM KEY="dvin/UI/Admin/Error/specifynameworkflowemail" ESCAPE="true" ENCODE="false"/>");
		<![CDATA[
		obj.elements['name'].focus();
		return false;
	}
	var isclean = isCleanString(obj.elements['name'].value, '<">', true);	
	if (!isclean) {
		alert("]]><XLAT.STREAM KEY="dvin/FlexibleAssets/Attributes/ApostropheNotAllowedMinimal" ESCAPE="true" ENCODE="false"/><![CDATA[");
		return false;
	}
	if (obj.elements['description'].value=="")
	{
		]]>
		alert("<XLAT.STREAM KEY="dvin/UI/Admin/Error/specifydescriptionemail" ESCAPE="true" ENCODE="false"/>");
		<![CDATA[
		obj.elements['description'].focus();
		return false;
	}
	if (obj.elements['subject'].value=="")
	{
		]]>
		alert("<XLAT.STREAM KEY="dvin/UI/Admin/Error/specifysubjectemail" ESCAPE="true" ENCODE="false"/>");
		<![CDATA[
		obj.elements['subject'].focus();
		return false;
	}
	if (obj.elements['body'].value=="")
	{
		]]>
		alert("<XLAT.STREAM KEY="dvin/UI/Admin/Error/specifybodyemail" ESCAPE="true" ENCODE="false"/>");
		<![CDATA[
		obj.elements['body'].focus();
		return false;
	}
	return true;
}

]]>
</SCRIPT>

<!-- front -->


	<STRING.ENCODE VARIABLE="acttype" VARNAME="acttype" />
	<STRING.ENCODE VARIABLE="id" VARNAME="id"/>
	<STRING.ENCODE VARIABLE="cs_environment" VARNAME="cs_environment"/>
	<STRING.ENCODE VARIABLE="cs_imagedir" VARNAME="cs_imagedir"/>
	<STRING.ENCODE VARIABLE="cs_formmode" VARNAME="cs_formmode"/>
    <INPUT TYPE="HIDDEN" NAME="acttype" VALUE="Variables.acttype" REPLACEALL="Variables.acttype"/>
    <setvar NAME="doform" VALUE="false"/>
<IF COND="Variables.action=list">
<THEN>

	<IF COND="IsVariable.orderby!=true">
	<THEN>
		<SETVAR NAME="orderby" VALUE="description"/>
	</THEN>
	</IF>
<IF COND="Variables.showtitle!=false">
<THEN>                                          
	<table class="width-outer-70" cellspacing="0" cellpadding="0" border="0">
	<tr><td>
		<span class="title-text"><XLAT.STREAM KEY="dvin/UI/Admin/WorkflowEmail"/></span>
	</td></tr>
	<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/TitleBar"/>
	</table>
</THEN>
</IF>  
	<SELECTTO LIST="WflSubject" FROM="WorkflowSubject" WHAT="*" ORDERBY="Variables.orderby"/>

	<table BORDER="0" CELLSPACING="0" CELLPADDING="0" class="width-outer-50">
		<tr>
			<td></td><td class="tile-dark" HEIGHT="1"><IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td><td></td>
		</tr>
		<tr>
			<td class="tile-dark" VALIGN="top" WIDTH="1" NOWRAP="nowrap"><BR /></td>
			<td >
				<table class="width-inner-100" cellpadding="0" cellspacing="0" border="0" bgcolor="#ffffff"><tr><td colspan="7" class="tile-highlight"><IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td></tr>
					<tr><td class="tile-a" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;</td>
						<td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;</td>
						<td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;</td><td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">
                                        <SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Admin/WorkflowSubjectFront" outstring="urlwfsubjfront">
                                            <satellite.argument name="cs_environment" value="Variables.cs_environment"/>
                                            <satellite.argument name="cs_formmode" value="Variables.cs_formmode"/>
                                                         <satellite.argument name="action" value="list"/>
                                                         <satellite.argument name="orderby" value="name"/>
                                                          </SATELLITE.LINK>
                                        <A HREF="Variables.urlwfsubjfront" REPLACEALL="Variables.urlwfsubjfront"><DIV class="new-table-title"><XLAT.STREAM KEY="dvin/Common/Name"/></DIV></A></td>
						<td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;&nbsp;&nbsp;&nbsp;</td><td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">
                                        <SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Admin/WorkflowSubjectFront" outstring="urlwfsubjfront">
                                            <satellite.argument name="cs_environment" value="Variables.cs_environment"/>
                                            <satellite.argument name="cs_formmode" value="Variables.cs_formmode"/>
                                                         <satellite.argument name="action" value="list"/>
                                                         <satellite.argument name="orderby" value="description"/>
                                                          </SATELLITE.LINK>
                                        <A HREF="Variables.urlwfsubjfront" REPLACEALL="Variables.urlwfsubjfront"><DIV class="new-table-title"><XLAT.STREAM KEY="dvin/Common/Description"/></DIV></A></td>
						<td class="tile-c" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;</td>
					</tr>
					<tr><td colspan="7" class="tile-dark"><IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td></tr>
						<!-- Loop over all search results. -->
			   			<SETVAR NAME="rowStyle" VALUE="tile-row-normal"/>
						<SETVAR NAME="separatorLine" VALUE="0"/>
						<LOOP LIST="WflSubject">

							<IF COND="Variables.separatorLine=1">
							<THEN>
								<!--<tr>
									<td colspan="7" class="light-line-color"><img height="1" width="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>
								</tr>-->
							</THEN>
							</IF>
							<SETVAR NAME="separatorLine" VALUE="1"/>
			
							<tr class="Variables.rowStyle"  REPLACEALL="Variables.rowStyle"><td><BR /></td>
							<td VALIGN="TOP" NOWRAP="NOWRAP" ALIGN="LEFT">
							<XLAT.LOOKUP KEY="dvin/Common/Inspect" VARNAME="_XLAT_" ESCAPE="true"/><XLAT.LOOKUP KEY="dvin/UI/Admin/InspectThisEmail" VARNAME="_alt_"/>
							<SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Admin/WorkflowSubjectFront" outstring="urlwfsubjfront">
                                <satellite.argument name="cs_environment" value="Variables.cs_environment"/>
                                <satellite.argument name="cs_formmode" value="Variables.cs_formmode"/>
                                                         <satellite.argument name="action" value="details"/>
                                                         <satellite.argument name="id" value="WflSubject.id"/>
                                                          </SATELLITE.LINK>
                            <A HREF="Variables.urlwfsubjfront" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true" REPLACEALL="Variables.urlwfsubjfront,Variables._XLAT_"><img height="14" width="14" hspace="2" vspace="4" src="Variables.cs_imagedir/graphics/common/icon/iconInspectContent.gif"  border="0" alt="Variables._alt_" title="Variables._alt_"  REPLACEALL="Variables.cs_imagedir,Variables._alt_"/></A>
							<XLAT.LOOKUP KEY="dvin/Common/Edit" VARNAME="_XLAT_" ESCAPE="true"/><XLAT.LOOKUP KEY="dvin/UI/Admin/EditThisEmail" VARNAME="_alt_"/>
							<SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Admin/WorkflowSubjectFront" outstring="urlwfsubjfront">
                                <satellite.argument name="cs_environment" value="Variables.cs_environment"/>
                                <satellite.argument name="cs_formmode" value="Variables.cs_formmode"/>
                                                         <satellite.argument name="action" value="edit"/>
                                                         <satellite.argument name="id" value="WflSubject.id"/>
                                                          </SATELLITE.LINK>
                            <A HREF="Variables.urlwfsubjfront" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true" REPLACEALL="Variables.urlwfsubjfront,Variables._XLAT_"><img height="14" width="14" hspace="2" vspace="4" src="Variables.cs_imagedir/graphics/common/icon/iconEditContent.gif"  border="0" alt="Variables._alt_" title="Variables._alt_"  REPLACEALL="Variables.cs_imagedir,Variables._alt_"/></A>
							<XLAT.LOOKUP KEY="dvin/Common/Delete" VARNAME="_XLAT_" ESCAPE="true"/><XLAT.LOOKUP KEY="dvin/UI/Admin/DeleteThisEmail" VARNAME="_alt_"/>
							<SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Admin/WorkflowSubjectFront" outstring="urlwfsubjfront">
                                <satellite.argument name="cs_environment" value="Variables.cs_environment"/>
                                <satellite.argument name="cs_formmode" value="Variables.cs_formmode"/>
                                                         <satellite.argument name="action" value="confirmdelete"/>
                                                         <satellite.argument name="id" value="WflSubject.id"/>
                                                          </SATELLITE.LINK>
                            <A HREF="Variables.urlwfsubjfront" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true" REPLACEALL="Variables.urlwfsubjfront,Variables._XLAT_"><img height="14" width="14" hspace="2" vspace="4" src="Variables.cs_imagedir/graphics/common/icon/iconDeleteContent.gif"  border="0" alt="Variables._alt_" title="Variables._alt_"  REPLACEALL="Variables.cs_imagedir,Variables._alt_"/></A>
							
							</td>
									<td><BR /></td><td VALIGN="TOP" ALIGN="LEFT">
					                    <DIV class="small-text-inset">
                                            <SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Admin/WorkflowSubjectFront" outstring="urlwfsubjfront">
                                                <satellite.argument name="cs_environment" value="Variables.cs_environment"/>
                                                <satellite.argument name="cs_formmode" value="Variables.cs_formmode"/>
                                                         <satellite.argument name="action" value="details"/>
                                                         <satellite.argument name="id" value="WflSubject.id"/>
                                                          </SATELLITE.LINK>
						                    <A HREF="Variables.urlwfsubjfront" REPLACEALL="Variables.urlwfsubjfront"><STRING.STREAM VALUE="WflSubject.name"/></A>
					                    </DIV>
					                 </td>
					                <td><BR /></td><td VALIGN="TOP" NOWRAP="NOWRAP" ALIGN="LEFT">
					                    <DIV class="small-text-inset">
											<STRING.STREAM VALUE="WflSubject.description"/>
										</DIV>
									</td>
					                 	<td><BR /></td></tr>
					            <IF COND="Variables.rowStyle=tile-row-normal">
					            <THEN><SETVAR NAME="rowStyle" VALUE="tile-row-highlight"/>
					            </THEN>
					            <ELSE><SETVAR NAME="rowStyle" VALUE="tile-row-normal"/>
					            </ELSE>
					            </IF>
							</LOOP>
							</table>
						</td>
						<td class="tile-dark" VALIGN="top" WIDTH="1" NOWRAP="nowrap"><BR /></td>
						</tr>
					<tr>
					<td colspan="3" class="tile-dark" VALIGN="TOP" HEIGHT="1"><IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>
					</tr>
					<tr>
					<td></td><td background="Variables.cs_imagedir/graphics/common/screen/shadow.gif" REPLACEALL="Variables.cs_imagedir"><IMG WIDTH="1" HEIGHT="5" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td><td></td>
					</tr>
					</table> 
 
    <SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Admin/WorkflowSubjectFront" outstring="urlwfsubjfront">
        <satellite.argument name="cs_environment" value="Variables.cs_environment"/>
        <satellite.argument name="cs_formmode" value="Variables.cs_formmode"/>
                                                         <satellite.argument name="action" value="new"/>
                                                          </SATELLITE.LINK>

<div class="width-outer-70">
<A HREF="Variables.urlwfsubjfront" REPLACEALL="Variables.urlwfsubjfront"><CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/AddNewEmail"/></CALLELEMENT></A>
</div>

</THEN>
</IF> <!-- end action=list -->

    <if COND="Variables.action=details">
    <then>
	  <setvar NAME="existingaction" VALUE="true"/>
        <INPUT TYPE="HIDDEN" NAME="acttype" VALUE="Variables.acttype" REPLACEALL="Variables.acttype"/>

	  <INPUT TYPE="HIDDEN" NAME="existingaction" VALUE="Variables.existingaction" REPLACEALL="Variables.existingaction"/> 
  	  <setvar NAME="errno" VALUE="0"/>

	  <EMAILMANAGER.LOAD OBJVARNAME="anemailobject" ID="Variables.id"/>
	  <EMAIL.SCATTER PREFIX="wfsubject:" NAME="anemailobject"/>

	<IF COND="Variables.showtitle!=false">
	<THEN>
		<table class="width-outer-70" cellspacing="0" cellpadding="0" border="0">
			<tr><td>
				<span class="title-text"><XLAT.STREAM KEY="dvin/UI/Admin/WorkflowEmail"/>: <STRING.STREAM VALUE="Variables.wfsubject:name"/></span>
			</td></tr>
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/TitleBar"/>
		</table>
	</THEN>
	</IF>

    <table BORDER="0" CELLSPACING="0" CELLPADDING="0" class="width-outer-50 margin-top-zero">
	<tr><td>
		<table class="width-inner-100" cellpadding="0" cellspacing="0" border="0" bgcolor="#ffffff">
			<tr>
				<td class="form-label-text" colspan="3">
				<table class="lagecyAbar" border="0" cellpadding="0" cellspacing="0">
				<tr>
					<td><XLAT.LOOKUP KEY="dvin/Common/Inspect" VARNAME="_XLAT_" ESCAPE="true"/><XLAT.LOOKUP KEY="dvin/UI/Admin/InspectThisEmail" VARNAME="_alt_"/>
					<SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Admin/WorkflowSubjectFront" outstring="urlwfsubjfront">
                        <satellite.argument name="cs_environment" value="Variables.cs_environment"/>
                        <satellite.argument name="cs_formmode" value="Variables.cs_formmode"/>
                                                         <satellite.argument name="action" value="details"/>
                                                         <satellite.argument name="id" value="Variables.id"/>
                                                          </SATELLITE.LINK>
                    <A HREF="Variables.urlwfsubjfront" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true" REPLACEALL="Variables.urlwfsubjfront,Variables._XLAT_"><img height="14" width="14" hspace="2" vspace="4" src="Variables.cs_imagedir/graphics/common/icon/iconInspectContent.gif"  border="0" alt="Variables._alt_" title="Variables._alt_"  REPLACEALL="Variables.cs_imagedir,Variables._alt_"/></A></td>
					<td>
					<A HREF="Variables.urlwfsubjfront" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true" REPLACEALL="Variables.urlwfsubjfront,Variables._XLAT_"><span class="action-text"><XLAT.STREAM KEY="dvin/Common/Inspect"/></span></A></td>
<td>&nbsp;&nbsp;&nbsp;&nbsp;</td>
					<td><XLAT.LOOKUP KEY="dvin/Common/Edit" VARNAME="_XLAT_" ESCAPE="true"/><XLAT.LOOKUP KEY="dvin/UI/Admin/EditThisEmail" VARNAME="_alt_"/>
					<SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Admin/WorkflowSubjectFront" outstring="urlwfsubjfront">
                        <satellite.argument name="cs_environment" value="Variables.cs_environment"/>
                        <satellite.argument name="cs_formmode" value="Variables.cs_formmode"/>
                                                         <satellite.argument name="action" value="edit"/>
                                                         <satellite.argument name="id" value="Variables.id"/>
                                                          </SATELLITE.LINK>
                    <A HREF="Variables.urlwfsubjfront" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true" REPLACEALL="Variables.urlwfsubjfront,Variables._XLAT_"><img height="14" width="14" src="Variables.cs_imagedir/graphics/common/icon/iconEditContentUp.gif" hspace="2" border="0" alt="Variables._alt_" title="Variables._alt_"  REPLACEALL="Variables.cs_imagedir,Variables._alt_"/></A></td>
					<td>
					<A HREF="Variables.urlwfsubjfront" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true" REPLACEALL="Variables.urlwfsubjfront,Variables._XLAT_"><span class="action-text"><XLAT.STREAM KEY="dvin/Common/Edit"/></span></A></td>

	<td>&nbsp;&nbsp;&nbsp;&nbsp;</td>

					<td><XLAT.LOOKUP KEY="dvin/Common/Delete" VARNAME="_XLAT_" ESCAPE="true"/><XLAT.LOOKUP KEY="dvin/UI/Admin/DeleteThisEmail" VARNAME="_alt_"/>
					<SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Admin/WorkflowSubjectFront" outstring="urlwfsubjfront">
                        <satellite.argument name="cs_environment" value="Variables.cs_environment"/>
                        <satellite.argument name="cs_formmode" value="Variables.cs_formmode"/>
                                                         <satellite.argument name="action" value="confirmdelete"/>
                                                         <satellite.argument name="id" value="Variables.id"/>
                                                          </SATELLITE.LINK>
                    <A HREF="Variables.urlwfsubjfront" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true" REPLACEALL="Variables.urlwfsubjfront,Variables._XLAT_"><img height="14" width="14" src="Variables.cs_imagedir/graphics/common/icon/iconDeleteContentUp.gif" hspace="2" border="0" alt="Variables._alt_" title="Variables._alt_"  REPLACEALL="Variables.cs_imagedir,Variables._alt_"/></A></td>
					<td>
					<A HREF="Variables.urlwfsubjfront" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true" REPLACEALL="Variables.urlwfsubjfront,Variables._XLAT_"><span class="action-text"><XLAT.STREAM KEY="dvin/Common/Delete"/></span></A></td>
<td>&nbsp;&nbsp;&nbsp;&nbsp;</td>

</tr>
</table>

				</td>
			</tr></table>
			<table width="100%" cellpadding="0" cellspacing="0" border="0" bgcolor="#ffffff">
			<!--<tr>
				<td colspan="2" class="light-line-color"><img height="1" width="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>
			</tr>-->
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
			<tr>
				<td class="form-label-text"><XLAT.STREAM KEY="dvin/Common/Name"/>:</td>
				<td class="form-inset">
					<STRING.STREAM VARIABLE="wfsubject:name"/>
				</td>
			</tr>
			<!--<tr>
				<td colspan="2" class="light-line-color"><img height="1" width="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>
			</tr>-->
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
			<tr>
				<td class="form-label-text"><XLAT.STREAM KEY="dvin/Common/Description"/>:</td>
				<td class="form-inset">
						<STRING.STREAM VARIABLE="wfsubject:description"/>
				</td>
			</tr>
			<!--<tr>
				<td colspan="2" class="light-line-color"><img height="1" width="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>
			</tr>-->
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
			<tr>
				<td class="form-label-text"><XLAT.STREAM KEY="dvin/Common/Subject"/>:</td>
				<td class="form-inset">
						<STRING.STREAM VARIABLE="wfsubject:subject"/>
				</td>
			</tr>
			<!--<tr>
				<td colspan="2" class="light-line-color"><img height="1" width="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>
			</tr>-->
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
			<tr>
				<td class="form-label-text"><XLAT.STREAM KEY="dvin/UI/Admin/Body"/>:</td>
				<td class="form-inset">
						<STRING.STREAM VARIABLE="wfsubject:body"/>
				</td>
			</tr>
		
			<!--<tr>
				<td colspan="2" class="light-line-color"><img height="1" width="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>
			</tr>-->
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
			<tr>
				<td class="form-label-text"><XLAT.STREAM KEY="dvin/AT/Common/ID"/>:</td>
				<td class="form-inset">
						<STRING.STREAM VARIABLE="wfsubject:id"/>
				</td>
			</tr>
			</table>
	</td></tr>
</table>

<DIV class="width-outer-70">
    <SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Admin/WorkflowSubjectFront" outstring="urlwfsubjfront">
        <satellite.argument name="cs_environment" value="Variables.cs_environment"/>
        <satellite.argument name="cs_formmode" value="Variables.cs_formmode"/>
                                                         <satellite.argument name="action" value="list"/>
                                                          </SATELLITE.LINK>
    <A HREF="Variables.urlwfsubjfront" REPLACEALL="Variables.urlwfsubjfront"><IMG src="Variables.cs_imagedir/graphics/common/icon/doubleArrow.gif" WIDTH="15" HEIGHT="12" BORDER="0" REPLACEALL="Variables.cs_imagedir"/><XLAT.STREAM KEY="dvin/UI/Admin/Listallworkflowemails"/></A>
</DIV>
    </then>
    <else>
        <setvar NAME="doform" VALUE="true"/>
    </else>
    </if>

    <if COND="Variables.doform=true">
    <then>
		<if COND="Variables.action=new">
            <then>

	  <setvar NAME="existingaction" VALUE="false"/>
	  <INPUT TYPE="HIDDEN" NAME="existingaction" VALUE="Variables.existingaction" REPLACEALL="Variables.existingaction"/> 
    	  <INPUT TYPE="HIDDEN" NAME="acttype" VALUE="Variables.acttype" REPLACEALL="Variables.acttype"/>
		<IF COND="Variables.showtitle!=false">
        <THEN>                                          
			<table class="width-outer-70" cellspacing="0" cellpadding="0" border="0">
				<tr><td>
					<span class="title-text"><XLAT.STREAM KEY="dvin/UI/Admin/AddNewWorkflowEmail"/></span>
				</td></tr>
				<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/TitleBar"/>
			</table>                                      
        </THEN>
        </IF>   

    <table BORDER="0" CELLSPACING="0" CELLPADDING="0" class="width-outer-50">
	<tr><td>
		<table class="width-inner-100" cellpadding="0" cellspacing="0" border="0" bgcolor="#ffffff">
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
			<tr>
				<td class="form-label-text" NOWRAP="NOWRAP">
					<span class="alert-color">*</span><XLAT.STREAM KEY="dvin/Common/Name"/>:
				</td>
				<td class="form-inset">
                  	   <INPUT TYPE="TEXT" SIZE="32" MAXLENGTH="40" NAME="name" VALUE=""/>
				</td>
			</tr>
			<!--<tr>
				<td colspan="3" class="light-line-color"><img height="1" width="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>
			</tr>-->
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
			<tr>
				<td class="form-label-text">
					<span class="alert-color">*</span><XLAT.STREAM KEY="dvin/Common/Description"/>:
				</td>
				<td class="form-inset">
						<INPUT TYPE="TEXT" SIZE="32" MAXLENGTH="40" NAME="description" VALUE=""/>
				</td><td><BR /></td>
			</tr>
			<!--<tr>
				<td colspan="3" class="light-line-color"><img height="1" width="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>
			</tr>-->
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
			<tr>
				<td class="form-label-text">
					<span class="alert-color">*</span><XLAT.STREAM KEY="dvin/Common/Subject"/>:
				</td>
				<td class="form-inset">
						<INPUT TYPE="TEXT" SIZE="32" MAXLENGTH="60" NAME="subject" VALUE=""/>
				</td><td><BR /></td>
			</tr>
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
			<tr>
				<td class="form-label-text">
					<span class="alert-color">*</span><XLAT.STREAM KEY="dvin/UI/Admin/Body"/>:
				</td>
				<td class="form-inset">
					<TEXTAREA NAME="body" ROWS="10" COLS="60" WRAP="VIRTUAL"></TEXTAREA>
				</td><td><BR /></td>
			</tr>
			<INPUT TYPE="HIDDEN" NAME="pagename" VALUE="OpenMarket/Xcelerate/Admin/WorkflowSubjectPost"/>                
			<INPUT TYPE="HIDDEN" NAME="action" VALUE="new"/>
			<SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Admin/WorkflowSubjectFront" outstring="WorkflowSubjectFrontURL">
			<satellite.argument name="cs_environment" value="Variables.cs_environment"/>
			<satellite.argument name="cs_formmode" value="Variables.cs_formmode"/>
			 <satellite.argument name="action" value="list"/>
			</SATELLITE.LINK>
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/FooterBar"/>
			<TR>
				<TD class="form-label-text"></TD><TD class="form-inset">
				<A HREF="Variables.WorkflowSubjectFrontURL" REPLACEALL="Variables.WorkflowSubjectFrontURL"><CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/Cancel"/></CALLELEMENT></A><XLAT.LOOKUP KEY="dvin/UI/AddEmail" VARNAME="_XLAT_" ESCAPE="true"/>
				<A HREF="javascript:void(0);" onClick="if(checkfields()!=false){document.forms['AppForm'].submit();return false;}" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true;" REPLACEALL="Variables._XLAT_"><CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/AddNewEmail"/></CALLELEMENT></A>
				</TD>
			</TR>
		</table>
	</td></tr>
</table>
    	</then>
    	</if>    



<!-- ************** edit ****************-->
	<if COND="Variables.action=edit">
	<then>

		<REMOVEVAR NAME="action"/>
		<EMAILMANAGER.LOAD OBJVARNAME="anemailobject" ID="Variables.id"/>

	  	<EMAIL.SCATTER PREFIX="wfsubject:" NAME="anemailobject"/>
	  	<INPUT TYPE="HIDDEN" NAME="existingaction" VALUE="true"/> 
		<IF COND="Variables.showtitle!=false">
		<THEN>
			<table class="width-outer-70" cellspacing="0" cellpadding="0" border="0">
				<tr><td>
					<span class="title-text"><XLAT.STREAM KEY="dvin/UI/Admin/EditWorkflowEmail"/>: <STRING.STREAM VARIABLE="wfsubject:name"/></span>
				</td></tr>
				<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/TitleBar"/>
			</table>
		</THEN>
		</IF>   

    <table BORDER="0" CELLSPACING="0" CELLPADDING="0" class="width-outer-50">
	<tr><td>
		<table class="width-inner-100" cellpadding="0" cellspacing="0" border="0" bgcolor="#ffffff">
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
			<tr>
				<td class="form-label-text" NOWRAP="NOWRAP">
					<span class="alert-color">*</span><XLAT.STREAM KEY="dvin/Common/Name"/>:
				</td>
				<td class="form-inset">
						<STRING.ENCODE VARIABLE="wfsubject:name" VARNAME="wfsubject:name"/>
                  	   <INPUT TYPE="TEXT" SIZE="32" MAXLENGTH="40" NAME="name" VALUE="Variables.wfsubject:name" REPLACEALL="Variables.wfsubject:name"/>
				</td>
			</tr>
			<!--<tr>
				<td colspan="3" class="light-line-color"><img height="1" width="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>
			</tr>-->
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
			<tr>
				<td class="form-label-text">
					<span class="alert-color">*</span><XLAT.STREAM KEY="dvin/Common/Description"/>:
				</td>
				<td class="form-inset">
						<SETVAR NAME="OutputQString" VALUE="Variables.empty"/>
						<STRING.ENCODE VARIABLE="wfsubject:description" VARNAME="OutputQString"/>
						<INPUT TYPE="TEXT" SIZE="32" MAXLENGTH="40" NAME="description" VALUE="Variables.OutputQString" REPLACEALL="Variables.OutputQString"/>
				</td><td><BR /></td>
			</tr>
			<!--<tr>
				<td colspan="3" class="light-line-color"><img height="1" width="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>
			</tr>-->
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
			<tr>
				<td class="form-label-text">
					<span class="alert-color">*</span><XLAT.STREAM KEY="dvin/Common/Subject"/>:
				</td>
				<td class="form-inset">
						<SETVAR NAME="OutputQString" VALUE="Variables.empty"/>
						<STRING.ENCODE VARIABLE="wfsubject:subject" VARNAME="OutputQString"/>
						<INPUT TYPE="TEXT" SIZE="32" MAXLENGTH="60" NAME="subject" VALUE="Variables.OutputQString" REPLACEALL="Variables.OutputQString"/>
				</td><td><BR /></td>
			</tr>
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
			<tr>
				<td class="form-label-text">
					<span class="alert-color">*</span><XLAT.STREAM KEY="dvin/UI/Admin/Body"/>:
				</td>
				<td class="form-inset">
					<TEXTAREA NAME="body" ROWS="10" COLS="60" WRAP="VIRTUAL"><STRING.STREAM VARIABLE="wfsubject:body"/></TEXTAREA>
				</td><td><BR /></td>
			</tr>
			<!--<tr>
				<td colspan="3" class="light-line-color"><img height="1" width="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>
			</tr>-->			
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
			<tr>
				<td class="form-label-text">
					<XLAT.STREAM KEY="dvin/AT/Common/ID"/>:
				</td>
				<td class="form-inset">
						<INPUT TYPE="HIDDEN" NAME="id" VALUE="Variables.id" REPLACEALL="Variables.id"/>
						<STRING.STREAM VARIABLE="wfsubject:id"/>
				</td>
			</tr>
			<SETVAR NAME="action" VALUE="edit"/>

			<INPUT TYPE="HIDDEN" NAME="pagename" VALUE="OpenMarket/Xcelerate/Admin/WorkflowSubjectPost"/>                
			<INPUT TYPE="HIDDEN" NAME="action" VALUE="new"/>
			<SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Admin/WorkflowSubjectFront" outstring="WorkflowSubjectFrontURL">
				<satellite.argument name="cs_environment" value="Variables.cs_environment"/>
				<satellite.argument name="cs_formmode" value="Variables.cs_formmode"/>
				 <satellite.argument name="action" value="details"/>
				 <satellite.argument name="id" value="Variables.id"/> 
			 </SATELLITE.LINK>
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/FooterBar"/>
			<TR>
				<TD class="form-label-text"></TD><TD class="form-inset">
					<A HREF="Variables.WorkflowSubjectFrontURL" REPLACEALL="Variables.WorkflowSubjectFrontURL"><CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/Cancel"/></CALLELEMENT></A><XLAT.LOOKUP KEY="dvin/UI/SaveEmail" VARNAME="_XLAT_" ESCAPE="true"/>
					<A HREF="javascript:void(0);" onClick="if(checkfields()!=false){document.forms['AppForm'].submit();return false;}" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true;" REPLACEALL="Variables._XLAT_"><CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/Save"/></CALLELEMENT></A>
				</TD>
			</TR>
		</table>
	</td></tr>
</table>
   	</then>
    	</if>    

<IF COND="Variables.action=confirmdelete">
<THEN>
<table class="width-outer-70" cellspacing="0" cellpadding="0" border="0">
	<tr><td>
		<span class="title-text"><XLAT.STREAM KEY="dvin/UI/Admin/DeleteWorkflowEmail"/></span>
	</td></tr>
	<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/TitleBar"/>
</table>

	<EMAILMANAGER.LOAD OBJVARNAME="anemailobject" ID="Variables.id"/>

	<EMAIL.SCATTER PREFIX="wfsubject:" NAME="anemailobject"/>

  <!--
					
	  <setvar NAME="deletewarning" VALUE="DeleteWfSubjectWarning.txt"/>
	  <PROPERTY.GET PARAM="xcelerate.base" INIFILE="futuretense_xcel.ini" VARNAME="filepath"/>
    <setvar NAME="filepath" VALUE="Variables.filepath/Errors/Variables.deletewarning"/>
    <setvar NAME="errno" VALUE="0"/>
    <insert FILE="Variables.filepath" NAME="deletemessage"/>
    
   -->
<div class="width-outer-70">
    <XLAT.LOOKUP KEY="dvin/UI/Admin/DeleteWfSubjectWarning" ENCODE="false" VARNAME="deletemessage"/>
	<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/ShowMessage">
		<argument NAME="msgtext" VALUE="Variables.deletemessage"/>
		<argument NAME="severity" VALUE="warning"/>
	</callelement>							
</div>					
	<table BORDER="0" CELLSPACING="0" CELLPADDING="0" class="width-outer-50">
	<tr><td>
		<table class="width-inner-100" cellpadding="0" cellspacing="0" border="0" bgcolor="#ffffff">
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
			<tr>
				<td class="form-label-text">
					<XLAT.STREAM KEY="dvin/Common/Name"/>:
				</td>
				<td class="form-inset">
						<STRING.STREAM VARIABLE="wfsubject:name"/>
				</td>
			</tr>
			<!--<tr>
				<td colspan="3" class="light-line-color"><img height="1" width="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>
			</tr>-->
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
			<tr>
				<td class="form-label-text">
					<XLAT.STREAM KEY="dvin/Common/Description"/>:
				</td>
				<td class="form-inset">
						<STRING.STREAM VARIABLE="wfsubject:description"/>
				</td>
			</tr>
			<!--<tr>
				<td colspan="3" class="light-line-color"><img height="1" width="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>
			</tr>-->
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
			<tr>
				<td class="form-label-text">
					<XLAT.STREAM KEY="dvin/Common/Subject"/>:
				</td>
				<td class="form-inset">
						<STRING.STREAM VARIABLE="wfsubject:subject"/>
				</td>
			</tr>
			<!--<tr>
				<td colspan="3" class="light-line-color"><img height="1" width="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>
			</tr>-->
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
			<tr>
				<td class="form-label-text">
					<XLAT.STREAM KEY="dvin/UI/Admin/Body"/>:
				</td>
				<td class="form-inset">
						<STRING.STREAM VARIABLE="wfsubject:body"/>
				</td>
			</tr>
			<!--<tr>
				<td colspan="3" class="light-line-color"><img height="1" width="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>
			</tr>-->
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
			<tr>
				<td class="form-label-text">
					<XLAT.STREAM KEY="dvin/AT/Common/ID"/>:
				</td>
				<td class="form-inset">
						<INPUT TYPE="HIDDEN" NAME="id" VALUE="Variables.id" REPLACEALL="Variables.id"/>
						<STRING.STREAM VARIABLE="wfsubject:id"/>
				</td>
			</tr>
			<SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Admin/WorkflowSubjectFront" outstring="WorkflowSubjectFrontURL">
			<satellite.argument name="cs_environment" value="Variables.cs_environment"/>
			<satellite.argument name="cs_formmode" value="Variables.cs_formmode"/>
			 <satellite.argument name="action" value="details"/>
			 <satellite.argument name="id" value="Variables.id"/>
			  </SATELLITE.LINK>
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/FooterBar"/>
			<TR>
				<TD class="form-label-text"></TD><TD class="form-inset">
				<A HREF="Variables.WorkflowSubjectFrontURL" REPLACEALL="Variables.WorkflowSubjectFrontURL"><CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/Cancel"/></CALLELEMENT></A><XLAT.LOOKUP KEY="dvin/UI/DeletethisEmail" VARNAME="_XLAT_" ESCAPE="true"/>
				<A HREF="javascript:void(0);" onclick="document.forms['AppForm'].submit();return false;" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true;" REPLACEALL="Variables._XLAT_"><CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/DeleteEmail"/></CALLELEMENT></A>
				</TD>
			</TR>
		</table>
	</td></tr>
</table>


<INPUT TYPE="HIDDEN" NAME="pagename" VALUE="OpenMarket/Xcelerate/Admin/WorkflowSubjectPost"/>                
<INPUT TYPE="HIDDEN" NAME="action" VALUE="delete"/>

</THEN>
</IF>
    	</then>
    	</if>    


</FTCS> 
