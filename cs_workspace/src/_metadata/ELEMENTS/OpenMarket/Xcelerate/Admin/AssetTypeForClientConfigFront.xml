<?xml version="1.0" ?>
<!DOCTYPE FTCS SYSTEM "futuretense_cs.dtd">

<FTCS Version="1.1">
<!--
$Logfile: /VerticalApps/XcelerateD/install/Xcelerate/Populate/ElementCatalog/OpenMarket/Xcelerate/Admin/AssetTypeForClientConfigFront.xml $

-->

<!--
- Confidential and Proprietary Information of Open Market, Inc.
-					All Rights Reserved.
-
- DESCRIPTION
-	Admin control of specifying attributes of an external client for each of
-     of the columns for a given asset type, subtype, pubid and clientapplication.
-     Known Attributes for MSWord:  
-     	name:  enable  ; values:  true,false
-		name:  preserveformat  ; values:  true,false
-
- INPUT
-   action   - list,edit  when pagetype is front, empty when pagetype is post
-   pagetype - front,post
-   clientid - id of the row in externalclients table 
-               (assettypeid,clientapp,pubid combination)
-   subtype -   asset subtype
-->


<!-- type is either front or post -->

	<!-- 
	Load the externalclients entry corresponding to clientid.
	Get the list of assettype columns & attributes values from 
	externalclients config table
	-->
	<STRING.ENCODE VARIABLE="cs_environment" VARNAME="cs_environment"/>
<STRING.ENCODE VARIABLE="cs_imagedir" VARNAME="cs_imagedir"/>
<STRING.ENCODE VARIABLE="cs_formmode" VARNAME="cs_formmode"/>
<STRING.ENCODE VARIABLE="clientid" VARNAME="clientid"/>
	<EXTERNALCLIENTSMANAGER.LOADID OBJVARNAME="aClient" ID="Variables.clientid"/>
	<EXTERNALCLIENTSITEM.GETASSETTYPE NAME="aClient" VARNAME="aType" />
	<EXTERNALCLIENTSITEM.GETCLIENTAPP  NAME="aClient" VARNAME="clientapp" />
	<EXTERNALCLIENTSITEM.GETPUBID  NAME="aClient" VARNAME="pubid" />

	<if COND="IsVariable.subtype=false">
	<then>
		<SETVAR NAME="subtype" VALUE="Variables.empty"/>
	</then>
	</if>
	
	<ASSETTYPE.LOAD NAME="at" FIELD="assettype" VALUE="Variables.aType"/>
	<if COND="IsError.Variables.errno=true">
	<then>
		<setvar NAME="assettype" VALUE="Variables.aType"/>
			<XLAT.STREAM KEY="dvin/UI/Admin/NoDataavailableforassettype"/>
		<THROWEXCEPTION/>
	</then>
	</if>
	<ASSETTYPE.GET NAME="at" FIELD="description" OUTPUT="at:description"/>

	<!-- get a list of attributes for this asset subtype  -->
	<ASSET.DEF TYPE="Variables.aType" LIST="aTypeDef" SUBTYPE="Variables.subtype" PUBID="Variables.pubid"/>
	<STRING.ENCODE VARIABLE="subtype" VARNAME="subtype"/>
	<IF COND="IsList.aTypeDef=false">
	<THEN>
		<XLAT.STREAM KEY="dvin/UI/Admin/NoDataavailable"/>
		<THROWEXCEPTION/>
	</THEN>
	</IF>
      <!-- check if it has got any config. data already, if not add default data -->
	<EXTERNALCLIENTSCONFIGMANAGER.GETITEMLIST LISTVARNAME="verifyList" CLIENTID="Variables.clientid" SUBTYPE="Variables.subtype" />
	<IF COND="IsList.verifyList=true">
	<THEN>
		<IF COND="verifyList.#numRows=0">
		<THEN>
			<SETVAR NAME="names" VALUE="enable,preserveformat"/>
			<STRINGLIST NAME="nameList" STR="Variables.names" DELIM=","/>
			<LOOP  LIST="aTypeDef" >
				<IF COND="aTypeDef.editable=true" >
				<THEN>
					<LOOP LIST="nameList">
						<SETVAR NAME="attribVal" VALUE="false"/>
						<IF COND="aTypeDef.required=true">
						<THEN>
							<IF COND="nameList.ITEM=enable">
							<THEN>
								<SETVAR NAME="attribVal" VALUE="true"/>
							</THEN>
							</IF>
						</THEN>
						</IF>
						<EXTERNALCLIENTSCONFIGMANAGER.CREATE OBJVARNAME="aRec" />
						<EXTERNALCLIENTSCONFIGITEM.SETCLIENTID NAME="aRec" VALUE="Variables.clientid"/>
						<EXTERNALCLIENTSCONFIGITEM.SETSUBTYPE NAME="aRec" VALUE="Variables.subtype"/>
						<EXTERNALCLIENTSCONFIGITEM.SETACTION NAME="aRec" VALUE="nameList.ITEM"/>
						<EXTERNALCLIENTSCONFIGITEM.SETVALUE NAME="aRec" VALUE="Variables.attribVal"/>
						<EXTERNALCLIENTSCONFIGITEM.SETPROPERTY NAME="aRec" VALUE="aTypeDef.name"/>
						<EXTERNALCLIENTSCONFIGMANAGER.SAVE OBJECT="aRec"/>
					</LOOP>
				</THEN>
				</IF>
			</LOOP>
		<!-- call this element again to redisplay the new status -->
			<CALLELEMENT NAME="OpenMarket/Xcelerate/Admin/AssetTypeForClientConfigFront">
				<ARGUMENT NAME="action" VALUE="list"/>
				<ARGUMENT NAME="clientid" VALUE="Variables.clientid"/>
				<!--<ARGUMENT NAME="subtype" VALUE="Variables.subtype"/>-->
			</CALLELEMENT>   
			<THROWEXCEPTION/>
		</THEN>
		</IF>
	</THEN>
	</IF>

	<IF COND="Variables.action=list">
	<THEN>		
		<IF COND="Variables.subtype=Variables.empty">
		<THEN>
			<XLAT.LOOKUP KEY="dvin/UI/Util/Standardnosubtype" VARNAME="stdescription"/>
		</THEN>
		<ELSE>
			<SETVAR NAME="stdescription" VALUE="Variables.subtype"/>
		</ELSE>
		</IF>
		
		<table class="width-outer-70" cellspacing="0" cellpadding="0" border="0">
			<tr><td>
				<span class="title-text"><XLAT.STREAM KEY="dvin/UI/Admin/ConfigassettypeaTypesubtypeCSDesktop" aType="Variables.at:description" subtype="Variables.stdescription" EVALALL="false"/></span>
			</td></tr>
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/TitleBar"/>
		</table>
		<XLAT.LOOKUP KEY="dvin/Common/Edit" VARNAME="_XLAT_" ESCAPE="true"/>
		<XLAT.LOOKUP KEY="dvin/Common/Edit" VARNAME="_alt_"/>
        <SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Admin/AssetTypeClientConfigFront" outstring="urlasttpclconffront">
            <satellite.argument name="cs_environment" value="Variables.cs_environment"/>
            <satellite.argument name="cs_formmode" value="Variables.cs_formmode"/>
                                             <satellite.argument name="subtype" value="Variables.subtype"/>
                                             <satellite.argument name="action" value="edit"/>
                                             <satellite.argument name="clientid" value="Variables.clientid"/>
                                              </SATELLITE.LINK>
<XLAT.LOOKUP KEY="dvin/UI/Admin/Enabled" VARNAME="_isEnabled_"/>
			<table class="width-outer-70" BORDER="0" CELLSPACING="0" CELLPADDING="0">
				<tr>
					<td></td><td class="tile-dark" HEIGHT="1"><IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td><td></td>
				</tr>
				<tr>
					<td class="tile-dark" VALIGN="top" WIDTH="1"><IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>
					<td >
						<table width="100%" cellpadding="0" cellspacing="0" border="0" bgcolor="#ffffff"><tr><td colspan="10" class="tile-highlight"><IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td></tr>
							<tr><td class="tile-a" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;</td>
					            <td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;</td><td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir"><DIV class="new-table-title"><XLAT.STREAM KEY="dvin/UI/Admin/Fieldname"/></DIV></td>
					            <td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;&nbsp;&nbsp;&nbsp;</td><td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir"><DIV class="new-table-title"><XLAT.STREAM KEY="dvin/AT/Common/Description"/></DIV></td>
					            <td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;&nbsp;&nbsp;&nbsp;</td><td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir"><DIV class="new-table-title"><XLAT.STREAM KEY="dvin/Common/EnableQ"/></DIV></td>
					            <td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;&nbsp;&nbsp;&nbsp;</td><td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir"><DIV class="new-table-title"><XLAT.STREAM KEY="dvin/UI/Admin/PreserveformattingQ"/></DIV></td>
								<td class="tile-c" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;</td>
							</tr>
							<tr><td colspan="10" class="tile-dark"><IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td></tr>
							<!-- Loop over all search results. -->
					   			<setvar NAME="rowStyle" VALUE="tile-row-normal"/>
								<SETVAR NAME="separatorLine" VALUE="0"/>
								<SETROW LIST="aTypeDef" ACTION="FIRST"/>

							<LOOP  LIST="aTypeDef" >
								
								<!--This is to hide the display of Relationships field -->
								<IF COND="aTypeDef.name=Relationships">
								  <THEN>
									 <SETROW LIST="aTypeDef" ACTION="NEXT"/>
								  </THEN>
								</IF>

								<!--This is to hide the display of Dimension-parent field -->
								<IF COND="aTypeDef.name=Dimension-parent">
								  <THEN>
									 <SETROW LIST="aTypeDef" ACTION="NEXT"/>
								  </THEN>
								</IF>

								<IF COND="aTypeDef.editable=true" >
								<THEN>
									<EXTERNALCLIENTSCONFIGMANAGER.GETITEMLIST LISTVARNAME="cList" CLIENTID="Variables.clientid" SUBTYPE="Variables.subtype" PROPERTY="aTypeDef.name" />
									<REMOVEVAR NAME="enable"/>
									<REMOVEVAR NAME="preserveformat"/>
									<LOOP LIST="cList">
										<SETVAR NAME="cList.action" VALUE="cList.value"/>			
									</LOOP>
								
									<IF COND="Variables.separatorLine=1">
									<THEN>
										<tr>
											<!--<td colspan="10" class="light-line-color"><img height="1" width="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>-->
										</tr>
									</THEN>
									</IF>
									<SETVAR NAME="separatorLine" VALUE="1"/>
									<tr class="Variables.rowStyle"  REPLACEALL="Variables.rowStyle"><td><BR /></td>
					                <td><BR /></td><td VALIGN="TOP" NOWRAP="NOWRAP" ALIGN="LEFT">
					                    <DIV class="small-text-inset">
											<STRING.STREAM VALUE="aTypeDef.name"/>  
										</DIV>
									</td>
									<td><BR /></td><td VALIGN="TOP" ALIGN="LEFT">
					                    <DIV class="small-text-inset">
											<STRING.STREAM VALUE="aTypeDef.description"/><BR />
					                    </DIV>
					                 </td>
					                 <td><BR /></td>
					                 <td ALIGN="CENTER">
					                 <DIV class="small-text-inset">
										<IF COND="IsVariable.enable=true">
										<THEN>
											<IF COND="Variables.enable=true">
											<THEN>
												<IMG src="Variables.cs_imagedir/graphics/common/icon/check.gif" ALT="Variables._isEnabled_" REPLACEALL="Variables.cs_imagedir,Variables._isEnabled_"/>
											</THEN>
											<ELSE>
												-
											</ELSE>
											</IF>
										</THEN>
										<ELSE>
											<!-- add default config data since this is newly added field, which could be the case with flex asset types -->
											<IF COND="aTypeDef.required=true">
											<THEN>
												<SETVAR NAME="enable" VALUE="true"/>
											</THEN>
											<ELSE>
												<SETVAR NAME="enable" VALUE="false"/>
											</ELSE>
											</IF>
											<EXTERNALCLIENTSCONFIGMANAGER.CREATE OBJVARNAME="aRec" />
											<EXTERNALCLIENTSCONFIGITEM.SETCLIENTID NAME="aRec" VALUE="Variables.clientid"/>
											<EXTERNALCLIENTSCONFIGITEM.SETSUBTYPE NAME="aRec" VALUE="Variables.subtype"/>
											<EXTERNALCLIENTSCONFIGITEM.SETACTION NAME="aRec" VALUE="enable"/>
											<EXTERNALCLIENTSCONFIGITEM.SETVALUE NAME="aRec" VALUE="Variables.enable"/>
											<EXTERNALCLIENTSCONFIGITEM.SETPROPERTY NAME="aRec" VALUE="aTypeDef.name"/>
											<EXTERNALCLIENTSCONFIGMANAGER.SAVE OBJECT="aRec"/>

											<STRING.STREAM VALUE="Variables.enable" />
										</ELSE>
										</IF>

				                 	</DIV>
			                 	</td>
			                 	<td><BR /></td>
			                 	<td ALIGN="CENTER">
				                 	<DIV class="small-text-inset">
				<IF COND="IsVariable.preserveformat=true">
				<THEN>
					<IF COND="Variables.preserveformat=true">
					<THEN>
						<IMG src="Variables.cs_imagedir/graphics/common/icon/check.gif" REPLACEALL="Variables.cs_imagedir"/>
					</THEN>
					<ELSE>
						-
					</ELSE>
					</IF>
				</THEN>
				<ELSE>
					<EXTERNALCLIENTSCONFIGMANAGER.CREATE OBJVARNAME="aRec" />
					<EXTERNALCLIENTSCONFIGITEM.SETCLIENTID NAME="aRec" VALUE="Variables.clientid"/>
					<EXTERNALCLIENTSCONFIGITEM.SETSUBTYPE NAME="aRec" VALUE="Variables.subtype"/>
					<EXTERNALCLIENTSCONFIGITEM.SETACTION NAME="aRec" VALUE="preserveformat"/>
					<EXTERNALCLIENTSCONFIGITEM.SETVALUE NAME="aRec" VALUE="false"/>
					<EXTERNALCLIENTSCONFIGITEM.SETPROPERTY NAME="aRec" VALUE="aTypeDef.name"/>
					<EXTERNALCLIENTSCONFIGMANAGER.SAVE OBJECT="aRec"/>

					<XLAT.STREAM KEY="dvin/Common/lcfalse"/>	
				</ELSE>
				</IF>
				                 	</DIV>
			                 	</td>
			                 	<td><BR /></td>
			                 	</tr>
								<IF COND="Variables.rowStyle=tile-row-normal">
					            <THEN><SETVAR NAME="rowStyle" VALUE="tile-row-highlight"/>
					            </THEN>
					            <ELSE><SETVAR NAME="rowStyle" VALUE="tile-row-normal"/>
					            </ELSE>
					            </IF>
	</THEN>
		</IF>
							</LOOP>
							</table>
						</td>
						<td class="tile-dark" VALIGN="top" WIDTH="1"><IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>
						</tr>
					<tr>
					<td colspan="3" class="tile-dark" VALIGN="TOP" HEIGHT="1"><IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>
					</tr>
					<tr>
					<td></td><td background="Variables.cs_imagedir/graphics/common/screen/shadow.gif" REPLACEALL="Variables.cs_imagedir"><IMG WIDTH="1" HEIGHT="5" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td><td></td>
					</tr>
			</table> 
			<table class="width-outer-70" BORDER="0" CELLSPACING="0" CELLPADDING="0">
				<tr><td>
					<A HREF="Variables.urlasttpclconffront" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true" REPLACEALL="Variables.urlasttpclconffront,Variables._XLAT_"><CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/EditConfiguration"/></CALLELEMENT></A></td>
				</tr>
			</table>

     <SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Admin/AssetTypeClientFront" outstring="urlasttpclfront">
         <satellite.argument name="cs_environment" value="Variables.cs_environment"/>
         <satellite.argument name="cs_formmode" value="Variables.cs_formmode"/>
                                             <satellite.argument name="pubid" value="Variables.pubid"/>
                                             <satellite.argument name="action" value="list"/>
                                             <satellite.argument name="clientapp" value="MSWord"/>
                                              </SATELLITE.LINK>
<A HREF="Variables.urlasttpclfront" REPLACEALL="Variables.urlasttpclfront"><IMG src="Variables.cs_imagedir/graphics/common/icon/doubleArrow.gif" WIDTH="15" HEIGHT="12" BORDER="0" REPLACEALL="Variables.cs_imagedir"/><XLAT.STREAM KEY="dvin/UI/Admin/ListCSDesktopforthissite"/></A>
	<INPUT TYPE="HIDDEN" NAME="pagename" VALUE="OpenMarket/Xcelerate/Admin/AssetTypeClientConfigFront"/>
	<INPUT TYPE="HIDDEN" NAME="action" VALUE="edit" />
	<INPUT TYPE="HIDDEN" NAME="clientid" VALUE="Variables.clientid" REPLACEALL="Variables.clientid"/>
	<INPUT TYPE="HIDDEN" NAME="subtype" VALUE="Variables.subtype" REPLACEALL="Variables.subtype"/>


	</THEN>
	<ELSE>   <!--  edit screen -->
		<IF COND="Variables.action=edit">
		<THEN>
		<IF COND="Variables.subtype=Variables.empty">
		<THEN>
			<XLAT.LOOKUP KEY="dvin/UI/Util/Standardnosubtype" VARNAME="stdescription"/>
		</THEN>
		<ELSE>
			<SETVAR NAME="stdescription" VALUE="Variables.subtype"/>
		</ELSE>
		</IF>

			<table class="width-outer-70" cellspacing="0" cellpadding="0" border="0">
				<tr><td>
					<span class="title-text"><XLAT.STREAM KEY="dvin/UI/Admin/EditConfigassettypeaTypesubtypeCSDesktop" aType="Variables.at:description" subtype="Variables.stdescription" EVALALL="false"/></span>
				</td></tr>
				<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/TitleBar"/>
			</table>
		
			<table class="width-outer-70" BORDER="0" CELLSPACING="0" CELLPADDING="0" >
				<tr>
					<td></td><td class="tile-dark" HEIGHT="1"><IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td><td></td>
				</tr>
				<tr>
					<td class="tile-dark" VALIGN="top" WIDTH="1"><IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>
					<td >
						<table width="100%" cellpadding="0" cellspacing="0" border="0" bgcolor="#ffffff"><tr><td colspan="10" class="tile-highlight"><IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td></tr>
							<tr><td class="tile-a" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;</td>
					            <td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;</td><td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir"><DIV class="new-table-title"><XLAT.STREAM KEY="dvin/UI/Admin/Fieldname"/></DIV></td>
					            <td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;&nbsp;&nbsp;&nbsp;</td><td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir"><DIV class="new-table-title"><XLAT.STREAM KEY="dvin/AT/Common/Description"/></DIV></td>
					            <td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;&nbsp;&nbsp;&nbsp;</td><td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir"><DIV class="new-table-title"><XLAT.STREAM KEY="dvin/Common/EnableQ"/></DIV></td>
					            <td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;&nbsp;&nbsp;&nbsp;</td><td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir"><DIV class="new-table-title"><XLAT.STREAM KEY="dvin/UI/Admin/PreserveformattingQ"/></DIV></td>
								<td class="tile-c" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;</td>
							</tr>
							<tr><td colspan="10" class="tile-dark"><IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td></tr>
							<!-- Loop over all search results. -->
					   			<setvar NAME="rowStyle" VALUE="tile-row-normal"/>
								<SETVAR NAME="separatorLine" VALUE="0"/>
		<SETVAR NAME="rowList" VALUE="Variables.empty" />
		<SETVAR NAME="firstRow" VALUE="true"/>	
		<LOOP  LIST="aTypeDef" >
			
			<!--This is to hide the display of Relationships field -->
			<IF COND="aTypeDef.name=Relationships">
			  <THEN>
				 <SETROW LIST="aTypeDef" ACTION="NEXT"/>
			  </THEN>
			</IF>

			<!--This is to hide the display of Dimension-parent field pmk-->
			<IF COND="aTypeDef.name=Dimension-parent">
			  <THEN>
				 <SETROW LIST="aTypeDef" ACTION="NEXT"/>
			  </THEN>
			</IF>
			<IF COND="aTypeDef.editable=true">
			<THEN>
				<IF COND="Variables.firstRow=true">
				<THEN>
					<SETVAR NAME="firstRow" VALUE="false"/>
					<SETVAR NAME="rowList" VALUE="aTypeDef.name"/>						
				</THEN>
				<ELSE>
					<SETVAR NAME="rowList" VALUE="Variables.rowList,aTypeDef.name"/>				
				</ELSE>
				</IF>
				<EXTERNALCLIENTSCONFIGMANAGER.GETITEMLIST LISTVARNAME="cList" CLIENTID="Variables.clientid" SUBTYPE="Variables.subtype" PROPERTY="aTypeDef.name" />
				<REMOVEVAR NAME="enable"/>
				<REMOVEVAR NAME="preserveformat"/>
				<LOOP LIST="cList">
					<SETVAR NAME="cList.action" VALUE="cList.value"/>
				</LOOP>

								
									<IF COND="Variables.separatorLine=1">
									<THEN>
										<tr>
											<!--<td colspan="10" class="light-line-color"><img height="1" width="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>-->
										</tr>
									</THEN>
									</IF>
									<SETVAR NAME="separatorLine" VALUE="1"/>
									<tr class="Variables.rowStyle"  REPLACEALL="Variables.rowStyle"><td><BR /></td>
					                <td><BR /></td><td VALIGN="TOP" NOWRAP="NOWRAP" ALIGN="LEFT">
					                    <DIV class="small-text-inset">
											<STRING.STREAM VALUE="aTypeDef.name"/>  
										</DIV>
									</td>
									<td><BR /></td><td VALIGN="TOP" ALIGN="LEFT">
					                    <DIV class="small-text-inset">
											<STRING.STREAM VALUE="aTypeDef.description"/><BR />
					                    </DIV>
					                 </td>
					                 <td><BR /></td>
					                 <td ALIGN="CENTER">
					                 <DIV >
				<IF COND="aTypeDef.required=true">
				<THEN>
					<INPUT TYPE="HIDDEN" NAME="aTypeDef.name-enable" VALUE="true" REPLACEALL="aTypeDef.name"/><span class="alert-color"><XLAT.STREAM KEY="dvin/Common/Required"/></span>
				</THEN>
				<ELSE>
					<IF COND="IsVariable.enable=true">
					<THEN>
						<IF COND="Variables.enable=true">
						<THEN>
							<INPUT TYPE="checkbox" NAME="aTypeDef.name-enable" VALUE="true" CHECKED="true" REPLACEALL="aTypeDef.name"  />
						</THEN>
						<ELSE>
							<INPUT TYPE="checkbox" NAME="aTypeDef.name-enable" VALUE="true" REPLACEALL="aTypeDef.name"  />
						</ELSE>
						</IF>							
					</THEN>
					<ELSE>
						<INPUT TYPE="checkbox" NAME="aTypeDef.name-enable" VALUE="true" REPLACEALL="aTypeDef.name"  />
					</ELSE>
					</IF>
				</ELSE>
				</IF>

				                 	</DIV>
			                 	</td>
			                 	<td><BR /></td>
			                 	<td ALIGN="CENTER">
				                 	<DIV >
				<IF COND="aTypeDef.formattable=true" >
				<THEN>
                    <IF COND="IsVariable.preserveformat=true">
    				<THEN>
    					<IF COND="Variables.preserveformat=true">
    					<THEN>
    						<INPUT TYPE="checkbox" NAME="aTypeDef.name-preserveformat" VALUE="true" CHECKED="true" REPLACEALL="aTypeDef.name"  />
    					</THEN>
    					<ELSE>
    						<INPUT TYPE="checkbox" NAME="aTypeDef.name-preserveformat" VALUE="true" REPLACEALL="aTypeDef.name"  />
    					</ELSE>
    					</IF>		
    				</THEN>
    				<ELSE>
    					<INPUT TYPE="checkbox" NAME="aTypeDef.name-preserveformat" VALUE="true" REPLACEALL="aTypeDef.name"  />
    				</ELSE>
    				</IF>
                </THEN>
                </IF>
								
				                 	</DIV>
			                 	</td>
			                 	<td><BR /></td>
			                 	</tr>
								<IF COND="Variables.rowStyle=tile-row-normal">
					            <THEN><SETVAR NAME="rowStyle" VALUE="tile-row-highlight"/>
					            </THEN>
					            <ELSE><SETVAR NAME="rowStyle" VALUE="tile-row-normal"/>
					            </ELSE>
					            </IF>
	</THEN>
		</IF>
							</LOOP>
							</table>
						</td>
						<td class="tile-dark" VALIGN="top" WIDTH="1"><IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>
						</tr>
					<tr>
					<td colspan="3" class="tile-dark" VALIGN="TOP" HEIGHT="1"><IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>
					</tr>
					<tr>
					<td></td><td background="Variables.cs_imagedir/graphics/common/screen/shadow.gif" REPLACEALL="Variables.cs_imagedir"><IMG WIDTH="1" HEIGHT="5" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td><td></td>
					</tr>
					</table> 

    <SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Admin/AssetTypeClientConfigFront" outstring="CSDesktopURL">
        <satellite.argument name="cs_environment" value="Variables.cs_environment"/>
        <satellite.argument name="cs_formmode" value="Variables.cs_formmode"/>
                                             <satellite.argument name="subtype" value="Variables.subtype"/>
                                             <satellite.argument name="action" value="list"/>
                                             <satellite.argument name="clientid" value="Variables.clientid"/>
                                              </SATELLITE.LINK>
<XLAT.LOOKUP KEY="dvin/UI/Cancel" VARNAME="_XLAT_" ESCAPE="true"/>
<XLAT.LOOKUP KEY="dvin/UI/Cancel" VARNAME="_alt_"/>
<div class="width-outer-70">
	<A HREF="Variables.CSDesktopURL" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true;" REPLACEALL="Variables.CSDesktopURL,Variables._XLAT_"><CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/Cancel"/></CALLELEMENT></A>
	<XLAT.LOOKUP KEY="dvin/UI/Save" VARNAME="_XLAT_" ESCAPE="true"/>
	<XLAT.LOOKUP KEY="dvin/UI/Save" VARNAME="_alt_"/>
	<A HREF="javascript:void(0);" onclick="document.forms['AppForm'].submit(); return false;" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true;" REPLACEALL="Variables._XLAT_"><CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/Save"/></CALLELEMENT></A>
</div>
		<SCRIPT LANGUAGE="JavaScript">
		<![CDATA[
		function CheckAll (val) {
			var x =  document.forms[0].elements['rowList'].value;
			var rowArray = x.split(",");
			var y = document.forms[0].elements['columnList'].value;
			var colArray = y.split(",");
			var i=0, j=0;
			var name;
			for (i=0; i < rowArray.length; i++) {
				for(j=0; j<colArray.length; j++) {
					name=rowArray[i];
					name +="-";
					name+=colArray[j];
					document.forms[0].elements[name].checked = val;
				}
			}
		}
		]]>
		</SCRIPT>

		<INPUT TYPE="HIDDEN" NAME="pagename" VALUE="OpenMarket/Xcelerate/Admin/AssetTypeClientConfigPost"/>
		<STRING.ENCODE VARIABLE="aType" VARNAME="aType"/>
		<INPUT TYPE="HIDDEN" NAME="assettype" VALUE="Variables.aType" REPLACEALL="Variables.aType"/>
		<INPUT TYPE="HIDDEN" NAME="clientapp" VALUE="Variables.clientapp" REPLACEALL="Variables.clientapp"/>
		<INPUT TYPE="HIDDEN" NAME="subtype" VALUE="Variables.subtype" REPLACEALL="Variables.subtype"/>
		<INPUT TYPE="HIDDEN" NAME="clientid" VALUE="Variables.clientid" REPLACEALL="Variables.clientid"/>		
		<INPUT TYPE="HIDDEN" NAME="columnList" VALUE="enable,preserveformat"/>
		<STRING.ENCODE VARIABLE="rowList" VARNAME="rowList"/>
		<INPUT TYPE="HIDDEN" NAME="rowList" VALUE="Variables.rowList" REPLACEALL="Variables.rowList"/>
	

		</THEN>
		</IF>
	</ELSE>
	</IF>

</FTCS>
