<?xml version="1.0" ?>
<!DOCTYPE FTCS SYSTEM "futuretense_cs.dtd">
<FTCS Version="1.1">

<!-- OpenMarket/Xcelerate/Admin/StartMenuFront
   
    INPUT
   
    OUTPUT
    This template is being reused for CS7/Alloy UI for StartMenu details

 HISTORY
 [2007-09-1x KGF]
 * XSS fixes (adapted from 6.3 fixes):
   * isCleanString function usage
   * CSVAR NAME -> STRING.STREAM VALUE
 * changed definitions of 'obj' to just forms[0] (not .elements[0])
 [2007-10-09 KGF]
 * XSS revision: minimized set of restricted characters.
 [2008-02-25 KGF]
 * Further XSS fix: encode html special chars in description field
 *
 * Modified: Feb 22, 2011
 * By:       JAG
 * Reason:   Added Enhancement functionality which includes the following
 *           1)  User can configure via startmenu the UI From Mode or
                 Insite Layout Editing
             2)  Can assign Default Group/Parents based on selected Flex Definition
                 for both Single Value(SV) and Multi Value(MV) Parents
             3)  Can assign Default Associated/Customized Attributes based on
                 selected Flex Definition for both SingleValue(SV) and MultiValue(MV)
             5)  Provide the ability to assign MultiValue(MV) default values for all
                 supported datatypes
 *
 * Modified: March 22, 2011
 * By:       JAG
 * Reason:   Added Enhancement functionality which includes the following
 *           1) Support for SingleValue {SV} Named Asset Child Associations
             2) Support for MultiValue  {MV} Named Asset Child Associations

 * Modified:  April 27, 2011
 * By:        JAG
 * Reason:    Added Smart Processing and support for FLEX BASE Family Processing
              Example of FLEX LITE  is ExtensiblePage  has FLEX Definition with
              NO Parents/Groups

 * Modified:  May 10, 2011
 * By:        JAG
 * Reason:    Enhancement Added the Grouping and Section Attribute Type Heading(s) into both
              Default Value ALL Attributes ( Attributes Flex Defined, Parents, Associations and Meta Attributes )
              Pulldown and its associated assigned Values Pulldown. All attributes are displayed with the
              special prefix removed and just the "Name" post fixed with (S) or (M) for MultiValue / SingleValue.
              Improved the in ADD / REMOVE attribute functinality with respect to Grouped sections.
              Fixed PR#25711 Adv ui StartMenu - Add Another value button is not working for multiple
              valued and multiple ordered attribute t
              types if used in extensible page
              Fixed PR#25711  Adv UI - Cannot save attribute values in a
              custom extensivble page asset with attributes of all
              types, single, multiple, and multiple ordered
  
 * Modified: Dec 07,2011
 * By:       JAG
 * Reason:   CS80 PR#25701  Advanced ui start menu default values for attributes of 
             type asset reference  custom defined ${Attibute_name} do not show 
			 up when creating assets with that startmenu 
             Default value in the start menu edit screen is not correct. 
			 Shows ${AssetType} as in Media_C twice !    
			 
 * Modified: Dec 07,2011
 * By:       JAG
 * Reason:   CS80 PR#25718  CS Adv UI - start menu default values for 
             type assets, parents, and associations has extra Add button
    
-->
<CALLELEMENT NAME="OpenMarket/Xcelerate/Scripts/ValidateInputForXSS" />
   <SCRIPT LANGUAGE="JavaScript">
      <![CDATA[


function DecodeUTF8(encoded)
{
   var i=0;
   var currentUnicode=0;
   var UnicodeString = new Array();
   var UnicodeIndex = 0;

   var currentState = "Start";

   for (i = 0; i<encoded.length;i+=2) {
       var twochars = encoded.substr(i,2);
       var currentByte = parseInt(twochars,16);

       // utf-8 representation may have up to 4 bytes per character
       if (currentState=="Start") {
           if ((currentByte & 0x80) != 0) {
               // if 1st 3 bits are 110 then 2 bytes
               if ((currentByte>>5) == 0x06) {
                   // 2 bytes - want 3 bits after 0xC0 as low 3 bits in first unicode byte
                   currentUnicode = (currentByte & 0x1C)>>2;

                   // 2 remaining bits of byte 1 become low bits of currentUnicode
                   currentUnicode = currentUnicode << 2;
                   currentUnicode = currentUnicode | (currentByte & 0x03);
                   currentState = "Done";
               }
               // if first 4 bits are 1110 then 3 bytes
               else if ((currentByte>>4) == 0x0E) {
                       currentUnicode = (currentByte & 0x0F);
                       currentState = "Middle1";
               }
               // if first 5 bits are 11110 then 4 bytes
               else if ((currentByte>>3) == 0x1E) {
                       currentUnicode = (currentByte & 0x07);
                       currentState = "Middle2";
               }
           }
           else
           {
               UnicodeString[UnicodeIndex] = currentByte;
               UnicodeIndex++;
           }
       }
       else if (currentState=="Done") {
           currentUnicode = currentUnicode << 6;
           currentUnicode = currentUnicode | (currentByte & 0x3F);
           UnicodeString[UnicodeIndex] = currentUnicode;
           UnicodeIndex++;
           currentState = "Start";
       }
       else if (currentState=="Middle1") {
           currentUnicode = currentUnicode << 6;
           currentUnicode = currentUnicode | (currentByte & 0x3F);
           currentState = "Done";
       }
       else if (currentState=="Middle2") {
           currentUnicode = currentUnicode << 6;
           currentUnicode = currentUnicode | (currentByte & 0x3F);
           UnicodeString[UnicodeIndex] = currentUnicode;
           UnicodeIndex++;
           currentState = "Middle1";
       }

   }
   var StringCode = "String.fromCharCode(";
   StringCode += UnicodeString[0];
   for (var y = 1; y < UnicodeIndex; y++) {
       StringCode+=","+UnicodeString[y];
   }
   StringCode += ");";

   return(eval(StringCode));
 }
 

// Selects a Set of selected Assets from Tree 
function SelectAssetFromTree() {

	var id,name,type, subtype, selValue={};
	var EncodedString = parent.frames["XcelTree"].document.TreeApplet.exportSelections()+'';
	var idArray = EncodedString.split(',');
	var assetcheck = unescape(idArray[0]);	
					
	if (assetcheck.indexOf('assettype=')!=-1 && assetcheck.indexOf('id=')!=-1)
	{
		var test = new String(EncodedString);
		var allNodes = test.split(":");
		if (allNodes.length==1)
		{
			]]>
	      	alert("<XLAT.STREAM KEY="dvin/UI/Error/Nonodesareselectedinthetree" ENCODE="false" ESCAPE="true"/>");
	      	<![CDATA[
			return;
		}
		var currentNode = 0;
		for (currentNode = 0;currentNode<allNodes.length-1;currentNode++)
		{
							var nameVal = allNodes[currentNode].split(",");					
							var i = 0;
							for (i=0;i<nameVal.length;i+=2)
							{
								id = unescape(nameVal[i]);
								var splitid = id.split(',');
								if (splitid.length==1)
								{
									var xlatstr='<xlat:stream key="dvin/UI/Error/Nodeidisnotavalidselection" encode="false" escape="true"/>';
									var replacestr=/Variables.id/;
									xlatstr = xlatstr.replace(replacestr,id);
									alert(xlatstr);
									return;
								}
									
								var splitpair = splitid[1].split("=");
								
								id = (splitid[0].split('='))[1];
								type = (splitid[1].split('='))[1];
								subtype = (splitid[3].split('='))[1];
								name = (splitid[2].split('='))[1];
								name = name.replace(/\+/g," ");
								subtype = subtype.replace(/\+/g," ");
								type = type.replace(/\+/g," ");	
							}			

							selValue = {
								'id':        id,
								'name':      name,
								'subtype':   subtype,
								'type':      type, 
								'assettype': type
							};
							return selValue ; 
		}
	}
}



  // Parses Asset From Tree
  // Return a Selected OPTION Default Values Object
  function pickRefAssetFromTree(attrname)
  {
  
     var obj = document.forms[0];
	 var id,name;
	 var EncodedString = parent.frames["XcelTree"].document.TreeApplet.exportSelections()+'';
     var idArray = EncodedString.split(',');
     var assetcheck = unescape(idArray[0]);
     var assetName = idArray[1] ;
 
     var asset = SelectAssetFromTree() ; 
    
     console.debug('SM.pickRefAssetFromTree asset object',   asset ) ; 
     
     if (assetcheck.indexOf('assettype=')!=-1 && assetcheck.indexOf('id=')!=-1)
     {
        // The asset object 
        var assetId = asset.type+":"+asset.id   ; 
        
        // Create the selection OPTION asset object
        var optionasset = {
				assettype:     asset.type,
				id:            asset.id,
				name:          asset.name,
                displayItem :  attrname+"="+asset.name,
                valueItem   :  attrname+"="+assetId

			} ;
		   
		console.debug('pickRefAssetFromTree  return asset ',  optionasset ) ; 
  
   		return  optionasset   ;

      }
      else
      {
      ]]>
      alert("<XLAT.STREAM KEY="dvin/UI/PleaseSelectAssetFromTree" ENCODE="false" ESCAPE="true"/>");
      <![CDATA[
      }
  }

 

//*********************************************************************************************
//                               getChildAssociationFromTree
//  used to filter PFT asset refrence selected item
//  in essence the allowable type and subtype
//  for the following three Asset Child Association Refrerences
//         1) Named Asset Associations
//         2) Unamed Asset Associations
//
//  For each association that is eligible,
//  find its name and its saved value (if any),
//  and present these in a text element.
//                     Since an association may be multivalued,
//                     depending on the kind of association this is,
//                     we may need to display multiple elements
//                     and ordinal values, and all Associateions
//                     get  "Pick From Tree " button as well.
//
// INPUT   Association Properties Include the following
//                       1)  Name
//                       2)  Multivalued Child Association
//                       3)  The Child Asset Type
//
function getChildAssociationFromTree ( assocname,childassettype,childsubtype, assocmultivalue )
{
   // Examine the filter to apply from the asset PFT selected item
   // Get From Pick From Tree Selected Asset
   var selectedAsset = pickRefAssetFromTree(assocname) ;

   if ( selectedAsset != null  )
   {
     // Need to insure that the  Attribute Master 
     // META Data LookUp Tables have been loaded         
     installArgTypeLookUpTables(document.forms[0].elements['legalname']) ; 
      
     var target  = document.forms[0].elements['item:sarguments']   ;

     // Place at the End of this option
     newindex=target.options.length;

     if ( assocmultivalue == "false" || assocmultivalue == "F")
     {
		// This is to ensure that correct assettype is picked from tree
		if(selectedAsset.assettype != childassettype)
		{
		]]>
			var xlat_msg =  '<XLAT.STREAM KEY="dvin/UI/AssetTypeNotAccepted" ENCODE="false" ESCAPE="true"/>';
		<![CDATA[
			xlat_msg = xlat_msg.replace("{0}", selectedAsset.name).replace("{1}", selectedAsset.assettype);
			alert(xlat_msg);
			return false;
		}
		
        // find and replace Association with new selected child asset
        // if child asset has  already selected
        assocname = assocname.replace('(S)','');
        for (i=0;i<target.options.length;i++)
        {
              if (target.options[i].text.indexOf(assocname)==0)
   		      {
                 newindex=i ;
   		      }
   		}

   		// Add to Argument Values List
   		var items=new Option( selectedAsset.displayItem, selectedAsset.valueItem );

        // Add New ( End of List )  OR Replace the target items option display and value
        target.options[newindex]=items;
   	    target.options[newindex].selected=false;

   	    delNul(target);
   	}
    else
    {
       if ( assocmultivalue == "true" || assocmultivalue == "T" )
       {
           installGroupMVOption ( assocname,selectedAsset.name, selectedAsset.assettype+":"+selectedAsset.id, target ) ;
           delNul(target);
       }
    }
   // Group Target Attributes
  groupTargetValues ( target ) ;
  }

 
}

//*********************************************************************************************
//                               getChildAssociationFromPopUp
//  used to filter PFT asset refrence selected item
//  in essence the allowable type and subtype
//  for the following three Asset Child Association Refrerences
//         1) Named Asset Associations
//         2) Unamed Asset Associations
//
//  For each association that is eligible,
//  find its name and its saved value (if any),
//  and present these in a text element.
//                     Since an association may be multivalued,
//                     depending on the kind of association this is,
//                     we may need to display multiple elements
//                     and ordinal values, and all Associateions
//                     get  "Pick From Tree " button as well.
//
// INPUT   Association Properties Include the following
//                       1)  Name
//                       2)  Multivalued Child Association
//                       3)  The Child Asset Type
//********************************************************************************************
function getChildAssociationFromPopUp ( assocname, assocmultivalue, selectedAsset  )
{
   var target  = document.forms[0].elements['item:sarguments']   ;

   // Place at the End of this option
   newindex=target.options.length;

   // MultiValue or Singlr Value Association ? 
   if ( assocmultivalue == "false" || assocmultivalue == "F" )
   {
        // find and replace Association with new selected child asset
        // if child asset has  already selected
        for (i=0;i<target.options.length;i++)
        {
              if (target.options[i].text.indexOf(assocname)==0)
   		      {
                 newindex=i ;
   		      }
   		}
        // Selected Asset Object from PFT is as follows
        // { assettype, id, name, displayItem, valueItem  }
   		// Add to Argument Values List

   		var items=new Option( selectedAsset.displayItem, selectedAsset.valueItem );

        // Add New ( End of List )  OR Replace the target items option display and value
        target.options[newindex]=items;
   	    target.options[newindex].selected=false;

   	    delNul(target);
   	}
    else
    {
       if ( assocmultivalue == "true" || assocmultivalue == "T" )
       {
          installGroupMVOption ( assocname,selectedAsset.name, selectedAsset.assettype+":"+selectedAsset.id, target ) ;
          delNul(target);
       }
    }
}


//*********************************************************************************************
//                               installArgTypeLookUpTables
//  Utility function to Process and Populate the Default Values
//  Master StartMenu META Data Lookup Table by NAME
//       1) Named Asset Associations
//       2) Parent / Group Type
//       3) User Defined
//
//
//
// Example of -> $$_15@FieldsIDList=System_*assetreference*true*Dimension; Extracting
//               Attribute Meta Data
// System_*string*false*description;
//               System_*date*false*enddate;
//               System_*string*false*filename;
//               System_*string*false*name;
//               Group_*assetreference*false*FSIIManufacturer;
//               Attribute_*string*true*FSIIKeyword;
//               Attribute_*string*true*MrMetAtCiti
//               Association-named:*assetreference*false*InfoSheet
//
//
//********************************************************************************************


// The Master Attribute and  Label Headings
// Tables for Atytributes (ALL) META AND TITLE
// info on all Group type attributes
var masterLabels  ;

var MasterSM = {}  ;
var MasterESM = {}  ;

var ARG_PREFIX = 0 ;
var ARG_REFTYPE = 1 ;
var ARG_MULTIPLE = 2 ;
var ARG_NAME = 3 ;

// From INPUT Field Values named
// fieldsid and fieldslabel list
// Parses and populates the Master Attribute Meta TABLE
function installArgTypeLookUpTables ( argsLst )
{
    var obj = document.forms[0];
    var dogroupSM = obj.elements['dogroupSM'] ;
    var ename ; 

    // Has the Group Type Loookup tables been loaded
    if ( dogroupSM != undefined && dogroupSM.value == 'Load' )
    {
      // Parse and Create the Group Titles

      if ( obj.elements['fieldslabel'] != undefined  )
      {
         var fieldslabel = obj.elements['fieldslabel'].value ;
         masterLabels = fieldslabel.split(";");
      }

      var fieldsobj = obj.elements['fieldsid'] ;
      if ( fieldsobj != undefined  )
      {
        var fieldsid = obj.elements['fieldsid'].value ;
        argsArray = fieldsid.split(";");
        // Transverse, parse and extract the META Argument data
        //
        for (var i=0;i<  argsArray.length;i++)
	    {
            var attrMeta =  argsArray[i] ;
            // Extract the META Info  Group_*assetreference*false*FSIIManufacturer;
            var argMeta = attrMeta.split("*") ;
            var name = argMeta[ARG_NAME]   ;
            MasterSM[name] =  { prefix   : argMeta[ARG_PREFIX] ,
                                type     : argMeta[ARG_REFTYPE],
                                multiple : argMeta[ARG_MULTIPLE]  }  ;

            // Master Edit Mode SM Table
            if ( MasterSM[name].multiple == 'false' )
              ename=name.replace('(S)','') ;
            else
              ename=name.replace('(M)','') ;

            MasterESM[ename] =  { prefix   : argMeta[ARG_PREFIX] ,
                                  type     : argMeta[ARG_REFTYPE],
                                  multiple : argMeta[ARG_MULTIPLE]  }  ;


        }
        dogroupSM.value = 'Finished' ;
    }
  }
}


function getPrefixByNamedTypeValue ( optvalue )
{
    var prefixValue = optvalue ;
    var prefix = null ;
    var parts = optvalue.split("=") ;
    var name = parts[0] ;
    var fullname ;

    if (  MasterSM[name] != undefined  )
    {
       if ( MasterSM[name].prefix != 'System_' )
         prefixValue = MasterSM[name].prefix+optvalue  ;
       else
         prefixValue = optvalue  ;

       if ( MasterSM[name].multiple == 'false' )
        fullname=prefixValue.replace('(S)','') ;
       else
        fullname=prefixValue.replace('(M)','') ;
    }
    else
    {
       // Edit Mode Use StartMenu ( Args ) name

       if (  MasterESM[name] != undefined && MasterESM[name].prefix != 'System_' )
       {
          fullname = MasterESM[name].prefix+optvalue  ;
       }
       else
         fullname =  prefixValue ; 
    }
    return fullname ;
}



function selAll(lst){
  if (!lst) return;

  for (i=0; i<lst.options.length; i++)
  {
		lst.options[i].selected=true
		var currentVal = lst.options[i].value;
        var currentName = lst.options[i].text;
        if ( currentVal != '!*' )
	    {
          lst.options[i].selected=true
          lst.options[i].value = getPrefixByNamedTypeValue(lst.options[i].value) ;
        }
        else
          lst.options[i].selected=false ;
   }
   delNul(lst)
}

function selAllAll(){
	var obj = document.forms[0];
	selAll(obj.elements['item:sarguments']);
}





function installAssocMVOption ( assocName, childName, childId, target )
{
   var groupitem ;

   var isEditDirty  = document.forms[0].elements['EditDirty'] ;

   // If in edit mode need to construct and populate the MasterParentPDMV Table
   // to reflect the Arguments List
   if (  isEditDirty != undefined &&
         isEditDirty.value == 'Yes' )
   {
      initMasterMVTable( target ) ;
   }

   // Is the Association Parent in the Table
   if ( masterParentPd[assocName] == undefined )
   {
       // Push and register Parent Definition Field in  this in the table
       masterParentPd[assocName] =  { parents : [] , total : 0 }  ;

       // Set Selected Parent
       masterParentPd[assocName].parents[childId] = childName ;
       ++masterParentPd[childId].total  ;

       // Craft a Target List Group Otion Element to be added to the end Default Values List
       //installMVOptionItem( selectedPDefName, selectedParentName, selectedParentId, target ) ;
   }
   else
   {
      // Parent Def Template Name is Registered Check is the
      // specific Parent been selected already ?
      if (  masterParentPd[assocName].parents[childId] == undefined )
      {
           masterParentPd[assocName].parents[assocId] = childName ;
          ++masterParentPd[assocName].total  ;

           // Craft a Target List Group Otion Element to be added to the end Default Values List
           // TODO installMVOptionItem( selectedPDefName, selectedParentName, selectedParentId, target ) ;
      }
   }
   return null ;
}









function noenter() {
  return !(window.event && window.event.keyCode == 13); }

function CheckFields(ourPage,op)
{
	var obj = document.forms[0];
    if (dojo.trim(obj.elements['item:name'].value).length == 0)
	{
		]]>
		alert("
      <XLAT.STREAM KEY="dvin/UI/Error/Youmustspecifyaname" ESCAPE="true" ENCODE="false"/>
");
      <![CDATA[
		obj.elements['item:name'].focus();
		return false;
	}

	var isclean = isCleanString(obj.elements['item:name'].value, '<">\'', true);	
	if (!isclean) {
		]]>
		alert("<XLAT.STREAM KEY="dvin/AT/Common/Apostrophenotallowedinname" ESCAPE="true" ENCODE="false"/>");
		<![CDATA[
		obj.elements['item:name'].focus();
		return false;
	}

	var Types = obj.elements['item:assettype'];
	if (Types.type =="select-one" ) {
	for (var i=0;i<Types.options.length;i++)
	{
		if (Types.options[i].selected)
		{
 			if (Types.options[i].text=="[None selected]")
			{
				]]>
				alert("
      <XLAT.STREAM KEY="dvin/UI/Admin/Error/Youmustselectanassettype" ESCAPE="true" ENCODE="false"/>
");
      <![CDATA[
				obj.elements['item:assettype'].focus();
				return false;
			}
		}
	}
	}

	if (!checkMultiSelect(obj.elements['item:legalsitessites'])) {
		]]>
		alert("<XLAT.STREAM KEY="dvin/UI/Admin/Error/Youmustselectasite" ESCAPE="true" ENCODE="false"/>");
		<![CDATA[
 		obj.elements['item:legalsitessites'].focus();
		return false;
	}
	if (!checkMultiSelect(obj.elements['item:legalrolesroles'])) {
		]]>
		alert("<XLAT.STREAM KEY="dvin/UI/Admin/Error/Youmustselectarole" ESCAPE="true" ENCODE="false"/>");
		<![CDATA[
 		obj.elements['item:legalrolesroles'].focus();
		return false;
	}

	obj.elements['pagename'].value = "OpenMarket/Xcelerate/Admin/"+ourPage;
	obj.elements['op'].value = op;
}

function checkMultiSelect(obj)
{
	if (!obj) return false;
	if (obj.selectedIndex == -1)
		return false;
	if (obj.options[0].selected) //Any is selected; deselect others
		for (var i = 1; i < obj.options.length; i++)
			obj.options[i].selected = false;
	return true;
}

function GotoNextPage(ourPage,op,dothis)
{
	var obj = document.forms[0];

	var isclean = isCleanString(obj.elements['Name'].value, '<">\'', true);

	if (!isclean) {
		]]>
		alert("<XLAT.STREAM KEY="dvin/AT/Common/Apostrophenotallowedinname" ESCAPE="true" ENCODE="false"/>");
		<![CDATA[
		return false;
	}

	if (dothis=='cleardef' && typeof(obj.elements['Definition'])!='undefined')
	{
		obj.elements['Definition'].selectedIndex = -1; 
	}

	obj.elements['pagename'].value = "OpenMarket/Xcelerate/Admin/"+ourPage;
	obj.elements['op'].value = op;


}
/*
	This function is called Onchange of the select menu with 'item:itemtype'.
	Its purpose is to hide the 'Default values' section and 'Workflow process' section of the
	start menu item screen when a user creates a Search Start menu item.
*/
function hideDefaultAndWorkflowSections()
{
	
	var obj = document.forms[0];
	var selectedStartMenuType = obj.elements['item:itemtype'].value;
	]]>
	var defaultValues = document.getElementById('defaultValuesSection');
	var defaultValuesHr = document.getElementById('defaultValuesHr');
	var workflowRow = document.getElementById('workflowRow');
	var workflowRowHr = document.getElementById('workflowRowHr');
	var participantsTr = document.getElementById('participantsTr');


    if(selectedStartMenuType=="<XLAT.STREAM KEY="dvin/Common/Search" ESCAPE="true" ENCODE="false" />")
	{
		if(defaultValues)
			defaultValues.style.display="none";
		if(defaultValuesHr)
			defaultValuesHr.style.display="none";
		if(workflowRow)
			workflowRow.style.display="none";
		if(workflowRowHr)
			workflowRowHr.style.display="none";
		if(participantsTr)
			participantsTr.style.display="none";
	}
	else
	{
		if(defaultValues)
			defaultValues.style.display="";
		if(defaultValuesHr)
			defaultValuesHr.style.display="";
		if(workflowRow)
			workflowRow.style.display="";
		if(workflowRowHr)
			workflowRowHr.style.display="";
		if(participantsTr)
			participantsTr.style.display="";		
	}
	<![CDATA[
	return true;	
}

function selectAll(ourPage,op)
{

	var obj = document.forms[0];

	if (typeof(obj.elements['CheckRoles']) != 'undefined' &&
		obj.elements['CheckRoles'].value!="")
	{
		var allRoles = obj.elements['CheckRoles'].value;
		roleArray = allRoles.split(",");
		var currentSel,j,numSelected;
		for (var i=0;i<roleArray.length;i++)
		{

			numSelected=0;
			currentSel = obj.elements[roleArray[i]];
			if (typeof(currentSel) == 'undefined')
				continue;
			for (j=0;j<currentSel.options.length;j++)
			{
				currentSel.options[j].selected=true;
				numSelected++;
			}
		}
	}
	return false;
}


function SelectWorkflow(ourPage,op)
{
	var obj = document.forms[0];
	var basePage = "OpenMarket/Xcelerate/Admin/";
	var newpage = basePage + ourPage;
	obj.elements['op'].value = op;
	obj.elements['pagename'].value = newpage;
	obj.submit();
}

function CheckWorkflow(ourPage,op)
{
	var obj = document.forms[0];

	if (typeof(obj.elements['CheckRoles']) != 'undefined' &&
			 obj.elements['CheckRoles'].value!="")
	{
		var allRoles = obj.elements['CheckRoles'].value;
		roleArray = allRoles.split(",");
		var currentSel,j,numSelected;
		for (var i=0;i<roleArray.length;i++)
		{
			numSelected=0;
			currentSel = obj.elements[roleArray[i]];

			if (typeof(currentSel)=="undefined")
			{
				]]>
				var replacestr=/\bVariables.role\b/ ;
				var xlatstr='
      <XLAT.STREAM KEY="dvin/UI/Admin/Error/usersnotdefinedforrole" ESCAPE="true" ENCODE="false"/>
';
				alert(xlatstr.replace(replacestr, roleArray[i]));
      <![CDATA[
				return false;
			}
			for (j=0;j<currentSel.options.length;j++)
			{
				if (currentSel.options[j].selected)
					numSelected++;
			}

			if (numSelected==0)
			{
				]]>
                 var replacestr=/\bVariables.role\b/ ;
                 var xlatstr='
      <XLAT.STREAM KEY="dvin/UI/Admin/Error/roleArrayihasnotbeenselected" ESCAPE="true" ENCODE="false"/>
';
          	     alert(xlatstr.replace(replacestr, roleArray[i]));
      <![CDATA[
				return false;
			}
		}
	}

    obj.elements['pagename'].value = "OpenMarket/Xcelerate/Admin/"+ourPage;
	obj.elements['op'].value = op;

}

function CancelWorkflow(ourPage,op)
{
    var obj = document.forms[0];
	obj.elements['update:process'].value="";
	obj.elements['item:process'].selectedIndex=0;
	obj.elements['pagename'].value = "OpenMarket/Xcelerate/Admin/"+ourPage;
	obj.elements['op'].value = op;
}


function moveargright(srcname,target,prepend)
{
	var items, newindex;

	if(prepend=='R')
		items=new Option('*'+srcname.value,prepend+srcname.value);
	else
		items=new Option(srcname.value,prepend+srcname.value);
	newindex=target.options.length;
	target.options[newindex]=items;
	target.options[newindex].selected=true;

	delNul(target);

	srcname.value="";
}

//  ****************************************************************************
//  The Master Parent Def ( Group/Parents ) Table
//  Used to Manage the user selected parents for Parent Attributes
//  ****************************************************************************
var masterParentPd = [] ;


//  Get the total number of selected parents for the
//  passed in Parent Definiton Group Name
function getPDParentsCount ( selectedPDefName )
{
    var  length = 0  ;
    for ( var parent in masterParentPd[selectedPDefName].parents )
    {
      ++length ;
    }
    return length ;
}

function setEditArgTable ( sections )
{
 	var i = 0;
	for (i=0;i<sections.options.length;i++)
	{
        var text = sections.options[i].text;
		var value = sections.options[i].value;
	}
}

// Adds a Group/Parent Attribute select option item into table
function addToMasterParentTable ( selectedPDefName,selectedParentName,selectedParentId  )
{
  if ( masterParentPd[selectedPDefName] == undefined )
  {
       // Push and register Parent Definition Field in  this in the table
       masterParentPd[selectedPDefName] =  { parents : [] , total : 0 }  ;

       // Set Selected Parent
       masterParentPd[selectedPDefName].parents[selectedParentId] = selectedParentName ;
       // Add to total
       ++masterParentPd[selectedPDefName].total  ;
   }
   else
   {
      // Parent Def Template Name is Registered Check is the
      // specific Parent been selected already ?
      if (  masterParentPd[selectedPDefName].parents[selectedParentId] == undefined )
      {
           masterParentPd[selectedPDefName].parents[selectedParentId] = selectedParentName ;
          ++masterParentPd[selectedPDefName].total  ;
      }
   }
}




// Builds a Parent Def Field ( MV )  parent selected
// Target option in THE  select list of assigned default values .
// Modified;  Feb 24, 2011
// Reason :   Must go into the database MenuArgs as name=value
//            including MV Fields
function installMVOptionItem ( pdName, selectedParentName, selectedParentId, target )
{
   var parentsDefTotal =  masterParentPd.length ;
   var parentsTotal =  masterParentPd[pdName].total ;

   var  label = pdName+"="+selectedParentName;
   var  value = pdName+"="+selectedParentId ;

   // Create a Option Definition and Usage The <option> tag defines an option in a select list.
   // The option element goes inside the select element.
   var item=new Option( label , value );

   // Place at the End of this option
   newindex=target.options.length;

   // Add New ( End of List )  OR Replace the target items option display and value
   target.options[newindex]=item;
   target.options[newindex].selected=false;
}


// Builds a Parent Def Field ( MV )  parent selected
// Target option in THE  select list of assigned default values .
// Modified;  Feb 24, 2011
// Reason :   Must go into the database MenuArgs as name=value
//            including MV Fields
function installMVOptionItemReplace ( pdName, selectedParentName, selectedParentId, target, addit )
{
   var nogo = -1 ;

   var  label = pdName+"="+selectedParentName;
   var  value = pdName+"="+selectedParentId ;

   // find and replace argument if already selected
   for (i=0;i<target.options.length-1;i++)
   {
       var name =  target.options[i].text ;
       var edname = name.split("=") ;
       if ( edname[0].search('(M)') == -1 )
         name = edname[0]+"(M)="+edname[1] ;
       if ( name == label   )
       {
          nogo = i ;
       }
    }

    if ( nogo == -1 && addit == 1 )
    {
     // Create a Option Definition and Usage The <option> tag defines an option in a select list.
     // The option element goes inside the select element.
     var item=new Option( label , value );

     // Place at the End of this option
     newindex=target.options.length;

     // Add New ( End of List )  OR Replace the target items option display and value
     target.options[newindex]=item;
     target.options[newindex].selected=false;
   }

   return nogo ;
}








function initMasterMVTable ( target )
{
    // find and replace argument if already selected
    for (i=0;i<target.options.length-1;i++)
    {
       var name =  target.options[i].text ;
       var nameInfo =  name.split("=");

       // Extract Attribute Name and Parent Display name
       var parentDefName = nameInfo[0] ;
       var parentName = nameInfo[1] ;

       var value =    target.options[i].value ;
       // Extract the value into Attribute Name and  part of the value
       var valueInfo = value.split("=");

       if ( parentDefName.search("Group_") != -1 )
       {
          parentDefName = parentDefName.replace("Group_", "Group_MV_");
          addToMasterParentTable(parentDefName, parentName, valueInfo[1] );
       }
    }
    
    // Since its has been initilized no longer dirty
    var isEditDirty  = document.forms[0].elements['EditDirty'] ;
    isEditDirty.value = 'No' ;
}

function installGroupMVOption ( selectedPDefName, selectedParentName, selectedParentId, target )
{
   var groupitem ;
   var isEditDirty  = document.forms[0].elements['EditDirty'] ;
   var found ;
   // If in edit mode need to construct and populate the MasterParentPDMV Table
   // to reflect the Arguments List
   if (  isEditDirty != undefined &&
         isEditDirty.value == 'Yes' )
   {
      initMasterMVTable( target ) ;
   }

   if ( masterParentPd[selectedPDefName] == undefined )
   {
       found = installMVOptionItemReplace( selectedPDefName, selectedParentName, selectedParentId, target, 0 ) ;
       // Push and register Parent Definition Field in  this in the table
       masterParentPd[selectedPDefName] =  { parents : [] , total : 0 }  ;

       // Set Selected Parent 
       masterParentPd[selectedPDefName].parents[selectedParentId] = selectedParentName ;
       ++masterParentPd[selectedPDefName].total  ;

       // Craft a Target List Group Otion Element to be added to the end Default Values List
       installMVOptionItem( selectedPDefName, selectedParentName, selectedParentId, target ) ;
   }
   else
   {


      //   var found = installMVOptionItemReplace( selectedPDefName, selectedParentName, selectedParentId, target ) ;
      // Parent Def Template Name is Registered Check is the
      // specific Parent been selected already ?
      if (  masterParentPd[selectedPDefName].parents[selectedParentId] == undefined )
      {
           masterParentPd[selectedPDefName].parents[selectedParentId] = selectedParentName ;
          ++masterParentPd[selectedPDefName].total  ;

           // Craft a Target List Group Otion Element to be added to the end Default Values List
           installMVOptionItem( selectedPDefName, selectedParentName, selectedParentId, target ) ;
      }
      else
      {
         // Craft a Target List Group Otion Element to be added to the end Default Values List
         found = installMVOptionItemReplace( selectedPDefName, selectedParentName, selectedParentId, target, 1 ) ;
      }
   }
   return null ; 
}

// This will transverse the passed in specific group
// of attributes and set the option header and
// associated attribute name and default values
function setGroupMembers (  target, cpnt, attrlst)
{

   if ( attrlst.length > 1 )
   {
      for ( i=0 ; i< attrlst.length ; ++i )
      {
        target.options[cpnt]  = attrlst[i] ;
        cpnt=cpnt + 1 ;
      }
   }
   return cpnt ;
}



// Add Title and Labels and Group the
// Attribute and Assigned  Values by Type
//
function groupTargetValues ( target )
{
    var item  ;
    var sys = [],usr = [],par = [], assoc = [] ;
    var  s = 0,as=0,g=0,a=0,i,cj, cpnt = 0 ;

    // Assign a special token Value 
    sys[s] =   new Option( masterLabels[3], "!*");
    sys[s++].disabled = true;
    usr[a] =   new Option( masterLabels[0], "!*");
    usr[a++].disabled = true;
    par[g] =   new Option( masterLabels[1], "!*");
    par[g++].disabled = true;
    assoc[as] = new Option( masterLabels[2], "!*");
    assoc[as++].disabled = true;

    // Place Attrbute type into the correct type bucket !
    for (cj=0;   cj < target.options.length;  cj++)
    {
       var  displayText =  target.options[cj].text ;
       var  nameValuePair =   displayText.split("=") ;
       var  name = nameValuePair[0] ;
       if ( target.options[cj].value != '!*' )
       {
         item = new Option(target.options[cj].text,target.options[cj].value );

         // First is this in the NEW Master LookUp
         var argRec =  MasterSM[name] ;

         // Get the META from edit ASSIGNED ATTRIBUTE VALUES
         if ( argRec == null )
            argRec =  MasterESM[name] ;

         if ( argRec.prefix == 'System_'  )
           sys[s++] = item ;
         else
         if ( argRec.prefix == 'Attribute_'  )
           usr[a++] = item ;
         else
         if ( argRec.prefix == 'Group_'  )
         {
           par[g++] = item ;
         }
         else
         if ( argRec.prefix == 'Association-named:'  )
          assoc[as++] = item ;
       }
       else
         target.options[cj].disabled=true ;
    }

    cpnt = setGroupMembers (  target, cpnt, usr)    ;
    cpnt = setGroupMembers (  target, cpnt, par)    ;
    cpnt = setGroupMembers (  target, cpnt, assoc)    ;
    cpnt = setGroupMembers (  target, cpnt, sys)    ;   

}

function checkAlreadyFromEdit ( srcname, target )
{
    var argRec =  MasterSM[srcname] ;
    var  svindex = -1 ;

    var ename=srcname.replace('(S)','') ;
    for (i=0;i<target.options.length-1;i++)
    {
       var optname =  target.options[i].text ;
       var nameInfo =  optname.split("=");
       var edname = nameInfo[0] ;

       if ( edname == ename )
         return i ;
    }
    return -1 ;
}

// yoda Uitlize the MasterSM Group Attribute table to
// determine how to process the selected attribute
// and default value
function movedefargright(srcname,target)
{
	var items, newindex, newval, newdisp, i, srcindex;	
    var name,currentName;

    // Transverse and find the Source{options} index
    for (i=0;i<srcname.options.length;i++)
    {
      if (srcname.options[i].selected)
      {
        srcindex=i;
        currentName = 'StartMenuValueID_'+(i+1);
        name =  srcname.options[i].text ; 
      }
    }

   var obj = document.forms[0];
   var srcval = obj.elements[currentName];

   var selectedParentId = srcval.value ;

   if (srcval.value!='')
   {
      newval = srcval.value.replace(/=/g,'__EQ__');

      // Get the new Value to replace { SV ... } 
      if(typeof(srcval.options)!='undefined')
      {
        for (i=0;i<srcval.options.length;i++)
        {
          if (srcval.options[i].selected)
          {
            srcoptionlabel =   srcval.options[i].label ;
            newdisp = srcval.options[i].text;
    	  }
        }

      }
      else
        newdisp = srcval.value;
		newval =  newval.replace(/;/g,'__SEMI__');

    // Place at the End of this option
	newindex=target.options.length;

    var selectedPDefName =  srcname.options[srcindex].text ;
    var selectedParentName =  newdisp ;

    if ( MasterSM[name].prefix == 'Group_' &&
         MasterSM[name].multiple == 'true' )
    {
        // Consume Multi Value {MV}...Field Parent Group(s)
        installGroupMVOption ( name, selectedParentName, selectedParentId, target ) ;
    }
    else
    {
       // Consume Single Value{SV}...Field
       var displayItem = srcname.options[srcindex].text+"="+newdisp;
       var valueItem = srcname.options[srcindex].text+"="+newval ;

       // Get the Attribute Meta Record
       var argMeta = MasterSM[selectedPDefName] ;

       // Is this a Multi Value or Single Value Custom / Attribute_{$name} ?
       if ( argMeta != null && argMeta.multiple == 'false' )
       {
            // To not allow index
            var editindex = checkAlreadyFromEdit ( srcname.options[srcindex].text, target )     ;
            if ( editindex == -1 )
            {

             // find and replace argument if already selected
             for (i=0;i<target.options.length;i++)
             {
               if (target.options[i].text.indexOf(srcname.options[srcindex].text)==0)
   		       {
                newindex=i ;
   		       }
   		     }
   		    }
   		    else
   		     newindex=editindex ;
   		 }
   	   

   	   items=new Option( displayItem, valueItem );

       // Add New ( End of List )  OR Replace the target items option display and value
       target.options[newindex]=items;
   	   target.options[newindex].selected=false;
   	}


    delNul(target);

    // Group Target Attributes
    groupTargetValues ( target ) ;
  }

}

// Update the Group Table
function removearg(target)
{
	var i=0;

	while(i<target.options.length)
	{
		if(target.options[i].selected)
		{
		   target.options[i]=null;
		}
		else
			i++;
	}
	delNul(target);

	 i=0 ;
     var next ;

     // Handle All Between 

     while(i<target.options.length)
	 {
       var prevvalue = target.options[i].value ;
       if ( ( i + 1 ) <  target.options.length  )
	   {
           next= i + 1 ;
     	   nextvalue = target.options[next].value  ;
           if ( prevvalue == nextvalue && prevvalue == '!*' )
           {
             	target.options[i]=null;
           }
       }
       ++i ;
    }

    // Is the last Heading a EMPTY Group  the end
    if (  target.options.length > 0 )
    {
        next = target.options.length-1 ;
        if ( target.options[next].value == '!*' )
      	  target.options[next]=null;
    }

    // Is the last Heading a EMPTY Group
    if (  target.options.length > 0 )
    {
        next = target.options.length-1 ;
        if ( target.options[next].value == '!*' )
      	  target.options[next]=null;
    }

}

function delNul(lst){
	i = 0;
	while (i<lst.options.length) {
		if (lst.options[i].value==-1)
		{
			lst.options[i]=null   ;
 	    }
		else
			i = i + 1;
	}
}




function showStatus(sections)
{
   // Get the remove Butoon Widget style object
    var removebutton = document.getElementById('RemoveButton_1').style   ;

    var i = 0;
	for (i=0;i<sections.options.length;i++)
	if (sections.options[i].selected)
	{
		var currentVal = sections.options[i].value;
        if ( currentVal == '!*' )
        {
             removebutton.display = 'none' ;
        }
        else
        {
            removebutton.display = 'inline' ;
        }
        
		if (currentVal!='-1')
		{
			var showThis = currentVal.replace(/__EQ__/g,'=');
			showThis = showThis.replace(/__SEMI__/g,';');
			window.status=showThis;
		}
		else window.status='';
	}
}

// **********************************************************************
// yoda-1 If Selected Argument is of Type equal to assetref
// then hide the add button
//
function ShowValue(addbutton, srcname)
{
    var srcindex, thisStyleObj,currentName;

    // Get the AddButoon Widget style object
    var addbutton = document.getElementById('AddButton_1').style   ;

    for (i=0;i<srcname.options.length;i++)
    {
      currentName = 'StartMenuValueID_'+(i+1);
      thisStyleObj = document.getElementById(currentName)   ;
      if ( thisStyleObj != null )
      {
         thisStyleObj = document.getElementById(currentName).style;
         thisStyleObj.display='none';
         if (srcname.options[i].selected)
         {
            var name = srcname.options[i].text ;

            thisStyleObj.display='inline';

            var argMeta = MasterSM[name] ;
            if ( argMeta != undefined )
            {
                // Install and Load Attribute type META Lookup Table
                installArgTypeLookUpTables(srcname) ;
                argMeta = MasterSM[name] ;

                //TODO  Asset reference not Parent because parent we present as a Drop Down ! s
                if ( argMeta.type == 'assetreference' &&  argMeta.prefix != 'Group_' && argMeta.prefix != 'System_')
                {
                  addbutton.display = 'none' ;
                }
                else
                {
                 addbutton.display = 'inline' ;
                }
            }
            else
            {
                // Its a Header  Label  No Action to DO Value or Add Button 
                thisStyleObj.display='none';
                addbutton.display = 'none' ;
            }        
         }
       }    
    }
}


function RemoveWorkflow(ourPage,op)
{
   var obj = document.forms[0];
  obj.elements['item:process'].selectedIndex=0;
  obj.elements['pagename'].value = "OpenMarket/Xcelerate/Admin/"+ourPage;
  obj.elements['op'].value = op;
}


]]>
   </SCRIPT>

<!--
      In order to make the default arguments correctly reflect the available fields, we need to know the definition of the
      flex parent/assets.  For standard assets subtype doesn't matter.  If we know the asset type coming into this form and
      it is a flex asset or parent then we'll show a small form asking for the definition.  If we know the asset type and
      its not a flex asset or parent then we'll go straight to the main form.  If we don't know the asset type we'll show the
      small form asking for assettype and possibly definition before going to the main form.

      Once we know the defintion of the flex asset/parent we can use asset.inspect to get the list of fields to show in
      the default argument list.

      Also a defintion of 'Any' can be selected if you don't care about setting default arguments.

      Modified:  Feb 08, 2011
      Reason:    Add the ability to assign defaul.t Parent Values to Parent Definitions

      Example: TASK  Enhancement  -- User Selects  Media (Media_C) assetType and selects a specific
              Media Definition  FSSII_Image ( Media_D) now we shuld also
              1) Query for the Media Parent Defintions ( Media_PD) and
                 add to the list of attributes ( SV/ Asset ) that user can assign
                 the default values.
-->

     <CALLELEMENT NAME="OpenMarket/Xcelerate/Admin/StartMenuCommon"/>
	 <STRING.ENCODE VARIABLE="cs_environment" VARNAME="cs_environment"/>
	<STRING.ENCODE VARIABLE="cs_imagedir" VARNAME="cs_imagedir"/>
	<STRING.ENCODE VARIABLE="cs_formmode" VARNAME="cs_formmode"/>
	<STRING.ENCODE VARIABLE="cs_Permissions" VARNAME="cs_Permissions"/>
   <!--  What is the front and action user has requested
     -->

         <INPUT TYPE="HIDDEN" NAME="op" VALUE="new"/>
         <INPUT TYPE="HIDDEN" NAME="pagename" VALUE="OpenMarket/Xcelerate/Admin/StartMenuPost"/>

       
         <IF COND="Variables.op=list">
            <THEN>
            	<table class="width-outer-70" cellspacing="0" cellpadding="0" border="0">
				<tr><td>
                 <IF COND="IsVariable.AssetType=true">
                  <THEN>

                     <STARTMENU.GETALLSTARTITEMS ASSETTYPE="Variables.AssetType" LISTVARNAME="AllStartMenus"/>
                     <ASSETTYPE.LOAD NAME="at" TYPE="Variables.AssetType"/>
                     <ASSETTYPE.GET NAME="at" FIELD="description" OUTPUT="atdescription"/>
                     <span class="title-text">
                        <XLAT.STREAM KEY="dvin/UI/Admin/StartMenusforAssetType"/>
:
                        <SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Admin/AssetTypeFront" outstring="urlasttypefront">
                            <satellite.argument name="cs_environment" value="Variables.cs_environment"/>
                            <satellite.argument name="cs_formmode" value="Variables.cs_formmode"/>
                                                         <satellite.argument name="action" value="details"/>
                                                         <satellite.argument name="assettype" value="Variables.AssetType"/>
                                                          </SATELLITE.LINK>
                        <A HREF="Variables.urlasttypefront" REPLACEALL="Variables.urlasttypefront">
                           <IMG src="Variables.cs_imagedir/graphics/common/icon/doubleArrow.gif" WIDTH="15" HEIGHT="12" BORDER="0" REPLACEALL="Variables.cs_imagedir"/>
                           <STRING.STREAM VARIABLE="atdescription"/>
                        </A>
                     </span>
                     <P/>
                     <SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Admin/StartMenuFront" outstring="NewStartMenuURL">
                         <satellite.argument name="cs_environment" value="Variables.cs_environment"/>
                         <satellite.argument name="cs_formmode" value="Variables.cs_formmode"/>
                                                         <satellite.argument name="op" value="new"/>
                                                         <satellite.argument name="AssetType" value="Variables.AssetType"/>
                                                          </SATELLITE.LINK>
                  </THEN>
                  <ELSE>
                    <IF COND="IsVariable.ItemType=true">
					<THEN>
						<IF COND="Variables.ItemType=Word">
						<THEN>
							<XLAT.LOOKUP KEY="dvin/UI/CSDesktop" VARNAME="ItemTypeName"/>
						</THEN>
						<ELSE>
							<IF COND="Variables.ItemType=Search">
							<THEN>
								<XLAT.LOOKUP KEY="dvin/Common/Search" VARNAME="ItemTypeName"/>
							</THEN>
							<ELSE>
								<IF COND="Variables.ItemType=ContentForm">
								<THEN>
									<XLAT.LOOKUP KEY="dvin/Common/New" VARNAME="ItemTypeName"/>
								</THEN>
								<ELSE>
									<IF COND="Variables.ItemType=CSDocLink">
									<THEN>
										<XLAT.LOOKUP KEY="dvin/UI/Admin/CSDocLink" VARNAME="ItemTypeName"/>
									</THEN>
									
									<ELSE>
										<IF COND="Variables.ItemType=InsiteForm">
										<THEN>
											<XLAT.LOOKUP KEY="dvin/UI/Admin/NewInsite" VARNAME="ItemTypeName"/>
										</THEN>
										
									<ELSE>
										<SETVAR NAME="ItemTypeName" VALUE="Variables.ItemType"/>
									</ELSE>
									</IF>
								</ELSE>
									</IF>
								</ELSE>
								</IF>
							</ELSE>
							</IF>
						</ELSE>
						</IF>
						<span class="title-text">
							<XLAT.STREAM KEY="dvin/UI/Admin/StartMenusoftype" ItemTypeName="Variables.ItemTypeName"/>
						</span><p/>
						<STARTMENU.GETALLSTARTITEMS ITEMTYPE="Variables.ItemType" LISTVARNAME="AllStartMenus"/>
					</THEN>
					<ELSE>
						<IF COND="IsVariable.pubid=true">
						<THEN>
							<PUBLICATION.LOAD NAME="publication" OBJECTID="Variables.pubid"/>
							<PUBLICATION.GET NAME="publication" FIELD="name" OUTPUT="PublicationName"/>
							<span class="title-text">
								<XLAT.STREAM KEY="dvin/UI/Admin/StartMenusforsite" PublicationName="Variables.PublicationName"/>
							</span><p/>
							<STARTMENU.GETALLSTARTITEMS PUBID="Variables.pubid" LISTVARNAME="AllStartMenus"/>
						</THEN>
						<ELSE>


                            <STARTMENU.GETALLSTARTITEMS LISTVARNAME="AllStartMenus"/>
							<span class="title-text">
								<XLAT.STREAM KEY="dvin/UI/Admin/StartMenus"/>
							</span><p/>
						</ELSE>
						</IF>
					</ELSE>
					</IF>
					<SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Admin/StartMenuFront" outstring="NewStartMenuURL">
						<satellite.argument name="cs_environment" value="Variables.cs_environment"/>
						<satellite.argument name="cs_formmode" value="Variables.cs_formmode"/>
						<satellite.argument name="op" value="new"/>
                            <satellite.argument name="ItemType" value="Variables.ItemType"/>
                    </SATELLITE.LINK>
				</ELSE>
				</IF>
					</td></tr>
					<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/TitleBar"/>
				</table>

               <table BORDER="0" CELLSPACING="0" CELLPADDING="0" class="width-outer-70">
                  <tr>
                     <td></td>
                     <td class="tile-dark" nowrap="true" HEIGHT="1">
                        <IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/>
                     </td>
                     <td></td>
                  </tr>
                  <tr>
                     <td class="tile-dark" nowrap="true" VALIGN="top" WIDTH="1">
                        <BR />
                     </td>
                     <td >
                        <table class="width-inner-100" cellpadding="0" cellspacing="0" border="0" bgcolor="#ffffff">
                           <tr>
                              <td colspan="11" class="tile-highlight">
                                 <IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/>
                              </td>
                           </tr>
                           <tr>
                              <td class="tile-a" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;</td>
                              <td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;</td>
                              <td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;</td>
					  <td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">
						<DIV class="new-table-title">
							<XLAT.STREAM KEY="dvin/Common/Name"/>
						</DIV>
                              </td>
                              <td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;&nbsp;&nbsp;&nbsp;</td>
                              <td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">
						<DIV class="new-table-title">
                                       <XLAT.STREAM KEY="dvin/Common/Description"/>
                                  </DIV>
                              </td>
                              <td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;&nbsp;&nbsp;&nbsp;</td>
                              <td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">
                                    <DIV class="new-table-title">
                                       <XLAT.STREAM KEY="dvin/Common/Type"/>
                                    </DIV>
                                 
                              </td>
                              <td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;&nbsp;&nbsp;&nbsp;</td>
                              <td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">
                                 
                                    <DIV class="new-table-title">
                                       <XLAT.STREAM KEY="dvin/UI/AssetTypenospace"/>
                                    </DIV>
                                 
                              </td>
                              <td class="tile-c" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;</td>
                           </tr>
                           <tr>
                              <td colspan="11" class="tile-dark" nowrap="true">
                                 <IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/>
                              </td>
                           </tr>
                           <!-- Loop over all search results. -->
                           <SETVAR NAME="rowStyle" VALUE="tile-row-normal"/>
                           <SETVAR NAME="separatorLine" VALUE="0"/>


                           <LOOP LIST="AllStartMenus">
                              <SETVAR NAME="menu:id" VALUE="AllStartMenus.id"/>

                              <!--If the description is empty or has leading spaces,then the name is displayed -->
                              <IF COND="AllStartMenus.description!=Variables.empty">
                              <THEN>
                                <SETVAR NAME="errno" VALUE="0"/>
                                <INDEXOF STR="AllStartMenus.description" WHAT="%20" OUTSTR="myindex1" INDEX="0"/>
                                <IF COND="Variables.errno=1">
                                  <THEN>
                                    <IF COND="Variables.myindex1!=0">
                                       <THEN>
                                         <SETVAR NAME="menu:name" VALUE="AllStartMenus.description"/>
                                       </THEN>
                                       <ELSE>
                                         <SETVAR NAME="menu:name" VALUE="AllStartMenus.name"/>
                                       </ELSE>
                                     </IF>
                                   </THEN>
                                   <ELSE>
                                     <SETVAR NAME="menu:name" VALUE="AllStartMenus.description"/>
                                   </ELSE>
                                </IF>
                             </THEN>
                             <ELSE>
                                <SETVAR NAME="menu:name" VALUE="AllStartMenus.name"/>
                             </ELSE>
                             </IF>
                             <!--<SETVAR NAME="menu:name" VALUE="AllStartMenus.name"/>-->
                             <SETVAR NAME="menu:assettype" VALUE="AllStartMenus.assettype"/>
                             <SETVAR NAME="menu:itemtype" VALUE="AllStartMenus.itemtype"/>

                            <!-- This had sucky performance, obviously...
                             STARTMENU.LOAD ID="AllStartMenus.id" OBJVARNAME="currMenu"/>
                            <STARTMENUITEM.SCATTER PREFIX="menu:" NAME="currMenu"/ -->
                              <IF COND="Variables.separatorLine=1">
                                 <THEN>
                                    <!--<tr>
                                       <td colspan="9" class="light-line-color">
                                          <img height="1" width="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/>
                                       </td>
                                    </tr>-->
                                 </THEN>
                              </IF>
                              <SETVAR NAME="separatorLine" VALUE="1"/>


                              <tr class="Variables.rowStyle"  REPLACEALL="Variables.rowStyle">
                                 <td>
                                    <BR />
                                 </td>
                                 <td VALIGN="TOP" NOWRAP="NOWRAP" ALIGN="LEFT">
                                    <XLAT.LOOKUP KEY="dvin/Common/Inspect" VARNAME="_XLAT_" ESCAPE="true"/>
                                    <XLAT.LOOKUP KEY="dvin/UI/Admin/InspectThisStartMenu" VARNAME="_alt_"/>
                                    <SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Admin/StartMenuFront" outstring="urlstartmenufront">
                                        <satellite.argument name="cs_environment" value="Variables.cs_environment"/>
                                        <satellite.argument name="cs_formmode" value="Variables.cs_formmode"/>
                                                         <satellite.argument name="op" value="view"/>
                                                         <satellite.argument name="startitem" value="Variables.menu:id"/>
                                                          </SATELLITE.LINK>
                                    <A HREF="Variables.urlstartmenufront" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true" REPLACEALL="Variables.urlstartmenufront,Variables._XLAT_">
                                       <img height="14" width="14" hspace="2" vspace="4" src="Variables.cs_imagedir/graphics/common/icon/iconInspectContent.gif"  border="0" alt="Variables._alt_" title="Variables._alt_"  REPLACEALL="Variables.cs_imagedir,Variables._alt_"/>
                                    </A>
                                    <XLAT.LOOKUP KEY="dvin/Common/Edit" VARNAME="_XLAT_" ESCAPE="true"/>
                                    <XLAT.LOOKUP KEY="dvin/UI/Admin/EditThisStartMenu" VARNAME="_alt_"/>
                                    <SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Admin/StartMenuFront" outstring="urlstartmenufront">
                                        <satellite.argument name="cs_environment" value="Variables.cs_environment"/>
                                        <satellite.argument name="cs_formmode" value="Variables.cs_formmode"/>
                                                         <satellite.argument name="op" value="new"/>
                                                         <satellite.argument name="startitem" value="Variables.menu:id"/>
                                                         <satellite.argument name="action" value="edit"/>
                                                          </SATELLITE.LINK>
                                    <A HREF="Variables.urlstartmenufront" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true" REPLACEALL="Variables.urlstartmenufront,Variables._XLAT_">
                                       <img height="14" width="14" hspace="2" vspace="4" src="Variables.cs_imagedir/graphics/common/icon/iconEditContent.gif"  border="0" alt="Variables._alt_" title="Variables._alt_"  REPLACEALL="Variables.cs_imagedir,Variables._alt_"/>
                                    </A>
                                    <XLAT.LOOKUP KEY="dvin/Common/Delete" VARNAME="_XLAT_" ESCAPE="true"/>
                                    <XLAT.LOOKUP KEY="dvin/UI/Admin/DeleteThisStartMenu" VARNAME="_alt_"/>
                                    <SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Admin/StartMenuFront" outstring="urlstartmenufront">
                                        <satellite.argument name="cs_environment" value="Variables.cs_environment"/>
                                        <satellite.argument name="cs_formmode" value="Variables.cs_formmode"/>
                                                         <satellite.argument name="op" value="confirmdelete"/>
                                                         <satellite.argument name="startitem" value="Variables.menu:id"/>
                                                          </SATELLITE.LINK>
                                    <A HREF="Variables.urlstartmenufront" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true" REPLACEALL="Variables.urlstartmenufront,Variables._XLAT_">
                                       <img height="14" width="14" hspace="2" vspace="4" src="Variables.cs_imagedir/graphics/common/icon/iconDeleteContent.gif"  border="0" alt="Variables._alt_" title="Variables._alt_"  REPLACEALL="Variables.cs_imagedir,Variables._alt_"/>
                                    </A>


                                 </td>
                                 <td>
                                    <BR />
                                 </td>
                                 <td VALIGN="TOP" ALIGN="LEFT">
                                    <DIV class="small-text-inset">
                                       <XLAT.LOOKUP KEY="dvin/UI/Admin/InspectThisStartMenu" VARNAME="_XLAT_" ESCAPE="true"/>
                                       <SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Admin/StartMenuFront" outstring="urlstartmenufront">
                                           <satellite.argument name="cs_environment" value="Variables.cs_environment"/>
                                           <satellite.argument name="cs_formmode" value="Variables.cs_formmode"/>
                                                         <satellite.argument name="op" value="view"/>
                                                         <satellite.argument name="startitem" value="Variables.menu:id"/>
                                                          </SATELLITE.LINK>
                                       <A HREF="Variables.urlstartmenufront"  onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true" REPLACEALL="Variables.urlstartmenufront,Variables._XLAT_">
								<CSVAR NAME="AllStartMenus.name"/>
                                       </A>
                                    </DIV>
                                 </td>
                                 <td>
                                    <BR />
                                 </td>
						<td VALIGN="TOP" ALIGN="LEFT">
							<DIV class="small-text-inset">
								<XLAT.LOOKUP KEY="dvin/UI/Admin/InspectThisStartMenu" VARNAME="_XLAT_" ESCAPE="true"/>
								<STRING.STREAM VALUE="AllStartMenus.description"/>
							</DIV>
						</td>
						<td>
							<BR />
						</td>
                                 <td VALIGN="TOP" NOWRAP="NOWRAP" ALIGN="LEFT">
                                    <DIV class="small-text-inset">
                                       <IF COND="Variables.menu:itemtype=Word">
                                          <THEN>
                                             <XLAT.STREAM KEY="dvin/UI/CSDesktop"/>
                                          </THEN>
                                          <ELSE>
                                             <IF COND="Variables.menu:itemtype=Search">
                                                <THEN>
                                                   <XLAT.STREAM KEY="dvin/Common/Search"/>
                                                </THEN>
                                                <ELSE>
                                                   <IF COND="Variables.menu:itemtype=ContentForm">
                                                      <THEN>
                                                         <XLAT.STREAM KEY="dvin/Common/New"/>
                                                      </THEN>
                                                      <ELSE>
													  
													  <IF COND="Variables.menu:itemtype=InsiteForm">
                                                      <THEN>
                                                         <XLAT.STREAM KEY="dvin/UI/Admin/NewInsite"/>
                                                      </THEN>
                                                      <ELSE>
													  
                                                         <IF COND="Variables.menu:itemtype=CSDocLink">
                                                         <THEN>
                                                         	<XLAT.STREAM KEY="dvin/UI/Admin/CSDocLink"/>
                                                         </THEN>
                                                         <ELSE>
                                                         	<STRING.STREAM VARIABLE="menu:itemtype"/>
                                                         </ELSE>
                                                         </IF>
														 </ELSE>
														 </IF>
                                                      </ELSE>
                                                   </IF>
                                                </ELSE>
                                             </IF>
                                          </ELSE>
                                       </IF>
                                    </DIV>
                                 </td>
                                 <td>
                                    <BR />
                                 </td>
                                 <td VALIGN="TOP" NOWRAP="NOWRAP" ALIGN="LEFT">
                                    <DIV class="small-text-inset">
                                       <ASSETTYPE.LIST LIST="atList" FIELD1="assettype" VALUE1="Variables.menu:assettype"/>
                                       <STRING.STREAM LIST="atList" COLUMN="description"/>
                                    </DIV>
                                 </td>
                                 <td>
                                    <BR />
                                 </td>
                              </tr>
                              <IF COND="Variables.rowStyle=tile-row-normal">
                                 <THEN>
                                    <SETVAR NAME="rowStyle" VALUE="tile-row-highlight"/>
                                 </THEN>
                                 <ELSE>
                                    <SETVAR NAME="rowStyle" VALUE="tile-row-normal"/>
                                 </ELSE>
                              </IF>
                           </LOOP>
                        </table>
                     </td>
                     <td class="tile-dark" nowrap="true" VALIGN="top" WIDTH="1">
                        <BR />
                     </td>
                  </tr>
                  <tr>
                     <td colspan="3" class="tile-dark" nowrap="true" VALIGN="TOP" HEIGHT="1">
                        <IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/>
                     </td>
                  </tr>
                  <tr>
                     <td></td>
                     <td background="Variables.cs_imagedir/graphics/common/screen/shadow.gif" REPLACEALL="Variables.cs_imagedir">
                        <IMG WIDTH="1" HEIGHT="5" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/>
                     </td>
                     <td></td>
                  </tr>
               </table>
               <div class="width-outer-70">
               <A HREF="Variables.NewStartMenuURL" REPLACEALL="Variables.NewStartMenuURL">
				  <CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/AddNewStartMenu"/></CALLELEMENT>
               </A>
               </div>
            </THEN>
         </IF>

         <IF COND="Variables.op=new">
            <THEN>
               <STARTMENU.CREATE OBJVARNAME="menuitem"/>
               <STARTMENUITEM.SCATTER NAME="menuitem" PREFIX="item:"/>

               <IF COND="IsVariable.Name=true">
               <THEN>
					<STRING.ENCODE VARIABLE="Name" VARNAME="Name" />
                   <SETVAR NAME="item:name" VALUE="Variables.Name"/>
               </THEN>
               </IF>

               <SETVAR NAME="item:sitessites" VALUE="Variables.empty"/>
               <SETVAR NAME="update:sitessites" VALUE="Variables.empty"/>

               <IF COND="Variables.action=edit">
               <THEN>
                  <STARTMENU.LOAD ID="Variables.startitem" OBJVARNAME="menuitem"/>
                  <STARTMENUITEM.SCATTER NAME="menuitem" PREFIX="item:"/>
                  <SETVAR NAME="AssetType" VALUE="Variables.item:assettype"/>
                  <SETVAR NAME="ItemType" VALUE="Variables.item:itemtype"/>

               </THEN>
               </IF>

               <SETVAR NAME="NeedMoreInfo" VALUE="false"/>
               <SETVAR NAME="WhichFlexType" VALUE="none"/>
               <IF COND="IsVariable.AssetType=true">
               <THEN>
                  <IF COND="IsVariable.Definition!=true">
                  <THEN>
                     <HASH.CONTAINS NAME="hFlexTypes" VALUE="Variables.AssetType" VARNAME="hasit"/>
                     <IF COND="Variables.hasit=true">
                     <THEN>
                        <SETVAR NAME="NeedMoreInfo" VALUE="true"/>
						<SETVAR NAME="WhichFlexType" VALUE="asset"/>
                     </THEN>
					 <ELSE>
					  <HASH.CONTAINS NAME="hFlexParentTypes" VALUE="Variables.AssetType" VARNAME="hasit"/>
					  <IF COND="Variables.hasit=true">
                      <THEN>
                        <SETVAR NAME="NeedMoreInfo" VALUE="true"/>
						<SETVAR NAME="WhichFlexType" VALUE="parent"/>
                      </THEN>
                     </IF>
					 </ELSE>
                     </IF>
                  </THEN>
				  <ELSE>
                  <HASH.CONTAINS NAME="hFlexTypes" VALUE="Variables.AssetType" VARNAME="hasit"/>
                  <IF COND="Variables.hasit=true"> 
                  <THEN>
                     <SETVAR NAME="WhichFlexType" VALUE="asset"/>
                  </THEN>
                  <ELSE>
                     <HASH.CONTAINS NAME="hFlexParentTypes" VALUE="Variables.AssetType" VARNAME="hasit"/>
                     <IF COND="Variables.hasit=true">
                     <THEN>
                        <SETVAR NAME="WhichFlexType" VALUE="parent"/>
                     </THEN>
                     </IF>
                  </ELSE>
                  </IF>
                  </ELSE>
                  </IF>
				  <IF COND="Variables.AssetType=Page">
				   <THEN>
					  <SETVAR NAME="WhichFlexType" VALUE="page"/>
                    </THEN>
                  </IF>
               </THEN>
               <ELSE>
                  <SETVAR NAME="NeedMoreInfo" VALUE="true"/>
               </ELSE>
               </IF>
               <IF COND="Variables.action=edit">
               <THEN>
                  <IF COND="Variables.NeedMoreInfo=true">
                  <THEN>
                     <SETVAR NAME="Definition" VALUE="Any"/>
                     <SETVAR NAME="NeedMoreInfo" VALUE="false"/>
                     <IF COND="Variables.item:assetsubtype!=Variables.empty">
                     <THEN>
                           <SETVAR NAME="Definition" VALUE="Variables.item:assetsubtype"/>
                           <FATM.GETGROUPTYPE  ASSETTYPE="Variables.item:assettype" VARNAME="grouptype"/>
                     </THEN>
                     </IF>
                  </THEN>
                  </IF>
               </THEN>
               </IF>
				<table class="width-outer-70" cellspacing="0" cellpadding="0" border="0">
				<tr><td>
               <span class="title-text">
                  <XLAT.STREAM KEY="dvin/UI/Admin/StartMenu"/>
               </span>
               	</td></tr>
				<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/TitleBar"/>
				</table>

               <IF COND="Variables.NeedMoreInfo=true">
               <THEN>

                  <table BORDER="0" CELLSPACING="0" CELLPADDING="0" class="width-outer-50">
                  <tr><td>
                        <table width="100%" cellpadding="0" cellspacing="0" border="0" bgcolor="#ffffff">
                           <CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
						   <tr>
                              <td class="form-label-text" NOWRAP="NOWRAP">
                                    <XLAT.STREAM KEY="dvin/Common/Name"/>:
                              </td>
                              <td class="form-inset">
                                    <IF COND="IsVariable.Name=false">
                                    <THEN>
                                       <SETVAR NAME="Name" VALUE="Variables.empty"/>
                                    </THEN>
                                    </IF>
							<INPUT TYPE="TEXT" NAME="Name" VALUE="Variables.Name" onkeypress="return noenter()" SIZE="32" MAXLENGTH="64" REPLACEALL="Variables.Name"/>
							<STRING.ENCODE VARIABLE="ItemType" VARNAME="ItemType"/>
                                     <INPUT TYPE="hidden" NAME="ItemType" VALUE="Variables.ItemType" REPLACEALL="Variables.ItemType"/>
                              </td>
                           </tr>
                           <CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
						   <tr>
                              <td class="form-label-text" NOWRAP="NOWRAP">
                                    <span class="alert-color">*</span><XLAT.STREAM KEY="dvin/Common/AssetType"/>:
                              </td>
                              <td class="form-inset">
                                     <SELECT NAME="AssetType"
                                             SIZE="10"
                                             ONCHANGE="if(GotoNextPage('StartMenuFront','new','cleardef')!=false){document.forms['AppForm'].submit(); return false;}">

                                       <CALLELEMENT NAME="OpenMarket/Xcelerate/Admin/ListAvailableAssetType">
											<ARGUMENT NAME="listname" VALUE="lAllTypes"/>
										</CALLELEMENT>
                                       <LOOP LIST="lAllTypes">
                                          <IF COND="Variables.AssetType=lAllTypes.assettype">
                                          <THEN>
                                             <OPTION VALUE="lAllTypes.assettype" SELECTED="yes" REPLACEALL="lAllTypes.assettype"><STRING.STREAM LIST="lAllTypes" COLUMN="description"/></OPTION>
                                          </THEN>
                                          <ELSE>
                                             <OPTION VALUE="lAllTypes.assettype" REPLACEALL="lAllTypes.assettype"><STRING.STREAM LIST="lAllTypes" COLUMN="description"/></OPTION>
                                          </ELSE>
                                          </IF>
                                       </LOOP>
                                    </SELECT>
                              </td>
                           </tr>
                           <IF COND="Variables.WhichFlexType=page">
                           <THEN>
                             <CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
							 <tr>
                                 <td class="form-label-text" NOWRAP="NOWRAP">
                                       <span class="alert-color">*</span><XLAT.STREAM KEY="dvin/FlexibleAssets/Common/FlexDefinition"/>:
                                 </td>
                                 <td class="form-inset">
                                      <ASSET.LIST TYPE="PageDefinition" LIST="lDefs" ORDER="name" EXCLUDEVOIDED="true"/>

                                      <SELECT NAME="Definition" SIZE="1"
                                               ONCHANGE="if(GotoNextPage('StartMenuFront','new')!=false){document.forms['AppForm'].submit(); return false;}">
                                               <OPTION VALUE="Any"><XLAT.STREAM KEY="dvin/Common/Any"/></OPTION>

                                               <LOOP LIST="lDefs">
                                                <OPTION VALUE="lDefs.name" REPLACEALL="lDefs.name"><STRING.STREAM LIST="lDefs" COLUMN="name"/></OPTION>                                           
                                             </LOOP>
                                      </SELECT>
                                 </td>
                              </tr>						   
						   </THEN>
						   <ELSE>
                           <IF COND="Variables.WhichFlexType!=none">
                           <THEN>
                              <CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
							  <tr>
                                 <td class="form-label-text" NOWRAP="NOWRAP">
                                       <span class="alert-color">*</span>
                                       <IF COND="Variables.WhichFlexType=asset">
                                       <THEN>
                                          <XLAT.STREAM KEY="dvin/FlexibleAssets/Common/FlexDefinition"/> 
                                       </THEN>
                                       <ELSE>
                                          <XLAT.STREAM KEY="dvin/FlexibleAssets/Common/FlexParentDefinition"/>
                                       </ELSE>
                                       </IF>
                                    :
                                 </td>
                                 <td class="form-inset">
                                       <IF COND="Variables.WhichFlexType=asset">
                                       <THEN>
                                           <!-- Use the Asset Template Manager to get the
                                                 1) FlexDefinition Type  and then the
                                                 2) list of Flex Asset Definitions
                                            -->
                                           <FATM.GETALL ASSETTYPE="Variables.AssetType" LISTVARNAME="lFamily"/>
               
                                       </THEN>
                                       <ELSE>
                                           <FGTM.GETALL ASSETTYPE="Variables.AssetType" LISTVARNAME="lFamily"/>
                                       </ELSE>
                                       </IF>
                                       <!--
                                           Populate the List for Flex Definitions
                                       -->
                                      <ASSET.LIST TYPE="lFamily.templatetype" LIST="lDefs" ORDER="name" EXCLUDEVOIDED="true"/>

                                      <SELECT NAME="Definition" SIZE="1"
                                               ONCHANGE="if(GotoNextPage('StartMenuFront','new')!=false){document.forms['AppForm'].submit(); return false;}">
                                               <OPTION VALUE="Any"><XLAT.STREAM KEY="dvin/Common/Any"/></OPTION>

                                               <LOOP LIST="lDefs">
                                                <OPTION VALUE="lDefs.name" REPLACEALL="lDefs.name"><STRING.STREAM LIST="lDefs" COLUMN="name"/></OPTION>                                           
                                             </LOOP>
                                      </SELECT>
                                 </td>
                              </tr>
                           </THEN>
                           </IF>
						   </ELSE>
						    </IF>
						   <STRING.ENCODE VARIABLE="WhichFlexType" VARNAME="WhichFlexType" />	
                           <INPUT TYPE="HIDDEN" NAME="WhichFlexType" VALUE="Variables.WhichFlexType" REPLACEALL="Variables.WhichFlexType"/>
                                           <!-- form buttons -->
						   <SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Admin/StartMenuFront" outstring="StartMenuFrontURL">
						   <satellite.argument name="cs_environment" value="Variables.cs_environment"/>
						   <satellite.argument name="cs_formmode" value="Variables.cs_formmode"/>
						   <satellite.argument name="op" value="list"/>
							</SATELLITE.LINK>
						   <IF COND="IsVariable.AssetType=true">
						   <THEN>
							  <SETVAR NAME="StartMenuFrontURL" VALUE="Variables.StartMenuFrontURL&#38;AssetType=Variables.AssetType"/>
						   </THEN>
						   </IF>
							<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/FooterBar"/>
							<TR>
								<TD class="form-label-text"></TD><TD class="form-inset">
								<XLAT.LOOKUP KEY="dvin/UI/Cancel" VARNAME="ForCancel" ESCAPE="true"/>
								<XLAT.LOOKUP KEY="dvin/UI/Cancel" VARNAME="ForCancelALT"/>
								 <A HREF="Variables.StartMenuFrontURL" onmouseover="window.status='Variables.ForCancel';return true;" onmouseout="window.status='';return true;" REPLACEALL="Variables.ForCancel,Variables.StartMenuFrontURL">
									<CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/Cancel"/></CALLELEMENT>
								</A>
								<XLAT.LOOKUP KEY="dvin/AT/Common/Continue" VARNAME="ForContinue" ESCAPE="true"/>
								<XLAT.LOOKUP KEY="dvin/AT/Common/Continue" VARNAME="ForContinueALT"/>
								 <A HREF="javascript:void(0)" onclick="if(GotoNextPage('StartMenuFront','new')!=false){document.forms['AppForm'].submit(); return false;}" onmouseover="window.status='Variables.ForContinue';return true;" onmouseout="window.status='';return true;" REPLACEALL="Variables.ForContinue">
									<CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/Continue"/></CALLELEMENT>
								</A>
								</TD>
							</TR>
						</table>
                     </td></tr>
                  </table>
                  
               </THEN>
		       <ELSE>

               <IF COND="Variables.action=update">
               <THEN>
                  <SETVAR NAME="update:processesprocessTotal" VALUE="0"/>
                  <IF COND="IsVariable.item:process=true">
                     <THEN>
                        <SETVAR NAME="update:processesprocessTotal" VALUE="1"/>
                        <SETVAR NAME="update:processesprocess0" VALUE="Variables.item:process"/>
                     </THEN>
                  </IF>
                  <IF COND="IsVariable.update:sarguments=true">
                     <THEN>
                        <STRINGLIST STR="Variables.update:sarguments" NAME="largs" DELIM=";"/>
                        <SETVAR NAME="update:argumentsargumentTotal" VALUE="largs.#numRows"/>
                        <SETCOUNTER NAME="currentArg" VALUE="0"/>
                        <LOOP LIST="largs">
                           <STRINGLIST STR="largs.ITEM" NAME="pairs" DELIM="="/>
                           <LOOP LIST="pairs">
                              <SETVAR NAME="update:argumentsargumentCounters.currentArgname" VALUE="pairs.ITEM"/>
                              <SETROW LIST="pairs" ACTION="NEXT"/>
                              <SETVAR NAME="update:argumentsargumentCounters.currentArgvalue" VALUE="pairs.ITEM"/>
                           </LOOP>
                           <INCCOUNTER NAME="currentArg" VALUE="1"/>
                        </LOOP>
                     </THEN>
                  </IF>

                  <IF COND="IsVariable.legal=true">
                     <THEN>
                        <STRINGLIST NAME="legalargs" STR="Variables.legal" DELIM=";"/>
                        <SETVAR NAME="update:legalargsargumentTotal" VALUE="legalargs.#numRows"/>
                        <SETCOUNTER NAME="currentArg" VALUE="0"/>
                        <LOOP LIST="legalargs">
                           <SUBSTRING STR="legalargs.ITEM" OUTSTR="reqflag" ENDINDEX="1"/>
                           <SUBSTRING STR="legalargs.ITEM" OUTSTR="thearg" INDEX="1"/>


                           <SETVAR NAME="update:legalargsargumentCounters.currentArgname" VALUE="Variables.thearg"/>
                           <IF COND="Variables.reqflag=R">
                              <THEN>
                                 <SETVAR NAME="update:legalargsargumentCounters.currentArgrequired" VALUE="true"/>
                              </THEN>
                              <ELSE>
                                 <SETVAR NAME="update:legalargsargumentCounters.currentArgrequired" VALUE="false"/>
                              </ELSE>
                           </IF>
                           <INCCOUNTER NAME="currentArg" VALUE="1"/>
                        </LOOP>
                     </THEN>
                  </IF>
                  <STARTMENUITEM.GATHER NAME="menuitem" PREFIX="update:"/>
                  <STARTMENUITEM.SCATTER NAME="menuitem" PREFIX="item:"/>
                  <SETVAR NAME="item:sitessites" VALUE="Variables.empty"/>
               </THEN>
               </IF>


               <IF COND="IsVariable.item:id=true">
                  <THEN>
					<STRING.ENCODE VARIABLE="item:id" VARNAME="item:id"/>
                     <INPUT TYPE="HIDDEN" NAME="item:id" VALUE="Variables.item:id" REPLACEALL="Variables.item:id"/>
                  </THEN>
               </IF>
			   <STRING.ENCODE VARIABLE="item:processinput" VARNAME="item:processinput"/>
               <INPUT TYPE="HIDDEN" NAME="item:processinput" VALUE="Variables.item:processinput" REPLACEALL="Variables.item:processinput"/>
			   <STRING.ENCODE VARIABLE="item:participantinput" VARNAME="item:participantinput"/>
               <INPUT TYPE="HIDDEN" NAME="item:participantinput" VALUE="Variables.item:participantinput" REPLACEALL="Variables.item:participantinput"/>
			   <STRING.ENCODE VARIABLE="item:siteinput" VARNAME="item:siteinput"/>
               <INPUT TYPE="HIDDEN" NAME="item:siteinput" VALUE="Variables.item:siteinput" REPLACEALL="Variables.item:siteinput"/>

               <table BORDER="0" CELLSPACING="0" CELLPADDING="0" class="width-outer-70">
                  <tr><td>
                        <table class="width-inner-100" cellpadding="0" cellspacing="0" border="0" bgcolor="#ffffff">   
							<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>	                       
                           <tr>
                              <td class="form-label-text" NOWRAP="NOWRAP">
                                    <span class="alert-color">*</span><XLAT.STREAM KEY="dvin/Common/Name"/>:
                              </td>
                              <td class="form-inset">
                                    <INPUT TYPE="TEXT" NAME="item:name" VALUE="Variables.item:name" onkeypress="return noenter()" SIZE="32" MAXLENGTH="64" REPLACEALL="Variables.item:name"/>
                              </td>
                           </tr>
                           
                           <callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>	
						   <tr>
                              <td class="form-label-text">
                                    <XLAT.STREAM KEY="dvin/Common/Description"/>:
                              </td>
                              <td class="form-inset">
									<SETVAR NAME="OutputQString" VALUE="Variables.empty"/>
									<STRING.ENCODE VARIABLE="item:description" VARNAME="OutputQString"/>
                                    <INPUT TYPE="TEXT" NAME="item:description" VALUE="Variables.OutputQString" onkeypress="return noenter()" SIZE="32" MAXLENGTH="255" REPLACEALL="Variables.OutputQString"/>
                              </td>
                              <td>
                                 <BR />
                              </td>
                           </tr>
                          
                           <callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>	
						   <tr>
                              <td class="form-label-text">
                                    <XLAT.STREAM KEY="dvin/Common/Type"/>:
                              </td>
                              <td class="form-inset">
                                   <!-- Added New Configurable StartMenu  -->
								<ASSET.GetAssetTypeProperties TYPE="Variables.AssetType"/>
									<SELECT NAME="item:itemtype" ONCHANGE="hideDefaultAndWorkflowSections();">
									<IF COND="Variables.IsProxyAssetType=true">
										<THEN>
											<OPTION VALUE="Search" SELECTED="yes">
													<XLAT.STREAM KEY="dvin/Common/Search"/>
											</OPTION>
										</THEN>
										<ELSE>
											<OPTION VALUE="ContentForm">
												 <XLAT.STREAM KEY="dvin/Common/New"/>
											</OPTION>

											<IF COND="Variables.ItemType=Search">
											  <THEN>
												 <OPTION VALUE="Search" SELECTED="yes">
													<XLAT.STREAM KEY="dvin/Common/Search"/>
												 </OPTION>
												 <OPTION VALUE="InsiteForm">
													<XLAT.STREAM KEY="dvin/UI/Admin/NewInsite"/>
												</OPTION>
												<OPTION VALUE="Word">
													<XLAT.STREAM KEY="dvin/UI/CSDesktop"/>
												</OPTION>
												<OPTION VALUE="CSDocLink">
													<XLAT.STREAM KEY="dvin/UI/Admin/CSDocLink"/>
												</OPTION>
											  </THEN>
											  <ELSE>
												 <OPTION VALUE="Search">
													<XLAT.STREAM KEY="dvin/Common/Search"/>
												 </OPTION>
												 
												 <IF COND="Variables.ItemType=InsiteForm">
													<THEN>
														<OPTION VALUE="InsiteForm" SELECTED="yes">
															<XLAT.STREAM KEY="dvin/UI/Admin/NewInsite"/>
														</OPTION>
														<OPTION VALUE="Word">
															<XLAT.STREAM KEY="dvin/UI/CSDesktop"/>
														</OPTION>
														<OPTION VALUE="CSDocLink">
															<XLAT.STREAM KEY="dvin/UI/Admin/CSDocLink"/>
														</OPTION>
													</THEN>
													<ELSE>
														<OPTION VALUE="InsiteForm">
															<XLAT.STREAM KEY="dvin/UI/Admin/NewInsite"/>
														</OPTION>
													
														<IF COND="Variables.ItemType=Word">
															<THEN>
																<OPTION VALUE="Word" SELECTED="yes">
																	<XLAT.STREAM KEY="dvin/UI/CSDesktop"/>
																</OPTION>
																<OPTION VALUE="CSDocLink">
																	<XLAT.STREAM KEY="dvin/UI/Admin/CSDocLink"/>
																</OPTION>
															</THEN>
														<ELSE>
															<OPTION VALUE="Word">
																<XLAT.STREAM KEY="dvin/UI/CSDesktop"/>
															</OPTION>
															<IF COND="Variables.ItemType=CSDocLink">
																<THEN>
																	<OPTION VALUE="CSDocLink" SELECTED="yes">
																		<XLAT.STREAM KEY="dvin/UI/Admin/CSDocLink"/>
																	</OPTION>
																</THEN>
																<ELSE>
																	<OPTION VALUE="CSDocLink">
																		<XLAT.STREAM KEY="dvin/UI/Admin/CSDocLink"/>
																	</OPTION>
															 
																</ELSE>
																</IF>
														  </ELSE>
													   </IF>
													</ELSE>
												 </IF>
											  </ELSE>
										   </IF>
										</ELSE>
									</IF>		

                                    </SELECT>    
                              </td>
                              <td>
                                 <BR />
                              </td>
                           </tr>
                          
                           <SETVAR NAME="item:assettype" VALUE="Variables.AssetType"/>
                           <callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>	
						   <tr>
                              <td class="form-label-text" NOWRAP="NOWRAP">
                                 <NOBR>
                                       <XLAT.STREAM KEY="dvin/UI/AssetType"/>:
                                 </NOBR>
                              </td>
                              <td class="form-inset">
                                    <SETVAR NAME="errno" VALUE="0"/>
                                    <ASSETTYPE.LIST LIST="atList" FIELD1="assettype" VALUE1="Variables.AssetType"/>
									<STRING.ENCODE VARIABLE="AssetType" VARNAME="AssetType"/>
							<INPUT TYPE="HIDDEN" NAME="item:assettype" VALUE="Variables.AssetType" REPLACEALL="Variables.AssetType"/>
							<INPUT TYPE="HIDDEN" NAME="AssetType" VALUE="Variables.AssetType" REPLACEALL="Variables.AssetType"/>
									<SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Admin/AssetTypeFront" outstring="urlassettypefront">
										<satellite.argument name="cs_environment" value="Variables.cs_environment"/>
										<satellite.argument name="cs_formmode" value="Variables.cs_formmode"/>
										<satellite.argument name="action" value="details"/>
										<satellite.argument name="assettype" value="Variables.AssetType"/>
									</SATELLITE.LINK>
									<XLAT.LOOKUP KEY="dvin/Common/Inspect" VARNAME="_XLAT_" ESCAPE="true"/>
                                    <a HREF="Variables.urlassettypefront" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true" REPLACEALL="Variables.urlassettypefront,Variables._XLAT_"><STRING.STREAM LIST="atList" COLUMN="description"/></a>
                              </td>
                              <td>
                                 <BR />
                              </td>
                           </tr>

                          
                           <IF COND="IsVariable.Definition=true">
                           <THEN>
							  <STRING.ENCODE VARIABLE="Definition" VARNAME="Definition"/>
                              <INPUT TYPE="HIDDEN" NAME="Definition" VALUE="Variables.Definition" REPLACEALL="Variables.Definition"/>
							  <STRING.ENCODE VARIABLE="WhichFlexType" VARNAME="WhichFlexType" />
                              <INPUT TYPE="HIDDEN" NAME="WhichFlexType" VALUE="Variables.WhichFlexType" REPLACEALL="Variables.WhichFlexType"/>
                              <IF COND="Variables.Definition!=Any">
                              <THEN>
								 <IF COND="Variables.WhichFlexType=asset">
                                 <THEN>
                                    <FATM.GETALL ASSETTYPE="Variables.AssetType" LISTVARNAME="lFamily"/>
									<SETVAR NAME="templatetype" VALUE="lFamily.templatetype"/>
                                 </THEN>
                                 <ELSE>
                                   <IF COND="Variables.WhichFlexType=page">
									<THEN>	
										<SETVAR NAME="templatetype" VALUE="PageDefinition"/>
									</THEN>
									<ELSE>
								       <FGTM.GETALL ASSETTYPE="Variables.AssetType" LISTVARNAME="lFamily"/>
									   <SETVAR NAME="templatetype" VALUE="lFamily.templatetype"/>
									</ELSE>
                                  </IF>
                                 </ELSE>
                                 </IF>

                               <!--
                                   Get Flex Definition Selected Name and ID
                                 -->
							
                               <ASSET.LIST TYPE="Variables.templatetype" LIST="lDef" FIELD1="name" VALUE1="Variables.Definition"/>

                              </THEN>
                              <ELSE>
                                 <XLAT.LOOKUP KEY="dvin/Common/Any" VARNAME="_XLAT_"/>
                                 <LISTOBJECT.CREATE NAME="Def" COLUMNS="name"/>
                                 <LISTOBJECT.ADDROW NAME="Def" name="[Variables._XLAT_]"/>
                                 <LISTOBJECT.TOLIST NAME="Def" LISTVARNAME="lDef"/>
                              </ELSE>
                              </IF>
                              
							  <callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>	
							  <tr>
                                 <td class="form-label-text" NOWRAP="NOWRAP">
                                    <NOBR>
                                          <IF COND="Variables.WhichFlexType=asset">
                                          <THEN>
                                             <XLAT.STREAM KEY="dvin/FlexibleAssets/Common/FlexDefinition"/>
                                          </THEN>
                                          <ELSE>
										     <IF COND="Variables.WhichFlexType=page">
											<THEN>	
												<XLAT.STREAM KEY="dvin/FlexibleAssets/Common/FlexDefinition"/>
											</THEN>
											<ELSE>
                                             <XLAT.STREAM KEY="dvin/FlexibleAssets/Common/FlexParentDefinition"/>
											 </ELSE>
                                          </IF>
                                          </ELSE>
                                          </IF>:
                                    </NOBR>
                                 </td>
                                 <td class="form-inset">
                                       <STRING.STREAM LIST="lDef" COLUMN="name"/>
                                 </td>
                                 <td>
                                    <BR />
                                 </td>
                              </tr>

                             
                           </THEN>
                           </IF>
							
					<CALLELEMENT NAME="OpenMarket/Xcelerate/Util/CheckIgnoreAssettypesForDefaultValues">
						<ARGUMENT NAME="AssetType" VALUE="Variables.item:assettype"/>
						<ARGUMENT NAME="whichflextype"  VALUE="Variables.WhichFlexType"/>
						<ARGUMENT NAME="flexdefinition" VALUE="Variables.Definition"/>
					</CALLELEMENT>
					
					<IF COND="Variables.IgnoreAT!=true">
					<THEN>
                           <callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>	
						   <tr id="defaultValuesSection">
                              <td class="form-label-text" NOWRAP="NOWRAP">
                                 <NOBR>
                                       <XLAT.STREAM KEY="dvin/UI/Admin/DefaultValues" />
                                 </NOBR>
                              </td>
                              <td class="form-inset">
                                    <IF COND="IsVariable.Definition=false">
                                      <THEN>
                                              <!--
                                                  /**
                                                   * Returns association definitions for a given asset type (and subtype).
                                                   *
                                                   * @param subtype subtype name, if any.
                                                   */
                                               -->
                                             <CALLELEMENT NAME="OpenMarket/Xcelerate/Util/GetAssetAssociations">
                                               <ARGUMENT NAME="AssetType"  VALUE="Variables.item:assettype"/>
                                               <ARGUMENT NAME="SubType"    VALUE=""/>
                                             </CALLELEMENT>
                                      </THEN>
                                    </IF> 

                                   <CALLELEMENT NAME="OpenMarket/Xcelerate/Util/GetAssetFields">
                                       <ARGUMENT NAME="AssetType"      VALUE="Variables.item:assettype"/>
                                       <ARGUMENT NAME="whichflextype"  VALUE="Variables.WhichFlexType"/>
                                       <ARGUMENT NAME="flexdefinition" VALUE="Variables.Definition"/>
                                    </CALLELEMENT>

                                    <TABLE CELLSPACING="0" CELLPADDING="5" BORDER="0">
                                       <TR>
                                          <TD VALIGN="TOP">
                                             <TABLE CELLSPACING="0" CELLPADDING="0" BORDER="0">
                                                <TR>
                                                   <!--
                                                       Get ALL Defualt Attributes the generated List Groups
                                                     -->
                                                   <STRINGLIST NAME="lFields" STR="Variables.fields" DELIM=";"/>
                                                   <TD>
                                                      <XLAT.STREAM KEY="dvin/Common/Field"/>:&nbsp;
                                                    </TD>
                                                   <TD>

                                                      <!--Construct the default fields pulldown ivan -->
                                                      <SELECT NAME="legalname"
                                                              ONCHANGE="installArgTypeLookUpTables( document.forms[0].elements['legalname'] ) ;  ShowValue(document.forms[0].elements['AddButton'],document.forms[0].elements['legalname']);"
                                                              SIZE="1">
                                                         <LOOP LIST="lFields">
                                                             <BEGINS STR="lFields.ITEM" WHAT="*-"/>
                                                             <IF COND="Variables.errno=1">
                                                               <THEN>
                                                                   <OPTION value="!*" disabled="disabled">
                                                                     <STRING.STREAM LIST="lFields" COLUMN="ITEM"/>  </OPTION>
                                                               </THEN>
                                                               <ELSE>
                                                                   
                                                                       <IF COND="lFields.#curRow=2" >
                                                                           <THEN>
                                                                               <OPTION SELECTED="yes">
                                                                                  <STRING.STREAM LIST="lFields" COLUMN="ITEM"/>  </OPTION>
                                                                           </THEN>
                                                                           <ELSE>
                                                                               <OPTION/>
                                                                                <STRING.STREAM LIST="lFields" COLUMN="ITEM"/>
                                                                           </ELSE>
                                                                       </IF>
                                                                   
                                                               </ELSE>
                                                             </IF>

                                                           
                                                         </LOOP>
                                                      </SELECT>

                                                   </TD>
                                                </TR>
                                                <callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>	
                                                <TR>
                                                   <TD>
                                                      <XLAT.STREAM KEY="dvin/UI/Admin/UCValue"/>:&nbsp;
                                                   </TD>
                                                   <TD>
                                                       <!--
                                                            Build associated Display Fields for default values
                                                         -->

                                                       <CALLELEMENT NAME="OpenMarket/Xcelerate/Admin/ShowStartMenuArgs"/>
                                                   </TD>
                                                </TR>
                                             </TABLE>
                                          </TD>
                                          <TD VALIGN="TOP">
                                             <BR/>
                                          </TD>
                                          <TD VALIGN="TOP">
                                             <INPUT TYPE="hidden" NAME="EditDirty" VALUE="Yes" REPLACEALL="Variables.EditDirty"/>
                                             <!--  edit Default Values Pulldown list -->

                                             <SELECT NAME="item:sarguments"
                                                     SIZE="10" 
                                                     MULTIPLE="yes"
                                                     ONLOAD="setEditArgTable( document.forms[0].elements['item:sarguments'] ) ;return true;"
                                                     ONCHANGE="installArgTypeLookUpTables( document.forms[0].elements['legalname'] ) ; showStatus(document.forms[0].elements['item:sarguments']);return true;"
                                                     ONMOUSEOUT="window.status=' ';return true;">

                                                <IF COND="Variables.item:argumentsargumentTotal!=0">
                                                   <THEN>

                                                      <HASH.CREATE NAME="hPermissionsToSave"/>
                                                      <SETCOUNTER NAME="currentArg" VALUE="0"/>

                                                      <LOOP COUNT="Variables.item:argumentsargumentTotal">

                                                         <SETVAR NAME="argname" VALUE="Variables.item:argumentsargumentCounters.currentArgname"/>
                                                         <SETVAR NAME="argval" VALUE="Variables.item:argumentsargumentCounters.currentArgvalue"/>
                                                         <SETVAR NAME="errno" VALUE="0"/>

                                                         <!-- Edit Mode Process the Default Argument and assigned values 
                                                              For all Attribute values of type Asset References ( CHILD )  the Asset
                                                              is formatted with  ${AssetType}:${AssetID} MUST parse and diaplay the
                                                              Asset name
                                                           -->

                                                         <BEGINS STR="Variables.argname" WHAT="cs_Permission_"/>
                                                         <IF COND="Variables.errno=0">
                                                         <THEN>
                                                             <IF COND="IsVariable.Definition=true">
                                                             <THEN>
                                                                 <!-- vador  Is the a Parent Def Group SV or MV
                                                                      Field with a Assigned Associated Asset
                                                                  -->
                                                                 <BEGINS STR="Variables.argname" WHAT="Group_"/>
                                                                   <IF COND="Variables.errno=1">
                                                                   <THEN>
                                                                          <FATM.GETGROUPTYPE    ASSETTYPE="Variables.item:assettype" VARNAME="grouptype"/>

                                                                          <ASSET.LOAD NAME="parentAsset" TYPE="Variables.grouptype" FIELD="id" VALUE="Variables.argval"  />
                                                                          <ASSET.GET NAME="parentAsset" FIELD="name" OUTPUT="parentName" />

                                                                          <SETVAR NAME="displayThis" VALUE="Variables.parentName"/>


                                                                    </THEN>
                                                                    <ELSE>
                                                                        <!--
                                                                             Check if this is an asset reference
                                                                             Gather-yoda the Named Associations field specially
                                                                          -->
                                                                        <BEGINS STR="Variables.argname" WHAT="Association-named:"/>
                                                                        <IF COND="Variables.errno=1">
                                                                        <THEN>
                                                                         <STRINGLIST STR="Variables.argval" DELIM=":" NAME="mylist"/>
                                                                         <IF COND="mylist.#numRows=2">
                                                                         <THEN>
                                                                           <LOOP LIST="mylist">
                                                                               <IF COND="mylist.#curRow=1">
                                                                               <THEN>
                                                                                  <setvar NAME="childassettype" VALUE="mylist.ITEM"/>
                                                                               </THEN>
                                                                               <ELSE>
                                                                                  <setvar NAME="childassetid" VALUE="mylist.ITEM"/>
                                                                                </ELSE>
                                                                                </IF>
                                                                           </LOOP>
                                                                           <ASSET.LOAD NAME="myChildAsset" TYPE="Variables.childassettype" OBJECTID="Variables.childassetid"/>
                                                                           <ASSET.GET NAME="myChildAsset" FIELD="name" OUTPUT="childname"/>
                                                                           <SETVAR NAME="displayThis" VALUE="Variables.childname"/>
                                                                           </THEN>
                                                                          </IF>
                                                                         </THEN>
                                                                        <ELSE>
                                                                            <!-- Is Default value a Asset Reference -->
                                                                            <STRINGLIST STR="Variables.argval" DELIM=":" NAME="asset"/>
                                                                            <IF COND="asset.#numRows=2">
                                                                            <THEN>
                                                                                <SETROW LIST="asset" ACTION="FIRST"/>
                                                                                <SETVAR NAME="type" VALUE="asset.ITEM"/>
                                                                                <SETROW LIST="asset" ACTION="NEXT"/>
                                                                                <SETVAR NAME="id" VALUE="asset.ITEM"/>
                                                                                <ASSET.LOAD NAME="myChildAsset" TYPE="Variables.type" OBJECTID="Variables.id"/>
                                                                                <ASSET.GET NAME="myChildAsset" FIELD="name" OUTPUT="childname"/>
                                                                                <SETVAR NAME="displayThis" VALUE="Variables.childname"/>                                                                 </THEN>
                                                                            <ELSE>
                                                                                <setvar name="displayThis"    VALUE="Variables.argval" />

                                                                                <!-- <INSPECTOR.GETVALUE  ATTRIBUTE="Variables.argname" VALUE="Variables.argval" TYPE="Variables.AssetType" SUBTYPE="Variables.Definition" VARNAME="displayThis"/>   -->
                                                                            </ELSE>
                                                                            </IF>

                                                                        </ELSE>
                                                                       </IF>
                                                                    </ELSE>
                                                                   </IF>
                                                            </THEN>
                                                          <ELSE>
                                                              <!-- Gather-yoda the Named Associations field specially -->
                                                              <BEGINS STR="Variables.argname" WHAT="Association-named:"/>
                                                              <IF COND="Variables.errno=1">
                                                              <THEN>
                                                                 <STRINGLIST STR="Variables.argval" DELIM=":" NAME="mylist"/>
                                                                 <IF COND="mylist.#numRows=2">
                                                                 <THEN>
                                                                    <LOOP LIST="mylist">

                                                                      <IF COND="mylist.#curRow=1">
                                                                       <THEN>
                                                                            <setvar NAME="childassettype" VALUE="mylist.ITEM"/>
                                                                        </THEN>
                                                                        <ELSE>
                                                                            <setvar NAME="childassetid" VALUE="mylist.ITEM"/>
                                                                        </ELSE>
                                                                       </IF>
                                                                    </LOOP>
                                                                    <ASSET.LOAD NAME="myChildAsset" TYPE="Variables.childassettype" OBJECTID="Variables.childassetid"/>
                                                                    <ASSET.GET NAME="myChildAsset" FIELD="name" OUTPUT="childname"/>
                                                                    <SETVAR NAME="displayThis" VALUE="Variables.childname"/>
                                                                  </THEN>
                                                                  </IF>
                                                                  </THEN>
                                                                <ELSE>
                                                                     <INSPECTOR.GETVALUE  ATTRIBUTE="Variables.argname" VALUE="Variables.argval" TYPE="Variables.AssetType" VARNAME="displayThis"/>
                                                                </ELSE>
                                                               </IF>
                                                          </ELSE>
                                                            </IF>
                                                             <SUBSTITUTE STR="Variables.argval" WHAT="=" WITH="__EQ__" OUTSTR="argval"/>
                                                             <SUBSTITUTE STR="Variables.argval" WHAT=";" WITH="__SEMI__" OUTSTR="argval"/>
                                                             <SETVAR NAME="textName" VALUE="Variables.argname"/>
															 
															<IF COND="Variables.textName=Dimension">
															<THEN>
																<ASSET.LOAD NAME="dimAsset" TYPE="Dimension" FIELD="id" VALUE="Variables.displayThis" />
																<ASSET.GET NAME="dimAsset" FIELD="name" OUTPUT="dimName" />
																<OPTION VALUE="Variables.argname=Variables.argval" REPLACEALL="Variables.argname,Variables.argval">
																	<STRING.STREAM VALUE="Variables.textName="/><STRING.STREAM VARIABLE="dimName"/>
																 </OPTION>																	
															</THEN>
															<ELSE>
	                                                             <IF COND="IsVariable.Definition=true">
	                                                             <THEN>
	                                                                <IF COND="Variables.textName!=subtype">
	                                                                <THEN>
                                                                         <!-- yogi -->
                                                                         <!-- TODO  Must Extract Argument prefix
                                                                              a) Attribute_
                                                                              b) Group_
                                                                              c) Association_named:
                                                                              from both Variables.textName and Variables.argname
                                                                           -->

                                                                        <SUBSTITUTE STR="Variables.textName" WHAT="Group_" WITH="" OUTSTR="textName"/>
                                                                        <SUBSTITUTE STR="Variables.argname"  WHAT="Group_" WITH="" OUTSTR="argname"/>
                                                                        <SUBSTITUTE STR="Variables.textName" WHAT="Attribute_" WITH="" OUTSTR="textName"/>
                                                                        <SUBSTITUTE STR="Variables.argname"  WHAT="Attribute_" WITH="" OUTSTR="argname"/>
                                                                        <SUBSTITUTE STR="Variables.textName" WHAT="Association-named:" WITH="" OUTSTR="textName"/>
                                                                        <SUBSTITUTE STR="Variables.argname"  WHAT="Association-named:" WITH="" OUTSTR="argname"/>

                                                                        <OPTION VALUE="Variables.argname=Variables.argval" REPLACEALL="Variables.argname,Variables.argval">
																			<STRING.STREAM VALUE="Variables.textName="/><STRING.STREAM VARIABLE="displayThis"/>
																		 </OPTION>
	                                                                </THEN>
	                                                                </IF>
	                                                             </THEN>
	                                                             <ELSE>
																	<OPTION VALUE="Variables.argname=Variables.argval" REPLACEALL="Variables.argname,Variables.argval">
																		<STRING.STREAM VALUE="Variables.textName="/><STRING.STREAM VARIABLE="displayThis"/>
																	 </OPTION>
	                                                             </ELSE>
	                                                             </IF>
															</ELSE>
															</IF>
                                                         </THEN>
                                                         <ELSE>
                                                             <HASH.ADD NAME="hPermissionsToSave" VALUE="Variables.argname=Variables.argval"/>
                                                         </ELSE>
                                                         </IF>
                                                         <INCCOUNTER NAME="currentArg" VALUE="1"/>
                                                      </LOOP>
                                                      <HASH.HASDATA NAME="hPermissionsToSave" VARNAME="hasit"/>
                                                      <IF COND="Variables.hasit=true">
                                                      <THEN>
                                                          <HASH.TOSTRING NAME="hPermissionsToSave" VARNAME="cs_Permissions" DELIM=","/>
                                                          <input type="hidden" name="cs_Permissions" value="Variables.cs_Permissions" REPLACEALL="Variables.cs_Permissions"/>
                                                      </THEN>
                                                      </IF>
                                                </THEN>
                                                </IF>
                                                <option VALUE="-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</option>
                                             </SELECT>

                                          </TD>
                                       </TR>
                                       <callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>	
									   <TR>
                                           <TD class="inline-right">

                                              <SETVAR NAME="currentStyle" VALUE="display:inline;"/>

                                            <!-- <INPUT TYPE="TEXT" NAME="AddButton" ID="yoda1"  STYLE="Variables.currentStyle" REPLACEALL="Variables.currentStyle " VALUE="enter "/>
                                                -->
                                             <XLAT.LOOKUP KEY="dvin/Common/Add" VARNAME="mouseover" ESCAPE="true"/>
                                            <A NAME="AddButton_1" ID="AddButton_1" STYLE="Variables.currentStyle" HREF="javascript:void(0);"
                                                onmouseover="window.status='Variables.mouseover';return true;"
                                                onmouseout="window.status='';return true;"
                                                onclick="installArgTypeLookUpTables(document.forms[0].elements['legalname']) ; movedefargright( document.forms[0].elements['legalname'],document.forms[0].elements['item:sarguments'] );"
                                                REPLACEALL="Variables.currentStyle,Variables.mouseover">
												<CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/Add"/></CALLELEMENT>
                                            </A>
                                          </TD>
                                          <TD></TD>
                                          <TD class="inline-right">
                                             <XLAT.LOOKUP KEY="dvin/Common/Remove" VARNAME="mouseover" ESCAPE="true"/>
                                             <A NAME="RemoveButton_1" ID="RemoveButton_1" STYLE="Variables.currentStyle" HREF="javascript:void(0);"
                                                onmouseover="window.status='Variables.mouseover';return true;"
                                                onmouseout="window.status='';return true;"
                                                onclick="installArgTypeLookUpTables( document.forms[0].elements['legalname'] ) ; removearg(document.forms[0].elements['item:sarguments'])" 
                                                REPLACEALL="Variables.currentStyle,Variables.mouseover">
                                                <CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/Remove"/></CALLELEMENT>
                                             </A>
                                          </TD>
                                       </TR>
                                    </TABLE>
                              </td>
                              <td>
                                 <BR />
                              </td>

                           </tr>
						</THEN>
						</IF>  
                          <!--
                             All Related Named Associations SV MV
                             needs to be collected and added to
                             Default Values Attributes Pulldown
                           -->

                           <!-- <CALLELEMENT NAME="OpenMarket/Xcelerate/Util/GetAssetAssociations">
                              <ARGUMENT NAME="AssetType"  VALUE="Variables.item:assettype"/>
                               <ARGUMENT NAME="subtypname" VALUE="Variables.Definition"/>
                           </CALLELEMENT> -->

                           <!--<tr id="defaultValuesHr">
                              <td colspan="3" class="light-line-color">
                                 <img height="1" width="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/>
                              </td>
                           </tr>-->
                           <callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>	
						   <tr>
                              <td class="form-label-text" NOWRAP="NOWRAP">
                                    <IF COND="IsVariable.siteid!=true">
                                       <THEN>
                                          <span class="alert-color">*</span>
                                          <XLAT.STREAM KEY="dvin/Common/Sites"/>
:</THEN>
                                       <ELSE>
                                          <XLAT.STREAM KEY="dvin/Common/Site"/>
:</ELSE>
                                    </IF>
                              </td>
                              <td class="form-inset">
                                    <IF COND="IsVariable.siteid!=true">
                                       <THEN>
                                          <SETVAR NAME="errno" VALUE="0"/>
                                          <PUBLICATION.LIST LIST="PublicationResults"/>
                                          <IF COND="IsList.PublicationResults=true">
                                             <THEN>
                                                <IF COND="Variables.item:legalsitessites!=Variables.empty">
                                                   <THEN>
                                                      <STRINGLIST NAME="selSites" STR="Variables.item:legalsitessites" DELIM=";"/>
                                                      <HASH.CREATE NAME="selectedSites" LIST="selSites" COLUMN="ITEM"/>
                                                   </THEN>
                                                   <ELSE>
                                                      <HASH.CREATE NAME="selectedSites"/>
                                                   </ELSE>
                                                </IF>
                                                <IF COND="PublicationResults.#numRows!=0">
                                                   <THEN>
                                                      <SELECT NAME="item:legalsitessites" MULTIPLE="yes" SIZE="8">
                                                         <IF COND="Variables.item:legalsitessites=_ALL_">
                                                            <THEN>
                                                               <OPTION  SELECTED="yes" VALUE="_ALL_">
                                                                  <XLAT.STREAM KEY="dvin/Common/Any"/>
                                                               </OPTION>
                                                            </THEN>
                                                            <ELSE>
                                                               <OPTION VALUE="_ALL_">
                                                                  <XLAT.STREAM KEY="dvin/Common/Any"/>
                                                               </OPTION>
                                                            </ELSE>
                                                         </IF>

                                                         <LOOP LIST="PublicationResults">
                                                            <HASH.CONTAINS NAME="selectedSites" VALUE="PublicationResults.id" VARNAME="hasit"/>
                                                            <IF COND="Variables.hasit=true">
                                                               <THEN>
                                                                  <OPTION SELECTED="yes" VALUE="PublicationResults.id" REPLACEALL="PublicationResults.id">
                                                                     <STRING.STREAM VALUE="PublicationResults.name"/>
                                                                  </OPTION>
                                                               </THEN>
                                                               <ELSE>
                                                                  <OPTION VALUE="PublicationResults.id" REPLACEALL="PublicationResults.id">
                                                                     <STRING.STREAM VALUE="PublicationResults.name"/>
                                                                  </OPTION>
                                                               </ELSE>
                                                            </IF>
                                                         </LOOP>
                                                      </SELECT>
                                                   </THEN>
                                                   <ELSE>
									[
                                                      <XLAT.STREAM KEY="dvin/UI/Admin/NoPublicationsAvailable"/>
]
                                                   </ELSE>
                                                </IF>
                                             </THEN>
                                          </IF>
                                       </THEN>
                                       <ELSE>
                                          <STRING.STREAM VALUE="Variables.siteid"/>
                                          <BR/>
                                       </ELSE>
                                    </IF>
                              </td>
                              <td>
                                 <BR />
                              </td>
                           </tr>
                          <!-- <tr>
                              <td colspan="3" class="light-line-color">
                                 <img height="1" width="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/>
                              </td>
                           </tr>-->
                           <callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
                           <tr>
                              <td class="form-label-text">
                                    <span class="alert-color">*</span><XLAT.STREAM KEY="dvin/Common/Roles"/>:
                              </td>
                              <td class="form-inset">
                                    <IF COND="Variables.item:legalrolesroles!=Variables.empty">
                                       <THEN>
                                          <STRINGLIST NAME="selRoles" STR="Variables.item:legalrolesroles" DELIM=","/>
                                          <HASH.CREATE NAME="selectedRoles" LIST="selRoles" COLUMN="ITEM"/>
                                       </THEN>
                                       <ELSE>
                                          <HASH.CREATE NAME="selectedRoles"/>
                                       </ELSE>
                                    </IF>
                                    <SETVAR NAME="errno" VALUE="0"/>
                                    <ROLEMANAGER.GETROLENAMES LISTVARNAME="acls"/>
                                    <SELECT NAME="item:legalrolesroles" MULTIPLE="yes" SIZE="8">
                                       <IF COND="Variables.item:legalrolesroles=_ALL_">
                                          <THEN>
                                             <OPTION  SELECTED="yes" VALUE="_ALL_">
                                                <XLAT.STREAM KEY="dvin/Common/Any"/>
                                             </OPTION>
                                          </THEN>
                                          <ELSE>
                                             <OPTION VALUE="_ALL_">
                                                <XLAT.STREAM KEY="dvin/Common/Any"/>
                                             </OPTION>
                                          </ELSE>
                                       </IF>

                                       <LOOP LIST="acls">
                                          <HASH.CONTAINS NAME="selectedRoles" VALUE="acls.aclname" VARNAME="hasit"/>
                                          <IF COND="Variables.hasit=true">
                                             <THEN>
                                                <OPTION SELECTED="yes"/>
                                                <STRING.STREAM VALUE="acls.aclname"/>
                                             </THEN>
                                             <ELSE>
                                                <OPTION/>
                                                <STRING.STREAM VALUE="acls.aclname"/>
                                             </ELSE>
                                          </IF>
                                       </LOOP>
                                    </SELECT>
                              </td>
                              <td>
                                 <BR />
                              </td>
                           </tr>
                           <!-- Set subtype as the LegalArgument if asset is a FlexGroup or FlexAsset -->
                           <SETVAR NAME="item:sarguments" VALUE="Variables.empty"/>
                           <HASH.CONTAINS NAME="hFlexTypes" VALUE="Variables.item:assettype" VARNAME="hasit"/>
                           <IF COND="Variables.hasit=true">
                           <THEN>
                               <SETVAR NAME="item:sarguments" VALUE="Osubtype;OGroup_%"/>
                               <INPUT NAME="legal" TYPE="HIDDEN" VALUE="Osubtype;OGroup_%"/>
                           </THEN>
						   <ELSE>
						   <HASH.CONTAINS NAME="hFlexParentTypes" VALUE="Variables.item:assettype" VARNAME="hasit"/>
                           <IF COND="Variables.hasit=true">
                           <THEN>
                               <SETVAR NAME="item:sarguments" VALUE="Osubtype;OGroup_%"/>
                               <INPUT NAME="legal" TYPE="HIDDEN" VALUE="Osubtype;OGroup_%"/>
                           </THEN>
                           </IF>
						   </ELSE>
                           </IF>
							<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>

                           <tr id="workflowRowHr">
                              <!--<td colspan="3" class="light-line-color"><img height="1" width="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>-->
                           </tr>
                           <tr id="workflowRow">
                              <td class="form-label-text">
                                    <XLAT.STREAM KEY="dvin/Common/WorkflowProcess"/>:
                              </td>
                              <td VALIGN="MIDDLE">
                                    <IF COND="Variables.item:processesprocessTotal!=0">
                                       <THEN>
                                          <WORKFLOWENGINE.GETPROCESSID OBJVARNAME="currentProc" ID="Variables.item:processesprocess0"/>
                                          <WORKFLOWPROCESS.GETPROCESSNAME NAME="currentProc" VARNAME="currentName"/>
                                          <WORKFLOWPROCESS.GETID NAME="currentProc" VARNAME="currentID"/>
                                          <INPUT TYPE="HIDDEN" NAME="item:process" VALUE="Variables.currentID" REPLACEALL="Variables.currentID"/>
                                          <STRING.STREAM VALUE="Variables.currentName"/>
-
                                       </THEN>
                                    </IF>
									<table><tr><td>
                                    <XLAT.LOOKUP KEY="dvin/UI/SelectWorkflowProcessforthisStartMenuItem" VARNAME="_XLAT_" ESCAPE="true"/>
                                    <A HREF="javascript:void(0);" onClick="selAllAll();if(CheckFields('StartMenuFront','select')!=false){document.forms['AppForm'].submit(); return false;}" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true;" REPLACEALL="Variables._XLAT_">
									   <CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/SelectWorkflow_"/></CALLELEMENT>
                                    </A>
									</td><td>
                                     <IF COND="Variables.action=edit">
									 <THEN>
									    <IF COND="Variables.item:processesprocessTotal!=0">
                                       <THEN>
									  <A HREF="javascript:void(0);" onClick="selAllAll();if(RemoveWorkflow('StartMenuFront','removeworkflow')!=false){document.forms['AppForm'].submit(); return false;}" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true;" REPLACEALL="Variables._XLAT_">
									  <CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/RemoveWorkflow"/></CALLELEMENT>
                                    </A>
									</THEN>
									</IF>
									</THEN>
									</IF>
									</td></tr></table>
                              </td>
                           </tr>
                           <IF COND="Variables.item:processesprocessTotal!=0">
                              <THEN>
                                 <callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>	
								 <tr id="participantsTr">
                                    <td class="form-label-text">
                                          <XLAT.STREAM KEY="dvin/Common/Participants"/>:
                                    </td>
                                    <td class="form-inset">
                                        <table BORDER="0" CELLSPACING="0" CELLPADDING="0">
                                             <tr>
                                                <td></td>
                                                <td class="tile-dark" nowrap="true" HEIGHT="1">
                                                   <IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/>
                                                </td>
                                                <td></td>
                                             </tr>
                                             <tr>
                                                <td class="tile-dark" nowrap="true" VALIGN="top" WIDTH="1">
                                                   <BR />
                                                </td>
                                                <td >
                                                   <table width="100%" cellpadding="0" cellspacing="0" border="0" bgcolor="#ffffff">
                                                      <tr>
                                                         <td colspan="6" class="tile-highlight">
                                                            <IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/>
                                                         </td>
                                                      </tr>
                                                      <tr>
                                                         <td class="tile-a" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;</td>
                                                         <td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;</td>
                                                         <td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">
                                                            <DIV class="new-table-title">
                                                               <XLAT.STREAM KEY="dvin/Common/Role"/>
                                                            </DIV>
                                                         </td>
                                                         <td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;&nbsp;&nbsp;&nbsp;</td>
                                                         <td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">
                                                            <DIV class="new-table-title">
                                                               <XLAT.STREAM KEY="dvin/Common/Users"/>
                                                            </DIV>
                                                         </td>
                                                         <td class="tile-c" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;</td>
                                                      </tr>
                                                      <tr>
                                                         <td colspan="6" class="tile-dark" nowrap="true">
                                                            <IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/>
                                                         </td>
                                                      </tr>
                                                      <!-- Loop over all search results. -->
                                                      <setvar NAME="rowStyle" VALUE="tile-row-normal"/>
                                                      <SETVAR NAME="separatorLine" VALUE="0"/>

                                                      <IF COND="Variables.action=edit">
                                                         <THEN>
                                                            <IF COND="Variables.item:participantsrequiredroleTotal!=0">
                                                               <THEN>

                                                                  <SETCOUNTER NAME="currRole" VALUE="0"/>
                                                                  <SETVAR NAME="parts" VALUE="Variables.empty"/>
                                                                  <loop FROM="0" COUNT="Variables.item:participantsrequiredroleTotal">
                                                                     <IF COND="Variables.separatorLine=1">
                                                                        <THEN>
                                                                           <!--<tr>
                                                                              <td colspan="6" class="light-line-color">
                                                                                 <img height="1" width="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/>
                                                                              </td>
                                                                           </tr>-->
                                                                        </THEN>
                                                                     </IF>
                                                                     <SETVAR NAME="separatorLine" VALUE="1"/>

                                                                     <tr class="Variables.rowStyle"  REPLACEALL="Variables.rowStyle">
                                                                        <td>
                                                                           <BR />
                                                                        </td>

                                                                        <td>
                                                                           <BR />
                                                                        </td>
                                                                        <td VALIGN="TOP" NOWRAP="NOWRAP" ALIGN="LEFT">
                                                                           <DIV class="small-text-inset">
                                                                              <SETVAR NAME="role" VALUE="Variables.item:participantsrequiredroleCounters.currRole"/>
                                                                              <STRING.STREAM VALUE="Variables.role:"/>
                                                                           </DIV>
                                                                        </td>
                                                                        <td>
                                                                           <BR />
                                                                        </td>
                                                                        <td VALIGN="TOP" ALIGN="LEFT">
                                                                           <DIV class="small-text-inset">

                                                                              <setvar NAME="userNames" VALUE="Variables.empty"/>
                                                                              <SETCOUNTER NAME="currUser" VALUE="0"/>
                                                                              <SETVAR NAME="usercount" VALUE="Variables.item:participantsrequiredroleCounters.currRoleuserTotal"/>
                                                                              <SETVAR NAME="currentUsers" VALUE="Variables.empty"/>
                                                                              <loop COUNT="Variables.usercount">
                                                                                 <setvar NAME="uglyName" VALUE="Variables.item:participantsrequiredroleCounters.currRoleuserCounters.currUser"/>
                                                                                 <USERMANAGER.GETDISPLAYABLEUSERNAME USER="Variables.uglyName" VARNAME="niceName"/>
                                                                                 <IF COND="Variables.parts=Variables.empty">
                                                                                    <THEN>
                                                                                       <SETVAR NAME="postList" VALUE="Variables.uglyName"/>
                                                                                       <SETVAR NAME="parts" VALUE="Variables.niceName"/>
                                                                                    </THEN>
                                                                                    <ELSE>
                                                                                       <SETVAR NAME="postList" VALUE="Variables.postList;Variables.uglyName"/>
                                                                                       <SETVAR NAME="parts" VALUE="Variables.parts, Variables.niceName"/>
                                                                                    </ELSE>
                                                                                 </IF>
                                                                                 <inccounter NAME="currUser" VALUE="1"/>
                                                                              </loop>
																			  <STRING.ENCODE VARIABLE="role" VARNAME="role"/>
																			  <STRING.ENCODE VARIABLE="postList" VARNAME="postList"/>
                                                                              <INPUT TYPE="HIDDEN" NAME="Variables.role" VALUE="Variables.postList" REPLACEALL="Variables.role,Variables.postList"/>
                                                                              <INCCOUNTER NAME="currRole" VALUE="1"/>
                                                                              <STRING.STREAM VALUE="Variables.parts"/>
                                                                              <SETVAR NAME="parts" VALUE="Variables.empty"/>
                                                                           </DIV>
                                                                        </td>
                                                                        <td>
                                                                           <BR />
                                                                        </td>
                                                                     </tr>
                                                                     <IF COND="Variables.rowStyle=tile-row-normal">
                                                                        <THEN>
                                                                           <SETVAR NAME="rowStyle" VALUE="tile-row-highlight"/>
                                                                        </THEN>
                                                                        <ELSE>
                                                                           <SETVAR NAME="rowStyle" VALUE="tile-row-normal"/>
                                                                        </ELSE>
                                                                     </IF>
                                                                  </loop>


                                                               </THEN>
                                                            </IF>
                                                         </THEN>
                                                         <ELSE>
                                                            <WORKFLOWPROCESS.GETROLES NAME="currentProc" OBJVARNAME="roleList"/>
                                                            <ROLELIST.GETALL NAME="roleList" VARNAME="roles"/>
                                                            <IF COND="Variables.roles!=Variables.empty">
                                                               <THEN>
                                                                  <STRINGLIST NAME="rlist" STR="Variables.roles" DELIM=","/>
                                                                  <LOOP LIST="rlist">
								     <SETVAR NAME="rolename" VALUE="rlist.ITEM"/>
								     <ICS.GETVAR NAME="Variables.rolename" ENCODING="default" OUTPUT="rolevalue"/>
                                                                     <IF COND="Variables.rolevalue!=Variables.empty">
                                                                        <THEN>
                                                                           <IF COND="Variables.separatorLine=1">
                                                                              <THEN>
                                                                                 <!--<tr>
                                                                                    <td colspan="6" class="light-line-color">
                                                                                       <img height="1" width="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/>
                                                                                    </td>
                                                                                 </tr>-->
                                                                              </THEN>
                                                                           </IF>
                                                                           <SETVAR NAME="separatorLine" VALUE="1"/>


                                                                           <tr class="Variables.rowStyle"  REPLACEALL="Variables.rowStyle">
                                                                              <td>
                                                                                 <BR />
                                                                              </td>
                                                                              <td>
                                                                                 <BR />
                                                                              </td>
                                                                              <td VALIGN="TOP" NOWRAP="NOWRAP" ALIGN="LEFT">
                                                                                 <DIV class="small-text-inset">
                                                                                    <STRING.STREAM VALUE="Variables.rolename:"/>
                                                                                 </DIV>
                                                                              </td>
                                                                              <td>
                                                                                 <BR />
                                                                              </td>
                                                                              <td VALIGN="TOP" ALIGN="LEFT">
                                                                                 <DIV class="small-text-inset">
                                                                                    <STRINGLIST STR="Variables.rolevalue" NAME="out" DELIM=";"/>
                                                                                    <LOOP LIST="out">
                                                                                       <USERMANAGER.GETUSERNAME VARNAME="uName" USER="out.ITEM"/>
                                                                                       <IF COND="out.#curRow=1">
                                                                                          <THEN>
                                                                                             <SETVAR NAME="uList" VALUE="Variables.uName"/>
                                                                                             <SETVAR NAME="postList" VALUE="out.ITEM"/>
                                                                                          </THEN>
                                                                                          <ELSE>
                                                                                             <SETVAR NAME="uList" VALUE="Variables.uList,Variables.uName"/>
                                                                                             <SETVAR NAME="postList" VALUE="Variables.postList;out.ITEM"/>
                                                                                          </ELSE>
                                                                                       </IF>
                                                                                    </LOOP>
                                                                                    <STRING.STREAM VALUE="Variables.uList"/>
                                                                                    <INPUT TYPE="hidden" NAME="Variables.rolename" VALUE="Variables.postList" REPLACEALL="Variables.rolename,Variables.postList"/>
                                                                                 </DIV>
                                                                              </td>
                                                                              <td>
                                                                                 <BR />
                                                                              </td>
                                                                           </tr>
                                                                           <IF COND="Variables.rowStyle=tile-row-normal">
                                                                              <THEN>
                                                                                 <SETVAR NAME="rowStyle" VALUE="tile-row-highlight"/>
                                                                              </THEN>
                                                                              <ELSE>
                                                                                 <SETVAR NAME="rowStyle" VALUE="tile-row-normal"/>
                                                                              </ELSE>
                                                                           </IF>
                                                                        </THEN>
                                                                     </IF>
                                                                  </LOOP>
                                                               </THEN>
                                                            </IF>
                                                         </ELSE>
                                                      </IF>
                                                   </table>
                                                </td>
                                                <td class="tile-dark" nowrap="true" VALIGN="top" WIDTH="1">
                                                   <BR />
                                                </td>
                                             </tr>
                                             <tr>
                                                <td colspan="3" class="tile-dark" nowrap="true" VALIGN="TOP" HEIGHT="1">
                                                   <IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/>
                                                </td>
                                             </tr>
                                             <tr>
                                                <td></td>
                                                <td background="Variables.cs_imagedir/graphics/common/screen/shadow.gif" REPLACEALL="Variables.cs_imagedir">
                                                   <IMG WIDTH="1" HEIGHT="5" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/>
                                                </td>
                                                <td></td>
                                             </tr>
                                          </table>
                                    </td>
                                 </tr>

                              </THEN>
                           </IF>
                           <IF COND="Variables.IgnoreAT!=true">
								<THEN>
								   <SCRIPT LANGUAGE="Javascript">
								   <![CDATA[
									hideDefaultAndWorkflowSections();
									installArgTypeLookUpTables( document.forms[0].elements['legalname'] ) ;  
									ShowValue(document.forms[0].elements['AddButton'],document.forms[0].elements['legalname']);							
								   ]]>
								   </SCRIPT>
								</THEN>
							</IF>
                           <IF COND="IsVariable.startitem=true">
                              <THEN>
                                 <!--<tr>
                                    <td colspan="3" class="light-line-color">
                                       <img height="1" width="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/>
                                    </td>
                                 </tr>-->
                                 <callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
								 <tr>
                                    <td class="form-label-text">
                                          <XLAT.STREAM KEY="dvin/AT/Common/ID"/>:
                                    </td>
                                    <td class="form-inset">
										<STRING.ENCODE VARIABLE="id" VARNAME="id"/>
                                          <INPUT TYPE="HIDDEN" NAME="id" VALUE="Variables.id" REPLACEALL="Variables.id"/>
                                          <STRING.STREAM VALUE="Variables.startitem"/>
                                    </td>
                                 </tr>
                              </THEN>
                           </IF>
						   
						   <INPUT TYPE="HIDDEN" NAME="action" VALUE="new"/>
						   <IF COND="IsVariable.startitem=true">
							  <THEN>
								  <SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Admin/StartMenuFront" outstring="StartMenuFrontURL">
									  <satellite.argument name="cs_environment" value="Variables.cs_environment"/>
									  <satellite.argument name="cs_formmode" value="Variables.cs_formmode"/>
																	 <satellite.argument name="op" value="view"/>
																	 <satellite.argument name="startitem" value="Variables.startitem"/>
																	  </SATELLITE.LINK>
							  </THEN>
							  <ELSE>
								 <SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Admin/StartMenuFront" outstring="StartMenuFrontURL">
									 <satellite.argument name="cs_environment" value="Variables.cs_environment"/>
									 <satellite.argument name="cs_formmode" value="Variables.cs_formmode"/>
																	 <satellite.argument name="op" value="list"/>
																	  </SATELLITE.LINK>
							  </ELSE>
						   </IF>
						   <IF COND="IsVariable.AssetType=true">
							  <THEN>
								 <SETVAR NAME="StartMenuFrontURL" VALUE="Variables.StartMenuFrontURL&#38;AssetType=Variables.AssetType"/>
							  </THEN>
						   </IF>
							<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/FooterBar"/>
							<TR>
								<TD class="form-label-text"></TD><TD class="form-inset">
								   <XLAT.LOOKUP KEY="dvin/UI/Cancel" VARNAME="_status_" ESCAPE="true"/>
								   <A HREF="Variables.StartMenuFrontURL" onmouseover="window.status='Variables._status_';return true;" onmouseout="window.status='';return true;" REPLACEALL="Variables._status_,Variables.StartMenuFrontURL">
									  <CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/Cancel"/></CALLELEMENT>
								   </A>
								   <XLAT.LOOKUP KEY="dvin/UI/AddNewStartMenu" VARNAME="_XLAT_" ESCAPE="true"/>
								   <A HREF="javascript:void(0);"

										   onclick=" installArgTypeLookUpTables( document.forms[0].elements['legalname'] ) ;
													 
													 selAllAll();

													 if(CheckFields('StartMenuPost','new')!=false)
													 {
														   document.forms['AppForm'].submit();
														   return false;
													 }"
													 onmouseover="window.status='Variables._XLAT_';return true;"
													 onmouseout="window.status='';return true;" REPLACEALL="Variables._XLAT_">
										<CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/Save"/></CALLELEMENT>
								   </A>
								</TD>
							</TR>
							</table>
                     </td></tr>
               </table>
               <P/>


               <P/>
               </ELSE>
               </IF>
            </THEN>
         </IF>


         <!-- ########## Remove WorkFlow ########## -->

            <IF COND="Variables.op=removeworkflow">
			<THEN>
				<table class="width-outer-70" cellspacing="0" cellpadding="0" border="0">
					<tr><td>
						<span class="title-text">Remove WorkFlow</span>
					</td></tr>
					<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/TitleBar"/>
				</table>
                <INPUT TYPE="HIDDEN" NAME="action" VALUE="update"/>
               <!-- input all data from other form -->
               <SETVAR NAME="item:sitessites" VALUE="Variables.empty"/>
               <SETVAR NAME="update:sitessites" VALUE="Variables.empty"/>
               <STARTMENU.CREATE OBJVARNAME="menuitem"/>
               <IF COND="Variables.action=update">
                  <THEN>
                     <IF COND="IsVariable.update:id=true">
                        <THEN>
							<STRING.ENCODE VARIABLE="update:id" VARNAME="update:id"/>
                           <INPUT TYPE="HIDDEN" NAME="update:id" VALUE="Variables.update:id" REPLACEALL="Variables.update:id"/>
                        </THEN>
                     </IF>
                     <IF COND="IsVariable.update:name=false">
                        <THEN>
                           <INPUT TYPE="HIDDEN" NAME="update:name" VALUE="Variables.empty" REPLACEALL="Variables.empty"/>
                        </THEN>
                        <ELSE>
						   <STRING.ENCODE VARIABLE="update:name" VARNAME="update:nameEnc"/>	
                           <INPUT TYPE="HIDDEN" NAME="update:name" VALUE="Variables.update:nameEnc" REPLACEALL="Variables.update:nameEnc"/>
                        </ELSE>
                     </IF>
                     <IF COND="IsVariable.update:description=false">
                        <THEN>
                           <INPUT TYPE="HIDDEN" NAME="update:description" VALUE="Variables.empty" REPLACEALL="Variables.empty"/>
                        </THEN>
                        <ELSE>
							<STRING.ENCODE VARIABLE="update:description" VARNAME="OutputQString"/>
                           <INPUT TYPE="HIDDEN" NAME="update:description" VALUE="Variables.OutputQString" REPLACEALL="Variables.OutputQString"/>
                        </ELSE>
                     </IF>
					 <STRING.ENCODE VARIABLE="update:itemtype" VARNAME="update:itemtype"/>
                     <INPUT TYPE="HIDDEN" NAME="Itemtype" VALUE="Variables.update:itemtype" REPLACEALL="Variables.update:itemtype"/>
                     <INPUT TYPE="HIDDEN" NAME="update:itemtype" VALUE="Variables.update:itemtype" REPLACEALL="Variables.update:itemtype"/>
                     <IF COND="IsVariable.update:sarguments=false">
                        <THEN>
                           <INPUT TYPE="HIDDEN" NAME="update:sarguments" VALUE="Variables.empty" REPLACEALL="Variables.empty"/>
                        </THEN>
                        <ELSE>
						   <STRING.ENCODE VARIABLE="update:sarguments" VARNAME="update:sarguments"/>
                           <INPUT TYPE="HIDDEN" NAME="update:sarguments" VALUE="Variables.update:sarguments" REPLACEALL="Variables.update:sarguments"/>
                        </ELSE>
                     </IF>
                     <IF COND="IsVariable.legal=false">
                        <THEN>
                           <INPUT TYPE="HIDDEN" NAME="legal" VALUE="Variables.empty" REPLACEALL="Variables.empty"/>
                        </THEN>
                        <ELSE>
						   <STRING.ENCODE VARIABLE="legal" VARNAME="legal"/>
                           <INPUT TYPE="HIDDEN" NAME="legal" VALUE="Variables.legal" REPLACEALL="Variables.legal"/>
                        </ELSE>
                     </IF>
					 <STRING.ENCODE VARIABLE="update:assettype" VARNAME="update:assettype"/>
                     <INPUT TYPE="HIDDEN" NAME="update:assettype" VALUE="Variables.update:assettype" REPLACEALL="Variables.update:assettype"/>
                     <INPUT TYPE="HIDDEN" NAME="AssetType" VALUE="Variables.AssetType" REPLACEALL="Variables.AssetType"/>
                     <IF COND="IsVariable.Definition=true">
                     <THEN>
						<STRING.ENCODE VARIABLE="Definition" VARNAME="Definition"/>
                        <INPUT TYPE="HIDDEN" NAME="Definition" VALUE="Variables.Definition" REPLACEALL="Variables.Definition"/>
						<STRING.ENCODE VARIABLE="WhichFlexType" VARNAME="WhichFlexType" />
                        <INPUT TYPE="HIDDEN" NAME="WhichFlexType" VALUE="Variables.WhichFlexType" REPLACEALL="Variables.WhichFlexType"/>
                     </THEN>
                     </IF>
                     <IF COND="IsVariable.cs_Permissions=true">
                     <THEN>
                         <input type="hidden" name="cs_Permissions" value="Variables.cs_Permissions" REPLACEALL="Variables.cs_Permissions"/>
                     </THEN>
                     </IF>
					<STRING.ENCODE VARIABLE="update:legalrolesroles" VARNAME="update:legalrolesroles"/>
                     <INPUT TYPE="HIDDEN" NAME="update:legalrolesroles" VALUE="Variables.update:legalrolesroles" REPLACEALL="Variables.update:legalrolesroles"/>
					 <STRING.ENCODE VARIABLE="update:legalsitessites" VARNAME="update:legalsitessites"/>
                     <INPUT TYPE="HIDDEN" NAME="update:legalsitessites" VALUE="Variables.update:legalsitessites" REPLACEALL="Variables.update:legalsitessites"/>
					 <STRING.ENCODE VARIABLE="update:process" VARNAME="update:process"/>
                     <INPUT TYPE="HIDDEN" NAME="update:process" VALUE="Variables.update:process" REPLACEALL="Variables.update:process"/>
					 <STRING.ENCODE VARIABLE="update:processinput" VARNAME="update:processinput"/>
                     <INPUT TYPE="HIDDEN" NAME="update:processinput" VALUE="Variables.update:processinput" REPLACEALL="Variables.update:processinput"/>
					 <STRING.ENCODE VARIABLE="update:participantinput" VARNAME="update:participantinput"/>
                     <INPUT TYPE="HIDDEN" NAME="update:participantinput" VALUE="Variables.update:participantinput" REPLACEALL="Variables.update:participantinput"/>
					 <STRING.ENCODE VARIABLE="update:siteinput" VARNAME="update:siteinput"/>
                     <INPUT TYPE="HIDDEN" NAME="update:siteinput" VALUE="Variables.update:siteinput" REPLACEALL="Variables.update:siteinput"/>
                     <STARTMENUITEM.GATHER NAME="menuitem" PREFIX="update:"/>
                     <STARTMENUITEM.SCATTER NAME="menuitem" PREFIX="update:"/>
                  </THEN>
                  <ELSE>
                     <IF COND="IsVariable.item:legalrolesroles=true">
                        <THEN>
                           <SUBSTITUTE STR="Variables.item:legalrolesroles" WITH="," WHAT=";" OUTSTR="item:legalrolesroles"/>

                        </THEN>
                     </IF>
                     <IF COND="IsVariable.item:id=true">
                        <THEN>
							<STRING.ENCODE VARIABLE="item:id" VARNAME="item:id"/>
                           <INPUT TYPE="HIDDEN" NAME="update:id" VALUE="Variables.item:id" REPLACEALL="Variables.item:id"/>
                        </THEN>
                     </IF>
                     <IF COND="IsVariable.item:name=false">
                        <THEN>
                           <INPUT TYPE="HIDDEN" NAME="update:name" VALUE="Variables.empty" REPLACEALL="Variables.empty"/>
                        </THEN>
                        <ELSE>
						   <STRING.ENCODE VARIABLE="item:name" VARNAME="OutputQString"/>
                           <INPUT TYPE="HIDDEN" NAME="update:name" VALUE="Variables.OutputQString" REPLACEALL="Variables.OutputQString"/>
                        </ELSE>
                     </IF>
                     <IF COND="IsVariable.item:description=false">
                        <THEN>
                           <INPUT TYPE="HIDDEN" NAME="update:description" VALUE="Variables.empty" REPLACEALL="Variables.empty"/>
                        </THEN>
                        <ELSE>
							<STRING.ENCODE VARIABLE="item:description" VARNAME="OutputQString"/>
                           <INPUT TYPE="HIDDEN" NAME="update:description" VALUE="Variables.OutputQString" REPLACEALL="Variables.OutputQString"/>
                        </ELSE>
                     </IF>
					 <STRING.ENCODE VARIABLE="item:itemtype" VARNAME="item:itemtype"/>
                     <INPUT TYPE="HIDDEN" NAME="ItemType" VALUE="Variables.item:itemtype" REPLACEALL="Variables.item:itemtype"/>
                     <INPUT TYPE="HIDDEN" NAME="update:itemtype" VALUE="Variables.item:itemtype" REPLACEALL="Variables.item:itemtype"/>
                     <IF COND="IsVariable.item:sarguments=false">
                        <THEN>
                           <INPUT TYPE="HIDDEN" NAME="update:sarguments" VALUE="Variables.empty" REPLACEALL="Variables.empty"/>
                        </THEN>
                        <ELSE>
						   <STRING.ENCODE VARIABLE="item:sarguments" VARNAME="item:sarguments"/>
                           <INPUT TYPE="HIDDEN" NAME="update:sarguments" VALUE="Variables.item:sarguments" REPLACEALL="Variables.item:sarguments"/>
                        </ELSE>
                     </IF>
                     <IF COND="IsVariable.legal=false">
                        <THEN>
                           <INPUT TYPE="HIDDEN" NAME="legal" VALUE="Variables.empty" REPLACEALL="Variables.empty"/>
                        </THEN>
                        <ELSE>
						   <STRING.ENCODE VARIABLE="legal" VARNAME="legal"/>
                           <INPUT TYPE="HIDDEN" NAME="legal" VALUE="Variables.legal" REPLACEALL="Variables.legal"/>
                        </ELSE>
                     </IF>
                     <!-- make sure Any is not used in gather for roles
                     <if COND="Variables.update:legalrolesroles=Any">
                     <then>
                       <STARTMENUITEM.GETLEGALROLES NAME="menuitem" OBJVARNAME="robject"/>
                       <ROLELIST.SETALL NAME="robject"/>
                       <ROLELIST.SCATTER NAME="menuitem" PREFIX="update:roles"/>
                     </then>
                     </if> -->

                     <!-- make sure Any is not used in gather for sites
                     <if COND="Variables.item:legalsitessites=Any">
                     <then>

                       <STARTMENUITEM.GETLEGALSITES NAME="menuitem" OBJVARNAME="sobject"/>
                       <SITELIST.SETALL NAME="sobject"/>
                       <SITELIST.SCATTER NAME="menuitem" PREFIX="update:sites"/>
                     </then>
                     </if>-->
					 <STRING.ENCODE VARIABLE="item:assettype" VARNAME="item:assettype"/>
                     <INPUT TYPE="HIDDEN" NAME="update:assettype" VALUE="Variables.item:assettype" REPLACEALL="Variables.item:assettype"/>
                     <INPUT TYPE="HIDDEN" NAME="AssetType" VALUE="Variables.item:assettype" REPLACEALL="Variables.item:assettype"/>
                     <IF COND="IsVariable.Definition=true">
                     <THEN>
					    <STRING.ENCODE VARIABLE="Definition" VARNAME="Definition"/>
                        <INPUT TYPE="HIDDEN" NAME="Definition" VALUE="Variables.Definition" REPLACEALL="Variables.Definition"/>
						<STRING.ENCODE VARIABLE="WhichFlexType" VARNAME="WhichFlexType" />
                        <INPUT TYPE="HIDDEN" NAME="WhichFlexType" VALUE="Variables.WhichFlexType" REPLACEALL="Variables.WhichFlexType"/>
                     </THEN>
                     </IF>
                     <IF COND="IsVariable.cs_Permissions=true">
                     <THEN>
                         <input type="hidden" name="cs_Permissions" value="Variables.cs_Permissions" REPLACEALL="Variables.cs_Permissions"/>
                     </THEN>
                     </IF>
					 <STRING.ENCODE VARIABLE="item:legalrolesroles" VARNAME="item:legalrolesroles" />
                     <INPUT TYPE="HIDDEN" NAME="update:legalrolesroles" VALUE="Variables.item:legalrolesroles" REPLACEALL="Variables.item:legalrolesroles"/>
					  <STRING.ENCODE VARIABLE="item:legalsitessites" VARNAME="item:legalsitessites" />
                     <INPUT TYPE="HIDDEN" NAME="update:legalsitessites" VALUE="Variables.item:legalsitessites" REPLACEALL="Variables.item:legalsitessites"/>
					  <STRING.ENCODE VARIABLE="item:process" VARNAME="item:process" />
                     <INPUT TYPE="HIDDEN" NAME="update:process" VALUE="Variables.item:process" REPLACEALL="Variables.item:process"/>
					  <STRING.ENCODE VARIABLE="item:processinput" VARNAME="item:processinput" />
                     <INPUT TYPE="HIDDEN" NAME="update:processinput" VALUE="Variables.item:processinput" REPLACEALL="Variables.item:processinput"/>
					  <STRING.ENCODE VARIABLE="item:participantinput" VARNAME="item:participantinput" />
                     <INPUT TYPE="HIDDEN" NAME="update:participantinput" VALUE="Variables.item:participantinput" REPLACEALL="Variables.item:participantinput"/>
					  <STRING.ENCODE VARIABLE="item:siteinput" VARNAME="item:siteinput" />
                     <INPUT TYPE="HIDDEN" NAME="update:siteinput" VALUE="Variables.item:siteinput" REPLACEALL="Variables.item:siteinput"/>
                     <STARTMENUITEM.GATHER NAME="menuitem" PREFIX="item:"/>
                     <STARTMENUITEM.SCATTER NAME="menuitem" PREFIX="update:"/>
                  </ELSE>
               </IF>
               <!-- SELECT WORKFLOW -->
               <table BORDER="0" CELLSPACING="0" CELLPADDING="0" >
                  <tr><td>
                        <table width="100%" cellpadding="0" cellspacing="0" border="0" bgcolor="#ffffff">
                          <CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
						  <tr>
                              <td class="form-label-text" NOWRAP="NOWRAP">
                                    <XLAT.STREAM KEY="dvin/Common/Name"/>:
                              </td>
                              <td class="form-inset">
                                    <STRING.STREAM VALUE="Variables.update:name"/>
                              </td>
                           </tr>
                          <CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
                           <tr>
                              <td class="form-label-text">
                                    <XLAT.STREAM KEY="dvin/Common/Description"/>:
                              </td>
                              <td class="form-inset">
                                    <STRING.STREAM VALUE="Variables.update:description"/>
                              </td>
                              <td>
                                 <BR />
                              </td>
                           </tr>
                         <CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
                           <tr>
                              <td class="form-label-text">
                                    <XLAT.STREAM KEY="dvin/Common/Type"/>:
                              </td>
                              <td class="form-inset">
                                    <IF COND="Variables.update:itemtype=Word">
                                       <THEN>
                                          <XLAT.STREAM KEY="dvin/UI/CSDesktop"/>
                                       </THEN>
                                       <ELSE>
                                          <IF COND="Variables.update:itemtype=Search">
                                             <THEN>
                                                <XLAT.STREAM KEY="dvin/Common/Search"/>
                                             </THEN>
                                             <ELSE>
                                                <IF COND="Variables.update:itemtype=ContentForm">
                                                   <THEN>
                                                      <XLAT.STREAM KEY="dvin/Common/New"/>
                                                   </THEN>
												   <ELSE>
														<IF COND="Variables.update:itemtype=InsiteForm">
															<THEN>
																<XLAT.STREAM KEY="dvin/UI/Admin/NewInsite"/>
															</THEN>	
															<ELSE>
																<IF COND="Variables.menu:itemtype=CSDocLink">
																<THEN>
																	<XLAT.STREAM KEY="dvin/UI/Admin/CSDocLink"/>
																</THEN>
															<ELSE>
																<STRING.STREAM VARIABLE="menu:itemtype"/>
															
															</ELSE>
															</IF>
															</ELSE>
                                                         </IF>
                                                    </ELSE>
                                                </IF>
                                             </ELSE>
                                          </IF>
                                       </ELSE>
                                    </IF>
                              </td>
                              <td>
                                 <BR />
                              </td>
                           </tr>
                           <CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
                           <tr>
                              <td class="form-label-text" NOWRAP="NOWRAP">
                                 <NOBR>
                                       <XLAT.STREAM KEY="dvin/UI/AssetType"/>:
                                 </NOBR>
                              </td>
                              <td class="form-inset">
                                    <ASSETTYPE.LIST LIST="atList" FIELD1="assettype" VALUE1="Variables.AssetType"/>
                                    <STRING.STREAM VALUE="atList.description"/>
                              </td>
                              <td>
                                 <BR />
                              </td>
                           </tr>
						   
						<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/FooterBar"/>
						<TR>
							<TD class="form-label-text"></TD><TD class="form-inset">
							   <IF COND="IsVariable.item:process=true">
								  <THEN>
								  <table><tr><td>
									   <INPUT TYPE="HIDDEN" NAME="item:process" VALUE="" />
									<!-- <XLAT.LOOKUP KEY="dvin/UI/SetParticipantsforWorkflow" VARNAME="_XLAT_" ESCAPE="true"/ -->
									 <A HREF="javascript:void(0);" onClick="if(CheckWorkflow('StartMenuFront','new')!=false){document.forms['AppForm'].submit();return false;}" onmouseover="window.status='remove workflow';return true;" onmouseout="window.status='';return true;" REPLACEALL="">
										<CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/RemoveWorkflow"/></CALLELEMENT>
									 </A>
									 </td><td>
									 <A HREF="javascript:history.go(-1)" onClick="history.back()">
										<CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/Cancel"/></CALLELEMENT>
									 </A>
									</td></tr></table>
								  </THEN>
								  <ELSE>
									 <IF COND="Variables.noSelect!=true">
										<THEN>
										<table><tr><td>
											<XLAT.LOOKUP KEY="dvin/UI/AssetMgt/SelectWorkflow" VARNAME="_XLAT_" ESCAPE="true"/>
										   <A HREF="javascript:void(0);" onClick="if(SelectWorkflow('StartMenuFront','select')!=false){document.forms['AppForm'].submit();return false;}" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true;" REPLACEALL="Variables._XLAT_">
											  <CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/SelectWorkflow"/></CALLELEMENT>
										   </A>
										   </td><td>
											<A HREF="javascript:void(0);" onClick="if(SelectWorkflow('StartMenuFront','select')!=false){document.forms['AppForm'].submit();return false;}" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true;" REPLACEALL="Variables._XLAT_">
											  <CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/Cancel"/></CALLELEMENT>
										   </A>
										   </td></tr></table>
										</THEN>
									 </IF>
								  </ELSE>
							   </IF>
							</TD>
						</TR>
                    </table>
									<!--- New Added Code -->
                     </td></tr>
               </table>

			   <!----- New code ended Here ---->


               <P/>
            </THEN>
         </IF>

         <!-- ########## SELECT ########## -->
         <!-- ########## SELECT ########## -->
         <!-- ########## SELECT ########## -->


         <IF COND="Variables.op=select">
            <THEN>
            	<table class="width-outer-70" cellspacing="0" cellpadding="0" border="0">
				<tr><td>
               		<span class="title-text"><XLAT.STREAM KEY="dvin/UI/Admin/Selectworkflowandparticipants"/></span>
               	</td></tr>
				<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/TitleBar"/>
				</table>
               <INPUT TYPE="HIDDEN" NAME="action" VALUE="update"/>
               <!-- input all data from other form -->
               <SETVAR NAME="item:sitessites" VALUE="Variables.empty"/>
               <SETVAR NAME="update:sitessites" VALUE="Variables.empty"/>
               <STARTMENU.CREATE OBJVARNAME="menuitem"/>
               <IF COND="Variables.action=update">
                  <THEN>
                     <IF COND="IsVariable.update:id=true">
                        <THEN>
							<STRING.ENCODE VARIABLE="update:id" VARNAME="update:id"/>
                           <INPUT TYPE="HIDDEN" NAME="update:id" VALUE="Variables.update:id" REPLACEALL="Variables.update:id"/>
                        </THEN>
                     </IF>
                     <IF COND="IsVariable.update:name=false">
                        <THEN>
                           <INPUT TYPE="HIDDEN" NAME="update:name" VALUE="Variables.empty" REPLACEALL="Variables.empty"/>
                        </THEN>
                        <ELSE>
						   <STRING.ENCODE VARIABLE="update:name" VARNAME="update:nameEnc"/>
                           <INPUT TYPE="HIDDEN" NAME="update:name" VALUE="Variables.update:nameEnc" REPLACEALL="Variables.update:nameEnc"/>
                        </ELSE>
                     </IF>
                     <IF COND="IsVariable.update:description=false">
                        <THEN>
                           <INPUT TYPE="HIDDEN" NAME="update:description" VALUE="Variables.empty" REPLACEALL="Variables.empty"/>
                        </THEN>
                        <ELSE>
							<STRING.ENCODE VARIABLE="update:description" VARNAME="OutputQString"/>
                           <INPUT TYPE="HIDDEN" NAME="update:description" VALUE="Variables.OutputQString" REPLACEALL="Variables.OutputQString"/>
                        </ELSE>
                     </IF>
					 <STRING.ENCODE VARIABLE="update:itemtype" VARNAME="update:itemtype"/>
                     <INPUT TYPE="HIDDEN" NAME="update:itemtype" VALUE="Variables.update:itemtype" REPLACEALL="Variables.update:itemtype"/>
                     <INPUT TYPE="HIDDEN" NAME="ItemType" VALUE="Variables.update:itemtype" REPLACEALL="Variables.update:itemtype"/>
			         <IF COND="IsVariable.update:sarguments=false">
                        <THEN>
                           <INPUT TYPE="HIDDEN" NAME="update:sarguments" VALUE="Variables.empty" REPLACEALL="Variables.empty"/>
                        </THEN>
                        <ELSE>
							 <STRING.ENCODE VARIABLE="update:sarguments" VARNAME="update:sarguments"/>
                           <INPUT TYPE="HIDDEN" NAME="update:sarguments" VALUE="Variables.update:sarguments" REPLACEALL="Variables.update:sarguments"/>
                        </ELSE>
                     </IF>
                     <IF COND="IsVariable.legal=false">
                        <THEN>
                           <INPUT TYPE="HIDDEN" NAME="legal" VALUE="Variables.empty" REPLACEALL="Variables.empty"/>
                        </THEN>
                        <ELSE>
						   <STRING.ENCODE VARIABLE="legal" VARNAME="legal"/>
                           <INPUT TYPE="HIDDEN" NAME="legal" VALUE="Variables.legal" REPLACEALL="Variables.legal"/>
                        </ELSE>
                     </IF>
					  <STRING.ENCODE VARIABLE="update:assettype" VARNAME="update:assettype"/>
					  <INPUT TYPE="HIDDEN" NAME="update:assettype" VALUE="Variables.update:assettype" REPLACEALL="Variables.update:assettype"/>
					   <STRING.ENCODE VARIABLE="AssetType" VARNAME="AssetType"/>
                     <INPUT TYPE="HIDDEN" NAME="AssetType" VALUE="Variables.AssetType" REPLACEALL="Variables.AssetType"/>
                     <IF COND="IsVariable.Definition=true">
                     <THEN>
						<STRING.ENCODE VARIABLE="Definition" VARNAME="Definition"/>
                        <INPUT TYPE="HIDDEN" NAME="Definition" VALUE="Variables.Definition" REPLACEALL="Variables.Definition"/>
						<STRING.ENCODE VARIABLE="WhichFlexType" VARNAME="WhichFlexType" />
                        <INPUT TYPE="HIDDEN" NAME="WhichFlexType" VALUE="Variables.WhichFlexType" REPLACEALL="Variables.WhichFlexType"/>
                     </THEN>
                     </IF>
                     <IF COND="IsVariable.cs_Permissions=true">
                     <THEN>
                         <input type="hidden" name="cs_Permissions" value="Variables.cs_Permissions" REPLACEALL="Variables.cs_Permissions"/>
                     </THEN>
                     </IF>
					 <STRING.ENCODE VARIABLE="update:legalrolesroles" VARNAME="update:legalrolesroles" />
                     <INPUT TYPE="HIDDEN" NAME="update:legalrolesroles" VALUE="Variables.update:legalrolesroles" REPLACEALL="Variables.update:legalrolesroles"/>
					 <STRING.ENCODE VARIABLE="update:legalsitessites" VARNAME="update:legalsitessites" />
                     <INPUT TYPE="HIDDEN" NAME="update:legalsitessites" VALUE="Variables.update:legalsitessites" REPLACEALL="Variables.update:legalsitessites"/>
					  <STRING.ENCODE VARIABLE="update:process" VARNAME="update:process" />
                     <INPUT TYPE="HIDDEN" NAME="update:process" VALUE="Variables.update:process" REPLACEALL="Variables.update:process"/>
					  <STRING.ENCODE VARIABLE="update:processinput" VARNAME="update:processinput" />
                     <INPUT TYPE="HIDDEN" NAME="update:processinput" VALUE="Variables.update:processinput" REPLACEALL="Variables.update:processinput"/>
					  <STRING.ENCODE VARIABLE="update:participantinput" VARNAME="update:participantinput" />
                     <INPUT TYPE="HIDDEN" NAME="update:participantinput" VALUE="Variables.update:participantinput" REPLACEALL="Variables.update:participantinput"/>
					  <STRING.ENCODE VARIABLE="update:siteinput" VARNAME="update:siteinput" />
                     <INPUT TYPE="HIDDEN" NAME="update:siteinput" VALUE="Variables.update:siteinput" REPLACEALL="Variables.update:siteinput"/>
                     <STARTMENUITEM.GATHER NAME="menuitem" PREFIX="update:"/>
                     <STARTMENUITEM.SCATTER NAME="menuitem" PREFIX="update:"/>
                  </THEN>
                  <ELSE>
                     <IF COND="IsVariable.item:legalrolesroles=true">
                        <THEN>
                           <SUBSTITUTE STR="Variables.item:legalrolesroles" WITH="," WHAT=";" OUTSTR="item:legalrolesroles"/>
                        </THEN>
                     </IF>
                     <IF COND="IsVariable.item:id=true">
                        <THEN>
							<STRING.ENCODE VARIABLE="item:id" VARNAME="item:id"/>
                           <INPUT TYPE="HIDDEN" NAME="update:id" VALUE="Variables.item:id" REPLACEALL="Variables.item:id"/>
                        </THEN>
                     </IF>
                     <IF COND="IsVariable.item:name=false">
                        <THEN>
                           <INPUT TYPE="HIDDEN" NAME="update:name" VALUE="Variables.empty" REPLACEALL="Variables.empty"/>
                        </THEN>
                        <ELSE>
						   <STRING.ENCODE VARIABLE="item:name" VARNAME="item:nameEnc"/>
                           <INPUT TYPE="HIDDEN" NAME="update:name" VALUE="Variables.item:nameEnc" REPLACEALL="Variables.item:nameEnc"/>
                        </ELSE>
                     </IF>
                     <IF COND="IsVariable.item:description=false">
                        <THEN>
                           <INPUT TYPE="HIDDEN" NAME="update:description" VALUE="Variables.empty" REPLACEALL="Variables.empty"/>
                        </THEN>
                        <ELSE>
							<STRING.ENCODE VARIABLE="item:description" VARNAME="OutputQString"/>
                           <INPUT TYPE="HIDDEN" NAME="update:description" VALUE="Variables.OutputQString" REPLACEALL="Variables.OutputQString"/>
                        </ELSE>
                     </IF>
					 <STRING.ENCODE VARIABLE="item:itemtype" VARNAME="item:itemtype"/>
                     <INPUT TYPE="HIDDEN" NAME="ItemType" VALUE="Variables.item:itemtype" REPLACEALL="Variables.item:itemtype"/>
                     <INPUT TYPE="HIDDEN" NAME="update:itemtype" VALUE="Variables.item:itemtype" REPLACEALL="Variables.item:itemtype"/>
                     <IF COND="IsVariable.item:sarguments=false">
                        <THEN>
                           <INPUT TYPE="HIDDEN" NAME="update:sarguments" VALUE="Variables.empty" REPLACEALL="Variables.empty"/>
                        </THEN>
                        <ELSE>
						   <STRING.ENCODE VARIABLE="item:sarguments" VARNAME="item:sarguments"/>
                           <INPUT TYPE="HIDDEN" NAME="update:sarguments" VALUE="Variables.item:sarguments" REPLACEALL="Variables.item:sarguments"/>
                        </ELSE>
                     </IF>
                     <IF COND="IsVariable.legal=false">
                        <THEN>
                           <INPUT TYPE="HIDDEN" NAME="legal" VALUE="Variables.empty" REPLACEALL="Variables.empty"/>
                        </THEN>
                        <ELSE>
							 <STRING.ENCODE VARIABLE="legal" VARNAME="legal"/>
                           <INPUT TYPE="HIDDEN" NAME="legal" VALUE="Variables.legal" REPLACEALL="Variables.legal"/>
                        </ELSE>
                     </IF>
                     <!-- make sure Any is not used in gather for roles
                     <if COND="Variables.update:legalrolesroles=Any">
                     <then>
                       <STARTMENUITEM.GETLEGALROLES NAME="menuitem" OBJVARNAME="robject"/>
                       <ROLELIST.SETALL NAME="robject"/>
                       <ROLELIST.SCATTER NAME="menuitem" PREFIX="update:roles"/>
                     </then>
                     </if> -->

                     <!-- make sure Any is not used in gather for sites
                     <if COND="Variables.item:legalsitessites=Any">
                     <then>

                       <STARTMENUITEM.GETLEGALSITES NAME="menuitem" OBJVARNAME="sobject"/>
                       <SITELIST.SETALL NAME="sobject"/>
                       <SITELIST.SCATTER NAME="menuitem" PREFIX="update:sites"/>
                     </then>
                     </if>-->
					 <STRING.ENCODE VARIABLE="item:assettype" VARNAME="item:assettype"/>
                     <INPUT TYPE="HIDDEN" NAME="update:assettype" VALUE="Variables.item:assettype" REPLACEALL="Variables.item:assettype"/>
                     <INPUT TYPE="HIDDEN" NAME="AssetType" VALUE="Variables.item:assettype" REPLACEALL="Variables.item:assettype"/>
                     <IF COND="IsVariable.Definition=true">
                     <THEN>
					    <STRING.ENCODE VARIABLE="Definition" VARNAME="Definition"/>
                        <INPUT TYPE="HIDDEN" NAME="Definition" VALUE="Variables.Definition" REPLACEALL="Variables.Definition"/>
						<STRING.ENCODE VARIABLE="WhichFlexType" VARNAME="WhichFlexType" />
                        <INPUT TYPE="HIDDEN" NAME="WhichFlexType" VALUE="Variables.WhichFlexType" REPLACEALL="Variables.WhichFlexType"/>
                     </THEN>
                     </IF>
                     <IF COND="IsVariable.cs_Permissions=true">
                     <THEN>
                         <input type="hidden" name="cs_Permissions" value="Variables.cs_Permissions" REPLACEALL="Variables.cs_Permissions"/>
                     </THEN>
                     </IF>
					 <STRING.ENCODE VARIABLE="item:legalrolesroles" VARNAME="item:legalrolesroles" />
                     <INPUT TYPE="HIDDEN" NAME="update:legalrolesroles" VALUE="Variables.item:legalrolesroles" REPLACEALL="Variables.item:legalrolesroles"/>
					 <STRING.ENCODE VARIABLE="item:legalsitessites" VARNAME="item:legalsitessites" />
                     <INPUT TYPE="HIDDEN" NAME="update:legalsitessites" VALUE="Variables.item:legalsitessites" REPLACEALL="Variables.item:legalsitessites"/>
					 <STRING.ENCODE VARIABLE="item:process" VARNAME="item:process" />
                     <INPUT TYPE="HIDDEN" NAME="update:process" VALUE="Variables.item:process" REPLACEALL="Variables.item:process"/>
					 <STRING.ENCODE VARIABLE="item:processinput" VARNAME="item:processinput" />
                     <INPUT TYPE="HIDDEN" NAME="update:processinput" VALUE="Variables.item:processinput" REPLACEALL="Variables.item:processinput"/>
					 <STRING.ENCODE VARIABLE="item:participantinput" VARNAME="item:participantinput" />
                     <INPUT TYPE="HIDDEN" NAME="update:participantinput" VALUE="Variables.item:participantinput" REPLACEALL="Variables.item:participantinput"/>
					 <STRING.ENCODE VARIABLE="item:siteinput" VARNAME="item:siteinput" />
                     <INPUT TYPE="HIDDEN" NAME="update:siteinput" VALUE="Variables.item:siteinput" REPLACEALL="Variables.item:siteinput"/>
                     <STARTMENUITEM.GATHER NAME="menuitem" PREFIX="item:"/>
                     <STARTMENUITEM.SCATTER NAME="menuitem" PREFIX="update:"/>
                  </ELSE>
               </IF>
               <!-- SELECT WORKFLOW -->
               <table BORDER="0" CELLSPACING="0" CELLPADDING="0" class="width-outer-50">
                  <tr><td>
                        <table class="width-inner-100" cellpadding="0" cellspacing="0" border="0" bgcolor="#ffffff">
                           <CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
						   <tr>
                              <td class="form-label-text" NOWRAP="NOWRAP">
                                    <XLAT.STREAM KEY="dvin/Common/Name"/>:
                              </td>
                              <td class="form-inset">
                                    <STRING.STREAM VALUE="Variables.update:name"/>
                              </td>
                           </tr>
							<CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
						   
                           <tr>
                              <td class="form-label-text">
                                    <XLAT.STREAM KEY="dvin/Common/Description"/>:
                              </td>
                              <td class="form-inset">
                                    <STRING.STREAM VALUE="Variables.update:description"/>
                              </td>
                              <td>
                                 <BR />
                              </td>
                           </tr>
                           <CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
                           <tr>
                              <td class="form-label-text">
                                    <XLAT.STREAM KEY="dvin/Common/Type"/>:
                              </td>
                              <td class="form-inset">
                                    <IF COND="Variables.update:itemtype=Word">
                                       <THEN>
                                          <XLAT.STREAM KEY="dvin/UI/CSDesktop"/>
                                       </THEN>
                                       <ELSE>
                                          <IF COND="Variables.update:itemtype=Search">
                                             <THEN>
                                                <XLAT.STREAM KEY="dvin/Common/Search"/>
                                             </THEN>
                                             <ELSE>
                                                <IF COND="Variables.update:itemtype=ContentForm">
                                                   <THEN>
                                                      <XLAT.STREAM KEY="dvin/Common/New"/>
                                                   </THEN>
                                                   <ELSE>
														<IF COND="Variables.update:itemtype=InsiteForm">
															<THEN>
																<XLAT.STREAM KEY="dvin/UI/Admin/NewInsite"/>
															</THEN>	
															<ELSE>
																<IF COND="Variables.menu:itemtype=CSDocLink">
																<THEN>
																	<XLAT.STREAM KEY="dvin/UI/Admin/CSDocLink"/>
																</THEN>
															<ELSE>
																<STRING.STREAM VARIABLE="menu:itemtype"/>
															
														</ELSE>
															</IF>	
                                                         </ELSE>
                                                         </IF>
                                                    </ELSE>
                                                </IF>
                                             </ELSE>
                                          </IF>
                                       </ELSE>
                                    </IF>
                              </td>
                              <td>
                                 <BR />
                              </td>
                           </tr>
                          <CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
                           <tr>
                              <td class="form-label-text" NOWRAP="NOWRAP">
                                 <NOBR>
                                       <XLAT.STREAM KEY="dvin/UI/AssetType"/>:
                                 </NOBR>
                              </td>
                              <td class="form-inset">
                                    <ASSETTYPE.LIST LIST="atList" FIELD1="assettype" VALUE1="Variables.AssetType"/>
                                    <STRING.STREAM VALUE="atList.description"/>
                              </td>
                              <td>
                                 <BR />
                              </td>
                           </tr>
                          <CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
                           <tr>
                              <td class="form-label-text">
                                 <NOBR>
                                       <IF COND="IsVariable.update:process!=true">
                                          <THEN>
                                             <span class="alert-color">*</span>
                                          </THEN>
                                       </IF>
                                       <XLAT.STREAM KEY="dvin/Common/Workflow"/>:
                                 </NOBR>
                              </td>
                              <td class="form-inset">
                                    <!-- if sites=Any, get all processes (with the filter of asettypes only)-->
                                    <if COND="Variables.update:legalsitessites=_ALL_">
                                       <then>
                                          <SETVAR NAME="errno" VALUE="0"/>
                                          <PUBLICATION.LIST LIST="PublicationResults"/>
                                          <IF COND="IsList.PublicationResults=true">
                                             <THEN>
                                                <LOOP LIST="PublicationResults">

                                                   <IF COND="PublicationResults.#curRow=1">
                                                      <THEN>
                                                         <setvar NAME="selectedSites" VALUE="PublicationResults.id"/>
                                                      </THEN>
                                                      <ELSE>
                                                         <setvar NAME="selectedSites" VALUE="Variables.selectedSites,PublicationResults.id"/>
                                                      </ELSE>
                                                   </IF>
                                                </LOOP>
                                             </THEN>
                                          </IF>
                                       </then>
                                       <else>
                                          <SUBSTITUTE STR="Variables.update:legalsitessites" WHAT=";" WITH="," OUTSTR="selectedSites"/>
                                       </else>
                                    </if>
                                    <WORKFLOWENGINE.GETMULTISITEPROCESSES ASSETTYPE="Variables.update:assettype" PREFIX="process:" PUBIDS="Variables.selectedSites"/>
                                    <!--
                                                  <STRINGLIST NAME="selectedSites" STR="Variables.selectedSites" DELIM="," />
                                                  <if COND="selectedSites.#numRows=1">
                                                  <then>
                                                  <WORKFLOWENGINE.GETALLPROCESSES ASSETTYPE="Variables.update:assettype" PREFIX="process:" PUBID="Variables.selectedSites"/>
                                                  </then>
                                                  <else>
                                                  <WORKFLOWENGINE.GETMULTISITEPROCESSES ASSETTYPE="Variables.update:assettype" PREFIX="process:" PUBIDS="Variables.selectedSites"/>
                                                  </else>
                                                  </if>    Sreedhar Debug 14042

									  -->
                                    <IF COND="Variables.process:Total!=0">
                                       <THEN>
                                          <SETCOUNTER NAME="currentProc" VALUE="0"/>
                                          <SELECT NAME="item:process" onChange="javascript:SelectWorkflow('StartMenuFront','select')"> 
                                        <!--     <OPTION VALUE="Variables.empty" REPLACEALL="Variables.empty">[
                                                <XLAT.STREAM KEY="dvin/UI/Admin/NoWorkflow"/>
]</OPTION>  Bug 14042 -->
                                             <LOOP COUNT="Variables.process:Total">
                                                <WORKFLOWPROCESS.GETPROCESSNAME NAME="process:Counters.currentProc" VARNAME="currentName"/>
                                                <WORKFLOWPROCESS.GETID NAME="process:Counters.currentProc" VARNAME="currentID"/>


                                                <IF COND="Variables.item:process=Variables.currentID">
                                                   <THEN>
                                                      <WORKFLOWPROCESS.GETROLES NAME="process:Counters.currentProc" OBJVARNAME="roleList"/>
                                                      <OPTION VALUE="Variables.currentID" SELECTED="SELECTED" REPLACEALL="Variables.currentID">
                                                         <STRING.STREAM VALUE="Variables.currentName"/>
                                                      </OPTION>
                                                   </THEN>
                                                   <ELSE>
                                                      <OPTION VALUE="Variables.currentID" REPLACEALL="Variables.currentID">
                                                         <STRING.STREAM VALUE="Variables.currentName"/>
                                                      </OPTION>
                                                   </ELSE>
                                                </IF>


                                                <INCCOUNTER NAME="currentProc" VALUE="1"/>
                                             </LOOP>
                                          </SELECT>
                                          <SETVAR NAME="noSelect" VALUE="false"/>
                                       </THEN>
                                       <ELSE>
                                          <ASSETTYPE.LIST LIST="currentAT"  FIELD1="assettype" VALUE1="Variables.update:assettype"/>
							[
                                          <XLAT.STREAM KEY="dvin/UI/Admin/NoprocessesdefinedsitesATdesc"/>
]
                                          <SETVAR NAME="noSelect" VALUE="true"/>
                                          <INPUT TYPE="hidden" NAME="item:process" VALUE=""/>
                                       </ELSE>
                                    </IF>
                              </td>
                              <td>
                                 <BR />
                              </td>
                           </tr>
                           <IF COND="IsVariable.item:process=true">
                              <THEN>
                                 <CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
                                 <tr>
                                    <td class="form-label-text">
                                          <XLAT.STREAM KEY="dvin/Common/Participants"/>:
                                    </td>
                                    <td class="form-inset">
                                          <ROLELIST.GETALL NAME="roleList" VARNAME="roles"/>
                                          <INPUT TYPE="HIDDEN" NAME="CheckRoles" VALUE="Variables.roles" REPLACEALL="Variables.roles"/>
                                          <IF COND="Variables.roles!=Variables.empty">
                                             <THEN>
                                                <STRINGLIST NAME="rlist" STR="Variables.roles" DELIM="," />

                                                <!-- make user role hash from what is saved -->
                                                <LOOP LIST="rlist">
                                                   <HASH.CREATE NAME="hashrlist.ITEM"/>
						   <SETVAR NAME="rolename" VALUE="rlist.ITEM"/>
						   <ICS.GETVAR NAME="Variables.rolename" ENCODING="default" OUTPUT="rolevalue"/>
                                                   <IF COND="Variables.rolevalue!=Variables.empty">
                                                      <THEN>
                                                         <STRINGLIST NAME="users" STR="Variables.rolevalue" DELIM=";"/>
                                                         <LOOP LIST="users">
                                                            <HASH.ADD NAME="hashrlist.ITEM" VALUE="users.ITEM"/>
                                                         </LOOP>
                                                      </THEN>
                                                   </IF>
                                                </LOOP>

                                                <table BORDER="0" CELLSPACING="0" CELLPADDING="0" >
                                                   <tr>
                                                      <td></td>
                                                      <td class="tile-dark" nowrap="true" HEIGHT="1">
                                                         <IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/>
                                                      </td>
                                                      <td></td>
                                                   </tr>
                                                   <tr>
                                                      <td class="tile-dark" nowrap="true" VALIGN="top" WIDTH="1">
                                                         <BR />
                                                      </td>
                                                      <td >
                                                         <table width="100%" cellpadding="0" cellspacing="0" border="0" bgcolor="#ffffff">
                                                            <tr>
                                                               <td colspan="6" class="tile-highlight">
                                                                  <IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/>
                                                               </td>
                                                            </tr>
                                                            <tr>
                                                               <td class="tile-a" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;</td>
                                                               <td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;</td>
                                                               <td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">
                                                                  <DIV class="new-table-title">
                                                                     <XLAT.STREAM KEY="dvin/Common/Role"/>
                                                                  </DIV>
                                                               </td>
                                                               <td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;&nbsp;&nbsp;&nbsp;</td>
                                                               <td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">
                                                                  <DIV class="new-table-title">
                                                                     <XLAT.STREAM KEY="dvin/Common/Users"/>
                                                                  </DIV>
                                                               </td>
                                                               <td class="tile-c" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;</td>
                                                            </tr>
                                                            <tr>
                                                               <td colspan="6" class="tile-dark" nowrap="true">
                                                                  <IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/>
                                                               </td>
                                                            </tr>


                                                            <!-- for each role, list the available participants -->
                                                            <setcounter NAME="ROLECOUNT" VALUE="0"/>
                                                            <setvar NAME="rowStyle" VALUE="tile-row-normal"/>
                                                            <SETVAR NAME="separatorLine" VALUE="0"/>
                                                            <loop LIST="rlist">
							       <SETVAR NAME="rolename" VALUE="rlist.ITEM"/>
                                                               <IF COND="Variables.separatorLine=1">
                                                                  <THEN>
                                                                     <!--<tr>
                                                                        <td colspan="6" class="light-line-color">
                                                                           <img height="1" width="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/>
                                                                        </td>
                                                                     </tr>-->
                                                                  </THEN>
                                                               </IF>

                                                               <SETVAR NAME="separatorLine" VALUE="1"/>
                                                               <callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
															   <tr class="Variables.rowStyle"  REPLACEALL="Variables.rowStyle">
                                                                  <td>
                                                                     <BR />
                                                                  </td>
                                                                  <td VALIGN="TOP">                                                                     
                                                                     <BR />
                                                                  </td>


                                                                  <td class="form-label-text" NOWRAP="NOWRAP" ALIGN="LEFT">
                                                                          <span class="alert-color">*</span><STRING.STREAM VALUE="Variables.rolename"/>:
                                                                  </td>


                                                                  <td>
                                                                     <BR />
                                                                  </td>
                                                                  <td class="form-inset" NOWRAP="NOWRAP" ALIGN="LEFT">
                                                                        <SETVAR NAME="myuname" VALUE="Variables.empty"/>
                                                                        <!-- If all sites are chosen (or any)not finished yet -->
                                                                        <if COND="Variables.update:legalsitessites=_ALL_">
                                                                           <then>

                                                                              <SETVAR NAME="errno" VALUE="0"/>
                                                                              <PUBLICATION.LIST LIST="PublicationResults"/>
                                                                              <IF COND="IsList.PublicationResults=true">
                                                                                 <THEN>
                                                                                    <LOOP LIST="PublicationResults">

                                                                                       <IF COND="PublicationResults.#curRow=1">
                                                                                          <THEN>
                                                                                             <setvar NAME="sitelist" VALUE="PublicationResults.id"/>
                                                                                          </THEN>
                                                                                          <ELSE>
                                                                                             <setvar NAME="sitelist" VALUE="Variables.sitelist;PublicationResults.id"/>
                                                                                          </ELSE>
                                                                                       </IF>
                                                                                    </LOOP>
                                                                                    <STRINGLIST NAME="sitelist" STR="Variables.sitelist" DELIM=";" />
                                                                                 </THEN>
                                                                              </IF>
                                                                           </then>
                                                                           <else>
                                                                              <STRINGLIST NAME="sitelist" STR="Variables.update:legalsitessites" DELIM=";" />
                                                                           </else>
                                                                        </if>

                                                                        <!-- we need a , separated string of site ids for the tag getmultisiteusers -->
                                                                        <setvar NAME="sitelist" VALUE="Variables.empty"/>
                                                                        <if COND="sitelist.#numRows!=0">
                                                                           <then>
                                                                              <loop LIST="sitelist">
                                                                                 <setvar NAME="sitelist" VALUE="Variables.sitelist,sitelist.ITEM"/>
                                                                              </loop>
                                                                              <substring STR="Variables.sitelist" OUTSTR="sitelist" INDEX="1"/>
                                                                           </then>
                                                                        </if>

                                                                        <USERMANAGER.GETMULTISITEUSERS ROLE="Variables.rolename" SITES="Variables.sitelist" PREFIX="currentUsers:"/>
                                                                        <if COND="IsVariable.currentUsers:Total=true">
                                                                           <then>

                                                                              <IF COND="Variables.currentUsers:Total!=0">
                                                                                 <THEN>
                                                                                    <SETCOUNTER NAME="currentUser" VALUE="0"/>
                                                                                    <SETVAR NAME="myuser" VALUE="Variables.empty"/>
                                                                                    <LOOP COUNT="Variables.currentUsers:Total">
                                                                                       <CCUSER.GETID NAME="currentUsers:Counters.currentUser" VARNAME="cID"/>
                                                                                       <SETVAR NAME="testvar" VALUE="Variables.Variables.cID"/>
                                                                                       <CCUSER.GETDISPLAYABLENAME NAME="currentUsers:Counters.currentUser" VARNAME="uname"/>


                                                                                       <SETVAR NAME="Variables.uname__cID" VALUE="Variables.cID"/>
                                                                                       <INCCOUNTER NAME="currentUser" VALUE="1"/>
                                                                                       <SETVAR NAME="myuser" VALUE="Variables.myuser;Variables.uname"/>
                                                                                       <STRING.SORT VALUE="Variables.myuser" DELIM=";" VARNAME="myuser"/>
                                                                                    </LOOP>
                                                                                    <STRINGLIST   NAME="SortedUsers" STR="Variables.myuser" DELIM=";"/>


                                                                                    <SELECT NAME="Variables.rolename" MULTIPLE="yes" SIZE="4" REPLACEALL="Variables.rolename">
                                                                                       <LOOP LIST="SortedUsers">
                                                                                          <SETVAR NAME="cID" VALUE="Variables.SortedUsers.ITEM__cID"/>
                                                                                          <HASH.CONTAINS NAME="hashrlist.ITEM" VALUE="Variables.cID" VARNAME="hasit"/>
                                                                                          <IF COND="Variables.hasit=true">
                                                                                             <THEN>
                                                                                                <OPTION SELECTED="yes" VALUE="Variables.cID" REPLACEALL="Variables.cID">
                                                                                                   <STRING.STREAM VALUE="SortedUsers.ITEM"/>
                                                                                                </OPTION>
                                                                                             </THEN>
                                                                                             <ELSE>
                                                                                                <OPTION  VALUE="Variables.cID" REPLACEALL="Variables.cID">
                                                                                                   <STRING.STREAM VALUE="SortedUsers.ITEM"/>
                                                                                                </OPTION>
                                                                                             </ELSE>
                                                                                          </IF>
                                                                                       </LOOP>
                                                                                    </SELECT>
                                                                                 </THEN>
                                                                                 <ELSE>
							[
                                                                                    <XLAT.STREAM KEY="dvin/UI/Admin/Nousersdefined"/>
]
                                                                                 </ELSE>
                                                                              </IF>
                                                                           </then>
                                                                           <else>
						[
                                                                              <XLAT.STREAM KEY="dvin/UI/Admin/Nousersdefined"/>
]
                                                                           </else>
                                                                        </if>
                                                                  </td>
                                                                  <td>
                                                                     <BR />
                                                                  </td>
                                                               </tr>
                                                               <IF COND="Variables.rowStyle=tile-row-normal">
                                                                  <THEN>
                                                                     <SETVAR NAME="rowStyle" VALUE="tile-row-highlight"/>
                                                                  </THEN>
                                                                  <ELSE>
                                                                     <SETVAR NAME="rowStyle" VALUE="tile-row-normal"/>
                                                                  </ELSE>
                                                               </IF>
																<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
                                                            </loop>

                                                         </table>
                                                      </td>
                                                      <td class="tile-dark" nowrap="true" VALIGN="top" WIDTH="1">
                                                         <BR />
                                                      </td>

                                                   </tr>

                                                   <tr>
                                                      <td colspan="3" class="tile-dark" nowrap="true" VALIGN="TOP" HEIGHT="1">
                                                         <IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/>
                                                      </td>
                                                   </tr>
                                                   <tr>
                                                      <td></td>
                                                      <td background="Variables.cs_imagedir/graphics/common/screen/shadow.gif" REPLACEALL="Variables.cs_imagedir">
                                                         <IMG WIDTH="1" HEIGHT="5" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/>
                                                      </td>
                                                      <td></td>
                                                   </tr>
                                                   <TR>
                                                      <TD></TD>
                                                      <td VALIGN="TOP" ALIGN="RIGHT" WIDTH="1">
                                                         <A HREF="javascript:document.forms;" onClick="return selectAll();" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true;" REPLACEALL="Variables._XLAT_">
															<CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/SelectAll"/></CALLELEMENT>
                                                         </A>
                                                         <P/>
                                                      </td>
                                                   </TR>
                                                </table>
                                             </THEN>
                                          </IF>
                                    </td>

                                 </tr>

                              </THEN>
                           </IF>
							<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/FooterBar"/>
							<TR>
								<TD class="form-label-text"></TD><TD class="form-inset">
							  <XLAT.LOOKUP KEY="dvin/UI/CancelSetParticipantsforWorkflow" VARNAME="_XLAT_" ESCAPE="true"/>
							   <A HREF="javascript:history.go(-1)" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true;" REPLACEALL="Variables._XLAT_">
								<CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/Cancel"/></CALLELEMENT>
							   </A>
							   <IF COND="IsVariable.item:process=true">
								  <THEN>
									 <XLAT.LOOKUP KEY="dvin/UI/SetParticipantsforWorkflow" VARNAME="_XLAT_" ESCAPE="true"/>
									 <A HREF="javascript:void(0);" onClick="if(CheckWorkflow('StartMenuFront','new')!=false){document.forms['AppForm'].submit();return false;}" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true;" REPLACEALL="Variables._XLAT_">
										<CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/SetParticipants"/></CALLELEMENT>
									 </A>
								  </THEN>
								  <ELSE>
									 <IF COND="Variables.noSelect!=true">
										<THEN>
										   <XLAT.LOOKUP KEY="dvin/UI/AssetMgt/SelectWorkflow" VARNAME="_XLAT_" ESCAPE="true"/>
										   <A HREF="javascript:void(0);" onClick="if(SelectWorkflow('StartMenuFront','select')!=false){document.forms['AppForm'].submit();return false;}" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true;" REPLACEALL="Variables._XLAT_">
											  <CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/SelectWorkflow"/></CALLELEMENT>
										   </A>
										</THEN>
									 </IF>
								  </ELSE>
							   </IF>
								</TD>
							</TR>
                        </table>

                     </td></tr>
               </table>
               <P/>
               <P/>
            </THEN>
         </IF>

         <!-- ------------------------ op=view ----------------------------- -->
         <IF COND="Variables.op=view">
            <THEN>
               <STARTMENU.LOAD ID="Variables.startitem" OBJVARNAME="menu"/>
               <IF COND="Variables.errno=0">
                  <THEN>
                     <STARTMENUITEM.SCATTER NAME="menu" PREFIX="item:"/>
					<table class="width-outer-70" cellspacing="0" cellpadding="0" border="0">
					<tr><td>
                     <span class="title-text">
                        <XLAT.STREAM KEY="dvin/UI/Admin/StartMenuItem"/>
:
                        <STRING.STREAM VALUE="Variables.item:name"/>
 					    <SETVAR NAME="startMenuItemName_for_AlloyUI" VALUE="Variables.item:name" />
						<SETVAR NAME="startMenuItemDescription_for_AlloyUI" VALUE="Variables.item:description" />
						<SETVAR NAME="startMenuItemSubType_for_AlloyUI" VALUE="Variables.item:assetsubtype" />
                    </span>
                   	</td></tr>
					<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/TitleBar"/>
					</table>
                     <table BORDER="0" CELLSPACING="0" CELLPADDING="0" class="width-outer-50 margin-top-zero">
                        <tr><td>
                              <table class="width-inner-100" cellpadding="0" cellspacing="0" border="0" bgcolor="#ffffff">
                                 <tr>
                                    <td class="form-label-text" colspan="3">
                                          <table class="legacyAbar" border="0" cellpadding="0" cellspacing="0">
                                             <tr>
                                                <td>
                                                   <XLAT.LOOKUP KEY="dvin/Common/Inspect" VARNAME="_XLAT_" ESCAPE="true"/>
                                                   <XLAT.LOOKUP KEY="dvin/UI/Admin/InspectThisStartMenu" VARNAME="_alt_"/>
                                                   <SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Admin/StartMenuFront" outstring="urlstartmenufront">
                                                       <satellite.argument name="cs_environment" value="Variables.cs_environment"/>
                                                       <satellite.argument name="cs_formmode" value="Variables.cs_formmode"/>
                                                         <satellite.argument name="op" value="view"/>
                                                         <satellite.argument name="startitem" value="Variables.startitem"/>
                                                          </SATELLITE.LINK>
                                                   <A HREF="Variables.urlstartmenufront" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true" REPLACEALL="Variables.urlstartmenufront,Variables._XLAT_">
                                                      <img height="14" width="14" hspace="2" src="Variables.cs_imagedir/graphics/common/icon/iconInspectContentUp.gif"  border="0" alt="Variables._alt_" REPLACEALL="Variables.cs_imagedir,Variables._alt_"/>
                                                   </A>
                                                </td>
                                                <td>
                                                   <A HREF="Variables.urlstartmenufront" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true" REPLACEALL="Variables.urlstartmenufront,Variables._XLAT_">
                                                      <span class="action-text">
                                                         <XLAT.STREAM KEY="dvin/Common/Inspect"/>
                                                      </span>
                                                   </A>
                                                </td>
                                                <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>
                                                <td>
                                                   <XLAT.LOOKUP KEY="dvin/Common/Edit" VARNAME="_XLAT_" ESCAPE="true"/>
                                                   <XLAT.LOOKUP KEY="dvin/UI/Admin/EditThisStartMenu" VARNAME="_alt_"/>
                                                   <SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Admin/StartMenuFront" outstring="urlstartmenufront">
                                                       <satellite.argument name="cs_environment" value="Variables.cs_environment"/>
                                                       <satellite.argument name="cs_formmode" value="Variables.cs_formmode"/>
                                                         <satellite.argument name="op" value="new"/>
                                                         <satellite.argument name="startitem" value="Variables.startitem"/>
                                                         <satellite.argument name="action" value="edit"/>
                                                          </SATELLITE.LINK>
                                                   <A HREF="Variables.urlstartmenufront" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true" REPLACEALL="Variables.urlstartmenufront,Variables._XLAT_">
                                                      <img height="14" width="14" src="Variables.cs_imagedir/graphics/common/icon/iconEditContentUp.gif" hspace="2" border="0" alt="Variables._alt_" REPLACEALL="Variables.cs_imagedir,Variables._alt_"/>
                                                   </A>
                                                </td>
                                                <td>
                                                   <A HREF="Variables.urlstartmenufront" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true" REPLACEALL="Variables.urlstartmenufront,Variables._XLAT_">
                                                      <span class="action-text">
                                                         <XLAT.STREAM KEY="dvin/Common/Edit"/>
                                                      </span>
                                                   </A>
                                                </td>

                                                <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>

                                                <td>
                                                   <XLAT.LOOKUP KEY="dvin/Common/Delete" VARNAME="_XLAT_" ESCAPE="true"/>
                                                   <XLAT.LOOKUP KEY="dvin/UI/Admin/DeleteThisStartMenu" VARNAME="_alt_"/>
                                                   <SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Admin/StartMenuFront" outstring="urlstartmenufront">
                                                       <satellite.argument name="cs_environment" value="Variables.cs_environment"/>
                                                       <satellite.argument name="cs_formmode" value="Variables.cs_formmode"/>
                                                         <satellite.argument name="op" value="confirmdelete"/>
                                                         <satellite.argument name="startitem" value="Variables.startitem"/>
                                                          </SATELLITE.LINK>
                                                   <A HREF="Variables.urlstartmenufront" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true" REPLACEALL="Variables.urlstartmenufront,Variables._XLAT_">
                                                      <img height="14" width="14" src="Variables.cs_imagedir/graphics/common/icon/iconDeleteContentUp.gif" hspace="2" border="0" alt="Variables._alt_" REPLACEALL="Variables.cs_imagedir,Variables._alt_"/>
                                                   </A>
                                                </td>
                                                <td>
                                                   <A HREF="Variables.urlstartmenufront" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true" REPLACEALL="Variables.urlstartmenufront,Variables._XLAT_">
                                                      <span class="action-text">
                                                         <XLAT.STREAM KEY="dvin/Common/Delete"/>
                                                      </span>
                                                   </A>
                                                </td>
                                                <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>

                                             </tr>
                                          </table>
                                    </td>
                                 </tr>
                              </table>
                              <table width="100%" cellpadding="0" cellspacing="0" border="0" bgcolor="#ffffff">
                                <!--<tr>
                                    <td colspan="2" class="light-line-color">
                                       <img height="1" width="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/>
                                    </td>
                                 </tr>-->
                                 <CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
								 <tr>
                                    <td class="form-label-text" WIDTH="20%">
                                          <XLAT.STREAM KEY="dvin/Common/Name"/>:
                                    </td>
                                    <td class="form-inset">
                                          <STRING.STREAM VALUE="Variables.item:name"/>
                                    </td>
                                 </tr>
                                 <CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
								 <!--<tr>
                                    <td colspan="2" class="light-line-color">
                                       <img height="1" width="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/>
                                    </td>
                                 </tr>-->
                                 <tr>
                                    <td class="form-label-text">
                                          <XLAT.STREAM KEY="dvin/Common/Description"/>:
                                    </td>
                                    <td class="form-inset">
                                          <NOBR>
                                             <STRING.STREAM VALUE="Variables.item:description"/>
                                          </NOBR>
                                    </td>
                                 </tr>
                                 <CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
								 <!--<tr>
                                    <td colspan="2" class="light-line-color">
                                       <img height="1" width="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/>
                                    </td>
                                 </tr>-->
                                 <tr>
                                    <td class="form-label-text">
                                          <XLAT.STREAM KEY="dvin/Common/Type"/>:
                                    </td>
                                    <td class="form-inset">
                                          <IF COND="Variables.item:itemtype=Word">
                                             <THEN>
                                                <XLAT.STREAM KEY="dvin/UI/CSDesktop"/>
                                             </THEN>
                                             <ELSE>
                                                <IF COND="Variables.item:itemtype=Search">
                                                   <THEN>
                                                      <XLAT.STREAM KEY="dvin/Common/Search"/>
                                                   </THEN>
                                                   <ELSE>
												   
												   <IF COND="Variables.item:itemtype=InsiteForm">
                                                   <THEN>
                                                      <XLAT.STREAM KEY="dvin/UI/Admin/NewInsite"/>
                                                   </THEN>
                                                   <ELSE>
														
                                                      <IF COND="Variables.item:itemtype=ContentForm">
                                                         <THEN>
                                                            <XLAT.STREAM KEY="dvin/Common/New"/>
                                                         </THEN>
                                                         <ELSE>
                                                            <XLAT.STREAM KEY="dvin/UI/Admin/CSDocLink"/>
                                                         </ELSE>
                                                      </IF>
													  </ELSE>
													  </IF>
                                                   </ELSE>
                                                </IF>
                                             </ELSE>
                                          </IF>
                                    </td>
                                 </tr>
                                 <CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
								 <!--<tr>
                                    <td colspan="2" class="light-line-color">
                                       <img height="1" width="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/>
                                    </td>
                                 </tr>-->
                                 <tr>
                                    <td class="form-label-text">
                                       <NOBR>
                                             <XLAT.STREAM KEY="dvin/UI/AssetType"/>:
                                       </NOBR>
                                    </td>
                                    <td class="form-inset">
                                     <ASSETTYPE.LIST LIST="atList" FIELD1="assettype" VALUE1="Variables.item:assettype"/>
									<SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Admin/AssetTypeFront" outstring="urlassettypefront">
										<satellite.argument name="cs_environment" value="Variables.cs_environment"/>
										<satellite.argument name="cs_formmode" value="Variables.cs_formmode"/>
										<satellite.argument name="action" value="details"/>
										<satellite.argument name="assettype" value="Variables.item:assettype"/>
									</SATELLITE.LINK>
									<XLAT.LOOKUP KEY="dvin/Common/Inspect" VARNAME="_XLAT_" ESCAPE="true"/>
                                    <a HREF="Variables.urlassettypefront" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true" REPLACEALL="Variables.urlassettypefront,Variables._XLAT_"><STRING.STREAM LIST="atList" COLUMN="description"/></a>
                                    </td>
                                 </tr>
                                 <!-- for flex assets/parents display the value of the subtype -->
                                 <HASH.CONTAINS NAME="hFlexTypes" VALUE="Variables.item:assettype" VARNAME="hasit"/>
								 <IF COND="Variables.hasit=false">
                                 <THEN>
									<HASH.CONTAINS NAME="hFlexParentTypes" VALUE="Variables.item:assettype" VARNAME="hasit"/>
								 </THEN>
								 </IF>
                                 <SETVAR NAME="WhichFlexType" VALUE="none"/>
                                 <IF COND="Variables.hasit=true">
                                 <THEN>

                                      <HASH.CONTAINS NAME="hFlexTypes" VALUE="Variables.item:assettype" VARNAME="hasit"/>
                                      <IF COND="Variables.hasit=true">
                                      <THEN>
                                        <SETVAR NAME="WhichFlexType" VALUE="asset"/>
                                      </THEN>
                                      <ELSE>
                                         <HASH.CONTAINS NAME="hFlexParentTypes" VALUE="Variables.item:assettype" VARNAME="hasit"/>
                                         <IF COND="Variables.hasit=true">
                                         <THEN>
                                          <SETVAR NAME="WhichFlexType" VALUE="parent"/>
                                         </THEN>
                                         </IF>
                                      </ELSE>
                                      </IF>
                                     <CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
									 <!--<tr>
                                        <td colspan="2" class="light-line-color">
                                           <img height="1" width="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/>
                                        </td>
                                     </tr>-->
                                     <tr>
                                        <td class="form-label-text">
                                           <NOBR>
                                                  <IF COND="Variables.WhichFlexType=asset">
                                                  <THEN>
                                                     <XLAT.STREAM KEY="dvin/FlexibleAssets/Common/FlexDefinition"/>
                                                  </THEN>
                                                  <ELSE>
                                                      <XLAT.STREAM KEY="dvin/FlexibleAssets/Common/FlexParentDefinition"/>
                                                  </ELSE>
                                                  </IF>
                                            :
                                           </NOBR>
                                        </td>
                                        <td class="form-inset">
                                               <IF COND="Variables.item:assetsubtype!=Variables.empty">
                                               <THEN>
                                                   <STRING.STREAM VARIABLE="item:assetsubtype"/>
                                               </THEN>
                                               <ELSE>
                                                   [<XLAT.STREAM KEY="dvin/Common/Any"/>]
                                               </ELSE>
                                               </IF>
                                        </td>
                                     </tr>
									 <!--<tr>
                                        <td colspan="2" class="light-line-color">
                                           <img height="1" width="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/>
                                        </td>
                                     </tr>-->
                                 </THEN>
                                 </IF>
							
							<XLAT.LOOKUP KEY="dvin/Common/Search" VARNAME="searchStartMenuItem" ESCAPE="true"/>
							<IF COND="Variables.item:itemtype!=Variables.searchStartMenuItem">
							<THEN>
								  <CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
								  <tr>
								  <td class="form-label-text">
                                          <XLAT.STREAM KEY="dvin/UI/Admin/DefaultValues"/>:
                                    </td>
                                    <td class="form-inset">
                                           <VECTOR.CREATE NAME="vDefaultArgs"/>
                                          <IF COND="Variables.item:argumentsargumentTotal!=0">
                                         <THEN>
                                             <SETCOUNTER NAME="currentArg" VALUE="0"/>
                                             <SETCOUNTER NAME="currentValidArg" VALUE="0"/>
                                             <!--
                                                yoda-0 Display the Default Attributes and Values
                                                1) All AssetReferences  as defined by
                                                   the following
                                                    1) ${Attribute_}
                                                    2) ${Group_}
                                                    3) ${
                                               -->

                                             <LOOP COUNT="Variables.item:argumentsargumentTotal">

                                               <SETVAR NAME="textName" VALUE="Variables.item:argumentsargumentCounters.currentArgname"/>
                                               <SETVAR NAME="textValue" VALUE="Variables.item:argumentsargumentCounters.currentArgvalue"/>
                                               <SETVAR NAME="errno" VALUE="0"/>

                                               <BEGINS STR="Variables.textName" WHAT="cs_Permission_"/>
                                               <IF COND="Variables.errno=0">
                                               <THEN>
                                                    <IF COND="Variables.item:assetsubtype!=Variables.empty">
                                                    <THEN>
                                                          <!-- Is the a Parent Def Group SV or MV
                                                               Field with a Assigned Associated Asset
                                                           -->
                                                           <BEGINS STR="Variables.textName" WHAT="Group_"/>
                                                           <IF COND="Variables.errno=1">
                                                           <THEN>
                                                               <!--
                                                                     Must Get the Group Type for the Startmenu assetType
                                                                -->
                                                               <FATM.GETGROUPTYPE    ASSETTYPE="Variables.item:assettype" VARNAME="grouptype"/>

                                                               <ASSET.LOAD NAME="parentAsset" TYPE="Variables.grouptype" FIELD="id" VALUE="Variables.textValue"  />
                                                               <!-- Get the Asset Parent Name to be displayed as its value -->
                                                               <ASSET.GET NAME="parentAsset" FIELD="name" OUTPUT="parentName" />
                                                               <SETVAR NAME="displayThis" VALUE="Variables.parentName"/>
                                                               <SUBSTITUTE STR="Variables.textName" WHAT="Group_" WITH="" OUTSTR="textName"/>
                                                                          
                                                            </THEN>
                                                            <ELSE>
                                                                      <SUBSTITUTE STR="Variables.textName" WHAT="Attribute_" WITH="" OUTSTR="textName"/>

                                                                 <!-- Is Asset Child Reference -->
                                                                       <STRINGLIST STR="Variables.textValue" DELIM=":" NAME="asset"/>
                                                                       <IF COND="asset.#numRows=2">
                                                                       <THEN>
                                                                                <SETROW LIST="asset" ACTION="FIRST"/>
                                                                                <SETVAR NAME="type" VALUE="asset.ITEM"/>
                                                                                <SETROW LIST="asset" ACTION="NEXT"/>
                                                                                <SETVAR NAME="id" VALUE="asset.ITEM"/>
                                                                                <ASSET.LOAD NAME="myChildAsset" TYPE="Variables.type" OBJECTID="Variables.id"/>
                                                                                <ASSET.GET NAME="myChildAsset" FIELD="name" OUTPUT="childname"/>
                                                                                <SETVAR NAME="displayThis" VALUE="Variables.childname"/>
                                                                            </THEN>
                                                                            <ELSE>
                                                                                <SETVAR name="displayThis" VALUE="Variables.textValue" />
                                                                         <!--   <INSPECTOR.GETVALUE  ATTRIBUTE="Variables.textName" VALUE="Variables.item:argumentsargumentCounters.currentArgvalue" TYPE="Variables.item:assettype" SUBTYPE="Variables.item:assetsubtype" VARNAME="displayThis"/>    -->
                                                                        </ELSE>
                                                                        </IF>

                                                           </ELSE>
                                                         </IF>
                                                    </THEN>
                                                    <ELSE>
                                                         <INSPECTOR.GETVALUE  ATTRIBUTE="Variables.textName" VALUE="Variables.item:argumentsargumentCounters.currentArgvalue" TYPE="Variables.item:assettype" VARNAME="displayThis"/>
                                                    </ELSE>
                                                    </IF>
                                               </THEN>

                                               <ELSE>
                                                   <SETVAR NAME="displayThis" VALUE="Variables.item:argumentsargumentCounters.currentArgvalue"/>
                                               </ELSE>

                                               </IF>

                                               <IF COND="Variables.textName=subtype">
                                               <THEN>
                                                   <IF COND="Variables.WhichFlexType=none">
                                                   <THEN>
                                                       <VECTOR.ADD NAME="vDefaultArgs" VALUE="Variables.textName=Variables.displayThis"/>
                                                       <SETVAR NAME="Alloy_DefaultArgNameCounters.currentValidArg" VALUE="Variables.textName" />
                                                       <SETVAR NAME="Alloy_DefaultArgValueCounters.currentValidArg" VALUE="Variables.displayThis" />
		                                               <INCCOUNTER NAME="currentValidArg" VALUE="1"/>
												   </THEN>
												   </IF>
                                               </THEN>
                                               <ELSE>
													<IF COND="Variables.textName=Dimension">
												    <THEN>
														<ASSET.LOAD NAME="dimAsset" TYPE="Dimension" FIELD="id" VALUE="Variables.displayThis"  />
														<ASSET.GET NAME="dimAsset" FIELD="name" OUTPUT="dimensionName" />						
														<VECTOR.ADD NAME="vDefaultArgs" VALUE="Variables.textName=Variables.dimensionName"/>
													</THEN>
													<ELSE>
                                                       <!-- Gather the Named Associations field specially -->
                                                       <BEGINS STR="Variables.textName" WHAT="Association-named:"/>
                                                       <IF COND="Variables.errno=1">
                                                       <THEN>
                                                         <STRINGLIST STR="Variables.textValue" DELIM=":" NAME="mylist"/>
                                                         <IF COND="mylist.#numRows=2">
                                                         <THEN>
                                                            <LOOP LIST="mylist">
                                                               <IF COND="mylist.#curRow=1">
                                                               <THEN>
                                                                  <setvar NAME="childassettype" VALUE="mylist.ITEM"/>
                                                               </THEN>
                                                               <ELSE>
                                                                  <setvar NAME="childassetid" VALUE="mylist.ITEM"/>
                                                               </ELSE>
                                                               </IF>
                                                            </LOOP>
                                                            <ASSET.LOAD NAME="myChildAsset" TYPE="Variables.childassettype" OBJECTID="Variables.childassetid"/>
                                                            <ASSET.GET NAME="myChildAsset" FIELD="name" OUTPUT="childname"/>
                                                            <SETVAR NAME="displayThis" VALUE="Variables.childname"/>
                                                             <SUBSTITUTE STR="Variables.textName" WHAT="Association-named:" WITH="" OUTSTR="textName"/>
                                                             
                                                         </THEN>
                                                         </IF>
                                                        </THEN>
                                                       </IF>
                                                        
                                                       <VECTOR.ADD NAME="vDefaultArgs" VALUE="Variables.textName=Variables.displayThis"/>
													</ELSE>
													</IF>
      
                                                     <IF COND="IsVariable.displayThis=true">
                                                        <THEN>
                                                              <SETVAR NAME="Alloy_DefaultArgNameCounters.currentValidArg" VALUE="Variables.textName" />
												              <SETVAR NAME="Alloy_DefaultArgValueCounters.currentValidArg" VALUE="Variables.displayThis" />
												              <INCCOUNTER NAME="currentValidArg" VALUE="1"/>
                                                        </THEN>
                                                    </IF>

                                               </ELSE>
                                               </IF>
                                               <INCCOUNTER NAME="currentArg" VALUE="1"/>
                                            </LOOP>
                                         </THEN>
                                         <ELSE>
                                            <SETVAR NAME="item:sarguments" VALUE="Variables.empty"/>
                                         </ELSE>
                                          </IF>
                                          <VECTOR.HASDATA NAME="vDefaultArgs" VARNAME="hasit"/>
                                          <IF COND="Variables.hasit=true">
                                          <THEN>
                                              <VECTOR.TOSTRING NAME="vDefaultArgs" VARNAME="item:sarguments" DELIM=","/>
                                              <STRINGLIST NAME="lDefArgs" STR="Variables.item:sarguments" DELIM=","/>
                                              <LOOP LIST="lDefArgs">
                                                  <STRING.STREAM LIST="lDefArgs" COLUMN="ITEM"/><BR/>
                                              </LOOP>
                                          </THEN>
                                          </IF>
                                    </td>
                                 </tr>
                                 
								 <!--<tr>
                                    <td colspan="2" class="light-line-color">
                                       <img height="1" width="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/>
                                    </td>
                                 </tr>-->
                       </THEN>
                       </IF>
                                 <CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
								 <tr>
                                    <td class="form-label-text">
                                          <XLAT.STREAM KEY="dvin/Common/Sites"/>:
                                    </td>
                                    <td class="form-inset">
                                          <IF COND="Variables.item:legalsitessites!=Variables.empty">
                                             <THEN>
                                                <IF COND="Variables.item:legalsitessites=_ALL_">
                                                   <THEN>
                                                      <XLAT.STREAM KEY="dvin/Common/Any"/>
                                                   </THEN>
                                                   <ELSE>

                                                      <STRINGLIST NAME="selSites" STR="Variables.item:legalsitessites" DELIM=";"/>
                                                      <LOOP LIST="selSites">
                                                         <PUBLICATION.LIST LIST="pub" FIELD1="id" VALUE1="selSites.ITEM"/>
                                                         <XLAT.LOOKUP KEY="dvin/Common/Inspect" VARNAME="_XLAT_" ESCAPE="true"/>
															<SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Admin/SiteFront" outstring="urlsitefront">
																<satellite.argument name="cs_environment" value="Variables.cs_environment"/>
																<satellite.argument name="cs_formmode" value="Variables.cs_formmode"/>
																<satellite.argument name="action" value="details"/>
																<satellite.argument name="pubid" value="selSites.ITEM"/>
															</SATELLITE.LINK>

                                                         <IF COND="selSites.#curRow=1">
                                                            <THEN>
                                                               <A HREF="Variables.urlsitefront" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true" REPLACEALL="Variables.urlsitefront,Variables._XLAT_">
																<STRING.STREAM VALUE="pub.name"/></A>
                                                            </THEN>
                                                            <ELSE>, <A HREF="Variables.urlsitefront" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true" REPLACEALL="Variables.urlsitefront,Variables._XLAT_">
																<STRING.STREAM VALUE="pub.name"/></A>
                                                            </ELSE>
                                                         </IF>
                                                      </LOOP>
                                                   </ELSE>
                                                </IF>

                                             </THEN>
                                          </IF>
                                    </td>
                                 </tr>
                                 <CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
								 <!--<tr>
                                    <td colspan="2" class="light-line-color">
                                       <img height="1" width="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/>
                                    </td>
                                 </tr>-->
                                 <tr>
                                    <td class="form-label-text">
                                          <XLAT.STREAM KEY="dvin/Common/Roles"/>:
                                    </td>
                                    <td class="form-inset">
                                          <IF COND="Variables.item:legalrolesroles!=Variables.empty">
                                             <THEN>
                                                <IF COND="Variables.item:legalrolesroles=_ALL_">
                                                   <THEN>
                                                      <XLAT.STREAM KEY="dvin/Common/AnyRole"/>
                                                   </THEN>
                                                   <ELSE>
                                                      <SUBSTITUTE STR="Variables.item:legalrolesroles" WHAT="," WITH=",%20" OUTSTR="selRoles"/>
                                                      <STRING.STREAM VALUE="Variables.selRoles"/>
                                                      <BR/>
                                                   </ELSE>
                                                </IF>
                                             </THEN>
                                          </IF>
                                    </td>
                                 </tr>
								 <!--<tr>
                                    <td colspan="2" class="light-line-color">
                                       <img height="1" width="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/>
                                    </td>
                                 </tr>-->
                                 
							<IF COND="Variables.item:itemtype!=Variables.searchStartMenuItem">
							<THEN>
                               <CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
								 <tr>
                                    <td class="form-label-text">
                                          <XLAT.STREAM KEY="dvin/Common/WorkflowProcess"/>:
                                    </td>
                                    <td class="form-inset">
                                          <IF COND="Variables.item:processesprocessTotal!=0">
                                             <THEN>
                                                <WORKFLOWENGINE.GETPROCESSID OBJVARNAME="currentProc" ID="Variables.item:processesprocess0"/>
                                                <IF COND="IsError.Variables.errno!=true">
												<THEN>
                                                	<WORKFLOWPROCESS.GETPROCESSNAME NAME="currentProc" VARNAME="currentName"/>
	                                                <WORKFLOWPROCESS.GETID NAME="currentProc" VARNAME="currentID"/>
    	                                            <XLAT.LOOKUP KEY="dvin/Common/Inspect" VARNAME="_XLAT_" ESCAPE="true"/>
													<SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Admin/WorkflowFront" outstring="urlwfpfront">
														<satellite.argument name="cs_environment" value="Variables.cs_environment"/>
														<satellite.argument name="cs_formmode" value="Variables.cs_formmode"/>
														<satellite.argument name="action" value="details"/>
														<satellite.argument name="processid" value="Variables.currentID"/>
													</SATELLITE.LINK>

													<A HREF="Variables.urlwfpfront" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true" REPLACEALL="Variables.urlwfpfront,Variables._XLAT_">
	                                	                <STRING.STREAM VALUE="Variables.currentName"/>
                                        	        </A>
												</THEN>
												<ELSE>
										    	 	<XLAT.LOOKUP VARNAME="wfperrmsg" KEY="dvin/UI/Admin/Error/StartMenucannotloadworkflowid" name="Variables.item:name" id="Variables.item:processesprocess0" EVALALL="false"/>
										    	 	<CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/ShowCellMessage">
														<ARGUMENT NAME="severity" VALUE="error"/>
														<ARGUMENT NAME="msgtext" VALUE="Variables.wfperrmsg"/>
									    			</CALLELEMENT>
												</ELSE>
												</IF>
                                             </THEN>
                                          </IF>
                                    </td>
                                 </tr>
                                 <IF COND="Variables.item:participantsrequiredroleTotal!=0">
                                    <THEN>
                                       <tr>
                                          <td class="form-label-text">
                                                <XLAT.STREAM KEY="dvin/Common/Participants"/>:
                                          </td>
                                          <td class="form-inset">
                                                <table BORDER="0" CELLSPACING="0" CELLPADDING="0">
                                                   <tr>
                                                      <td></td>
                                                      <td class="tile-dark" nowrap="true" HEIGHT="1">
                                                         <IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/>
                                                      </td>
                                                      <td></td>
                                                   </tr>
                                                   <tr>
                                                      <td class="tile-dark" nowrap="true" VALIGN="top" WIDTH="1">
                                                         <BR />
                                                      </td>
                                                      <td >
                                                         <table width="100%" cellpadding="0" cellspacing="0" border="0" bgcolor="#ffffff">
                                                            <tr>
                                                               <td colspan="6" class="tile-highlight">
                                                                  <IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/>
                                                               </td>
                                                            </tr>
                                                            <tr>
                                                               <td class="tile-a" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;</td>
                                                               <td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;</td>
                                                               <td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">
                                                                  <DIV class="new-table-title">
                                                                     <XLAT.STREAM KEY="dvin/Common/Role"/>
                                                                  </DIV>
                                                               </td>
                                                               <td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;&nbsp;&nbsp;&nbsp;</td>
                                                               <td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">
                                                                  <DIV class="new-table-title">
                                                                     <XLAT.STREAM KEY="dvin/Common/Users"/>
                                                                  </DIV>
                                                               </td>
                                                               <td class="tile-c" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;</td>
                                                            </tr>
                                                            <tr>
                                                               <td colspan="6" class="tile-dark" nowrap="true">
                                                                  <IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/>
                                                               </td>
                                                            </tr>
                                                            <!-- Loop over all search results. -->
                                                            <setvar NAME="rowStyle" VALUE="tile-row-normal"/>
                                                            <SETVAR NAME="separatorLine" VALUE="0"/>
                                                            <SETCOUNTER NAME="currRole" VALUE="0"/>
                                                            <SETVAR NAME="parts" VALUE="Variables.empty"/>

                                                            <!-- Reusing this template for the New/Alloy/CS7 UI requires that we create another list to store the output -->
							    <LISTOBJECT.CREATE NAME="tempList" COLUMNS="Role,Username"/>
                                                            <loop FROM="0" COUNT="Variables.item:participantsrequiredroleTotal">
                                                               <IF COND="Variables.separatorLine=1">
                                                                  <THEN>
									
																	 <!--<tr>
                                                                        <td colspan="6" class="light-line-color">
                                                                           <img height="1" width="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/>
                                                                        </td>
                                                                     </tr>-->
                                                                  </THEN>
                                                               </IF>
                                                               <SETVAR NAME="separatorLine" VALUE="1"/>
                                                               <SETVAR NAME="role" VALUE="Variables.item:participantsrequiredroleCounters.currRole"/>
                                                               <SETCOUNTER NAME="currUser" VALUE="0"/>
                                                               <SETVAR NAME="usercount" VALUE="Variables.item:participantsrequiredroleCounters.currRoleuserTotal"/>
                                                               <SETVAR NAME="currentUsers" VALUE="Variables.empty"/>
                                                               <CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
															   <tr class="Variables.rowStyle"  REPLACEALL="Variables.rowStyle">
                                                                  <td>
                                                                     <BR />
                                                                  </td>
                                                                  <td>
                                                                     <BR />
                                                                  </td>
                                                                  <td VALIGN="TOP" NOWRAP="NOWRAP" ALIGN="LEFT">
                                                                     <DIV class="small-text-inset">
                                                                        <STRING.STREAM VALUE="Variables.role:"/>
                                                                     </DIV>
                                                                  </td>
                                                                  <td>
                                                                     <BR />
                                                                  </td>
                                                                  <td VALIGN="TOP" ALIGN="LEFT">
                                                                     <DIV class="small-text-inset">
                                                                        <setvar NAME="userNames" VALUE="Variables.empty"/>
                                                                        <loop COUNT="Variables.usercount">
                                                                           <setvar NAME="uglyName" VALUE="Variables.item:participantsrequiredroleCounters.currRoleuserCounters.currUser"/>
                                                                           <USERMANAGER.GETUSERNAME USER="Variables.uglyName" VARNAME="niceName"/>
                                                                           <IF COND="Variables.parts=Variables.empty">
                                                                              <THEN>
                                                                                 <SETVAR NAME="parts" VALUE="Variables.niceName"/>
                                                                              </THEN>
                                                                              <ELSE>
                                                                                 <SETVAR NAME="parts" VALUE="Variables.parts, Variables.niceName"/>
                                                                              </ELSE>
                                                                           </IF>
                                                                           <inccounter NAME="currUser" VALUE="1"/>
                                                                        </loop>
                                                                        <INCCOUNTER NAME="currRole" VALUE="1"/>
                                                                        <STRING.STREAM VALUE="Variables.parts"/>
                                                                        <LISTOBJECT.ADDROW NAME="tempList" Role="Variables.role" Username="Variables.parts" />

                                                                        <SETVAR NAME="parts" VALUE="Variables.empty"/>
                                                                     </DIV>
                                                                  </td>
                                                                  <td>
                                                                     <BR />
                                                                  </td>
                                                               </tr>
                                                               <IF COND="Variables.rowStyle=tile-row-normal">
                                                                  <THEN>
                                                                     <SETVAR NAME="rowStyle" VALUE="tile-row-highlight"/>
                                                                  </THEN>
                                                                  <ELSE>
                                                                     <SETVAR NAME="rowStyle" VALUE="tile-row-normal"/>
                                                                  </ELSE>
                                                               </IF>
                                                            </loop>
							    <LISTOBJECT.TOLIST NAME="tempList" LISTVARNAME="ListofParticipants"/>
                                                         </table>

                                                      </td>
                                                      <td class="tile-dark" nowrap="true" VALIGN="top" WIDTH="1">
                                                         <BR />
                                                      </td>
                                                   </tr>
                                                   <tr>
                                                      <td colspan="3" class="tile-dark" nowrap="true" VALIGN="TOP" HEIGHT="1">
                                                         <IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/>
                                                      </td>
                                                   </tr>
                                                   <tr>
                                                      <td></td>
                                                      <td background="Variables.cs_imagedir/graphics/common/screen/shadow.gif" REPLACEALL="Variables.cs_imagedir">
                                                         <IMG WIDTH="1" HEIGHT="5" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/>
                                                      </td>
                                                      <td></td>
                                                   </tr>
                                                </table>
                                          </td>
                                       </tr>
                                    </THEN>
                                 </IF>
								 <!--<tr>
                                    <td colspan="2" class="light-line-color">
                                       <img height="1" width="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/>
                                    </td>
                                 </tr>-->
						</THEN>
						</IF><!-- End of <if Cond=Variables.item:itemtype != search> handling  -->
                                <CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
								 <tr>
                                    <td class="form-label-text">
                                          <XLAT.STREAM KEY="dvin/AT/Common/ID"/>:
                                    </td>
                                    <td class="form-inset">
                                          <STRING.STREAM VALUE="Variables.startitem"/>
                                    </td>
                                 </tr>

                              </table>
                           </td></tr>
                     </table>
                     <P/>
                     <DIV class="width-outer-70">
                        <SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Admin/StartMenuFront" outstring="urlstartmenufront">
                            <satellite.argument name="cs_environment" value="Variables.cs_environment"/>
                            <satellite.argument name="cs_formmode" value="Variables.cs_formmode"/>
                                                         <satellite.argument name="op" value="list"/>
                                                          </SATELLITE.LINK>
                        <A HREF="Variables.urlstartmenufront" REPLACEALL="Variables.urlstartmenufront">
                           <IMG src="Variables.cs_imagedir/graphics/common/icon/doubleArrow.gif" WIDTH="15" HEIGHT="12" BORDER="0" REPLACEALL="Variables.cs_imagedir"/>
                           <XLAT.STREAM KEY="dvin/UI/Admin/ListallStartMenuItems"/>
                        </A>
                     </DIV>
                     <P/>
                  </THEN>
               </IF>


            </THEN>
         </IF>

         <!-- ------------------------ op=confirmdelete ----------------------------- -->
         <IF COND="Variables.op=confirmdelete">
            <THEN>
               <STARTMENU.LOAD ID="Variables.startitem" OBJVARNAME="menu"/>
               <IF COND="Variables.errno=0">
                  <THEN>
                     <STARTMENUITEM.SCATTER NAME="menu" PREFIX="item:"/>
                     <table class="width-outer-70" cellspacing="0" cellpadding="0" border="0">
						<tr><td>
                     	<span class="title-text"><XLAT.STREAM KEY="dvin/UI/Admin/DeleteStartMenu"/></span>
                     	</td></tr>
						<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/TitleBar"/>
					</table>
                     <div class="width-outer-70">
                     <XLAT.LOOKUP KEY="dvin/UI/Admin/AreyousuredeletestartmenuQ" VARNAME="_msgtext_"/>
                     <callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/ShowMessage">
                        <argument NAME="msgtext" VALUE="Variables._msgtext_"/>
                        <argument NAME="severity" VALUE="warning"/>
                     </callelement>
					</div>
					<p/>
                     <table BORDER="0" CELLSPACING="0" CELLPADDING="0" class="width-outer-30 margin-top-zero">
                        <tr><td>
                              <table width="100%" cellpadding="0" cellspacing="0" border="0" bgcolor="#ffffff">
                                 <CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
								 <tr>
                                    <td class="form-label-text">
                                          <XLAT.STREAM KEY="dvin/Common/Name"/>:
                                    </td>
                                    <td class="form-inset">
                                          <STRING.STREAM VALUE="Variables.item:name"/>
                                    </td>
                                 </tr>
 									<CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
								 <!--<tr>
                                    <td colspan="2" class="light-line-color">
                                       <img height="1" width="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/>
                                    </td>
                                 </tr>-->
                                 <tr>
                                    <td class="form-label-text">
                                          <XLAT.STREAM KEY="dvin/Common/Description"/>:
                                    </td>
                                    <td class="form-inset" WIDTH="75%">
                                          <NOBR>
                                             <STRING.STREAM VALUE="Variables.item:description"/>
                                          </NOBR>
                                    </td>
                                 </tr>

									<CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>

								 <!--<tr>
                                    <td colspan="2" class="light-line-color">
                                       <img height="1" width="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/>
                                    </td>
                                 </tr>-->
                                 <tr>
                                    <td class="form-label-text">
                                          <XLAT.STREAM KEY="dvin/Common/Type"/>:
                                    </td>
                                    <td class="form-inset">
                                          <IF COND="Variables.item:itemtype=Word">
                                             <THEN>
                                                <XLAT.STREAM KEY="dvin/UI/CSDesktop"/>
                                             </THEN>
                                             <ELSE>
                                                <IF COND="Variables.item:itemtype=Search">
                                                   <THEN>
                                                      <XLAT.STREAM KEY="dvin/Common/Search"/>
                                                   </THEN>
													<ELSE>
														<IF COND="Variables.item:itemtype=InsiteForm">
														<THEN>
															<XLAT.STREAM KEY="dvin/UI/Admin/NewInsite"/>
														</THEN>
														<ELSE>
														<IF COND="Variables.item:itemtype=ContentForm">
                                                         <THEN>
                                                            <XLAT.STREAM KEY="dvin/Common/New"/>
                                                         </THEN>
                                                         <ELSE>
                                                            <XLAT.STREAM KEY="dvin/UI/Admin/CSDocLink"/>
                                                         </ELSE>
                                                      </IF>
													  </ELSE>
													  </IF>
                                                   </ELSE>
                                                </IF>
                                             </ELSE>
                                          </IF>
                                    </td>
                                 </tr>

									<CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>

								 <!--<tr>
                                    <td colspan="2" class="light-line-color">
                                       <img height="1" width="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/>
                                    </td>
                                 </tr>-->
                                 <tr>
                                    <td class="form-label-text">
                                       <NOBR>
                                             <XLAT.STREAM KEY="dvin/UI/AssetType"/>:
                                       </NOBR>
                                    </td>
                                    <td class="form-inset">
                                          <ASSETTYPE.LIST LIST="atList" FIELD1="assettype" VALUE1="Variables.item:assettype"/>
                                          <STRING.STREAM VALUE="atList.description"/>
                                    </td>
                                 </tr>
 									<CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
								<!--<tr>
                                    <td colspan="2" class="light-line-color">
                                       <img height="1" width="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/>
                                    </td>
                                 </tr>-->
                                 <tr>
                                    <td class="form-label-text">
                                          <XLAT.STREAM KEY="dvin/Common/Sites"/>:
                                    </td>
                                    <td class="form-inset">
                                          <IF COND="Variables.item:legalsitessites!=Variables.empty">
                                             <THEN>
                                             <IF COND="Variables.item:legalsitessites=_ALL_">
                                             <THEN>
                                               <XLAT.STREAM KEY="dvin/Common/Any"/>
                                             </THEN>
                                             <ELSE>
                                                <STRINGLIST NAME="selSites" STR="Variables.item:legalsitessites" DELIM=";"/>
                                                <LOOP LIST="selSites">
                                                <PUBLICATION.LIST LIST="pub" FIELD1="id" VALUE1="selSites.ITEM"/>
                                                <IF COND="selSites.#curRow=1">
                                                <THEN>
                                                  <SETVAR NAME="sites" VALUE="pub.name"/>
                                                </THEN>
                                                <ELSE>
                                                  <SETVAR NAME="sites" VALUE="Variables.sites, pub.name"/>
                                                </ELSE>
                                                </IF>
                                                </LOOP>
                                                <STRING.STREAM VALUE="Variables.sites"/>
                                             </ELSE>
                                             </IF>
                                             </THEN>
                                          </IF>
                                    </td>
                                 </tr>
									<CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
								 <!--<tr>
                                    <td colspan="2" class="light-line-color">
                                       <img height="1" width="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/>
                                    </td>
                                 </tr>-->
                                 <tr>
                                    <td class="form-label-text">
                                          <XLAT.STREAM KEY="dvin/Common/Roles"/>:
                                    </td>
                                    <td class="form-inset">
                                          <IF COND="Variables.item:legalrolesroles=_ALL_">
                                             <THEN>
                                                <XLAT.STREAM KEY="dvin/Common/AnyRole"/>
                                             </THEN>
                                             <ELSE>
                                                <SUBSTITUTE STR="Variables.item:legalrolesroles" WHAT="," WITH=",%20" OUTSTR="selRoles"/>
                                                <STRING.STREAM VALUE="Variables.selRoles"/>
                                                <BR/>
                                             </ELSE>
                                          </IF>
                                    </td>
                                 </tr>
                                 
							<XLAT.LOOKUP KEY="dvin/Common/Search" VARNAME="searchStartMenuItem" ESCAPE="true"/>
							<IF COND="Variables.item:itemtype!=Variables.searchStartMenuItem">
							<THEN>
									
                                 <callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
								 <tr>
                                    <td class="form-label-text">
                                          <XLAT.STREAM KEY="dvin/Common/WorkflowProcess"/>:
                                    </td>
                                    <td class="form-inset">
                                          <IF COND="Variables.item:processesprocessTotal!=0">
                                             <THEN>
                                                <WORKFLOWENGINE.GETPROCESSID OBJVARNAME="currentProc" ID="Variables.item:processesprocess0"/>
                                                <WORKFLOWPROCESS.GETPROCESSNAME NAME="currentProc" VARNAME="currentName"/>
                                                <WORKFLOWPROCESS.GETID NAME="currentProc" VARNAME="currentID"/>
                                                <STRING.STREAM VALUE="Variables.currentName"/>
                                             </THEN>
                                          </IF>
                                    </td>
                                 </tr>
                                 <IF COND="Variables.item:participantsrequiredroleTotal!=0">
                                    <THEN>
                                       <tr>
                                          <td class="form-label-text">
                                                <XLAT.STREAM KEY="dvin/Common/Participants"/>:
                                          </td>
                                          <td class="form-inset">
                                                <table BORDER="0" CELLSPACING="0" CELLPADDING="0">
                                                   <tr>
                                                      <td></td>
                                                      <td class="tile-dark" nowrap="true" HEIGHT="1">
                                                         <IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/>
                                                      </td>
                                                      <td></td>
                                                   </tr>
                                                   <tr>
                                                      <td class="tile-dark" nowrap="true" VALIGN="top" WIDTH="1">
                                                         <BR />
                                                      </td>
                                                      <td >
                                                         <table width="100%" cellpadding="0" cellspacing="0" border="0" bgcolor="#ffffff">
                                                            <tr>
                                                               <td colspan="6" class="tile-highlight">
                                                                  <IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/>
                                                               </td>
                                                            </tr>
                                                            <tr>
                                                               <td class="tile-a" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;</td>
                                                               <td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;</td>
                                                               <td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">
                                                                  <DIV class="new-table-title">
                                                                     <XLAT.STREAM KEY="dvin/Common/Role"/>
                                                                  </DIV>
                                                               </td>
                                                               <td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;&nbsp;&nbsp;&nbsp;</td>
                                                               <td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">
                                                                  <DIV class="new-table-title">
                                                                     <XLAT.STREAM KEY="dvin/Common/Users"/>
                                                                  </DIV>
                                                               </td>
                                                               <td class="tile-c" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;</td>
                                                            </tr>
                                                            <tr>
                                                               <td colspan="6" class="tile-dark" nowrap="true">
                                                                  <IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/>
                                                               </td>
                                                            </tr>
                                                            <!-- Loop over all search results. -->
                                                            <setvar NAME="rowStyle" VALUE="tile-row-normal"/>
                                                            <SETVAR NAME="separatorLine" VALUE="0"/>
                                                            <SETCOUNTER NAME="currRole" VALUE="0"/>
                                                            <SETVAR NAME="parts" VALUE="Variables.empty"/>
                                                            <loop FROM="0" COUNT="Variables.item:participantsrequiredroleTotal">
                                                               <IF COND="Variables.separatorLine=1">
                                                                  <THEN>
																	 <!--<tr>
                                                                        <td colspan="6" class="light-line-color">
                                                                           <img height="1" width="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/>
                                                                        </td>
                                                                     </tr>-->
                                                                  </THEN>
                                                               </IF>
                                                               <SETVAR NAME="separatorLine" VALUE="1"/>
                                                               <SETVAR NAME="role" VALUE="Variables.item:participantsrequiredroleCounters.currRole"/>
                                                               <SETCOUNTER NAME="currUser" VALUE="0"/>
                                                               <SETVAR NAME="usercount" VALUE="Variables.item:participantsrequiredroleCounters.currRoleuserTotal"/>
                                                               <SETVAR NAME="currentUsers" VALUE="Variables.empty"/>
                                                               <CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
															   <tr class="Variables.rowStyle"  REPLACEALL="Variables.rowStyle">
                                                                  <td>
                                                                     <BR />
                                                                  </td>
                                                                  <td>
                                                                     <BR />
                                                                  </td>
                                                                  <td VALIGN="TOP" NOWRAP="NOWRAP" ALIGN="LEFT">
                                                                     <DIV class="small-text-inset">
                                                                        <STRING.STREAM VALUE="Variables.role:"/>
                                                                     </DIV>
                                                                  </td>
                                                                  <td>
                                                                     <BR />
                                                                  </td>
                                                                  <td VALIGN="TOP" ALIGN="LEFT">
                                                                     <DIV class="small-text-inset">
                                                                        <setvar NAME="userNames" VALUE="Variables.empty"/>
                                                                        <loop COUNT="Variables.usercount">
                                                                           <setvar NAME="uglyName" VALUE="Variables.item:participantsrequiredroleCounters.currRoleuserCounters.currUser"/>
                                                                           <USERMANAGER.GETUSERNAME USER="Variables.uglyName" VARNAME="niceName"/>
                                                                           <IF COND="Variables.parts=Variables.empty">
                                                                              <THEN>
                                                                                 <SETVAR NAME="parts" VALUE="Variables.niceName"/>
                                                                              </THEN>
                                                                              <ELSE>
                                                                                 <SETVAR NAME="parts" VALUE="Variables.parts, Variables.niceName"/>
                                                                              </ELSE>
                                                                           </IF>
                                                                           <inccounter NAME="currUser" VALUE="1"/>
                                                                        </loop>
                                                                        <INCCOUNTER NAME="currRole" VALUE="1"/>
                                                                        <STRING.STREAM VALUE="Variables.parts"/>
                                                                        <SETVAR NAME="parts" VALUE="Variables.empty"/>
                                                                     </DIV>
                                                                  </td>
                                                                  <td>
                                                                     <BR />
                                                                  </td>
                                                               </tr>
                                                               <IF COND="Variables.rowStyle=tile-row-normal">
                                                                  <THEN>
                                                                     <SETVAR NAME="rowStyle" VALUE="tile-row-highlight"/>
                                                                  </THEN>
                                                                  <ELSE>
                                                                     <SETVAR NAME="rowStyle" VALUE="tile-row-normal"/>
                                                                  </ELSE>
                                                               </IF>
                                                            </loop>
                                                         </table>
                                                      </td>
                                                      <td class="tile-dark" nowrap="true" VALIGN="top" WIDTH="1">
                                                         <BR />
                                                      </td>
                                                   </tr>
                                                   <tr>
                                                      <td colspan="3" class="tile-dark" nowrap="true" VALIGN="TOP" HEIGHT="1">
                                                         <IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/>
                                                      </td>
                                                   </tr>
                                                   <tr>
                                                      <td></td>
                                                      <td background="Variables.cs_imagedir/graphics/common/screen/shadow.gif" REPLACEALL="Variables.cs_imagedir">
                                                         <IMG WIDTH="1" HEIGHT="5" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/>
                                                      </td>
                                                      <td></td>
                                                   </tr>
                                                </table>
                                          </td>
                                       </tr>
                                    </THEN>
                                 </IF>
						</THEN>
						</IF>
									<CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
								 <!--<tr>
                                    <td colspan="2" class="light-line-color">
                                       <img height="1" width="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/>
                                    </td>
                                 </tr>-->
								 <tr>
                                    <td class="form-label-text">
                                          <XLAT.STREAM KEY="dvin/AT/Common/ID"/>:
                                    </td>
                                    <td class="form-inset">
                                          <STRING.STREAM VALUE="Variables.startitem"/>
                                    </td>
                                 </tr>
								 <INPUT TYPE="HIDDEN" NAME="action" VALUE="delete"/>
								 <SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Admin/StartMenuFront" outstring="StartMenuFrontURL">
								 <satellite.argument name="cs_environment" value="Variables.cs_environment"/>
								 <satellite.argument name="cs_formmode" value="Variables.cs_formmode"/>
								 <satellite.argument name="op" value="view"/>
								 <satellite.argument name="startitem" value="Variables.startitem"/>
								  </SATELLITE.LINK>
								  <INPUT TYPE="HIDDEN" NAME="startitem" VALUE=""/>
								  <REPLACEALL LIST="Variables.cs_environment,Variables.cs_formmode,Variables.startitem">
									<script type="text/javascript">
									function deleteStartMenu(){
										document.AppForm.elements['pagename'].value ="OpenMarket/Xcelerate/Admin/StartMenuPost";
										document.AppForm.elements['cs_environment'].value = "Variables.cs_environment";
										document.AppForm.elements['cs_formmode'].value = "Variables.cs_formmode";
										document.AppForm.elements['startitem'].value = "Variables.startitem";
										document.AppForm.elements['op'].value = "delete";
										document.AppForm.submit();
									}
								  </script>
								  </REPLACEALL>
								  <callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/FooterBar"/>
								<TR>
									<TD class="form-label-text"></TD><TD class="form-inset">
									 <A HREF="Variables.StartMenuFrontURL" REPLACEALL="Variables.StartMenuFrontURL">
										<CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/Cancel"/></CALLELEMENT>
									 </A>
									 <A HREF="#" ONCLICK="javascript:deleteStartMenu();">
										<CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/DeleteStartMenu"/></CALLELEMENT>
									 </A>
									</TD>
								</TR>
                              </table>
                           </td></tr>
                     </table>
                     <P/>
                     <P/>
                     <P/>
                     <P/>

                  </THEN>
               </IF>
            </THEN>
         </IF><!-- end op=confirmdelete -->
      

</FTCS>
