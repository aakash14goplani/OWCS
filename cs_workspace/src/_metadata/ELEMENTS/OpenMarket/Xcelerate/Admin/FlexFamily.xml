<?xml version="1.0" ?>
<!DOCTYPE FTCS SYSTEM "futuretense_cs.dtd">
<FTCS Version="1.1">
<!-- OpenMarket/Xcelerate/Admin/FlexFamily
-
- INPUT
-
- OUTPUT
-
-->
<!-- [2007-09-18 KG]
 * XSS fixes (adapted from 6.3 fixes):
   * isCleanString function usage
   * CSVAR -> STRING.STREAM
 * changed definitions of 'obj' to just forms[0] (not .elements[0])
-->
<CALLELEMENT NAME="OpenMarket/Xcelerate/Scripts/ValidateInputForXSS" />
<STRING.ENCODE VARIABLE="cs_environment" VARNAME="cs_environment"/>
<STRING.ENCODE VARIABLE="cs_imagedir" VARNAME="cs_imagedir"/>
<STRING.ENCODE VARIABLE="cs_formmode" VARNAME="cs_formmode"/>
<input TYPE="HIDDEN" NAME="pagename" VALUE="FlexFamily"/>

<!-- check dbtype and set max table name size   
     assettype name size in flex asset tables limited to 32
     Oracle has a 30 char table name limit. with "-Extention" tables
     for flex assets .. the table name size is 20 -->
<ics.getproperty name="cs.dbtype" file="futuretense.ini" output="dbtype"/>
<IF COND="Variables.dbtype=Oracle">
    <THEN>
        <input TYPE="HIDDEN" NAME="tablenamesizelimit" VALUE="20"/>
    </THEN>
</IF>

	<SCRIPT LANGUAGE="JavaScript">
		function EditFamily(form)
		{
			var obj = document.forms[0];
	
			var postPage = "OpenMarket/Xcelerate/Admin/FlexFamilyFront";
			
			obj.pagename.value = postPage;
			obj.op.value = "editfamily";
			obj.submit();
			return false;
		}
		function DeleteFamily(form)
		{
			var obj = document.forms[0];
	
			var postPage = "OpenMarket/Xcelerate/Admin/FlexFamilyFront";
			
			obj.pagename.value = postPage;
			obj.op.value = "deletefamily";
			obj.submit();
			return false;
		}
	</SCRIPT>

	<IF COND="Variables.op=make">
	<THEN>
		<IF COND="Variables.pagetype=front">
		<THEN>
			<STRING.ENCODE VARIABLE="member" VARNAME="member"/>
         <INPUT TYPE="HIDDEN" NAME="member" VALUE="Variables.member" REPLACEALL="Variables.member"/>
			
			<IF COND="IsVariable.def=true">
			<THEN>
				<STRING.ENCODE VARIABLE="def" VARNAME="def"/>
				<INPUT TYPE="HIDDEN" NAME="def" VALUE="Variables.def" REPLACEALL="Variables.def"/>
			</THEN>
			</IF>
			
			<IF COND="Variables.member=parentdef">
			<THEN>
				<XLAT.LOOKUP KEY="dvin/FlexibleAssets/AssetMakers/FlexFamilyMakerNewParentDef" VARNAME="FFMNew"/>
            </THEN>
			<ELSE>
				<IF COND="Variables.member=def">
				<THEN>
					<XLAT.LOOKUP KEY="dvin/FlexibleAssets/AssetMakers/FlexFamilyMakerNewDef" VARNAME="FFMNew"/>
                </THEN>
				<ELSE>
					<IF COND="Variables.member=parent">
					<THEN>
						<XLAT.LOOKUP KEY="dvin/FlexibleAssets/AssetMakers/FlexFamilyMakerNewParent" VARNAME="FFMNew"/>
                    </THEN>
					<ELSE>
						<IF COND="Variables.member=asset">
						<THEN>
							<XLAT.LOOKUP KEY="dvin/FlexibleAssets/AssetMakers/FlexFamilyMakerNewAsset" VARNAME="FFMNew"/>
                        </THEN>
						<ELSE>
							<IF COND="Variables.member=filter">
							<THEN>
								<XLAT.LOOKUP KEY="dvin/FlexibleAssets/AssetMakers/FlexFamilyMakerNewFilter" VARNAME="FFMNew"/>
                            </THEN>
							</IF>
						</ELSE>
						</IF>
					</ELSE>
					</IF>
				</ELSE>
				</IF>
			</ELSE>
			</IF>
			<SCRIPT LANGUAGE="JavaScript"><![CDATA[
				function GotoNextStep(form)
				{
					var obj = document.forms[0];

					/*regardless of type, check against invalid chars in name*/
					var isclean = isCleanString(obj.elements['Filt'].value);					
					if (!isclean) {
						alert("]]><XLAT.STREAM KEY="dvin/FlexibleAssets/Attributes/ApostropheNotAllowed" ESCAPE="true" ENCODE="false"/><![CDATA[");
						return false;
					}
					
                    if(obj.elements['member'].value=='filter') {
                        if (obj.elements['Filt'].value=="")
    					{
    						alert("]]><XLAT.STREAM KEY="dvin/FlexibleAssets/AssetMakers/EnterNameforFlexFilter" ESCAPE="true" ENCODE="false"/><![CDATA[");
    						  obj.elements['Filt'].focus();
    						return false;
    					}
                        if (!IsAllowedInTablename(obj.elements['Filt'].value))
                    	{
                    		alert("]]><XLAT.STREAM KEY="dvin/FlexibleAssets/AssetMakers/NotAllowedInNameFlexFilter" ESCAPE="true" ENCODE="false"/><![CDATA[");
                            obj.elements['Filt'].focus();
                    		return false;
                    	}
                        if (obj.elements['tablenamesizelimit'] && obj.elements['Filt'].value.length>20)
                    	{
                    		alert("]]><XLAT.STREAM KEY="dvin/FlexibleAssets/AssetMakers/NameTooLongFlexFilter" ESCAPE="true" ENCODE="false"/><![CDATA[");
                            obj.elements['Filt'].focus();
                    		return false;
                    	}
                        
                        
                        if (obj.elements['DescFilt'].value=="")
    					{
    				
    						alert("]]><XLAT.STREAM KEY="dvin/FlexibleAssets/AssetMakers/EnterDescforFlexFilter" ESCAPE="true" ENCODE="false"/><![CDATA[");
    						  obj.elements['DescFilt'].focus();
    						return false;
    					}
                        
    					if (obj.elements['PluralFilt'].value=="")
    					{
    						alert("]]><XLAT.STREAM KEY="dvin/FlexibleAssets/AssetMakers/EnterPluralforFlexFilter" ESCAPE="true" ENCODE="false"/><![CDATA[");
    						  obj.elements['PluralFilt'].focus();
    						return false;
    					}

                       	if (obj.elements['parent'].value=="")
    					{
    						alert("]]><XLAT.STREAM KEY="dvin/FlexibleAssets/AssetMakers/MustselectFlexAttribute" ESCAPE="true" ENCODE="false"/><![CDATA[");
    						  obj.elements['parentList'].focus();
    						return false;
    					}
                    
                    }else if(obj.elements['member'].value=='parentdef'){

                        if (obj.elements['Filt'].value=="")
    					{
    						alert("]]><XLAT.STREAM KEY="dvin/FlexibleAssets/AssetMakers/EnterNameforFlexParentDef" ESCAPE="true" ENCODE="false"/><![CDATA[");
    						  obj.elements['Filt'].focus();
    						return false;
    					}
                        if (!IsAllowedInTablename(obj.elements['Filt'].value))
                    	{
                    		alert("]]><XLAT.STREAM KEY="dvin/FlexibleAssets/AssetMakers/NotAllowedInNameFlexParentDef" ESCAPE="true" ENCODE="false"/><![CDATA[");
                            obj.elements['Filt'].focus();
                    		return false;
                    	}

                        if (obj.elements['tablenamesizelimit'] && obj.elements['Filt'].value.length>20)
                    	{
                    		alert("]]><XLAT.STREAM KEY="dvin/FlexibleAssets/AssetMakers/NameTooLongFlexParentDef" ESCAPE="true" ENCODE="false"/><![CDATA[");
                            obj.elements['Filt'].focus();
                    		return false;
                    	}
                        
                        
                        if (obj.elements['DescFilt'].value=="")
    					{
    				
    						alert("]]><XLAT.STREAM KEY="dvin/FlexibleAssets/AssetMakers/EnterDescforFlexParentDef" ESCAPE="true" ENCODE="false"/><![CDATA[");
    						  obj.elements['DescFilt'].focus();
    						return false;
    					}
                        
    					if (obj.elements['PluralFilt'].value=="")
    					{
    						alert("]]><XLAT.STREAM KEY="dvin/FlexibleAssets/AssetMakers/EnterPluralforFlexParentDef" ESCAPE="true" ENCODE="false"/><![CDATA[");
    						  obj.elements['PluralFilt'].focus();
    						return false;
    					}

                    }else if(obj.elements['member'].value=='def'){

                        if (obj.elements['Filt'].value=="")
    					{
    						alert("]]><XLAT.STREAM KEY="dvin/FlexibleAssets/AssetMakers/EnterNameforFlexDef" ESCAPE="true" ENCODE="false"/><![CDATA[");
    						  obj.elements['Filt'].focus();
    						return false;
    					}
                        if (!IsAllowedInTablename(obj.elements['Filt'].value))
                    	{
                    		alert("]]><XLAT.STREAM KEY="dvin/FlexibleAssets/AssetMakers/NotAllowedInNameFlexDef" ESCAPE="true" ENCODE="false"/><![CDATA[");
                            obj.elements['Filt'].focus();
                    		return false;
                    	}
                       
                        if (obj.elements['tablenamesizelimit'] && obj.elements['Filt'].value.length>20)
                    	{
                    		alert("]]><XLAT.STREAM KEY="dvin/FlexibleAssets/AssetMakers/NameTooLongFlexDef" ESCAPE="true" ENCODE="false"/><![CDATA[");
                            obj.elements['Filt'].focus();
                    		return false;
                    	}
                        
                        
                        if (obj.elements['DescFilt'].value=="")
    					{
    				
    						alert("]]><XLAT.STREAM KEY="dvin/FlexibleAssets/AssetMakers/EnterDescforFlexDef" ESCAPE="true" ENCODE="false"/><![CDATA[");
    						  obj.elements['DescFilt'].focus();
    						return false;
    					}
                        
    					if (obj.elements['PluralFilt'].value=="")
    					{
    						alert("]]><XLAT.STREAM KEY="dvin/FlexibleAssets/AssetMakers/EnterPluralforFlexDef" ESCAPE="true" ENCODE="false"/><![CDATA[");
    						  obj.elements['PluralFilt'].focus();
    						return false;
    					}

                    }else if(obj.elements['member'].value=='parent'){

                        if (obj.elements['Filt'].value=="")
    					{
    						alert("]]><XLAT.STREAM KEY="dvin/FlexibleAssets/AssetMakers/EnterNameforFlexParent" ESCAPE="true" ENCODE="false"/><![CDATA[");
    						  obj.elements['Filt'].focus();
    						return false;
    					}
                        if (!IsAllowedInTablename(obj.elements['Filt'].value))
                    	{
                    		alert("]]><XLAT.STREAM KEY="dvin/FlexibleAssets/AssetMakers/NotAllowedInNameFlexParent" ESCAPE="true" ENCODE="false"/><![CDATA[");
                            obj.elements['Filt'].focus();
                    		return false;
                    	}
                       
                        if (obj.elements['tablenamesizelimit'] && obj.elements['Filt'].value.length>20)
                    	{
                    		alert("]]><XLAT.STREAM KEY="dvin/FlexibleAssets/AssetMakers/NameTooLongFlexParent" ESCAPE="true" ENCODE="false"/><![CDATA[");
                            obj.elements['Filt'].focus();
                    		return false;
                    	}
                        
                        
                        if (obj.elements['DescFilt'].value=="")
    					{
    				
    						alert("]]><XLAT.STREAM KEY="dvin/FlexibleAssets/AssetMakers/EnterDescforFlexParent" ESCAPE="true" ENCODE="false"/><![CDATA[");
    						  obj.elements['DescFilt'].focus();
    						return false;
    					}
                        
    					if (obj.elements['PluralFilt'].value=="")
    					{
    						alert("]]><XLAT.STREAM KEY="dvin/FlexibleAssets/AssetMakers/EnterPluralforFlexParent" ESCAPE="true" ENCODE="false"/><![CDATA[");
    						  obj.elements['PluralFilt'].focus();
    						return false;
    					}

                    }else if(obj.elements['member'].value=='asset'){

                        if (obj.elements['Filt'].value=="")
    					{
    						alert("]]><XLAT.STREAM KEY="dvin/FlexibleAssets/AssetMakers/EnterNameforFlexAsset" ESCAPE="true" ENCODE="false"/><![CDATA[");
    						  obj.elements['Filt'].focus();
    						return false;
    					}
                        if (!IsAllowedInTablename(obj.elements['Filt'].value))
                    	{
                    		alert("]]><XLAT.STREAM KEY="dvin/FlexibleAssets/AssetMakers/NotAllowedInNameFlexAsset" ESCAPE="true" ENCODE="false"/><![CDATA[");
                            obj.elements['Filt'].focus();
                    		return false;
                    	}
                       
                        if (obj.elements['tablenamesizelimit'] && obj.elements['Filt'].value.length>20)
                    	{
                    		alert("]]><XLAT.STREAM KEY="dvin/FlexibleAssets/AssetMakers/NameTooLongFlexAsset" ESCAPE="true" ENCODE="false"/><![CDATA[");
                            obj.elements['Filt'].focus();
                    		return false;
                    	}
                        
                        
                        if (obj.elements['DescFilt'].value=="")
    					{
    				
    						alert("]]><XLAT.STREAM KEY="dvin/FlexibleAssets/AssetMakers/EnterDescforFlexAsset" ESCAPE="true" ENCODE="false"/><![CDATA[");
    						  obj.elements['DescFilt'].focus();
    						return false;
    					}
                        
    					if (obj.elements['PluralFilt'].value=="")
    					{
    						alert("]]><XLAT.STREAM KEY="dvin/FlexibleAssets/AssetMakers/EnterPluralforFlexAsset" ESCAPE="true" ENCODE="false"/><![CDATA[");
    						  obj.elements['PluralFilt'].focus();
    						return false;
    					}

                    }
 
                    var postPage = "OpenMarket/Xcelerate/Admin/FlexFamilyPost";
					
					obj.pagename.value = postPage;
					obj.submit();
					return false;
				}
                
                ]]>
                <!-- to check if the string includes things NOT allowed in table names ! -->
                <![CDATA[
                function IsAllowedInTablename(StrVar)
                {
                 return /^[a-zA-Z\_]([0-9a-zA-Z\_])*$/.test(StrVar);
                }
			]]>
			</SCRIPT>
			<table class="width-outer-70" cellspacing="0" cellpadding="0" border="0">
				<tr><td>
					<span class="title-text"><STRING.STREAM VARIABLE="FFMNew"/></span>
				</td></tr>
				<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/TitleBar"/>
			</table>
						
			<table class="width-outer-30" BORDER="0" CELLSPACING="0" CELLPADDING="0">
			<tr>
				<td></td><td class="tile-dark" VALIGN="TOP" HEIGHT="1"><IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td><td></td>
			</tr>
			<tr>
				
				<td>
				<table class="width-inner-100" cellpadding="0" cellspacing="0" border="0" bgcolor="#ffffff"><tr></tr>
					
			<tr>
				<td class="form-label-text"><span class="alert-color">*</span><XLAT.STREAM KEY="dvin/AT/Common/Name"/>:</td>
				<td class="form-inset"><INPUT TYPE="TEXT" NAME="Filt" SIZE="32" MAXLENGTH="32"/></td>
			</tr>
			<tr>
				<CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
				<!--<td colspan="3" class="light-line-color"><img height="1" width="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>-->
			</tr>
			<tr>
				<td class="form-label-text"><span class="alert-color">*</span><XLAT.STREAM KEY="dvin/AT/Common/Description"/>:</td>
				<td class="form-inset"><INPUT TYPE="text" NAME="DescFilt" SIZE="32" MAXLENGTH="255"/></td>
			</tr>
			<tr>
				<CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
				<!--<td colspan="3" class="light-line-color"><img height="1" width="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>-->
			</tr>
			<tr>
				<td class="form-label-text"><span class="alert-color">*</span><XLAT.STREAM KEY="dvin/UI/Admin/PluralForm"/>:</td>
				<td class="form-inset"><INPUT TYPE="text" NAME="PluralFilt" SIZE="32" MAXLENGTH="30"/></td>
			</tr>
			<tr>
				<CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
				<!--<td colspan="3" class="light-line-color"><img height="1" width="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>-->
			</tr>
				
			<IF COND="IsVariable.parent=true">
			<THEN>
			<STRING.ENCODE VARIABLE="parent" VARNAME="parent"/>
			<INPUT TYPE="HIDDEN" NAME="parent" VALUE="Variables.parent" REPLACEALL="Variables.parent"/>
				<tr >
					<td class="form-label-text"><XLAT.STREAM KEY="dvin/FlexibleAssets/AssetMakers/FlexAttr"/></td>
					<ASSETTYPE.LIST LIST="currentType" FIELD1="assettype" VALUE1="Variables.parent"/>
					<td class="form-inset"><STRING.STREAM VALUE="currentType.description"/></td>
					<td><br /></td>
				</tr>
			</THEN>
			<ELSE>
				<INPUT TYPE="HIDDEN" NAME="parent" VALUE=""/>
				<tr>
					<td class="form-label-text"><span class="alert-color">*</span><XLAT.STREAM KEY="dvin/FlexibleAssets/AssetMakers/FlexAttr"/></td>
					<td class="form-inset"><SELECT name="parentList" onChange="this.form.elements['parent'].value=this.options[this.selectedIndex].value;">
						<OPTION VALUE=""/><XLAT.STREAM KEY="dvin/FlexibleAssets/AssetMakers/SelectFlexAttr"/>
						<!-- now show any existing FlexAttributes -->
						<ATM.GETASSETS FILTER="com.openmarket.gator.interfaces.IAttributeManager" LISTVARNAME="currentTypes"/>
						<IF COND="IsList.currentTypes=true">
						<THEN>
							<IF COND="currentTypes.#numRows!=0">
							<THEN>
							<LOOP LIST="currentTypes">
								<ASSETTYPE.LIST LIST="currentType" FIELD1="assettype" VALUE1="currentTypes.assettype"/>

								<SETVAR NAME="tablename" VALUE="FlexFilterTypes"/>
								<CALLELEMENT NAME="OpenMarket/Xcelerate/Util/validateFields">
									<ARGUMENT NAME="columnvalue" VALUE="currentTypes.assettype"/>
									<ARGUMENT NAME="type" VALUE="String"/>
								</CALLELEMENT>
								<IF COND="Variables.validatedstatus=true">
								<THEN>
									<EXECSQL SQL="SELECT * FROM Variables.tablename WHERE filterattr='currentTypes.assettype'" LIST="lFilterType"/>
								</THEN>
								</IF>
								
								<IF COND="lFilterType.#numRows=0">
								<THEN>
									<OPTION VALUE="currentTypes.assettype" REPLACEALL="currentTypes.assettype"/><STRING.STREAM VALUE="currentType.description"/>
								</THEN>
								</IF>
							</LOOP>
							</THEN>
							</IF>
						</THEN>
						</IF>
					</SELECT>
				</td>
				</tr>
			</ELSE>
			</IF>
			<SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Admin/FlexAssetMakerFront" outstring="AssetFrontURL">
                <satellite.argument name="cs_environment" value="Variables.cs_environment"/>
                <satellite.argument name="cs_formmode" value="Variables.cs_formmode"/>
                                          <satellite.argument name="action" value="list"/>
                                           </SATELLITE.LINK>
			<XLAT.LOOKUP KEY="dvin/UI/Cancel" VARNAME="_XLAT_" ESCAPE="true"/>
			<XLAT.LOOKUP KEY="dvin/UI/Cancel" VARNAME="_XLAT_ALT"/>
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/FooterBar"/>
			<TR>
				<TD class="form-label-text"></TD><TD class="form-inset">
					<A HREF="Variables.AssetFrontURL" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true;" REPLACEALL="Variables._XLAT_,Variables.AssetFrontURL"><CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/Cancel"/></CALLELEMENT></A>
					<XLAT.LOOKUP KEY="dvin/UI/Save" VARNAME="_XLAT_" ESCAPE="true"/>
					<XLAT.LOOKUP KEY="dvin/UI/Save" VARNAME="_XLAT_ALT"/>
					<A HREF="javascript:void(0);" ONCLICK="return GotoNextStep(this.form);" ONMOUSEOVER="window.status='Variables._XLAT_';return true;" ONMOUSEOUT="window.status='';return true" REPLACEALL="Variables.urlprefix,Variables._XLAT_">
						<CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/Save"/></CALLELEMENT>
					</A>
				</TD>
			</TR>
		</table>

			</td>
			
			</tr>
			<tr>
				<td></td><td background="Variables.cs_imagedir/graphics/common/screen/shadow.gif" REPLACEALL="Variables.cs_imagedir"><IMG WIDTH="1" HEIGHT="5" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td><td></td>
			</tr>
		</table>
		<INPUT TYPE="HIDDEN" NAME="op" VALUE="make"/>
		</THEN>
		<ELSE>
			<!-- do the right thing based on which family member -->
			
			<callelement NAME="OpenMarket/Gator/FlexibleAssets/AssetMaker/addAssetType">
				<argument NAME="assetname" VALUE="Variables.Filt"/>
				<argument NAME="AssetDescription" VALUE="Variables.DescFilt"/>
				<argument NAME="AssetPlural" VALUE="Variables.PluralFilt"/>
				<argument NAME="AssetChild" VALUE="F"/>
				<argument NAME="assetlogic" VALUE="com.openmarket.assetframework.complexasset.ComplexAsset"/>
			</callelement>
			<IF COND="Variables.result!=Variables.empty">
			<THEN>
				<STRING.STREAM VARIABLE="result"/>
			</THEN>
			</IF>

			<IF COND="Variables.AssetTypeExists=true">
			<THEN>
				<XLAT.STREAM KEY="dvin/FlexibleAssets/AssetMakers/InstFiltFailed" errno="-105" Filt="Variables.Filt" errdetail1="Already exists" EVALALL="false"/>
				<setvar NAME="errno" VALUE="-105"/>
				<setvar NAME="errdetail1" VALUE="Already exists"/>
			</THEN>
			<ELSE>
			    <IF COND="Variables.member=parentdef">
			    <THEN>
				<ATM.SET TYPE="Variables.Filt" VALUE="com.openmarket.gator.flexgrouptemplates.FlexGroupTemplateManager" CATEGORY="Administration"/>
				<IF COND="Variables.errno!=0">
				<THEN>
					<STRING.STREAM VALUE="Inserting Variables.Filt into ComplexAssets failed Variables.errno, Variables.errdetail1!"/>
				</THEN>
				</IF>
				
				<callelement NAME="OpenMarket/Gator/FlexibleAssets/AssetMaker/addElements">
					<argument NAME="elementtype" VALUE="FlexTmpls"/>
					<argument NAME="AssetType" VALUE="Variables.Filt"/>
				</callelement>
				<callelement NAME="OpenMarket/Gator/FlexibleAssets/AssetMaker/addSQL">
					<argument NAME="sqltype" VALUE="FlexDefinitions"/>
					<argument NAME="AssetType" VALUE="Variables.Filt"/>
				</callelement>
				
				<!-- parent is an attribute...get filter info from the attr -->
				<SETVAR NAME="errno" VALUE="0"/>
				<SETVAR NAME="tablename" VALUE="FlexFilterTypes"/>
				<CALLELEMENT NAME="OpenMarket/Xcelerate/Util/validateFields">
					<ARGUMENT NAME="columnvalue" VALUE="Variables.parent"/>
					<ARGUMENT NAME="type" VALUE="String"/>
				</CALLELEMENT>
				<IF COND="Variables.validatedstatus=true">
				<THEN>
					<EXECSQL SQL="SELECT * FROM Variables.tablename WHERE filterattr='Variables.parent'" LIST="lFilterType"/>
				</THEN>
				</IF>
				
				<IF COND="IsError.Variables.errno=false">
				<THEN>
					<FGTTM.ADD ASSETTYPE="Variables.Filt" ATTRIBUTETYPE="Variables.parent" FILTERTYPE="lFilterType.filtertype"/>
				</THEN>
				<ELSE>
					<FGTTM.ADD ASSETTYPE="Variables.Filt" ATTRIBUTETYPE="Variables.parent"/>
				</ELSE>
				</IF>
			    </THEN>
			    <ELSE>
				<IF COND="Variables.member=def">
				<THEN>
					<ATM.SET TYPE="Variables.Filt" VALUE="com.openmarket.gator.flextemplates.FlexTemplateManager" CATEGORY="Administration"/>
					<IF COND="Variables.errno!=0">
					<THEN>
						<STRING.STREAM VALUE="Inserting Variables.Filt into ComplexAssets failed Variables.errno, Variables.errdetail1!"/>
					</THEN>
					</IF>
					
					<callelement NAME="OpenMarket/Gator/FlexibleAssets/AssetMaker/addElements">
						<argument NAME="elementtype" VALUE="FlexTmpls"/>
						<argument NAME="AssetType" VALUE="Variables.Filt"/>
					</callelement>
					<callelement NAME="OpenMarket/Gator/FlexibleAssets/AssetMaker/addSQL">
						<argument NAME="sqltype" VALUE="FlexDefinitions"/>
						<argument NAME="AssetType" VALUE="Variables.Filt"/>
					</callelement>
					
					<!-- parent is a parent def, get filter and attr info from the parent def -->
					<FGTTM.GETALL ASSETTYPE="Variables.parent" LISTVARNAME="out"/>
					
					<IF COND="out.assetfilter=Variables.empty">
					<THEN>
						<FTTM.ADD ASSETTYPE="Variables.Filt" TEMPLATETYPE="Variables.parent" ATTRIBUTETYPE="out.attributetype"/>
					</THEN>
					<ELSE>
						<FTTM.ADD ASSETTYPE="Variables.Filt" TEMPLATETYPE="Variables.parent" ATTRIBUTETYPE="out.attributetype" FILTERTYPE="out.filtertype"/>
					</ELSE>
					</IF>
				</THEN>
				<ELSE>
					<IF COND="Variables.member=parent">
					<THEN>
						<ATM.SET TYPE="Variables.Filt" VALUE="com.openmarket.gator.flexgroups.FlexGroupManager" CATEGORY="Administration"/>
						<IF COND="Variables.errno!=0">
						<THEN>
							<STRING.STREAM VALUE="Inserting Variables.Filt into ComplexAssets failed Variables.errno, Variables.errdetail1!"/>
						</THEN>
						</IF>
						
						<callelement NAME="OpenMarket/Gator/FlexibleAssets/AssetMaker/addElements">
							<argument NAME="elementtype" VALUE="FlexGroups"/>
							<argument NAME="AssetType" VALUE="Variables.Filt"/>
						</callelement>
						<callelement NAME="OpenMarket/Gator/FlexibleAssets/AssetMaker/addSQL">
							<argument NAME="sqltype" VALUE="FlexGroups"/>
							<argument NAME="AssetType" VALUE="Variables.Filt"/>
						</callelement>
						
						<!-- parent is a def, get filter and attr info from the def -->
						<FTTM.GETALL ASSETTYPE="Variables.parent" LISTVARNAME="out"/>
						
						<IF COND="out.assetfilter=Variables.empty">
						<THEN>
							<FGTM.ADD ASSETTYPE="Variables.Filt" TEMPLATETYPE="out.templatetype" ATTRIBUTETYPE="out.attributetype"/>
						</THEN>
						<ELSE>
							<FGTM.ADD ASSETTYPE="Variables.Filt" TEMPLATETYPE="out.templatetype" ATTRIBUTETYPE="out.attributetype" FILTERTYPE="out.filtertype"/>
						</ELSE>
						</IF>
					</THEN>
					<ELSE>
						<IF COND="Variables.member=asset">
						<THEN>
							<ATM.SET TYPE="Variables.Filt" VALUE="com.openmarket.gator.flexassets.FlexAssetManager" CATEGORY="Administration"/>
							<IF COND="Variables.errno!=0">
							<THEN>
								<STRING.STREAM VALUE="Inserting Variables.Filt into ComplexAssets failed Variables.errno, Variables.errdetail1!"/>
							</THEN>
							</IF>
							
							<callelement NAME="OpenMarket/Gator/FlexibleAssets/AssetMaker/addElements">
								<argument NAME="elementtype" VALUE="FlexAssets"/>
								<argument NAME="AssetType" VALUE="Variables.Filt"/>
							</callelement>
							<callelement NAME="OpenMarket/Gator/FlexibleAssets/AssetMaker/addSQL">
								<argument NAME="sqltype" VALUE="FlexAssets"/>
								<argument NAME="AssetType" VALUE="Variables.Filt"/>
							</callelement>
							
							<!-- parent is a parent, get filter and attr info from the parent -->
							<!-- def must be passed in -->
							<FGTM.GETALL ASSETTYPE="Variables.parent" LISTVARNAME="out"/>
                     
							<IF COND="out.assetfilter=Variables.empty">
							<THEN>
								<FATM.ADD ASSETTYPE="Variables.Filt" PARENTGROUPTYPE="Variables.parent" TEMPLATETYPE="Variables.def" ATTRIBUTETYPE="out.attributetype"/>
							</THEN>
							<ELSE>
								<FATM.ADD ASSETTYPE="Variables.Filt" PARENTGROUPTYPE="Variables.parent" TEMPLATETYPE="Variables.def" ATTRIBUTETYPE="out.attributetype" FILTERTYPE="out.filtertype"/>
							</ELSE>
							</IF>
						</THEN>
						<ELSE>
							<IF COND="Variables.member=filter">
							<THEN>
								<ATM.SET TYPE="Variables.Filt" VALUE="com.openmarket.gator.flexfilters.FlexFilterManager" CATEGORY="Administration"/>
								<IF COND="Variables.errno!=0">
								<THEN>
									<STRING.STREAM VALUE="Inserting Variables.Filt into ComplexAssets failed Variables.errno, Variables.errdetail1!"/>
								</THEN>
								</IF>
								
								<callelement NAME="OpenMarket/Gator/FlexibleAssets/AssetMaker/addElements">
									<argument NAME="elementtype" VALUE="Filters"/>
									<argument NAME="AssetType" VALUE="Variables.Filt"/>
								</callelement>
								<callelement NAME="OpenMarket/Gator/FlexibleAssets/AssetMaker/addSQL">
									<argument NAME="sqltype" VALUE="Filters"/>
									<argument NAME="AssetType" VALUE="Variables.Filt"/>
								</callelement>
								
								<FFTM.ADD FILTERTYPE="Variables.Filt" ATTRIBUTETYPE="Variables.parent"/>

								<!-- Register filter asset type with all asset types that depend on the attr type for the filter -->
								<FGTTM.GETALLOFATTRTYPE ATTRIBUTETYPE="Variables.parent" LISTVARNAME="atypeFGTs"/>
								<IF COND="IsList.atypeFGTs=true">
										<THEN>
												<IF COND="atypeFGTs.#numRows!=0">
														<THEN>
																<LOOP LIST="atypeFGTs">
																						<FGTTM.UPDATE ASSETTYPE="atypeFGTs.assettype" FILTERTYPE="Variables.Filt"/>
																</LOOP>
														</THEN>
												</IF>
										</THEN>
								</IF>
								<FTTM.GETALLOFATTRTYPE ATTRIBUTETYPE="Variables.parent" LISTVARNAME="atypeFTs"/>
								<IF COND="IsList.atypeFTs=true">
										<THEN>
												<IF COND="atypeFTs.#numRows!=0">
														<THEN>
																<LOOP LIST="atypeFTs">
																		<FTTM.UPDATE ASSETTYPE="atypeFTs.assettype" FILTERTYPE="Variables.Filt"/>
																</LOOP>
														</THEN>
												</IF>
										</THEN>
								</IF>
								<FGTM.GETALLOFATTRTYPE ATTRIBUTETYPE="Variables.parent" LISTVARNAME="atypeFGs"/>
								<IF COND="IsList.atypeFGs=true">
										<THEN>
												<IF COND="atypeFGs.#numRows!=0">
														<THEN>
																<LOOP LIST="atypeFGs">
																		<FGTM.UPDATE ASSETTYPE="atypeFGs.assettype" FILTERTYPE="Variables.Filt"/>
																</LOOP>
														</THEN>
												</IF>
										</THEN>
								</IF>
								<FATM.GETALLOFATTRTYPE ATTRIBUTETYPE="Variables.parent" LISTVARNAME="atypeFAs"/>
								<IF COND="IsList.atypeFAs=true">
										<THEN>
												<IF COND="atypeFAs.#numRows!=0">
														<THEN>
																<LOOP LIST="atypeFAs">
																		<FATM.UPDATE ASSETTYPE="atypeFAs.assettype" FILTERTYPE="Variables.Filt"/>
																</LOOP>
														</THEN>
												</IF>
										</THEN>
								</IF>
								
							</THEN>
							</IF>
						</ELSE>
						</IF>
					</ELSE>
					</IF>
				</ELSE>
				</IF>
			    </ELSE>
			    </IF>
			</ELSE>
			</IF>

			<IF COND="IsError.Variables.errno=false">
			<THEN>
				<IF COND="IsVariable.defdirBase=false">
                		<THEN>
                		    <PROPERTY.GET PARAM="xcelerate.defaultbase" INIFILE="futuretense_xcel.ini" VARNAME="propbase"/>
                		    <SETVAR NAME="defdirBase" VALUE="Variables.propbase"/>
                		</THEN>
                		</IF>
				<ASSET.INSTALL TYPE="Variables.Filt" ACL="Browser,SiteGod,xceleditor,xceladmin" DIR="Variables.defdirBase/Variables.Filt"/>
				<IF COND="Variables.errno=0">
				<THEN>
					<XLAT.STREAM KEY="dvin/FlexibleAssets/AssetMakers/InstFiltSuc"/>
                    <br/>
                    <!-- If creation is successful, then show asset type details -->
                    <CALLELEMENT NAME="OpenMarket/Xcelerate/Admin/AssetTypeFront">
                        <ARGUMENT NAME="pagetype" VALUE="front"/>
                        <ARGUMENT NAME="action" VALUE="details"/>
                        <ARGUMENT NAME="assettype" VALUE="Variables.Filt"/>
                    </CALLELEMENT>
				</THEN>
				<ELSE>
					<XLAT.STREAM KEY="dvin/FlexibleAssets/AssetMakers/InstFiltFailed" errno="Variables.errno" Filt="Variables.Filt" errdetail1="Variables.errdetail1" EVALALL="false"/>
				</ELSE>
				</IF>
			</THEN>
			</IF>
			
			<!-- refresh the tree -->
			<PROPERTY.GET PARAM="xcelerate.treeType" INIFILE="futuretense_xcel.ini" VARNAME="proptreetype"/>
			<if  COND="IsElement.OpenMarket/Xcelerate/UIFramework/UpdateTreeVariables.proptreetype=true">
			<then>
				<callelement NAME="OpenMarket/Xcelerate/UIFramework/UpdateTreeVariables.proptreetype">
					<argument NAME="__TreeRefreshKeys__" VALUE="Self:FFM-Variables.parent;Self:AssetTypes"/>
				</callelement>		
			</then>
			</if>

			
		<!--	<CALLELEMENT NAME="OpenMarket/Xcelerate/Admin/FlexFamily">
				<ARGUMENT NAME="op" VALUE="details"/>
				<ARGUMENT NAME="pagetype" VALUE="front"/>
			</CALLELEMENT>
        -->
		</ELSE>
		</IF>
	</THEN>
	<ELSE>
		<IF COND="Variables.op=editfamily">
		<THEN>
         <IF COND="Variables.pagetype=front">
			<THEN>
				<SCRIPT LANGUAGE="JavaScript">
					function SaveFamily(form)
					{
						var obj = document.forms[0];

						var postPage = "OpenMarket/Xcelerate/Admin/FlexFamilyPost";

						obj.pagename.value = postPage;
						obj.op.value = "editfamily";
						obj.submit();
						return false;
					}
				</SCRIPT>
				<ASSETTYPE.LOAD TYPE="Variables.AssetType" NAME="type"/>
				<ASSETTYPE.SCATTER NAME="type" PREFIX="at"/>
                <SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Admin/AssetTypeFront" outstring="urlassettypefront">
                    <satellite.argument name="cs_environment" value="Variables.cs_environment"/>
                    <satellite.argument name="cs_formmode" value="Variables.cs_formmode"/>
                                          <satellite.argument name="action" value="details"/>
                                          <satellite.argument name="assettype" value="Variables.AssetType"/>
                                           </SATELLITE.LINK>
				<table class="width-outer-70" cellspacing="0" cellpadding="0" border="0">
					<tr><td>
						<span class="title-text"><XLAT.STREAM KEY="dvin/UI/Admin/SelectFlexFilterforAT"/>: <A HREF="Variables.urlassettypefront" REPLACEALL="Variables.urlassettypefront"><IMG src="Variables.cs_imagedir/graphics/common/icon/doubleArrow.gif" WIDTH="15" HEIGHT="12" BORDER="0" REPLACEALL="Variables.cs_imagedir"/><STRING.STREAM VARIABLE="at:description"/></A></span>
					</td></tr>
					<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/TitleBar"/>
				</table>
				
<table class="width-outer-30"  BORDER="0" CELLSPACING="0" CELLPADDING="0">
	<tr>
		<td></td><td class="tile-dark" VALIGN="TOP" HEIGHT="1"><IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td><td></td>
	</tr>
	<tr>
		<td class="tile-dark" VALIGN="top" WIDTH="1" NOWRAP="nowrap"><BR /></td>
		<td>
		<table class="width-inner-100" cellpadding="0" cellspacing="0" border="0" bgcolor="#ffffff"><tr><td colspan="3" class="tile-highlight"><IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td></tr>
			<tr><td HEIGHT="16" class="tile-a" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;</td>
	            <td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;<BR /></td>
				<td class="tile-c" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;</td>
			</tr>
			<tr><td colspan="3" class="tile-dark"><IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td></tr>
			<tr>
				<td class="form-label-text"><XLAT.STREAM KEY="dvin/AT/Common/Name"/>:</td>
				<td class="form-inset">
						<STRING.STREAM VARIABLE="at:assettype"/>
				</td>
			</tr>
			<tr>
				<!--<td colspan="3" class="light-line-color"><img height="1" width="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>-->
			</tr>
			<tr>
				<td class="form-label-text"><XLAT.STREAM KEY="dvin/AT/Common/Description"/>:</td>
				<td class="form-inset">
						<STRING.STREAM VARIABLE="at:description"/>
				</td>
			</tr>
<IF COND="Variables.at:logic=com.openmarket.assetframework.complexasset.ComplexAsset">
<THEN>
	<FATM.GETALL ASSETTYPE="Variables.AssetType" LISTVARNAME="FFamily"/>
	<IF COND="IsList.FFamily=true">
	<THEN>
	<IF COND="FFamily.#numRows!=0">
	<THEN>
		<tr>
			<!--<td colspan="3" class="light-line-color"><img height="1" width="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>-->
		</tr>
		<tr>
			<td class="form-label-text"><XLAT.STREAM KEY="dvin/FlexibleAssets/Common/FlexFamily"/>:</td>
			<td class="form-inset">
					<XLAT.LOOKUP KEY="dvin/Common/Inspect" VARNAME="_XLAT_"/><XLAT.LOOKUP KEY="dvin/UI/Admin/InspectThisAssetType" VARNAME="_alt_"/>

				<TABLE BORDER="0">
				<TR>
				<TD><XLAT.STREAM KEY="dvin/FlexibleAssets/AssetMakers/FlexAttr"/></TD>
				<TD>			<ASSETTYPE.LIST LIST="ThisType" FIELD1="assettype" VALUE1="FFamily.attributetype"/>
<STRING.STREAM VALUE="ThisType.description"/></TD>
				</TR>
				<SETVAR NAME="parentType" VALUE="FFamily.grouptype"/>
				<FGTM.GETALL ASSETTYPE="Variables.parentType" LISTVARNAME="PFamily"/>
				<TR>
				<TD><XLAT.STREAM KEY="dvin/FlexibleAssets/AssetMakers/FlexParentDef"/></TD>
				<TD>
					<ASSETTYPE.LIST LIST="ThisType" FIELD1="assettype" VALUE1="PFamily.templatetype"/>
<STRING.STREAM VALUE="ThisType.description"/></TD>
				</TR>
				<TR>
				<TD><XLAT.STREAM KEY="dvin/FlexibleAssets/AssetMakers/FlexDef"/></TD>
				<TD>
					<ASSETTYPE.LIST LIST="ThisType" FIELD1="assettype" VALUE1="FFamily.templatetype"/>

<STRING.STREAM VALUE="ThisType.description"/>
</TD>
				</TR>
				<TR>
				<TD><XLAT.STREAM KEY="dvin/FlexibleAssets/AssetMakers/FlexParent"/></TD>
				<TD>
					<ASSETTYPE.LIST LIST="ThisType" FIELD1="assettype" VALUE1="FFamily.grouptype"/>
<STRING.STREAM VALUE="ThisType.description"/>
				</TD>
				</TR>
				</TABLE>
			</td>
			<td><BR /></td>
		</tr>
		</THEN>
		</IF>
	</THEN>
	</IF>
</THEN>
</IF>

			<tr>
				<!--<td colspan="3" class="light-line-color"><img height="1" width="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>-->
			</tr>
			<tr>
				<td class="form-label-text"><span class="alert-color">*</span><XLAT.STREAM KEY="dvin/UI/Admin/SelectFlexFilter"/>:</td>
				<td class="form-inset">
				<ATM.GETASSETS FILTER="com.openmarket.gator.flexfilters.FlexFilterManager" LISTVARNAME="lFilterTypes"/>
				<IF COND="IsList.lFilterTypes=true">
				<THEN>
					<IF COND="lFilterTypes.#numRows!=0">
					<THEN>
						<SELECT NAME="assetfilter" SIZE="1">
							<OPTION VALUE="Variables.empty" REPLACEALL="Variables.empty">None</OPTION>
							<LOOP LIST="lFilterTypes">
								<OPTION/><STRING.STREAM LIST="lFilterTypes" COLUMN="assettype"/>
							</LOOP>
						</SELECT>
						<BR/>
					</THEN>
					</IF>
				</THEN>
				</IF>
				</td>
				<td><BR /></td>
			</tr>

			<tr>
				<!--<td colspan="3" class="light-line-color"><img height="1" width="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>-->
			</tr>
			<tr class="form-shade">
				<td class="form-label-text"><XLAT.STREAM KEY="dvin/AT/Common/ID"/>:	</td>
				<td class="form-inset">
						<STRING.STREAM VARIABLE="at:id"/>
				</td>
				<td><BR /></td>
			</tr>
				</table>

	</td>
	<td class="tile-dark" VALIGN="top" WIDTH="1" NOWRAP="nowrap"><BR /></td>
	</tr>
	<tr>
		<td colspan="3" class="tile-dark" VALIGN="TOP" HEIGHT="1"><IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>
	</tr>
	<tr>
		<td></td><td background="Variables.cs_imagedir/graphics/common/screen/shadow.gif" REPLACEALL="Variables.cs_imagedir"><IMG WIDTH="1" HEIGHT="5" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td><td></td>
	</tr>
</table>

<SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Admin/AssetTypeFront" outstring="AssetFrontURL">
    <satellite.argument name="cs_environment" value="Variables.cs_environment"/>
    <satellite.argument name="cs_formmode" value="Variables.cs_formmode"/>
                                          <satellite.argument name="action" value="details"/>
                                          <satellite.argument name="assettype" value="Variables.AssetType"/>
                                           </SATELLITE.LINK>
			<table class="width-outer-70"><tr><td>
				<XLAT.LOOKUP KEY="dvin/UI/Cancel" VARNAME="_XLAT_" ESCAPE="true"/>
				<A HREF="Variables.AssetFrontURL" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true;" REPLACEALL="Variables._XLAT_,Variables.AssetFrontURL"><CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/Cancel"/></CALLELEMENT></A><XLAT.LOOKUP KEY="dvin/UI/SaveAssetType" VARNAME="_XLAT_"/>
				<XLAT.LOOKUP KEY="dvin/UI/Save" VARNAME="_XLAT_" ESCAPE="true"/>
				<XLAT.LOOKUP KEY="dvin/UI/Save" VARNAME="_XLAT_ALT"/>
				<A HREF="javascript:void(0);" ONCLICK="return SaveFamily(this.form);" ONMOUSEOVER="window.status='Variables._XLAT_';return true;" ONMOUSEOUT="window.status='';return true" REPLACEALL="Variables.urlprefix,Variables._XLAT_">
					<CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/Save"/></CALLELEMENT>
				</A>
			</td></tr></table>
				<INPUT TYPE="HIDDEN" NAME="op" VALUE="editfamily"/>
				<STRING.ENCODE VARIABLE="AssetType" VARNAME="AssetType"/>
				<INPUT TYPE="HIDDEN" NAME="AssetType" VALUE="Variables.AssetType" REPLACEALL="Variables.AssetType"/>
			</THEN>
			<ELSE>
				<!-- add filter to family -->
				<IF COND="IsVariable.assetfilter=true">
				<THEN>
					<FATM.GETALL ASSETTYPE="Variables.AssetType" LISTVARNAME="lFamily"/>
					<SETVAR NAME="attrType" VALUE="lFamily.attributetype"/>
					<SETVAR NAME="defType" VALUE="lFamily.templatetype"/>
					<SETVAR NAME="parentType" VALUE="lFamily.grouptype"/>
					<SETVAR NAME="filterType" VALUE="lFamily.filtertype"/>
					<FGTM.GETALL ASSETTYPE="Variables.parentType" LISTVARNAME="lFamily"/>
					<SETVAR NAME="parentDefType" VALUE="lFamily.templatetype"/>
					
					<SETVAR NAME="errno" VALUE="0"/>
					<CATALOGMANAGER>
						<ARGUMENT NAME="ftcmd" VALUE="updaterow"/>
						<ARGUMENT NAME="tablename" VALUE="FlexAssetTypes"/>
						<ARGUMENT NAME="tablekey" VALUE="assettype"/>
						<ARGUMENT NAME="tablekeyvalue" VALUE="Variables.AssetType"/>
						<!-- assetfilter passed implicitly -->
					</CATALOGMANAGER>
					<CATALOGMANAGER>
						<ARGUMENT NAME="ftcmd" VALUE="updaterow"/>
						<ARGUMENT NAME="tablename" VALUE="FlexGroupTypes"/>
						<ARGUMENT NAME="tablekey" VALUE="assettype"/>
						<ARGUMENT NAME="tablekeyvalue" VALUE="Variables.parentType"/>
						<!-- assetfilter passed implicitly -->
					</CATALOGMANAGER>
					<CATALOGMANAGER>
						<ARGUMENT NAME="ftcmd" VALUE="updaterow"/>
						<ARGUMENT NAME="tablename" VALUE="FlexGrpTmplTypes"/>
						<ARGUMENT NAME="tablekey" VALUE="assettype"/>
						<ARGUMENT NAME="tablekeyvalue" VALUE="Variables.parentDefType"/>
						<!-- assetfilter passed implicitly -->
					</CATALOGMANAGER>
					<CATALOGMANAGER>
						<ARGUMENT NAME="ftcmd" VALUE="updaterow"/>
						<ARGUMENT NAME="tablename" VALUE="FlexTmplTypes"/>
						<ARGUMENT NAME="tablekey" VALUE="assettype"/>
						<ARGUMENT NAME="tablekeyvalue" VALUE="Variables.defType"/>
						<!-- assetfilter passed implicitly -->
					</CATALOGMANAGER>
				</THEN>
				<ELSE>
					
				</ELSE>
				</IF>
				<CALLELEMENT NAME="OpenMarket/Xcelerate/Admin/AssetTypeFront">
					<ARGUMENT NAME="pagetype" VALUE="front"/>
					<ARGUMENT NAME="action" VALUE="details"/>
					<ARGUMENT NAME="assettype" VALUE="Variables.AssetType"/>
				</CALLELEMENT>
			</ELSE>
			</IF>
		</THEN>
		<ELSE>
			<IF COND="Variables.op=deletefamily">
			<THEN>
				<IF COND="Variables.pagetype=front">
				<THEN>
					Check for delete
					<!-- warning message -->
               
					<!-- delete flex asset -->
					<CALLELEMENT NAME="OpenMarket/Gator/FlexibleAssets/AssetMaker/DeleteFlexAssetType">
						<ARGUMENT NAME="typeToDelete" VALUE="Variables.AssetType"/>
						<ARGUMENT NAME="flexType" VALUE="asset"/>
					</CALLELEMENT>
				</THEN>
				<ELSE>
				</ELSE>
				</IF>
			</THEN>
			</IF>
		</ELSE>
		</IF>
	</ELSE>
	</IF>

</FTCS> 
