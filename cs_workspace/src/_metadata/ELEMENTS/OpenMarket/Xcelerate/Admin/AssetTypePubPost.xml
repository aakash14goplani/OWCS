<?xml version="1.0" ?>
<!DOCTYPE FTCS SYSTEM "futuretense_cs.dtd">

<FTCS Version="1.1">
<!--
$Logfile: /VerticalApps/XcelerateC/install/Xcelerate/Populate/ElementCatalog/OpenMarket/Xcelerate/Admin/AssetTypePubPost.xml $

-->

<!--
- Confidential and Proprietary Information of Open Market, Inc.
-					All Rights Reserved.
-
- DESCRIPTION
-	Admin things about an allowed AssetType
-   Will now display an intermediary screen to manage the creation or enabling of the appropriate start menu items
-   associated with each asset type being enabled.
-
- INPUT
-   action - authorize/grant/revoke/asksmi/postsmi
-   pagetype - front/post
-   smitype - comma delimited list of start menu types to manage when performing asksmi or postsmi
-   destelem - name of element to call after start menus have been created/enabled
-   clientapp - name of client application for which the start menus are being created/enabled (used by AssetTypeForClient)
-   ContCategory - semicolon delimited list of AssetType names being enabled/disabled
-->

    <script LANGUAGE="JavaScript">
    
	function changeCheckBoxes(val, NotForDelete){
	if (val){
		select_unselect('all', NotForDelete);
	} else {
		select_unselect('none', NotForDelete);
	}
}



	function select_unselect(selection, NotForDelete)
    {
           <![CDATA[
    var obj = document.forms[0];

    if (selection == "all")
    {
        var i = 0;
        while ( i < obj.elements['numMenuItems'].value )
        {
            obj.elements['currSMI' + i].checked=true;
            i++;
			
        }
		if (NotForDelete)
		{
        var j = 0;
        while ( j < obj.elements['createCount'].value )
        {
            obj.elements['createSMI' + j].checked=true;
            j++;
			
        }
		}
    }
    else{
        var i = 0;
        while ( i < obj.elements['numMenuItems'].value )
        {
            obj.elements['currSMI' + i].checked=false;
            i++;
        }
	   if (NotForDelete)
       {
		var j = 0;
        while ( j < obj.elements['createCount'].value  )
        {
            obj.elements['createSMI' + j].checked=false;
            j++;
        }
	   }
    }

    ]]>
    }
	
	function unSelect_All_CheckBox(val, NotForDelete)
{
 <![CDATA[
    var obj = document.forms[0];
	
 if (!(val)) { 
 obj.elements['AllCheckBox'].checked=false;
  }
  
  else if ( val && obj.elements['AllCheckBox'].checked==false)
{
        var i = 0;
        while ( i < obj.elements['numMenuItems'].value )
		   if (obj.elements['currSMI' + i].checked==true) i++ ;
		    else break;

		if (NotForDelete)
		{
		var j = 0;
        while ( j < obj.elements['createCount'].value )
		   if (obj.elements['createSMI' + j].checked==true) j++ ;
		    else break;
		}
		
	if (NotForDelete)
      {	
	 if (i == obj.elements['numMenuItems'].value  && j == obj.elements['createCount'].value ) 
	                       obj.elements['AllCheckBox'].checked=true;
	  }
	  else  if (i == obj.elements['numMenuItems'].value) 
	                       obj.elements['AllCheckBox'].checked=true;
						   
       						   
}
  

]]>
}

     	 
    </script>
        

<!-- type is either front or post -->



<STRING.ENCODE VARIABLE="cs_environment" VARNAME="cs_environment"/>
<STRING.ENCODE VARIABLE="cs_imagedir" VARNAME="cs_imagedir"/>
<STRING.ENCODE VARIABLE="cs_formmode" VARNAME="cs_formmode"/>
<STRING.ENCODE VARIABLE="pubid" VARNAME="pubid"/>

	<SETVAR NAME="Variables.showDetails" VALUE="true"/>

	<if COND="Variables.action=asksmi">
	<then>
		<PUBLICATION.LOAD NAME="publication" OBJECTID="Variables.pubid"/>
		<PUBLICATION.SCATTER NAME="publication" PREFIX="Publication"/>
		<SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Admin/SiteFront" outstring="urlsitefront">
			<satellite.argument name="cs_environment" value="Variables.cs_environment"/>
			<satellite.argument name="cs_formmode" value="Variables.cs_formmode"/>
			<satellite.argument name="action" value="details"/>
			<satellite.argument name="pubid" value="Variables.Publication:id"/>
		</SATELLITE.LINK>
		<table class="width-outer-70" cellspacing="0" cellpadding="0" border="0">
			<tr><td>
				<span class="title-text"><XLAT.STREAM KEY="dvin/UI/Admin/EnableAssetTypesforSiteHTML" EVALALL="false" sitename="Variables.Publication:name" urlsitefront="Variables.urlsitefront" ENCODE="false"/></span>
			</td></tr>
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/TitleBar"/>
			<tr><td class="form-label-inset"><XLAT.STREAM KEY="dvin/UI/Admin/StartMenuselection"/></td></tr>
		</table>
		<!--<DIV class="form-label-text"><XLAT.STREAM KEY="dvin/UI/Admin/StartMenuselection"/></DIV>-->              
		<STRINGLIST NAME="smitypelist" STR="Variables.SMIType" DELIM=","/>
		<HASH.CREATE NAME="lftypes"/>
		<LOOP LIST="smitypelist">
			<HASH.ADD NAME="lftypes" VALUE="smitypelist.ITEM"/>
		</LOOP>

		<LISTOBJECT.CREATE NAME="AllSMITypeObj" COLUMNS="name,description"/>
			<XLAT.LOOKUP KEY="dvin/Common/Search" VARNAME="niceName"/>
			<LISTOBJECT.ADDROW NAME="AllSMITypeObj" name="Search" description="Variables.niceName"/>

			<XLAT.LOOKUP KEY="dvin/Common/New" VARNAME="niceName"/>
			<LISTOBJECT.ADDROW NAME="AllSMITypeObj" name="ContentForm" description="Variables.niceName"/>

			<XLAT.LOOKUP KEY="dvin/UI/Admin/MSWord" VARNAME="niceName"/>
			<LISTOBJECT.ADDROW NAME="AllSMITypeObj" name="Word" description="Variables.niceName"/>

			<XLAT.LOOKUP KEY="dvin/UI/Admin/CSDocLink" VARNAME="niceName"/>
			<LISTOBJECT.ADDROW NAME="AllSMITypeObj" name="CSDocLink" description="Variables.niceName"/>
		<LISTOBJECT.TOLIST NAME="AllSMITypeObj" LISTVARNAME="AllSMITypeList"/>

		<IF COND="IsVariable.ContCategory=true">
		<THEN>
			<!-- for each asset type specified, do the following:
				 - check to see if the asset type is already enabled.
				 - if not, then get a list of start menu items for the asset type
				 - for each start menu, see if it is available for use in this site
				 - also, see if we need to create any missing start menu items
			-->
		<STRINGLIST NAME="EnableAssetType" STR="Variables.ContCategory" DELIM=";"/>
		<STRING.ENCODE VARIABLE="ContCategory" VARNAME="ContCategory"/>
		<input type="hidden" name="ContCategory" value="Variables.ContCategory" REPLACEALL="Variables.ContCategory"/>
         
		<table class="width-outer-50" border="0" cellspacing="0" cellpadding="0">
		<tr>
			<td></td><td class="tile-dark" height="1"><img width="1" height="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td><td></td>
		</tr>
		<tr>
		<td class="tile-dark" VALIGN="top" WIDTH="1" NOWRAP="nowrap"><BR /></td>
		<td >
		<table class="width-inner-100" cellpadding="0" cellspacing="0" border="0" bgcolor="#ffffff"><tr><td colspan="5" class="tile-highlight">
                <IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td></tr>
			<tr><td class="tile-a" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;</td>
				<td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir"><DIV class="new-table-title" style="text-align: center;"><XLAT.STREAM KEY="dvin/UI/AssetType"/></DIV></td>
				<td class="tile-b" colspan="2" nowrap="nowrap" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir"><input type="checkbox" style="vertical-align:middle;" name="AllCheckBox" onclick="changeCheckBoxes(this.checked,1);"/><XLAT.STREAM KEY="dvin/UI/Admin/AvailableStartMenus" EVALALL="false" ENCODE="false"/></td>

				<td class="tile-c" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;</td>
			</tr>
			
			<tr><td colspan="5" class="tile-dark"><IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td></tr>
				<!-- Loop over all search results. -->
				<SETVAR NAME="rowStyle" VALUE="tile-row-normal"/>
				<SETVAR NAME="separatorLine" VALUE="0"/>
				<SETCOUNTER NAME="create" VALUE="0"/>
                <SETCOUNTER NAME="nth" VALUE="0"/>
                <callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
                <LOOP LIST="EnableAssetType">
					<ASSETTYPE.LIST LIST="ThisAsset" FIELD1="assettype" VALUE1="EnableAssetType.ITEM"/>
					<IF COND="IsError.Variables.errno!=true">
					<THEN>
						<IF COND="Variables.separatorLine=1">
						<THEN>
							<!--<tr><td colspan="5" class="light-line-color"><img height="1" width="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td></tr>-->
						</THEN>
						</IF>
						<SETVAR NAME="separatorLine" VALUE="1"/>
						<HASH.CREATE NAME="foundtypes"/>
						<tr class="Variables.rowStyle"  REPLACEALL="Variables.rowStyle">
				            <td><br /></td>
				            <td class="form-label-text" NOWRAP="NOWRAP" ALIGN="LEFT">
				              	<STRING.STREAM VALUE="ThisAsset.description"/>
							</td>
							<td><BR /></td>
							<td class="form-inset" NOWRAP="NOWRAP" ALIGN="LEFT">
								<table cellpadding="0" cellspacing="0" border="0">								
								<CALLELEMENT NAME="OpenMarket/Xcelerate/Admin/FilterAvaibleStartMenus">
									<ARGUMENT NAME="assetType" VALUE="EnableAssetType.ITEM"/>
								</CALLELEMENT>								
								<STARTMENU.GETALLSTARTITEMS ASSETTYPE="EnableAssetType.ITEM" LISTVARNAME="menuitems"/>
								<IF COND="Variables.errno=0">
								<THEN>
									<IF COND="menuitems.#numRows!=0">
									<THEN>
										<DIV>
											<LOOP LIST="menuitems">
			    					    		<INDEXOF STR="Variables.SMIType" WHAT="menuitems.itemtype" OUTSTR="junk" INDEX="0"/> 
												 <IF COND="Variables.errno=1">
										         <THEN>
													<SETVAR NAME="errno" VALUE="0"/>

				    	     						<STARTMENU.LOAD OBJVARNAME="sm" ID="menuitems.id"/>
				         							<IF COND="IsError.Variables.errno=false">
				         							<THEN>
														<STARTMENUITEM.SCATTER NAME="sm" PREFIX="item:"/>
														<STARTMENUITEM.GETLEGALSITES NAME="sm" OBJVARNAME="sitelist"/>
														<!-- do nothing if it already set to all sites -->
														<SITELIST.ISALL NAME="sitelist" VARNAME="allsites"/>
														<IF COND="Variables.item:processesprocessTotal!=0">
														<THEN>
															<WORKFLOWENGINE.GETPROCESSID OBJVARNAME="currentProc" ID="Variables.item:processesprocess0"/>
															<IF COND="IsError.Variables.errno!=true">
															<THEN>
																<WORKFLOWPROCESS.GETPROCESSNAME NAME="currentProc" VARNAME="currentName"/>
																<WORKFLOWPROCESS.GETID NAME="currentProc" VARNAME="currentID"/>
					        
			        		                				   	<!-- workflow process site can be Any -->
																<WORKFLOWPROCESS.GETSITES NAME="currentProc" OBJVARNAME="wfpsiteobject"/>
																<SITELIST.ISALL NAME="wfpsiteobject" VARNAME="siteisall"/>
																<IF COND="Variables.siteisall=true">
														        <THEN>
																	<SETVAR NAME="CanUseWFP" VALUE="true"/>
														        </THEN>
														        <ELSE>
											    	    			<!-- we need to see if this site is in the list of sites for the WFP -->
											        				<SITELIST.HASSITE NAME="wfpsiteobject" PUBID="Variables.pubid" VARNAME="hasSite"/>
																	<IF COND="Variables.hasSite=true">
																	<THEN>
																		<!-- WFP is good for this site -->
																		<SETVAR NAME="CanUseWFP" VALUE="true"/>
																	</THEN>
																	<ELSE>
																		<!-- WFP is not good for this site -->
																		<SETVAR NAME="CanUseWFP" VALUE="false"/>
																	</ELSE>
																	</IF> 
														        </ELSE>
													    	    </IF>
													    	 </THEN>
													    	 <ELSE>
													    	 	<XLAT.STREAM KEY="dvin/UI/Admin/Error/StartMenucannotloadworkflowid" name="Variables.item:name" id="Variables.item:processesprocess0" EVALALL="false"/>
																<br/> 
													    	 	<SETVAR NAME="CanUseWFP" VALUE="false"/>
													    	 </ELSE>
													    	 </IF>
	        											</THEN>
					        							<ELSE>
					        								<!-- no workflow process for this start menu -->
					        								<SETVAR NAME="CanUseWFP" VALUE="true"/>
					        							</ELSE>
					        							</IF>

	            					               		<!-- we only want to flag it if we have found a type we're looking for 
	            					               		and it uses a compatible wfprocess -->
	            					               		
						                           		<HASH.CONTAINS NAME="lftypes" VALUE="menuitems.itemtype" VARNAME="bFoundType"/>
	                					           		<IF COND="Variables.bFoundType=true">
						                           		<THEN>
	                           								<!-- okay, make a note that we've found it -->
	                           								<IF COND="Variables.CanUseWFP=true">
	                           								<THEN>
																<HASH.ADD NAME="foundtypes" VALUE="menuitems.itemtype"/>
							                           		</THEN>
							                           		</IF>
	                					           		</THEN>
						                           		</IF>	
						                           		
														<IF COND="Variables.allsites!=true">
														<THEN>
															<!-- Sites!=Any -->
															<SITELIST.HASSITE NAME="sitelist" PUBID="Variables.pubid" VARNAME="hasSite"/>
															<IF COND="Variables.hasSite=true">
															<THEN>
																<tr>
																	<td style="padding: 0 0 8px 0;" nowrap="nowrap" align="left">
																		<XLAT.LOOKUP KEY="dvin/UI/Admin/InspectThisStartMenu" VARNAME="_XLAT_" ESCAPE="true"/>
																		<SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Admin/StartMenuFront" outstring="urlstartmenufront">
																			<satellite.argument name="cs_environment" value="Variables.cs_environment"/>
																			<satellite.argument name="cs_formmode" value="Variables.cs_formmode"/>
																			<satellite.argument name="op" value="view"/>
																			<satellite.argument name="startitem" value="menuitems.id"/>
																		</SATELLITE.LINK>
																		<XLAT.STREAM KEY="dvin/UI/Admin/StartMenualreadyenabledHTML" urlstartmenufront="Variables.urlstartmenufront" name="menuitems.name" EVALALL="false" ENCODE="false"/>
																	</td>
																</tr>
															</THEN>
															<ELSE>
																<IF COND="Variables.CanUseWFP=true">
																<THEN>
																	<tr>
																		<td style="padding: 0 0 8px 0;" nowrap="nowrap" align="left">
																			<INPUT TYPE="checkbox" onClick="unSelect_All_CheckBox(this.checked,1);" NAME="currSMICounters.nth" VALUE="menuitems.id" REPLACEALL="Counters.nth,menuitems.id"  />                                                 
																		<XLAT.LOOKUP KEY="dvin/UI/Admin/InspectThisStartMenu" VARNAME="_XLAT_" ESCAPE="true"/>
																			<SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Admin/StartMenuFront" outstring="urlstartmenufront">
																				<satellite.argument name="cs_environment" value="Variables.cs_environment"/>
																				<satellite.argument name="cs_formmode" value="Variables.cs_formmode"/>
																				<satellite.argument name="op" value="view"/>
																				<satellite.argument name="startitem" value="menuitems.id"/>
																			</SATELLITE.LINK>
																			<XLAT.STREAM KEY="dvin/UI/Admin/EnableStartMenuforsiteQHTML" urlstartmenufront="Variables.urlstartmenufront" name="menuitems.name" EVALALL="false" ENCODE="false"/>
																		</td>
																	</tr>
																	<INCCOUNTER NAME="nth" VALUE="1"/>
																	</THEN>
																</IF>
															</ELSE>
															</IF>
														</THEN>
														<ELSE>
															<!-- Sites=Any -->
															<!-- No other action is required for this start menu item  -->
															<div style="margin: 0 0 12px 0px">
																<XLAT.LOOKUP KEY="dvin/UI/Admin/InspectThisStartMenu" VARNAME="_XLAT_" ESCAPE="true"/>
	                    										<SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Admin/StartMenuFront" outstring="urlstartmenufront">
																	<satellite.argument name="cs_environment" value="Variables.cs_environment"/>
																	<satellite.argument name="cs_formmode" value="Variables.cs_formmode"/>
																	<satellite.argument name="op" value="view"/>
																	<satellite.argument name="startitem" value="menuitems.id"/>
																</SATELLITE.LINK>
																<XLAT.STREAM KEY="dvin/UI/Admin/StartMenuenabledforanysiteHTML" urlstartmenufront="Variables.urlstartmenufront" name="menuitems.name" EVALALL="false" ENCODE="false"/>																
															</div>
														</ELSE>
														</IF>
													</THEN>
	       											<ELSE>
	       												<XLAT.STREAM KEY="dvin/UI/Admin/Error/UnabletoLoadStartMenuid" id="menuitems.id" EVALALL="false"/>
														<br/> 
					        						</ELSE>
	            				            	   	</IF>
												</THEN>
			        							</IF>
											</LOOP>
										</DIV>	
									</THEN>

									<ELSE>
										<!-- no start menu items at all, but we don't need to do anything special -->
									</ELSE>
									</IF>
								</THEN>
								</IF>
									
								<LOOP LIST="AllSMITypeList">
									<HASH.CONTAINS NAME="lftypes" VALUE="AllSMITypeList.name" VARNAME="checkforSMI"/>
									<IF COND="Variables.checkforSMI=true">
									<THEN>
										<HASH.CONTAINS NAME="foundtypes" VALUE="AllSMITypeList.name" VARNAME="foundSMIType"/>
										<IF COND="Variables.foundSMIType=false">
										<THEN>
											<tr>
												<td style="padding: 0 0 8px 0;" nowrap="nowrap" align="left">
													<input type="checkbox" onClick="unSelect_All_CheckBox(this.checked,1);" name="createSMICounters.create" value="EnableAssetType.ITEM" REPLACEALL="EnableAssetType.ITEM,Counters.create"/>
													<XLAT.STREAM KEY="dvin/UI/Admin/CreateStartMenuTypeforatdesc" type="AllSMITypeList.description" atdesc="ThisAsset.description" EVALALL="false"/>
												</td>
											</tr>
											<input type="hidden" name="createSMItypeCounters.create" value="AllSMITypeList.name" REPLACEALL="AllSMITypeList.name,Counters.create"/>
											<INCCOUNTER NAME="create" VALUE="1"/>
										</THEN>
										</IF>
									</THEN>
									</IF>
								</LOOP>
								</table>	
				                 </td>
				               	<td><BR /></td>
					        </tr>
				        </THEN>
				        <ELSE>
							<SETVAR NAME="separatorLine" VALUE="1"/>
								
							<tr class="Variables.rowStyle"  REPLACEALL="Variables.rowStyle">
								<td><BR /></td>
								<td class="form-label-text" NOWRAP="NOWRAP" ALIGN="LEFT">
				               		<strong><STRING.STREAM VALUE="EnableAssetType.ITEM"/></strong>
								</td>
								<td><BR /></td><td class="small-text-inset" ALIGN="LEFT">
			    	                <setvar NAME="assettype" VALUE="EnableAssetType.ITEM"/>
				                    <XLAT.STREAM KEY="dvin/UI/Admin/NoDataavailableforassettype"/>
								</td>
								<td><BR /></td>
							</tr>
				        </ELSE>
				        </IF>
										        
				        <IF COND="Variables.rowStyle=tile-row-normal">
						<THEN><SETVAR NAME="rowStyle" VALUE="tile-row-highlight"/>
						</THEN>
						<ELSE><SETVAR NAME="rowStyle" VALUE="tile-row-normal"/>
						</ELSE>
						</IF>
					</LOOP>
				</table>
			</td>
			<td class="tile-dark" VALIGN="top" WIDTH="1" NOWRAP="nowrap"><BR /></td>
			</tr>
			<tr>
				<td colspan="3" class="tile-dark" VALIGN="TOP" HEIGHT="1"><IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>
			</tr>
			<tr>
				<td></td><td background="Variables.cs_imagedir/graphics/common/screen/shadow.gif" REPLACEALL="Variables.cs_imagedir"><IMG WIDTH="1" HEIGHT="5" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td><td></td>
			</tr>
		</table>
        <input type="HIDDEN" name="numMenuItems" value="Counters.nth" REPLACEALL="Counters.nth"/>
		<INPUT TYPE="HIDDEN" NAME="createCount" VALUE="Counters.create" REPLACEALL="Counters.create"/>
		<INPUT TYPE="HIDDEN" NAME="pagename" VALUE="OpenMarket/Xcelerate/Admin/AssetTypePubPost"/>
		<INPUT TYPE="HIDDEN" NAME="action" VALUE="postsmi"/>
		<INPUT TYPE="HIDDEN" NAME="pubid" VALUE="Variables.pubid" REPLACEALL="Variables.pubid"/>
		<STRING.ENCODE VARIABLE="destelem" VARNAME="destelem"/>
		<INPUT TYPE="HIDDEN" NAME="destelem" VALUE="Variables.destelem" REPLACEALL="Variables.destelem"/>
		<IF COND="IsVariable.clientapp=true">
		<THEN>
			<STRING.ENCODE VARIABLE="clientapp" VARNAME="clientapp"/>
			<INPUT TYPE="HIDDEN" NAME="clientapp" VALUE="Variables.clientapp" REPLACEALL="Variables.clientapp"/>
		</THEN>
		</IF>
		<XLAT.LOOKUP KEY="dvin/UI/Cancel" VARNAME="_status_" ESCAPE="true"/>
		<XLAT.LOOKUP KEY="dvin/UI/Cancel" VARNAME="_alt_"/>
		<SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Admin/SiteFront" outstring="urlsitefront">
			<satellite.argument name="cs_environment" value="Variables.cs_environment"/>
			<satellite.argument name="cs_formmode" value="Variables.cs_formmode"/>
			<satellite.argument name="action" value="details"/>
			<satellite.argument name="pubid" value="Variables.pubid"/>
		</SATELLITE.LINK>
		<div class="width-outer-70">
		<A HREF="Variables.urlsitefront" onmouseover="window.status='Variables._status_';return true;" onmouseout="window.status='';return true;" REPLACEALL="Variables._status_,Variables.urlsitefront"><CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/Cancel"/></CALLELEMENT></A>
		<SETVAR NAME="buttonName" VALUE="EnableAssetTypes"/>
		<XLAT.LOOKUP KEY="dvin/UI/Admin/EnableSelectedAssetTypesforsite" VARNAME="_XLAT_" ESCAPE="true"/>
		<XLAT.LOOKUP KEY="dvin/UI/Admin/EnableAssetTypes" VARNAME="_ALT_"/>
		<A HREF="javascript:void(0);" onclick="document.forms['AppForm'].submit(); return false;" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true;" REPLACEALL="Variables._XLAT_"><CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/Variables.buttonName" REPLACEALL="Variables.buttonName"/></CALLELEMENT></A>
		</div>
		</THEN>
		<ELSE>
			<XLAT.LOOKUP KEY="dvin/UI/Admin/Noassettypesselected" VARNAME="msgtext"/>
			<div class="width-outer-70">
			<CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/ShowMessage">
				<ARGUMENT NAME="severity" VALUE="warning"/>
			</CALLELEMENT>
			</div>
			<CALLELEMENT NAME="OpenMarket/Xcelerate/Admin/SiteFront">
				<ARGUMENT NAME="pubid" VALUE="Variables.pubid"/>
				<ARGUMENT NAME="action" VALUE="details"/>
				<ARGUMENT NAME="showtitle" VALUE="false"/>
			</CALLELEMENT>
		</ELSE>
		</IF>

		<SETVAR NAME="showDetails" VALUE="false"/>
	</then>
	</if><!-- end if action=asksmi -->

	<if COND="Variables.action=postsmi">
	<then>
		<STRING.ENCODE VARIABLE="ContCategory" VARNAME="ContCategory"/>
		<SETCOUNTER NAME="create" VALUE="0"/>
		<IF COND="Variables.createCount!=0">
		<THEN>
			<LOOP FROM="0" COUNT="Variables.createCount">
				<IF COND="IsVariable.createSMICounters.create=true">
				<THEN>
				<ASSETTYPE.LIST LIST="ThisAsset" FIELD1="assettype" VALUE1="Variables.createSMICounters.create"/>
				<IF COND="IsError.Variables.errno!=true">
				<THEN>
					<REMOVEVAR NAME="junk"/>
					<SETVAR NAME="curType" VALUE="Variables.createSMItypeCounters.create"/>
					<IF COND="Variables.curType=ContentForm">
					<THEN>
						<XLAT.LOOKUP KEY="dvin/UI/Admin/NewSMIdefaultname" EVALALL="false" atdesc="ThisAsset.description" VARNAME="xlatname"/>
					</THEN>
					</IF>
					<IF COND="Variables.curType=Word">
					<THEN>
						<XLAT.LOOKUP KEY="dvin/UI/Admin/CSDesktopSMIdefaultname" EVALALL="false" atdesc="ThisAsset.description" VARNAME="xlatname"/>
					</THEN>
					</IF>
					<IF COND="Variables.curType=Search">
					<THEN>
						<XLAT.LOOKUP KEY="dvin/UI/Admin/SearchSMIdefaultname" EVALALL="false" atdesc="ThisAsset.description" VARNAME="xlatname"/>
					</THEN>
					</IF>
					<IF COND="Variables.curType=CSDocLink">
					<THEN>
						<XLAT.LOOKUP KEY="dvin/UI/Admin/CSDocLinkSMIdefaultname" EVALALL="false" atdesc="ThisAsset.description" VARNAME="xlatname"/>
					</THEN>
					</IF>
				
					<SETVAR NAME="name" VALUE="Variables.xlatname"/>
					<SETCOUNTER NAME="SMIsuffix" VALUE="0"/>
					<SETVAR NAME="IsGoodName" VALUE="false"/>

					<LOOP UNTIL="Variables.IsGoodName=true">
						<STARTMENU.LOAD NAME="Variables.name" ITEMTYPE="Variables.createSMItypeCounters.create" OBJVARNAME="existsm"/>
						<STARTMENUITEM.GETID NAME="existsm" VARNAME="junk"/>
					
						<!-- check to see if there is already an existing SMI with the same name -->
						<IF COND="IsVariable.junk=true">
						<THEN>
							<SETVAR NAME="name" VALUE="Variables.xlatnameCounters.SMIsuffix"/>
							<INCCOUNTER NAME="SMIsuffix" VALUE="1"/>
						</THEN>
						<ELSE>
							<SETVAR NAME="IsGoodName" VALUE="true"/>
						</ELSE>
						</IF>
						<IF COND="Counters.SMIsuffix=99"><THEN><SETVAR NAME="IsGoodName" VALUE="true"/></THEN></IF>
					</LOOP>
					<STARTMENU.CREATE OBJVARNAME="newsm"/>
					<STARTMENUITEM.SCATTER NAME="newsm" PREFIX="item:"/>
					<STARTMENUITEM.GETSITES NAME="newsm" OBJVARNAME="siteobj"/>
					<SETVAR NAME="item:assettype" VALUE="Variables.createSMICounters.create"/>
					
					<SETVAR NAME="item:name" VALUE="Variables.name"/>
					<SETVAR NAME="item:legalrolesroles" VALUE="_ALL_"/>
					<SETVAR NAME="item:itemtype" VALUE="Variables.createSMItypeCounters.create"/>
					<STARTMENUITEM.GATHER NAME="newsm" PREFIX="item:"/>
					<SITELIST.CLEAR NAME="siteobj"/>
					<SITELIST.ADD NAME="siteobj" PUBID="Variables.pubid"/>
					<STARTMENUITEM.SETLEGALSITES NAME="newsm" OBJECT="siteobj"/>
					<STARTMENUITEM.SETSITES NAME="newsm" OBJECT="siteobj"/>
					<STARTMENU.SAVE OBJECT="newsm"/>
				</THEN>
				<ELSE>
					<setvar NAME="assettype" VALUE="Variables.createSMICounters.create"/>
					<XLAT.STREAM KEY="dvin/UI/Admin/NoDataavailableforassettype"/><br/>
				</ELSE>
				</IF>
				</THEN>
				</IF>
				<INCCOUNTER NAME="create" VALUE="1"/>
			</LOOP>
		</THEN>
		</IF>


        <SETCOUNTER NAME="n" VALUE="0"/>
        <IF COND="Variables.numMenuItems!=0">
        <THEN>
            <LOOP FROM="0" COUNT="Variables.numMenuItems">
                <IF COND="IsVariable.currSMICounters.n=true">
                <THEN>
                        <STARTMENU.LOAD OBJVARNAME="sm" ID="Variables.currSMICounters.n"/>
                        <STARTMENUITEM.GETID NAME="sm" VARNAME="junk"/>
                        <IF COND="IsVariable.junk=true">
                        <THEN>
                            <STARTMENUITEM.GETNAME NAME="sm" VARNAME="currName"/>
                            <STARTMENUITEM.GETLEGALSITES NAME="sm" OBJVARNAME="siteobj"/>
                            <!-- do nothing if it already set to all sites -->
                            <SITELIST.ISALL NAME="siteobj" VARNAME="allsites"/>
                            <IF COND="Variables.allssites!=true">
                            <THEN>
                                <SITELIST.ADD NAME="siteobj" PUBID="Variables.pubid"/>
                                <STARTMENUITEM.SETSITES NAME="sm" OBJECT="siteobj"/>
                                <STARTMENUITEM.SETLEGALSITES NAME="sm" OBJECT="siteobj"/>
                                <STARTMENU.SAVE OBJECT="sm"/>
                                <IF COND="Variables.errno!=0">
                                  <THEN>
                                    <XLAT.STREAM KEY="dvin/UI/Admin/Error/savingstartmenuitemnameerrnodetail1" itemname="Variables.item:name" errno="Variables.errno" errdetail1="Variables.errdetail1" EVALALL="false"/>
                                </THEN>
                                </IF>
                            </THEN>
                            </IF>
                        </THEN>
                        <ELSE>
                            <XLAT.STREAM KEY="dvin/UI/Admin/Error/UnabletoLoadStartMenuid" id="menuitems.id" EVALALL="false"/>
                        </ELSE>
                        </IF>

                </THEN>
                </IF>
                <INCCOUNTER NAME="n" VALUE="1"/>
            </LOOP>
        </THEN>
        </IF>


    <!--	<IF COND="IsVariable.currSMI=true">
		<THEN>
            <STRINGLIST NAME="currSMIlist" STR="Variables.currSMI" DELIM=";"/>
			<LOOP LIST="currSMIlist">
				<STARTMENU.LOAD OBJVARNAME="sm" ID="currSMIlist.ITEM"/>
				<STARTMENUITEM.GETID NAME="sm" VARNAME="junk"/>
				<IF COND="IsVariable.junk=true">
				<THEN>
					<STARTMENUITEM.GETNAME NAME="sm" VARNAME="currName"/>
					<STARTMENUITEM.GETLEGALSITES NAME="sm" OBJVARNAME="siteobj"/>-->
					<!-- do nothing if it already set to all sites -->
					<!--<SITELIST.ISALL NAME="siteobj" VARNAME="allsites"/>
					<IF COND="Variables.allssites!=true">
					<THEN>
						<SITELIST.ADD NAME="siteobj" PUBID="Variables.pubid"/>
						<STARTMENUITEM.SETSITES NAME="sm" OBJECT="siteobj"/>
						<STARTMENUITEM.SETLEGALSITES NAME="sm" OBJECT="siteobj"/>
						<STARTMENU.SAVE OBJECT="sm"/>
						<IF COND="Variables.errno!=0">
                  		<THEN>
							<XLAT.STREAM KEY="dvin/UI/Admin/Error/savingstartmenuitemnameerrnodetail1" itemname="Variables.item:name" errno="Variables.errno" errdetail1="Variables.errdetail1" EVALALL="false"/>
						</THEN>
						</IF>
					</THEN>
					</IF>
				</THEN>
				<ELSE>
					<XLAT.STREAM KEY="dvin/UI/Admin/Error/UnabletoLoadStartMenuid" id="menuitems.id" EVALALL="false"/>
				</ELSE>
				</IF>

			</LOOP>
		</THEN>
		</IF>           -->
        
        <SETVAR NAME="showDetails" VALUE="true"/>
		<SETVAR NAME="action" VALUE="grant"/>

		<!-- now we need to go to the appropriate post page -->
		<CALLELEMENT NAME="Variables.destelem"/>
		<SETVAR NAME="action" VALUE="done"/>
		<SETVAR NAME="showDetails" VALUE="false"/>
	</then>
	</if>
	
	<!-- process enabling of things -->
	<div class="width-outer-70">
	<if COND="Variables.action=grant">
	<then>
		<span class="title-text"><XLAT.STREAM KEY="dvin/UI/Admin/EnableAssetTypes"/></span><P/>
				<IF COND="IsVariable.ContCategory=true">
					<THEN>
				<!-- for each asset type specified, do the following:
					 - check to see if the asset type is already
					 enabled
					 - if not, then authorize the asset type                -->
				<STRING.ENCODE VARIABLE="ContCategory" VARNAME="ContCategory"/>
				<stringlist NAME="EnableAssetType" STR="Variables.ContCategory" DELIM=";"/>
				<loop LIST="EnableAssetType">
					<!-- check to see if the Asset type is already enabled -->
					<callelement NAME="OpenMarket/Xcelerate/Actions/AssetMgt/EnableAssetTypePub">
						<argument NAME="upcommand" VALUE="IsAssetTypeEnabled"/>
						<argument NAME="assettype" VALUE="EnableAssetType.ITEM"/>
						<argument NAME="pubid" VALUE="Variables.pubid"/>
					</callelement>
					<if COND="Variables.IsAuthorized=false">
					<then>
						<setvar NAME="errno" VALUE="0"/>
						<callelement NAME="OpenMarket/Xcelerate/Actions/AssetMgt/EnableAssetTypePub">
							<argument NAME="upcommand" VALUE="EnableAssetType"/>
							<argument NAME="assettype" VALUE="EnableAssetType.ITEM"/>
							<argument NAME="pubid" VALUE="Variables.pubid"/>
						</callelement>

						<if COND="Variables.errno!=0">
						<then>
							<XLAT.LOOKUP KEY="dvin/UI/Admin/Error/enablingassettype" VARNAME="msgtext"/>
							<SETVAR NAME="msgtext" VALUE="Variables.msgtext: EnableAssetType.ITEM, errno=Variables.errno"/>
							<CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/ShowMessage">
								<ARGUMENT NAME="severity" VALUE="error"/>
							</CALLELEMENT>
						</then>
						<else>
							<XLAT.LOOKUP KEY="dvin/UI/Admin/Enabledassettype" VARNAME="msgtext"/>
							<SETVAR NAME="msgtext" VALUE="Variables.msgtext: EnableAssetType.ITEM"/>
							<CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/ShowMessage">
								<ARGUMENT NAME="severity" VALUE="info"/>
							</CALLELEMENT>
						</else>
						</if>

					</then>
					<else>
						<XLAT.LOOKUP KEY="dvin/UI/Admin/Assettypealreadyenabled" VARNAME="msgtext"/>
							<SETVAR NAME="msgtext" VALUE="Variables.msgtext: EnableAssetType.ITEM"/>
							<CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/ShowMessage">
								<ARGUMENT NAME="severity" VALUE="warning"/>
							</CALLELEMENT>
					</else>
					</if>
				</loop>
				</THEN>
				<ELSE>
					<XLAT.LOOKUP KEY="dvin/UI/Admin/Noassettypesselected" VARNAME="msgtext"/>
					<CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/ShowMessage">
						<ARGUMENT NAME="severity" VALUE="warning"/>
					</CALLELEMENT>
				</ELSE>
				</IF>
	</then>
	</if>
	</div>
	<!-- process disabling of things -->
	<if COND="Variables.action=revoke">
	<then>
		
	   	<PUBLICATION.LOAD NAME="publication" OBJECTID="Variables.pubid"/>
		<PUBLICATION.SCATTER NAME="publication" PREFIX="Publication"/>
		<SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Admin/SiteFront" outstring="urlsitefront">
			<satellite.argument name="cs_environment" value="Variables.cs_environment"/>
			<satellite.argument name="cs_formmode" value="Variables.cs_formmode"/>
			<satellite.argument name="action" value="details"/>
			<satellite.argument name="pubid" value="Variables.Publication:id"/>
		</SATELLITE.LINK>

		<table class="width-outer-70" cellspacing="0" cellpadding="0" border="0">
			<tr><td>
				<span class="title-text"><XLAT.STREAM KEY="dvin/UI/Admin/DisableAssetType" />:<a href="Variables.urlsitefront" title="Inspect this site" REPLACEALL="Variables.urlsitefront,Variables.Publication:name"><STRING.STREAM VALUE="Variables.Publication:name" /></a></span>
			</td></tr>
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/TitleBar"/>
			<tr><td class="form-label-inset"><XLAT.STREAM KEY="dvin/UI/Admin/StartMenuselection"/></td></tr>
		</table>		
		<IF COND="IsVariable.ContCategory=true">
	   	<THEN>
		
		<input type="hidden" name="ContCategory" value="Variables.ContCategory" REPLACEALL="Variables.ContCategory"/>
		
		<STRINGLIST NAME="DisableAssetType" STR="Variables.ContCategory" DELIM=";"/>
		<table class="width-outer-50" border="0" cellspacing="0" cellpadding="0">
			<tr>
				<td></td><td class="tile-dark" height="1"><img width="1" height="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td><td></td>
			</tr>
			<tr>
				<td class="tile-dark" VALIGN="top" WIDTH="1" NOWRAP="nowrap"><BR /></td>
				<td >
					<table width="100%" cellpadding="0" cellspacing="0" border="0" bgcolor="#ffffff">
						<tr><td colspan="5" class="tile-highlight"><IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td></tr>
						
						
						<tr><td class="tile-a" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;</td>
				<td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir"><DIV class="new-table-title" style="text-align: center;"><XLAT.STREAM KEY="dvin/UI/AssetType"/></DIV></td>
			
				<td class="tile-b" nowrap="nowrap" colspan="2" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir"><input type="checkbox" CHECKED="checked" name="AllCheckBox" onclick="changeCheckBoxes(this.checked,0);"/><XLAT.STREAM KEY="dvin/UI/Admin/AvailableStartMenus" EVALALL="false" ENCODE="false"/></td>
				
				<td class="tile-c" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;</td>
			</tr>
			
						<tr><td colspan="5" class="tile-dark"><IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td></tr>
						
							<SETVAR NAME="rowStyle" VALUE="tile-row-normal"/>
							<SETVAR NAME="separatorLine" VALUE="0"/>
							<SETCOUNTER NAME="nth" VALUE="0"/>
							<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>	
							<LOOP LIST="DisableAssetType">
								
								<ASSETTYPE.LIST LIST="ThisAsset" FIELD1="assettype" VALUE1="DisableAssetType.ITEM"/>
								 <IF COND="IsError.Variables.errno!=true">
									<THEN>
										<IF COND="Variables.separatorLine=1">
										<THEN>
											<!--<tr><td colspan="5" class="light-line-color"><img height="1" width="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td></tr>-->
										</THEN>
										</IF>
										<SETVAR NAME="separatorLine" VALUE="1"/>
										
										<!-- skip Hash create statement -->
										
										<tr class="Variables.rowStyle"  REPLACEALL="Variables.rowStyle">
											<td><br /></td>
											<td class="form-label-text" NOWRAP="NOWRAP" ALIGN="LEFT">
												<STRING.STREAM VALUE="ThisAsset.description"/>
											</td>
											<td><BR /></td>
											<td class="form-inset" NOWRAP="NOWRAP" ALIGN="LEFT">
												<STARTMENU.GETALLSTARTITEMS PUBID="Variables.pubid" ASSETTYPE="DisableAssetType.ITEM" LISTVARNAME="menuitems"/>
												<IF COND="Variables.errno=0">
												<THEN>
												
													<IF COND="menuitems.#numRows!=0">
													<THEN>
															
													<DIV>
													 	<LOOP LIST="menuitems">
													 		<STARTMENU.LOAD OBJVARNAME="sm" ID="menuitems.id"/>
													 		<STARTMENUITEM.SCATTER NAME="sm" PREFIX="item:"/>
													 		<setvar name="multiplesites" value="false" />
													 		<IF COND="Variables.item:legalsitessites=_ALL_">
													 			<THEN>
													 				<setvar name="multiplesites" value="true" />
													 			</THEN>
													 			<ELSE>
													 				<STRINGLIST NAME="selSites" STR="Variables.item:legalsitessites" DELIM=";"/>
													 				
													 				<IF COND="selSites.#numRows!=1" >
													 					<THEN>
													 						<setvar name="multiplesites" value="true" />
													 					</THEN>
													 				</IF>
													 			</ELSE>
													 		</IF>
														     	
															
															
															<div style="margin: 0 0 12px 0px">
																
																<SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Admin/StartMenuFront" outstring="urlstartmenufront">
																	<satellite.argument name="cs_environment" value="Variables.cs_environment"/>
																	<satellite.argument name="cs_formmode" value="Variables.cs_formmode"/>
																	<satellite.argument name="op" value="view"/>
																	<satellite.argument name="startitem" value="menuitems.id"/>
																</SATELLITE.LINK>
														
																<INPUT TYPE="checkbox" CHECKED="checked"  onClick="unSelect_All_CheckBox(this.checked,0);" NAME="currSMICounters.nth" VALUE="menuitems.id" REPLACEALL="Counters.nth,menuitems.id"/>
																<setvar name="sminame" value="menuitems.name" />
																 Delete <a href="Variables.urlstartmenufront" REPLACEALL="Variables.urlstartmenufront"><STRING.STREAM VALUE="Variables.sminame" /> </a> start menu
																 
																 <IF COND="Variables.multiplesites=true">
																     <THEN>
															     		<XLAT.LOOKUP KEY="dvin/UI/Admin/StartMenuUsedbyMultipleSites" VARNAME="_XLAT_"/> 
																	<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/ShowMessage">
																		<argument NAME="msgtext" VALUE="Variables._XLAT_"/>
																		<argument NAME="severity" VALUE="warning"/>
																	</callelement>
																	</THEN>
																</IF>		
																 
															</div> 
															<INCCOUNTER name="nth" value="1" />
													 	</LOOP>
													</DIV> 
													</THEN>
													
													<!--  If no start menu item exists -->
														<ELSE>
															<XLAT.LOOKUP KEY="dvin/UI/Admin/NoStartMenuExists" VARNAME="_XLAT_"/>
															<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/ShowMessage">
																		<argument NAME="msgtext" VALUE="Variables._XLAT_"/>
																		<argument NAME="severity" VALUE="info"/>
															</callelement>
																
														</ELSE>
													</IF>
												</THEN>
												</IF>
											</td>
											<td><br /></td>	
										</tr>	
									</THEN>
								</IF>	
								<IF COND="Variables.rowStyle=tile-row-normal">
									<THEN>
										<SETVAR NAME="rowStyle" VALUE="tile-row-highlight"/>
									</THEN>
									<ELSE>
										<SETVAR NAME="rowStyle" VALUE="tile-row-normal"/>
									</ELSE>
								</IF>
							</LOOP>
				
					</table>
				</td>
				<td class="tile-dark" VALIGN="top" WIDTH="1" NOWRAP="nowrap"><BR /></td>
			</tr>
			<tr>
				<td colspan="3" class="tile-dark" VALIGN="TOP" HEIGHT="1"><IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>
			</tr>
			<tr>
				<td></td><td background="Variables.cs_imagedir/graphics/common/screen/shadow.gif" REPLACEALL="Variables.cs_imagedir"><IMG WIDTH="1" HEIGHT="5" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td><td></td>
			</tr>
		</table>

		<INPUT TYPE="HIDDEN" NAME="numMenuItems" VALUE="Counters.nth" REPLACEALL="Counters.nth"/>
		<INPUT TYPE="HIDDEN" NAME="pagename" VALUE="OpenMarket/Xcelerate/Admin/AssetTypePubPost"/>
		<INPUT TYPE="HIDDEN" NAME="action" VALUE="delsmi"/>
		<INPUT TYPE="HIDDEN" NAME="pubid" VALUE="Variables.pubid" REPLACEALL="Variables.pubid"/>
		
		<XLAT.LOOKUP KEY="dvin/UI/Cancel" VARNAME="_status_" ESCAPE="true"/>
		<XLAT.LOOKUP KEY="dvin/UI/Cancel" VARNAME="_alt_"/>
		<SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Admin/SiteFront" outstring="urlsitefront">
			<satellite.argument name="cs_environment" value="Variables.cs_environment"/>
			<satellite.argument name="cs_formmode" value="Variables.cs_formmode"/>
			<satellite.argument name="action" value="details"/>
			<satellite.argument name="pubid" value="Variables.pubid"/>
		</SATELLITE.LINK>
		<div class="width-outer-70">
		<A HREF="Variables.urlsitefront" onmouseover="window.status='Variables._status_';return true;" onmouseout="window.status='';return true;" REPLACEALL="Variables._status_,Variables.urlsitefront"><CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/Cancel"/></CALLELEMENT></A>
		<SETVAR NAME="buttonName" VALUE="DisableAssetTypes"/>
		<XLAT.LOOKUP KEY="dvin/UI/Admin/DisableSelectedAssetTypesforsite" VARNAME="_XLAT_" ESCAPE="true"/>
		<XLAT.LOOKUP KEY="dvin/UI/Admin/DisableAssetTypes" VARNAME="_ALT_"/>
		<A HREF="javascript:void(0);" onclick="document.forms['AppForm'].submit(); return false;" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true;" REPLACEALL="Variables._XLAT_"><CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/Variables.buttonName" REPLACEALL="Variables.buttonName"/></CALLELEMENT></A>
		</div>
	   </THEN>
	   <ELSE>
	   	<XLAT.LOOKUP KEY="dvin/UI/Admin/Noassettypesselected" VARNAME="msgtext"/>
		<div class="width-outer-70">
	   	<CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/ShowMessage">
	   		<ARGUMENT NAME="severity" VALUE="warning"/>
	   	</CALLELEMENT>
		</div>
	   	<CALLELEMENT NAME="OpenMarket/Xcelerate/Admin/SiteFront">
			<ARGUMENT NAME="pubid" VALUE="Variables.pubid"/>
			<ARGUMENT NAME="action" VALUE="details"/>
			<ARGUMENT NAME="showtitle" VALUE="false"/>
		</CALLELEMENT>
	   </ELSE>
	 </IF> 
	
	<SETVAR NAME="showDetails" VALUE="false"/>
	</then>
	</if><!-- end if action=revoke -->
	
	<!-- 
	  this action will delete start menu item selected by the user and 
	  disable the asset type
	 -->
	 <div class="width-outer-70">
	<IF COND="Variables.action=delsmi">
	<THEN>
		<span class="title-text"><XLAT.STREAM KEY="dvin/UI/Admin/DisableAssetType"/></span><P/>
		

		<!-- for each asset type specified, do the following:
				 - check to see if the asset type is already authorized
				 - if so, then delete the row corresponding   to the asset type                
		-->
		<stringlist NAME="DisableAssetType" STR="Variables.ContCategory" DELIM=";"/>
		<loop LIST="DisableAssetType">

					<callelement NAME="OpenMarket/Xcelerate/Actions/AssetMgt/EnableAssetTypePub">
						<argument NAME="upcommand" VALUE="IsAssetTypeEnabled"/>
						<argument NAME="assettype" VALUE="DisableAssetType.ITEM"/>
						<argument NAME="pubid" VALUE="Variables.pubid"/>
					</callelement>
					<if COND="Variables.IsAuthorized=true">
						<then>
							<callelement NAME="OpenMarket/Xcelerate/Actions/AssetMgt/EnableAssetTypePub">
								<argument NAME="upcommand" VALUE="DisableAssetType"/>
								<argument NAME="assettype" VALUE="DisableAssetType.ITEM"/>
								<argument NAME="pubid" VALUE="Variables.pubid"/>
						   </callelement> 
	
							<if COND="Variables.errno!=0">
							<then>
								<XLAT.LOOKUP KEY="dvin/UI/Admin/Error/disablingasset" VARNAME="msgtext"/>
								<SETVAR NAME="msgtext" VALUE="Variables.msgtext: DisableAssetType.ITEM, errno= Variables.errno"/>
								<CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/ShowMessage">
									<ARGUMENT NAME="severity" VALUE="error"/>
								</CALLELEMENT>
							</then>
							<else>
								<XLAT.LOOKUP KEY="dvin/UI/Admin/Disabledasset" VARNAME="msgtext"/>
								<SETVAR NAME="msgtext" VALUE="Variables.msgtext: DisableAssetType.ITEM"/>
								<CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/ShowMessage">
									<ARGUMENT NAME="severity" VALUE="info"/>
								</CALLELEMENT>
							</else>
							</if>
						</then>
						<else>
							<XLAT.LOOKUP KEY="dvin/UI/Admin/Alreadydisabledasset" VARNAME="msgtext"/>
							<SETVAR NAME="msgtext" VALUE="Variables.msgtext: DisableAssetType.ITEM"/>
							<CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/ShowMessage">
								<ARGUMENT NAME="severity" VALUE="warning"/>
							</CALLELEMENT>
						</else>
				</if>
		</loop>
		
		
		<!-- 

			run this loop to delete the start menu items selected by the user
		-->
		<SETCOUNTER NAME="n" VALUE="0"/>
		<IF COND="Variables.numMenuItems!=0">
			<THEN>
				<LOOP FROM="0" COUNT="Variables.numMenuItems">
					<IF COND="IsVariable.currSMICounters.n=true">
						<THEN>
							 <STARTMENU.LOAD ID="Variables.currSMICounters.n" OBJVARNAME="mi"/>
		                     <STARTMENUITEM.GETNAME NAME="mi" VARNAME="currentName"/>
        		             <STARTMENU.DELETE ID="Variables.currSMICounters.n"/>
                		     <IF COND="Variables.errno!=0">
                        		<THEN>
                           			<XLAT.STREAM KEY="dvin/UI/Admin/Error/deletingcurrentNameerrnoerrdetail1" currentName="Variables.currentName" errno="Variables.errno" errdetail1="Variables.errdetail1" EVALALL="false"/>
	                        	</THEN>
	                    	</IF>
					    </THEN>
					</IF>
					<INCCOUNTER NAME="n" VALUE="1" />
				</LOOP>
			</THEN>
		</IF>
		
	
	<SETVAR NAME="showDetails" VALUE="true" />
	
	</THEN>
	</IF> <!-- end of delsmi -->
	 </div>
	<IF COND="Variables.showDetails=true">
	<THEN>
		
		<CALLELEMENT NAME="OpenMarket/Xcelerate/Admin/SiteFront">
			<ARGUMENT NAME="pubid" VALUE="Variables.pubid"/>
			<ARGUMENT NAME="action" VALUE="details"/>
			<ARGUMENT NAME="showtitle" VALUE="false"/>
		</CALLELEMENT>
					
		<PROPERTY.GET PARAM="xcelerate.treeType" INIFILE="futuretense_xcel.ini" VARNAME="proptreetype"/>
		<if  COND="IsElement.OpenMarket/Xcelerate/UIFramework/UpdateTreeVariables.proptreetype=true">
		<then>
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/UpdateTreeVariables.proptreetype">
				<argument NAME="__TreeRefreshKeys__" VALUE="Self:Variables.pubid_ATs"/>
			</callelement>		
		</then>
		</if>
	</THEN>
	</IF>


</FTCS>
