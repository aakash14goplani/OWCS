<?xml version="1.0" ?>
<!DOCTYPE FTCS SYSTEM "futuretense_cs.dtd">
<FTCS Version="1.1">
<PROPERTY.GET PARAM="xcelerate.charset" INIFILE="futuretense_xcel.ini" VARNAME="charset"/>
<SETVAR NAME="cs.contenttype" VALUE="text/html; charset=Variables.charset"/>
<!--
$Logfile: /VerticalApps/XcelerateD/install/Xcelerate/Populate/ElementCatalog/OpenMarket/Xcelerate/UIFramework/AdminPage.xml $
$Revision: 23 $
$Modtime: 7/30/04 1:56p $
-->
<!-- OpenMarket/Xcelerate/UIFramework/AdminPage
-
- INPUT
-
- OUTPUT
-
-->

<CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/StandardVariables"/>

<HTML>

    <HEAD>

	<CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/StandardHeader"/>

		<SCRIPT Language="JavaScript">
		<![CDATA[
		var isNew = 0;
		var isNS4 = 0;
		var isIE4 = 0;
		var isIE5 = 0;
		var isNS5 = 0;
		var isID  = 0;
		var docObj = "";
		var styleObj = "";

		// Determine browser versions
		var brow = ((navigator.appName) + (parseInt(navigator.appVersion)));
		var isat = navigator.userAgent.indexOf("MSIE");
		var ieVer = -1;
		if (isat > -1)
		{
			// IE
			isat += 5;
			var end = navigator.userAgent.indexOf(";", isat);
			if (end > isat)
				ieVer = parseInt(navigator.userAgent.substring(isat, end));
		}

		if (ieVer == 4)
		{isIE4 = 1;}
		if (ieVer == 5)
		{isIE5 = 1;}
		if (ieVer == 6)
		{isIE5 = 1;}
		if (ieVer > 6)
		{isNew = 1;}

		if (parseInt(navigator.appVersion) >= 5) { isNew=1; }
		else if (brow=="Netscape4") {isNS4=1;}

		if (brow=="Netscape5") {isNS5=1;}

		// Set docObj and styleObj
		if (isNS4 || isIE4 || isIE5 ||isNew) {
			docObj = (isNS4) ? 'document' : 'document.all';
			styleObj = (isNS4) ? '' : '.style';
			if (isIE5 || isNS5 || isNew) {isID=1;}
		}
		]]>
		</SCRIPT>
		<CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/LoadDojo"/>
		<CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/SetStylesheet"/>

</HEAD>
<BODY class="centerpane padding20">

<SETVAR NAME="errno" VALUE="0"/>
<!-- check to see if user is updating his profile other he should have xceladmin permission -->
<if cond="IsVariable.manageprofile=false">
<then>
	<USERISMEMBER GROUP="xceladmin"/>
	<if COND="Variables.errno=0">
	<then>
        <SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Actions/Security/TimeoutError" outstring="urltimeouterror">
            <satellite.argument name="cs_environment" value="Variables.cs_environment"/>
            <satellite.argument name="cs_formmode" value="Variables.cs_formmode"/>
        </SATELLITE.LINK>
		<REPLACE STR="Variables.urltimeouterror">
			<script LANGUAGE="JavaScript">
				parent.parent.location="Variables.urltimeouterror";
			</script>
		</REPLACE>
		<throwexception/>
	</then>
	</if>
</then>
</if>
	<CALLELEMENT NAME="OpenMarket/Xcelerate/Util/EncodeFieldsValue"/>
	<SATELLITE.FORM ASSEMBLER="query" NAME="AppForm" METHOD="POST">
	<STRING.ENCODE VARIABLE="charset" VARNAME="OutputQString"/>
    <INPUT TYPE="HIDDEN" NAME="_charset_" VALUE="Variables.OutputQString" REPLACEALL="Variables.OutputQString"/>
    <STRING.ENCODE VARIABLE="cs_environment" VARNAME="OutputQString"/>
    <INPUT TYPE="HIDDEN" NAME="cs_environment" VALUE="Variables.OutputQString" REPLACEALL="Variables.OutputQString"/>
    <STRING.ENCODE VARIABLE="cs_formmode" VARNAME="OutputQString"/>
    <INPUT TYPE="HIDDEN" NAME="cs_formmode" VALUE="Variables.OutputQString" REPLACEALL="Variables.OutputQString"/>
	<IF COND="IsVariable.id=true">
	<THEN>
		<STRING.ENCODE VARIABLE="id" VARNAME="id"/>
	</THEN>
	</IF>
	
	<IF COND="IsVariable.AssetType=true">
	<THEN>
		<STRING.ENCODE VARIABLE="AssetType" VARNAME="AssetType"/>
	</THEN>
	</IF>

    <!-- set the publication name if it has not been done -->
    <if COND="SessionVariables.PublicationName=Not Selected">
        <then>
            <setssvar NAME="pubid" VALUE="Variables.pubid"/>
            <callelement NAME="OpenMarket/Xcelerate/Actions/Security/SetPublicationName"/>
        </then>
    </if>

 	<setvar NAME="showSiteTree" VALUE="SessionVariables.showSiteTree"/>

   <!-- create a default dateformat object for use by all child elements -->

    <IF COND="IsSessionVariable.locale=true">
        <THEN>
            <LOCALE.CREATE VARNAME="LocaleName" LOCALENAME="SessionVariables.locale"/>
            <DATEFORMAT.CREATE NAME="_FormatDate_" TIMESTYLE="FULL" LOCALE="LocaleName" TIMEZONEID="SessionVariables.time.zone"/>
        </THEN>
        <ELSE>
            <DATEFORMAT.CREATE NAME="_FormatDate_" TIMESTYLE="FULL" TIMEZONEID="SessionVariables.time.zone"/>
        </ELSE>
    </IF>



	<if cond="IsVariable.ThisPage=true">
	<then>
		<if cond="IsVariable.PagePath=true">
		<then>
		<callelement NAME="Variables.PagePath/Variables.ThisPage"/>
		</then>
		<else>
		<callelement NAME="OpenMarket/Xcelerate/Admin/Variables.ThisPage"/>
		</else>
		</if>
	</then>
	<else>
	    <if cond="IsVariable.manageprofile=true">
		<then>
			<!-- So user wants to go to his profile -->
		<USERMANAGER.GETLOGINUSERNAME VARNAME="currentUserName" />
		<SETVAR NAME="username" VALUE="Variables.currentUserName" />
		<SETVAR NAME="action" VALUE="edit" />
		<callelement NAME="OpenMarket/Xcelerate/Admin/UserProfileFront"/>
		</then>
		<else>
		<!-- Display an informational message. -->
		<CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/ShowMessage">
			<ARGUMENT NAME="elem" VALUE="NoActionSpecified"/>
			<ARGUMENT NAME="severity" VALUE="error"/>
		</CALLELEMENT>
		</else>
		</if>
	</else>
	</if>

	<SCRIPT LANGUAGE="JavaScript">
		<![CDATA[
			var num = document.AppForm.length;
			document.AppForm.encoding="application/x-www-form-urlencoded";
			for (i=0; i < num; i++)
			{
				if (document.AppForm.elements[i].type=="file" || document.AppForm.elements[i].type=="textarea") document.AppForm.encoding="multipart/form-data";
			}
		]]>
	</SCRIPT>
	</SATELLITE.FORM>
	<div style="visibility:hidden;height:100px;"></div>
    </BODY>
</HTML>


</FTCS>
