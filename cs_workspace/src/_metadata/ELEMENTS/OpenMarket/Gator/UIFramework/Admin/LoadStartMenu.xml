<?xml version="1.0" ?>
<!DOCTYPE FTCS SYSTEM "futuretense_cs.dtd">
<FTCS Version="1.1">
<SETVAR NAME="cs.contenttype" VALUE="text/html; charset=UTF-8"/>

<!-- OpenMarket/Gator/UIFramework/Admin/LoadStartMenu
-
- INPUT
-
- OUTPUT
-
-->

<CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/BasicEnvironment"/>

<!-- This element handles all children of the StartMenu root node -->
<!-- All we need to do is 'Add New' and any StartMenu Items -->
<IF COND="Variables.Depth=1">
<THEN>
	<REMOVEVAR NAME="Description"/>
	
	<!-- display Add New, CS Direct and CS Desktop dummy nodes -->
	<CALLELEMENT NAME="OpenMarket/Gator/UIFramework/BuildTreeNodeID" SCOPED="STACKED">
		<ARGUMENT NAME="AdHoc" VALUE="StartMenu:New"/>
		<ARGUMENT NAME="TreeNodeID" VALUE="Variables.empty"/>
	</CALLELEMENT>
	
	<REMOVEVAR NAME="LoadURL"/>
	<REMOVEVAR NAME="OKActions"/>
    <XLAT.LOOKUP KEY="dvin/TreeApplet/AddNew" ENCODE="false" VARNAME="_XLAT_"/>
	<SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Admin/StartMenuFront" outstring="ExecuteURL">
		<satellite.argument name="op" value="new"/>
	</SATELLITE.LINK>

	<SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Gator/UIFramework/TreeOpURL" outstring="OpURL">
		<satellite.argument name="AssetType" value="Variables.AssetType"/>
	</SATELLITE.LINK>
	<XLAT.LOOKUP KEY="dvin/UI/AddNewStartMenu" ENCODE="false" VARNAME="newStartMenuDesc"/> 
	<CALLELEMENT NAME="OpenMarket/Gator/UIFramework/BuildTreeNode">
		<ARGUMENT NAME="Label" VALUE="Variables._XLAT_"/>
		<ARGUMENT NAME="Description" VALUE="Variables.newStartMenuDesc"/>  
		<ARGUMENT NAME="ID" VALUE="Variables.TreeNodeID"/>
		<ARGUMENT NAME="OpURL" VALUE="Variables.OpURL"/>
		<ARGUMENT NAME="ExecuteURL" VALUE="Variables.ExecuteURL"/>
		<ARGUMENT NAME="Image" VALUE="Variables.cs_imagedir/OMTree/TreeImages/plus.png"/>
	</CALLELEMENT>
	
	<REMOVEVAR NAME="ExecuteURL"/>
	
	
	
	<STARTMENU.GETALLSTARTITEMS ITEMTYPE="InsiteForm" LISTVARNAME="menuitems"/>
	<IF COND="Variables.errno=0">
	<THEN>
		<IF COND="IsList.menuitems=true">
		<THEN>
			<IF COND="menuitems.#numRows!=0">
			<THEN>
				<SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Gator/UIFramework/LoadAdminTree" outstring="LoadURL">
					<satellite.argument name="op" value="load"/>
					<satellite.argument name="NodeType" value="StartMenu"/>
					<satellite.argument name="Depth" value="2"/>
					<satellite.argument name="currentType" value="InsiteForm"/>
				</SATELLITE.LINK>
			</THEN>
			<ELSE>
				<REMOVEVAR NAME="LoadURL"/>
			</ELSE>
			</IF>
		</THEN>
		</IF>
	</THEN>
	</IF>

	<CALLELEMENT NAME="OpenMarket/Gator/UIFramework/BuildTreeNodeID" SCOPED="STACKED">
		<ARGUMENT NAME="AdHoc" VALUE="StartMenu:InsiteForm"/>
		<ARGUMENT NAME="TreeNodeID" VALUE="Variables.empty"/>
	</CALLELEMENT>
	
	<REMOVEVAR NAME="OKActions"/>
    <XLAT.LOOKUP KEY="dvin/UI/Admin/NewInsite" ENCODE="false" VARNAME="_XLAT_"/>
	<SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Gator/UIFramework/TreeOpURL" outstring="OpURL">
		<satellite.argument name="AssetType" value="Variables.AssetType"/>
	</SATELLITE.LINK>
	<SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Admin/StartMenuFront" outstring="ExecuteURL">
		<satellite.argument name="op" value="list"/>
		<satellite.argument name="ItemType" value="InsiteForm"/>
	</SATELLITE.LINK>


	<CALLELEMENT NAME="OpenMarket/Gator/UIFramework/BuildTreeNode">
		<ARGUMENT NAME="Label" VALUE="Variables._XLAT_"/>
		<ARGUMENT NAME="Description" VALUE="Variables._XLAT_"/> 
		<ARGUMENT NAME="ID" VALUE="Variables.TreeNodeID"/>
		<ARGUMENT NAME="OpURL" VALUE="Variables.OpURL"/>
		<ARGUMENT NAME="ExecuteURL" VALUE="Variables.ExecuteURL"/>
		<ARGUMENT NAME="Image" VALUE="Variables.cs_imagedir/OMTree/TreeImages/startmenu.png"/>
		<ARGUMENT NAME="RefreshKeys" VALUE="StartMenuInsiteForm"/>
	</CALLELEMENT>

	<REMOVEVAR NAME="RefreshKeys"/>
	
	
	
	
	
	<STARTMENU.GETALLSTARTITEMS ITEMTYPE="ContentForm" LISTVARNAME="menuitems"/>
	<IF COND="Variables.errno=0">
	<THEN>
		<IF COND="IsList.menuitems=true">
		<THEN>
			<IF COND="menuitems.#numRows!=0">
			<THEN>
				<SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Gator/UIFramework/LoadAdminTree" outstring="LoadURL">
					<satellite.argument name="op" value="load"/>
					<satellite.argument name="NodeType" value="StartMenu"/>
					<satellite.argument name="Depth" value="2"/>
					<satellite.argument name="currentType" value="ContentForm"/>
				</SATELLITE.LINK>
			</THEN>
			<ELSE>
				<REMOVEVAR NAME="LoadURL"/>
			</ELSE>
			</IF>
		</THEN>
		</IF>
	</THEN>
	</IF>

	<CALLELEMENT NAME="OpenMarket/Gator/UIFramework/BuildTreeNodeID" SCOPED="STACKED">
		<ARGUMENT NAME="AdHoc" VALUE="StartMenu:ContentForm"/>
		<ARGUMENT NAME="TreeNodeID" VALUE="Variables.empty"/>
	</CALLELEMENT>
	
	<REMOVEVAR NAME="OKActions"/>
    <XLAT.LOOKUP KEY="dvin/Common/New" ENCODE="false" VARNAME="_XLAT_"/>
	<SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Gator/UIFramework/TreeOpURL" outstring="OpURL">
		<satellite.argument name="AssetType" value="Variables.AssetType"/>
	</SATELLITE.LINK>
	<SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Admin/StartMenuFront" outstring="ExecuteURL">
		<satellite.argument name="op" value="list"/>
		<satellite.argument name="ItemType" value="ContentForm"/>
	</SATELLITE.LINK>


	<CALLELEMENT NAME="OpenMarket/Gator/UIFramework/BuildTreeNode">
		<ARGUMENT NAME="Label" VALUE="Variables._XLAT_"/>
		<ARGUMENT NAME="Description" VALUE="Variables._XLAT_"/> 
		<ARGUMENT NAME="ID" VALUE="Variables.TreeNodeID"/>
		<ARGUMENT NAME="OpURL" VALUE="Variables.OpURL"/>
		<ARGUMENT NAME="ExecuteURL" VALUE="Variables.ExecuteURL"/>
		<ARGUMENT NAME="Image" VALUE="Variables.cs_imagedir/OMTree/TreeImages/startmenu.png"/>
		<ARGUMENT NAME="RefreshKeys" VALUE="StartMenuContentForm"/>
	</CALLELEMENT>

	<REMOVEVAR NAME="RefreshKeys"/>
	
	<STARTMENU.GETALLSTARTITEMS ITEMTYPE="Search" LISTVARNAME="menuitems"/>
	<IF COND="Variables.errno=0">
	<THEN>
		<IF COND="IsList.menuitems=true">
		<THEN>
			<IF COND="menuitems.#numRows!=0">
			<THEN>
				<SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Gator/UIFramework/LoadAdminTree" outstring="LoadURL">
					<satellite.argument name="op" value="load"/>
					<satellite.argument name="NodeType" value="StartMenu"/>
					<satellite.argument name="Depth" value="2"/>
					<satellite.argument name="currentType" value="Search"/>
				</SATELLITE.LINK>
			</THEN>
			<ELSE>
				<REMOVEVAR NAME="LoadURL"/>
			</ELSE>
			</IF>
		</THEN>
		</IF>
	</THEN>
	</IF>

	<CALLELEMENT NAME="OpenMarket/Gator/UIFramework/BuildTreeNodeID" SCOPED="STACKED">
		<ARGUMENT NAME="AdHoc" VALUE="StartMenu:Search"/>
		<ARGUMENT NAME="TreeNodeID" VALUE="Variables.empty"/>
	</CALLELEMENT>
	
	<REMOVEVAR NAME="OKActions"/>
    <XLAT.LOOKUP KEY="dvin/TreeApplet/Search" ENCODE="false" VARNAME="_XLAT_"/>
	<SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Gator/UIFramework/TreeOpURL" outstring="OpURL">
		<satellite.argument name="AssetType" value="Variables.AssetType"/>
	</SATELLITE.LINK>
	<SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Admin/StartMenuFront" outstring="ExecuteURL">
		<satellite.argument name="op" value="list"/>
		<satellite.argument name="ItemType" value="Search"/>
	</SATELLITE.LINK>
	
	<CALLELEMENT NAME="OpenMarket/Gator/UIFramework/BuildTreeNode">
		<ARGUMENT NAME="Label" VALUE="Variables._XLAT_"/>
		<ARGUMENT NAME="Description" VALUE="Variables._XLAT_"/> 
		<ARGUMENT NAME="ID" VALUE="Variables.TreeNodeID"/>
		<ARGUMENT NAME="OpURL" VALUE="Variables.OpURL"/>
		<ARGUMENT NAME="ExecuteURL" VALUE="Variables.ExecuteURL"/>
		<ARGUMENT NAME="Image" VALUE="Variables.cs_imagedir/OMTree/TreeImages/startmenu.png"/>
		<ARGUMENT NAME="RefreshKeys" VALUE="StartMenuSearch"/>
	</CALLELEMENT>

	<REMOVEVAR NAME="RefreshKeys"/>
				
	<STARTMENU.GETALLSTARTITEMS ITEMTYPE="Word" LISTVARNAME="menuitems"/>
	<IF COND="Variables.errno=0">
	<THEN>
		<IF COND="IsList.menuitems=true">
		<THEN>
			<IF COND="menuitems.#numRows!=0">
			<THEN>
				<SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Gator/UIFramework/LoadAdminTree" outstring="LoadURL">
					<satellite.argument name="op" value="load"/>
					<satellite.argument name="NodeType" value="StartMenu"/>
					<satellite.argument name="Depth" value="2"/>
					<satellite.argument name="currentType" value="Word"/>
				</SATELLITE.LINK>
			</THEN>
			<ELSE>
				<REMOVEVAR NAME="LoadURL"/>
			</ELSE>
			</IF>
		</THEN>
		</IF>
	</THEN>
	</IF>
	
	<CALLELEMENT NAME="OpenMarket/Gator/UIFramework/BuildTreeNodeID" SCOPED="STACKED">
		<ARGUMENT NAME="AdHoc" VALUE="StartMenu:Word"/>
		<ARGUMENT NAME="TreeNodeID" VALUE="Variables.empty"/>
	</CALLELEMENT>
	
	<REMOVEVAR NAME="OKActions"/>
    <XLAT.LOOKUP KEY="dvin/TreeApplet/CSDesktop" ENCODE="false" VARNAME="_XLAT_"/>
	<SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Gator/UIFramework/TreeOpURL" outstring="OpURL">
		<satellite.argument name="AssetType" value="Variables.AssetType"/>
	</SATELLITE.LINK>
	<SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Admin/StartMenuFront" outstring="ExecuteURL">
		<satellite.argument name="op" value="list"/>
		<satellite.argument name="ItemType" value="Word"/>
	</SATELLITE.LINK>
	
	<CALLELEMENT NAME="OpenMarket/Gator/UIFramework/BuildTreeNode">
		<ARGUMENT NAME="Label" VALUE="Variables._XLAT_"/>
		<ARGUMENT NAME="Description" VALUE="Variables._XLAT_"/> 
		<ARGUMENT NAME="ID" VALUE="Variables.TreeNodeID"/>
		<ARGUMENT NAME="OpURL" VALUE="Variables.OpURL"/>
		<ARGUMENT NAME="ExecuteURL" VALUE="Variables.ExecuteURL"/>
		<ARGUMENT NAME="Image" VALUE="Variables.cs_imagedir/OMTree/TreeImages/startmenu.png"/>
		<ARGUMENT NAME="RefreshKeys" VALUE="StartMenuWord"/>
	</CALLELEMENT>

	<REMOVEVAR NAME="RefreshKeys"/>											 
											 
   <STARTMENU.GETALLSTARTITEMS ITEMTYPE="CSDocLink" LISTVARNAME="menuitems"/>
	<IF COND="Variables.errno=0">
	<THEN>
		<IF COND="IsList.menuitems=true">
		<THEN>
			<IF COND="menuitems.#numRows!=0">
			<THEN>
				<SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Gator/UIFramework/LoadAdminTree" outstring="LoadURL">
					<satellite.argument name="op" value="load"/>
					<satellite.argument name="NodeType" value="StartMenu"/>
					<satellite.argument name="Depth" value="2"/>
					<satellite.argument name="currentType" value="CSDocLink"/>
				</SATELLITE.LINK>
			</THEN>
			<ELSE>
				<REMOVEVAR NAME="LoadURL"/>
			</ELSE>
			</IF>
		</THEN>
		</IF>
	</THEN>
	</IF>

	<CALLELEMENT NAME="OpenMarket/Gator/UIFramework/BuildTreeNodeID" SCOPED="STACKED">
		<ARGUMENT NAME="AdHoc" VALUE="StartMenu:DocLink"/>
		<ARGUMENT NAME="TreeNodeID" VALUE="Variables.empty"/>
	</CALLELEMENT>

	<REMOVEVAR NAME="OKActions"/>
    <XLAT.LOOKUP KEY="dvin/UI/Admin/CSDocLink" ENCODE="false" VARNAME="_XLAT_"/>
	<SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Gator/UIFramework/TreeOpURL" outstring="OpURL">
		<satellite.argument name="AssetType" value="Variables.AssetType"/>
	</SATELLITE.LINK>
	<SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Admin/StartMenuFront" outstring="ExecuteURL">
		<satellite.argument name="op" value="list"/>
		<satellite.argument name="ItemType" value="CSDocLink"/>
	</SATELLITE.LINK>
	
	<CALLELEMENT NAME="OpenMarket/Gator/UIFramework/BuildTreeNode">
		<ARGUMENT NAME="Label" VALUE="Variables._XLAT_"/>
		<ARGUMENT NAME="Description" VALUE="Variables._XLAT_"/> 
		<ARGUMENT NAME="ID" VALUE="Variables.TreeNodeID"/>
		<ARGUMENT NAME="OpURL" VALUE="Variables.OpURL"/>
		<ARGUMENT NAME="ExecuteURL" VALUE="Variables.ExecuteURL"/>
		<ARGUMENT NAME="Image" VALUE="Variables.cs_imagedir/OMTree/TreeImages/startmenu.png"/>
		<ARGUMENT NAME="RefreshKeys" VALUE="StartMenuCSDocLink"/>
	</CALLELEMENT>

	<REMOVEVAR NAME="RefreshKeys"/>

</THEN>
<ELSE>
   
	<STARTMENU.GETALLSTARTITEMS ITEMTYPE="Variables.currentType" LISTVARNAME="menuitems"/>
	<IF COND="Variables.errno=0">
	<THEN>
		<IF COND="IsList.menuitems=true">
		<THEN>
			<IF COND="menuitems.#numRows!=0">
			<THEN>
				<LOOP LIST="menuitems">
					
					<CALLELEMENT NAME="OpenMarket/Gator/UIFramework/BuildTreeNodeID" SCOPED="STACKED">
						<ARGUMENT NAME="AdHoc" VALUE="StartMenu:menuitems.id"/>
						<ARGUMENT NAME="TreeNodeID" VALUE="Variables.empty"/>
					</CALLELEMENT>
					
					<REMOVEVAR NAME="LoadURL"/>
					<REMOVEVAR NAME="OKActions"/>
					<SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Admin/StartMenuFront" outstring="ExecuteURL">
						<satellite.argument name="op" value="view"/>
						<satellite.argument name="startitem" value="menuitems.id"/>
					</SATELLITE.LINK>

					<SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Gator/UIFramework/TreeOpURL" outstring="OpURL">
						<satellite.argument name="AssetType" value="Variables.AssetType"/>
					</SATELLITE.LINK>

					<CALLELEMENT NAME="OpenMarket/Gator/UIFramework/BuildTreeNode">
						<ARGUMENT NAME="Label" VALUE="menuitems.name"/>
						<ARGUMENT NAME="Description" VALUE="menuitems.description"/>
						<ARGUMENT NAME="ID" VALUE="Variables.TreeNodeID"/>
						<ARGUMENT NAME="OpURL" VALUE="Variables.OpURL"/>
						<ARGUMENT NAME="ExecuteURL" VALUE="Variables.ExecuteURL"/>
						<ARGUMENT NAME="Image" VALUE="Variables.cs_imagedir/OMTree/TreeImages/AssetTypes/menuitems.assettype.png"/>
					</CALLELEMENT>
				</LOOP>
			</THEN>
			</IF>
		</THEN>
		</IF>
	</THEN>
	</IF>
</ELSE>
</IF>

</FTCS> 
