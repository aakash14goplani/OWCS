<?xml version="1.0" ?>
<!DOCTYPE FTCS SYSTEM "futuretense_cs.dtd">
<FTCS Version="1.1">
<!-- OpenMarket/Gator/AttributeTypes/PICKFROMTREE
-
- INPUT
-
- OUTPUT
-
-->

<IF COND="Variables.MultiValueEntry=yes">
<THEN>
   
	<tr>
		<callelement NAME="OpenMarket/Gator/FlexibleAssets/Common/DisplayAttributeName"/>
		<if COND="Variables.RequiredAttr=true">
		<then>
			<setvar NAME="RequireInfo" VALUE="*Variables.cs_SingleInputName*Variables.currentAttrName*ReqTrue*Variables.AttrType*treepick!"/>
		</then>
		<else>
			<setvar NAME="RequireInfo" VALUE="*Variables.cs_SingleInputName*Variables.currentAttrName*ReqFalse*Variables.AttrType*treepick!"/>
		</else>
		</if>
		<INPUT TYPE="hidden" NAME="Variables.AttrNumberRequireInfo" VALUE="Variables.RequireInfo" REPLACEALL="Variables.AttrNumber,Variables.RequireInfo"/>
		<td></td>
		<td> 
			<setvar NAME="doDefaultDisplay" VALUE="no"/>
			<ASSETTYPE.LIST LIST="currentAT" FIELD1="assettype" VALUE1="Variables.attrassettype"/>
			<XLAT.LOOKUP KEY="dvin/AT/Common/Selectassettypefromtree" ESCAPE="true" VARNAME="_XLAT_"/>   
			<XLAT.LOOKUP KEY="dvin/AT/Common/Selectassettypefromtree" VARNAME="_XLAT_alt"/>   
			<A HREF="javascript:void(0)" onclick="return SelectFromTree('Variables.TemplateChosen','TPtmplattrlist.assetid')" onmouseover="window.status='Variables._XLAT_'; return true;"
				onmouseout="window.status='';return true;" REPLACEALL="Variables.TemplateChosen,tmplattrlist.assetid,Variables._XLAT_">
				<CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/AddSelectedItems"/></CALLELEMENT>
			</A>
			
			<!-- If there are restricted subtypes, we have to pass those in a hidden field, so that the selections can be pruned during repost -->
			<SETVAR NAME="subtypevalues" VALUE="Variables.empty"/>
			<IF COND="IsList.attrassetsubtypes=true">
			<THEN>
				<IF COND="attrassetsubtypes.#numRows!=0">
				<THEN>
					<!-- Build a hash of the subtypes we're allowed to take -->
					<HASH.CREATE NAME="subtypehash" LIST="attrassetsubtypes" COLUMN="subtype"/>
					<!-- Dump the hash table to the string.  Hopefully ; is a safe delimiter -->
					<HASH.TOSTRING NAME="subtypehash" VARNAME="subtypevalues" DELIM=";"/>
				</THEN>
				</IF>
			</THEN>
			</IF>
			
			<span class="small-text"><XLAT.STREAM KEY="dvin/AT/Forms/SelectTreeHint"/></span>
			<INPUT TYPE="hidden" NAME="TPtmplattrlist.assetid" VALUE="" REPLACEALL="tmplattrlist.assetid"/>
			<INPUT TYPE="hidden" NAME="TPStmplattrlist.assetid" VALUE="Variables.subtypevalues" REPLACEALL="tmplattrlist.assetid,Variables.subtypevalues"/>
			<HASH.ADD NAME="treePickAttrs" VALUE="tmplattrlist.assetid"/>
			<br/>
			<HASH.CREATE NAME="treePickVals"/>
			<LOOP LIST="AttrValueList">
				<setvar NAME="errno" VALUE="0"/>
				<setvar NAME="delete" VALUE="Variables.dtptmplattrlist.assetidAttrValueList.value"/>
				<BEGINS STR="Variables.delete" WHAT="Variables."/>
				<IF COND="Variables.errno=1">
				<THEN>
					<HASH.ADD NAME="treePickVals" VALUE="AttrValueList.value"/>
					<XLAT.LOOKUP KEY="dvin/Common/AT/Removethisselection" ESCAPE="true" VARNAME="_XLAT_"/>
					<XLAT.LOOKUP KEY="dvin/Common/AT/Removethisselection" VARNAME="_XLAT_alt"/>
					<a href="javascript:void(0)" onclick="return RemoveSelection('Variables.TemplateChosen','dtptmplattrlist.assetidAttrValueList.value','TreeSelect')" onmouseover="window.status='Variables._XLAT_'; return true;"
						onmouseout="window.status='';return true;" REPLACEALL="Variables.TemplateChosen,AttrValueList.value,tmplattrlist.assetid,Variables._XLAT_">
						<img src="Variables.cs_imagedir/graphics/common/icon/iconDeleteContent.gif" border="0" alt="Variables._XLAT_alt" title="Variables._XLAT_alt" REPLACEALL="Variables.cs_imagedir,Variables._XLAT_alt"/>
					</a>
					<INPUT TYPE="hidden" NAME="dtptmplattrlist.assetidAttrValueList.value" VALUE="" REPLACEALL="tmplattrlist.assetid,AttrValueList.value"/>
					<ASSET.LIST TYPE="Variables.attrassettype" LIST="currentAsset" FIELD1="id" VALUE1="AttrValueList.value"/>
					<span class="small-text"><STRING.STREAM VALUE="currentAsset.name (Variables.attrassettype)"/><br/></span>
				</THEN>
				</IF>
			</LOOP>
			<HASH.TOSTRING NAME="treePickVals" VARNAME="treePickVals" DELIM=";"/>
			<INPUT TYPE="hidden" NAME="MSVariables.AttrName" VALUE="yes" REPLACEALL="Variables.AttrName"/>
			<INPUT TYPE="hidden" NAME="Variables.cs_SingleInputName" VALUE="Variables.treePickVals" REPLACEALL="Variables.cs_SingleInputName,Variables.treePickVals"/>
		</td>
	</tr>
</THEN>
</IF>

</FTCS> 
