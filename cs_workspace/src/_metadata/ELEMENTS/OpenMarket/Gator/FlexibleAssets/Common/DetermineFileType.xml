<?xml version="1.0" ?>
<!DOCTYPE FTCS SYSTEM "futuretense_cs.dtd">
<FTCS Version="1.1">
<!-- OpenMarket/Gator/FlexibleAssets/Common/DetermineFileType
--
-- INPUT
--
-- OUTPUT
--
-->

<setvar NAME="displayable" VALUE="false"/>
<setvar NAME="filetype" VALUE="unknown"/>
<setvar NAME="picture" VALUE="false"/>

<STRINGLIST NAME="extensionList" STR="Variables.filename" DELIM="."/>
<IF COND="IsList.extensionList=true">
<THEN>
    <IF COND="extensionList.#numRows!=0">
    <THEN>
      <GOTOROW LIST="extensionList" ROWNUM="extensionList.#numRows"/>
				<TOLOWER STR="extensionList.ITEM" OUTSTR="lowerExtension"/>
				 <SETVAR NAME="errno" VALUE="0"/>
                 <SETVAR NAME="tablename" VALUE="MimeType"/>
                 <EXECSQL SQL="SELECT * FROM Variables.tablename WHERE extension='Variables.lowerExtension'" LIST="lMimeTypes"/>
                 <IF COND="Variables.errno=0">
                 <THEN>
				    <setvar NAME="filetype" VALUE="lMimeTypes.mimetype"/>
                 </THEN>
                 <ELSE>
                    <SETVAR NAME="filetype" VALUE="application/unknown"/>
                 </ELSE>
                 </IF>
				 <IF COND="lMimeTypes.keyword=image">
                    <THEN>
                        <setvar NAME="picture" VALUE="true"/>
                        <setvar NAME="displayable" VALUE="true"/>
                    </THEN>
                    <ELSE>
                        <IF COND="lMimeTypes.keyword=raw">
                        <THEN>
                            <setvar NAME="displayable" VALUE="true"/>
                   </THEN>
				 </IF>
			  </ELSE>
			</IF>
    </THEN>
    </IF>
</THEN>
</IF>
    
</FTCS> 
