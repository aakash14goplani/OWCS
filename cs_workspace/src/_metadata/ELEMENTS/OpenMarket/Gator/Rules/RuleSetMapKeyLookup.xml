<?xml version="1.0" ?>
<!DOCTYPE ftcs SYSTEM "futuretense_cs.dtd">
<ftcs version="1.2">
<!-- OpenMarket/Gator/Rules/RuleSetMapKeyLookup
-
- INPUT
-   ourKey : key to lookup in rulemaps
-   ourMap : object name of rulemap object (optional)
-
- OUTPUT
-  ourAssetid : id of asset in rulemap key
-  ourAssettype : type of asset in rulemap key
-->

     <IF COND="IsVariable.ourMap!=true">
     <THEN>
                <SETVAR NAME="ourMap" VALUE="theMap"/>    
     </THEN>
     </IF>
    <!-- fetch the rulemap value based on key -->
    <RULESETMAP.GETVALUE NAME="Variables.ourMap" KEY="Variables.ourKey" VARNAME="ourValue"/>
    <!-- calculate index for assettype and assetid -->
    <INDEXOF STR="Variables.ourValue" OUTSTR="keyColonIndex" WHAT=":" INDEX="0"/>
    <CALCULATOR.GO VALUE="Variables.keyColonIndex 1 +" VARNAME="keyColonPlusOne"/>
    <SUBSTRING STR="Variables.ourValue" OUTSTR="ourAssetid" INDEX="Variables.keyColonPlusOne"/>
    <SUBSTRING STR="Variables.ourValue" OUTSTR="ourAssettype" ENDINDEX="Variables.keyColonIndex"/>
        <!-- <CSVAR NAME="DEBUGrulelookup: Variables.ourKey,Variables.ourValue, Variables.ourAssettype, Variables.ourAssetid"/> -->
 </ftcs>