<?XML VERSION="1.0" ?>
<!DOCTYPE FTCS SYSTEM "futuretense_cs.dtd">
<FTCS Version="1.0">
<div class="width-outer-70">
<SETCOUNTER NAME="RollbackCounter" VALUE="1"/>
<LOOP UNTIL="Counters.RollbackCounter=Variables.numrollbacks">
    <IF COND="IsVariable.rollbackmeVersionCounters.RollbackCounter=true"><THEN>
        <!-- clear out errno -->
        <SETVAR NAME="errno" VALUE="0"/>

        <SETVAR NAME="rollbackTable" VALUE="Variables.rollbackmeTableCounters.RollbackCounter"/>
        <SETVAR NAME="rollbackAsset" VALUE="Variables.rollbackmeAssetCounters.RollbackCounter"/>
        <SETVAR NAME="rollbackVersion" VALUE="Variables.rollbackmeVersionCounters.RollbackCounter"/>
        <!-- do the rollback -->
        <ROLLBACK TABLE="Variables.rollbackTable"
                  ASSET="Variables.rollbackAsset"
                  VERSION="Variables.rollbackVersion"/>
        <!-- See if rollback succeeded -->
        <IF COND="Variables.errno=0">
             <THEN>
                  <!-- if succeeded, brag about it -->
                  <XLAT.LOOKUP KEY="dvin/AdminForms/Rollbacksucceeded" VARNAME="rollbacksucceeded"/>
				  <CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/ShowMessage">
						<ARGUMENT NAME="msgtext" VALUE="Variables.rollbacksucceeded"/>
						<ARGUMENT NAME="severity" VALUE="info"/>
				  </CALLELEMENT>
	         </THEN>
             <ELSE>
                  <!-- otherwise, call an error reporting element -->
                  <XLAT.LOOKUP KEY="dvin/AdminForms/Rollbackfailed" VARNAME="rollbackfailed"/>
				  <CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/ShowMessage">
						<ARGUMENT NAME="msgtext" VALUE="Variables.rollbackfailed"/>
						<ARGUMENT NAME="severity" VALUE="error"/>
				  </CALLELEMENT>
                  <CALLELEMENT NAME="FutureTense/Apps/AdminForms/RevisionMgt/errors"/>
             </ELSE>
        </IF>
    </THEN></IF>
    <INCCOUNTER NAME="RollbackCounter" VALUE="1"/>
</LOOP>
</div>
</FTCS>
