<?xml version="1.0" ?>
<!DOCTYPE FTCS SYSTEM "futuretense_cs.dtd">
<FTCS Version="1.1">
<!--
- Confidential and Proprietary Information of FutureTense Inc.
- All Rights Reserved.
-
- ContentDetailsUpload.xml
-
- DESCRIPTION
-
- HISTORY 
-->

<ASSET.LOAD NAME="basicUploadAsset" TYPE="Variables.AssetType" OBJECTID="Variables.id" />
<ASSET.GET NAME="basicUploadAsset" FIELD="Variables.fieldname_file" OUTPUT="fileName"/>

<callelement NAME="OpenMarket/Gator/FlexibleAssets/Common/DetermineFileType">
	<argument NAME="filename" VALUE="Variables.fileName"/>
</callelement>
<SETVAR NAME='contentDetailsUploadJSON' value='{ "1" : {'/>
<SETVAR NAME='contentDetailsUploadJSON' value='Variables.contentDetailsUploadJSON  "filename": "Variables.fileName", '/>
<SETVAR NAME='contentDetailsUploadJSON' value='Variables.contentDetailsUploadJSON  "filetype": "Variables.filetype" '/>
            
            
<div class='FormUploader'>
<div class='UploadFileDivInspect' name='contentDetailsUpload_Variables.fieldname_1' REPLACEALL='Variables.fieldname'>

<IF COND="IsVariable.revision=false">
<THEN>
    <if COND="IsVariable.assetmaker/property/Variables.fieldname/inputform/linktext=true">
    <then>
	    <if COND="IsVariable.assetmaker/property/Variables.fieldname/inputform/mimetype=true">
	    <then>
	        <setvar NAME="assetmakermimetype" VALUE="Variables.assetmaker/property/Variables.fieldname/inputform/mimetype" />
	    </then>
	    <else>
	        <setvar NAME="assetmakermimetype" VALUE="Variables.ContentDetails:mimetype" />
	    </else>
	    </if>
	    
	    <IF COND="Variables.displayable=true">
		<THEN>
			<RENDER.GETBLOBURL OUTSTR="urlblobserver" C="Variables.AssetType" CID="Variables.id" FIELD="Variables.fieldname" BLOBHEADER="Variables.filetype"  BLOBNOCACHE="true" ASSEMBLER="query" />
			<IF COND="Variables.picture=true">
			<THEN>
				<img src="Variables.urlblobserver" data-dojo-type='fw.dijit.UILightbox' data-dojo-props="title:'Variables.fileName', href:'Variables.urlblobserver'" style='width:96px' REPLACEALL="Variables.urlblobserver, Variables.fileName"/>
			</THEN>
			<ELSE>
				<XLAT.LOOKUP KEY="dvin/Assetmaker/ViewFormfield" VARNAME="ViewFormfield" ESCAPE="true" />
		        <A HREF=" Variables.urlblobserver" onmouseover="window.status='Variables.ViewFormfield';return true;" onmouseout="window.status='';return true;" REPLACEALL="Variables.ViewFormfield,Variables.urlblobserver" TARGET="_new">
		        	<img src='Variables.cs_imagedir/graphics/common/screen/dotclear.gif' name='iconImg' REPLACEALL="Variables.cs_imagedir"/>
		       	</A>
			</ELSE>
			</IF>
		</THEN>
		<ELSE>
			<XLAT.LOOKUP KEY="dvin/Assetmaker/ViewFormfield" VARNAME="ViewFormfield" ESCAPE="true" />
	       	<RENDER.GETBLOBURL OUTSTR="urlblobserver" C="Variables.AssetType" CID="Variables.id" FIELD="Variables.fieldname" BLOBHEADER="Variables.filetype"  BLOBHEADERNAME2="MDT-Type" BLOBHEADERVALUE2="abinary; charset=UTF-8" BLOBNOCACHE="true" ASSEMBLER="query" />
	        <A HREF=" Variables.urlblobserver" onmouseover="window.status='Variables.ViewFormfield';return true;" onmouseout="window.status='';return true;" REPLACEALL="Variables.ViewFormfield,Variables.urlblobserver" TARGET="_new">
	        	<img src='Variables.cs_imagedir/graphics/common/screen/dotclear.gif' name='iconImg' REPLACEALL="Variables.cs_imagedir"/>
	       	</A> 
		</ELSE>
		</IF>
    </then>
    </if>
</THEN>
 <ELSE>
     <satellite.link outstring="referURL" pagename="OpenMarket/Xcelerate/Util/LoadRevisionBlob" AssetType="Variables.AssetType" id="Variables.id" mimetype="Variables.ContentDetails:mimetype" filename="Variables.filename" fieldname="Variables.fieldname" Revision="Variables.rev" />
	 <STRING.ENCODE VARIABLE="assetmaker" VARNAME="assetmaker"/>
	 <STRING.ENCODE VARIABLE="fieldname" VARNAME="fieldname"/>
     <a href="javascript:void(0)" onclick="viewRevisionBlob('Variables.referURL','Variables.AssetType');" onmouseover="window.status='Variables.filename';return true;" onmouseout="window.status='';return true" REPLACEALL="Variables.AssetType,Variables.referURL,Variables.filename"> 
         <csvar NAME="Variables.assetmaker/property/Variables.fieldname/inputform/linktext" />
         <img src='Variables.cs_imagedir/graphics/common/screen/dotclear.gif' name='iconImg' REPLACEALL="Variables.cs_imagedir"/>
     </a> 
 </ELSE>
</IF>

</div>
</div>

<SETVAR NAME='contentDetailsUploadJSON' value='Variables.contentDetailsUploadJSON} }'/>

<callelement NAME="OpenMarket/Gator/Scripts/ApplyIconsAndTooltip">
	<argument NAME="AttributeName" VALUE="Variables.fieldname"/>
	<argument NAME="fileInfoJSON" VALUE='Variables.contentDetailsUploadJSON'/>
	<argument NAME="divNamePrefix" VALUE="contentDetailsUpload_"/>
</callelement>

</FTCS>