<?xml version="1.0" ?>
<!DOCTYPE FTCS SYSTEM "futuretense_cs.dtd">
<FTCS Version="1.1">
<!-- OpenMarket/Gator/FlexibleAssets/FlexGroups/ProductSetAttrs
--
-- INPUT
--
-- OUTPUT
--
-->

 <setvar NAME="tableheaderdone" VALUE="false"/>

<fgtm.gettemplatetype  ASSETTYPE="Variables.AssetType"  VARNAME="templatetype"/>

<!-- Load the  PGroup template asset  -->
	
	 <!--
	     1.  get the children associated with  this productgroup  (during edit)
			     using flexgroup(s).getimmediatechildren
			     Karl provides a tag to get the possible 
			 2.  for each child (product template)
			         get the attributes and display them (they should be editable)
			 3.  save the attributes associated with products
			 4.  The attribute names prefixed by  Productname will be the form variables.
			 5.  In Asset Gather,  set the values of the attributes to respective products
			     and save them.
	 -->
	

<setvar NAME="errno"  VALUE="0"/>
<atm.locate  TYPE="Variables.templatetype"   VARNAME="prdmgr"/>

<!-- locate the Product/content Group Manager -->
    
<atm.locate  TYPE="Variables.AssetType"   VARNAME="grpmgr"/>

<IF COND="Variables.id!=Variables.empty">
<THEN>

	<listobject.create  NAME="myList" COLUMNS="assetid"/>
	<listobject.addrow  NAME="myList" assetid="Variables.id"/> 
	<listobject.tolist  NAME="myList" LISTVARNAME="grouplist"/>
	
	<setvar NAME="errno"   VALUE="0"/>
	<flexgroups.getchildren  NAME="grpmgr"  ASSETS="grouplist" LISTVARNAME="prodlist"/>
	<setvar NAME="tableheaderdone"  VALUE="false"/>
	<if COND="Variables.errno=0">	  
	<then>
	  <if COND="IsList.prodlist=true">
		<then>
			<if COND="prodlist.#numRows!=0">
			 <then>
					
						<!--<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacerBar"/>-->
						<tr>
							<td valign="top"><span class="form-label-text"><XLAT.STREAM KEY="dvin/FlexibleAssets/FlexAssets/ProductsSet"/> :</span></td>
							<td></td>
							<td class="form-inset">
								<table border="0" cellpadding="0" cellspacing="0">
									<loop LIST="prodlist">
									<fatm.gettemplatetype  ASSETTYPE="prodlist.assettype"  VARNAME="templatetype"/>
									<!--  Narrow down the childtype to products only -->
									<ASSET.LOAD TYPE="prodlist.assettype" NAME="Prodinst"   FIELD="id"  VALUE="prodlist.assetid"/>
									<if COND="Variables.errno=0">
									<then>
										<ASSET.GET  FIELD="flextemplateid"  NAME="Prodinst"  OUTPUT="flextemplateid"/>
										<ASSET.GET  FIELD="name"  NAME="Prodinst"  OUTPUT="ProductName"/>
										<setvar NAME="ProductID"  VALUE="prodlist.assetid"/>
										<setvar NAME="myassettype"   VALUE="prodlist.assettype"/>
												 <callelement NAME="OpenMarket/Gator/FlexibleAssets/FlexGroups/AssocProdAttr"/>
										</then>
									</if>
								 </loop>
								</table>
						</td> 
					  </tr>
				</then>
			  </if>
		</then>
		</if>
	</then>
	</if>
</THEN>
</IF>
 
</FTCS> 
