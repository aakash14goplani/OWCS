<?xml version="1.0" ?>
<!DOCTYPE FTCS SYSTEM "futuretense_cs.dtd">
<FTCS Version="1.1">
<SETVAR NAME="cs.contenttype" VALUE="text/html; charset=UTF-8"/>

<!-- OpenMarket/Gator/UIFramework/LoadChildren
-
- INPUT
-
- OUTPUT
-
-->

<CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/BasicEnvironment"/>

<ASSET.LOAD NAME="ainst" TYPE="Variables.AssetType" OBJECTID="Variables.assetid"/>
<ASSET.CHILDREN NAME="ainst" LIST="children" ORDER="otype,ncode desc,nrank asc"/>
<IF COND="IsList.children=true">
<THEN>
	<IF COND="children.#numRows!=0">
	<THEN>
		<CALLELEMENT NAME="OpenMarket/Gator/UIFramework/GetDefaultNodeBehavior" />
		<LOOP LIST="children">
			<ASSET.LOAD NAME="currentChild" TYPE="children.otype" OBJECTID="children.oid"/>
			<ASSET.GET NAME="currentChild" FIELD="name" OUTPUT="currentName"/>
			<ASSET.GET NAME="currentChild" FIELD="description" OUTPUT="currentDesc"/>
			
			<ASSET.CHILDREN NAME="currentChild" LIST="grandchildren"/>
			
			<REMOVEVAR NAME="LoadURL"/>
			<IF COND="IsList.grandchildren=true">
			<THEN>
				<IF COND="grandchildren.#numRows!=0">
				<THEN>
					<SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Gator/UIFramework/LoadTab" outstring="LoadURL">
						<satellite.argument name="AssetType" value="children.otype"/>
						<satellite.argument name="populate" value="OpenMarket/Xcelerate/AssetType/Variables.AssetType/LoadSiteTree"/>
						<satellite.argument name="op" value="load"/>
						<satellite.argument name="assetid" value="children.oid"/>
					</SATELLITE.LINK>
				</THEN>
				</IF>
			</THEN>
			</IF>
			
			<SETVAR NAME="oldat" VALUE="Variables.AssetType"/>
			<CALLELEMENT NAME="OpenMarket/Gator/UIFramework/BuildTreeNodeID">
				<ARGUMENT NAME="ID" VALUE="children.oid"/>
				<ARGUMENT NAME="AssetType" VALUE="children.otype"/>
			</CALLELEMENT>
			<SETVAR NAME="AssetType" VALUE="Variables.oldat"/>
			<SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Gator/UIFramework/TreeOpURL" outstring="ExecuteURL">
				<satellite.argument name="AssetType" value="children.otype"/>
				<satellite.argument name="n0_" value="Variables.TreeNodeID"/>
				<satellite.argument name="op" value="displayNode"/>
			</SATELLITE.LINK>
			
			<SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Gator/UIFramework/TreeOpURL" outstring="OpURL">
				<satellite.argument name="AssetType" value="children.otype"/>
			</SATELLITE.LINK>
			<REMOVEVAR NAME="PreviewURL"/>
			<PREVIEWURL.MAKEURL VARNAME="PreviewURL" ASSETTYPE="children.otype" ASSETID="children.oid" PUBID="SessionVariables.pubid"/>
			
			<CALLELEMENT NAME="OpenMarket/Gator/UIFramework/BuildTreeNode">
				<ARGUMENT NAME="Label" VALUE="Variables.currentName"/>
				<ARGUMENT NAME="Description" VALUE="Variables.currentDesc"/>
				<ARGUMENT NAME="ID" VALUE="Variables.TreeNodeID"/>
				<!-- LoadURL implicitly passed in -->
				<ARGUMENT NAME="OpURL" VALUE="Variables.OpURL"/>
				<ARGUMENT NAME="ExecuteURL" VALUE="Variables.ExecuteURL"/>
				<ARGUMENT NAME="OKActions" VALUE="Status;Inspect;Edit;Preview;Delete;refresh"/>
				<ARGUMENT NAME="Image" VALUE="Variables.cs_imagedir/OMTree/TreeImages/AssetTypes/children.otype.png"/>
				<ARGUMENT NAME="RefreshKeys" VALUE="children.oid"/>
				<ARGUMENT NAME="okFunctions" VALUE="viewstatus;inspect;edit;preview;delete;treerefresh" />
				<ARGUMENT NAME="executeFunction" VALUE="Variables.cs_defaultFunctionChild" />
			</CALLELEMENT>
		</LOOP>
	</THEN>
	</IF>
</THEN>
</IF>
</FTCS>