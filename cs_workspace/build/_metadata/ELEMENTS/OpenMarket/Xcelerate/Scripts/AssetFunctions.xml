<?xml version="1.0" ?>
<!DOCTYPE FTCS SYSTEM "futuretense_cs.dtd">
<FTCS Version="1.1">
<!-- 
$Logfile: /VerticalApps/XcelerateC/install/Xcelerate/Populate/ElementCatalog/OpenMarket/Xcelerate/Scripts/AssetFunctions.xml $ 
$Revision: 14 $ 
$Modtime: 2/26/04 3:15p $ 
-->

<!--
- Confidential and Proprietary Information of FutureTense Inc.
-					All Rights Reserved.
-
- AssetFunctions.xml
-
- DESCRIPTION
-	JavaScript function handlers for functions used by the Asset Functions
-
- HISTORY 
  [2007-12-05 KG] (intended initially as a workaround for #16246)
  Added checkLock function for onclick locking of ActionBar links
-->

<script language="JavaScript">
<![CDATA[

function assetHandler(F, dict)
{
    var pURL = "";
    i = 0;
    while (i < dict.options.length) {
        if (dict.options[i].selected) {
            pURL = pURL + dict.options[i].value;
            break;
        }
        i++;
    }
    if (dict.options[i].value=='*') {
        return true;
    }
    if (dict.options[i].text=='Preview') {
    	showPreview(pURL);
    	return true;
    	}
    var docIdInput = dojo.query('input[name="docId"]')[0];
    if(docIdInput){
    	pURL = pURL + "&docId=" + docIdInput.value;
    }
    window.location = pURL;
    return true;
}

var locklink = false;
function checkLock(e)
{
    if (!e) e = window.event;
    var target = (e.target ? e.target : e.srcElement);
    if (locklink) //already clicked something, block click
        return false;
    //else, assume we're clicking a link now: block further clicks
    locklink = target;
    lockActions();
    //auto-unlock after 10s (in case the server doesn't respond at all)
    setTimeout('lockActions(true)', 10000);
    return true;
}
function lockActions(unlock)
{
    if (!locklink) return false;
    //for UI effects:
    var tbl = locklink.parentNode;
    while (tbl.tagName.toLowerCase() != 'table')
        tbl = tbl.parentNode;
    var links = tbl.getElementsByTagName('a');
    for (var i = 0; i < links.length; i++)
    {
        if (!links[i].onclick || links[i].onclick.toString().indexOf('checkLock') < 0)
            continue;
        links[i].firstChild.style['color'] = (unlock ? '' : '#999');
        links[i].firstChild.style['cursor'] = (unlock ? '' : 'wait');
    }
    if (unlock) locklink = false;
}
]]>

</script>

</FTCS>
