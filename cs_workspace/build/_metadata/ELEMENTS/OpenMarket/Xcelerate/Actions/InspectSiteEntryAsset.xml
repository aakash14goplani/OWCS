<?xml version="1.0" ?>
<!DOCTYPE FTCS SYSTEM "futuretense_cs.dtd">
<FTCS Version="1.1">
<!-- OpenMarket/Xcelerate/Actions/InspectSiteEntryAsset
-
- INPUT
- Variables.op : front, postPrivsFailedReason
- Variables.id :  when op=front
- Variables.SiteEntry:sarguments  : when op=post
-
- OUTPUT
-  renders this page  with arguments provided
-->
<SCRIPT LANGUAGE="JavaScript">

<![CDATA[
function checkfields()
{
	var obj = document.forms[0].elements[0];
	if (obj.form.elements['rootelement'].value=="")
	{
		]]>
		alert("<XLAT.STREAM KEY="dvin/Common/AT/NoPagename" ESCAPE="true" ENCODE="false"/>");
		<![CDATA[
		obj.form.elements['rootelement'].focus();
		return false;
	}
	if (obj.form.elements['SiteEntry:pagename'].value=="")
	{
		]]>
		alert("<XLAT.STREAM KEY="dvin/Common/AT/NoPagename" ESCAPE="true" ENCODE="false"/>");
		<![CDATA[
		obj.form.elements['SiteEntry:pagename'].focus();
		return false;
	}
	obj.form.submit();
	return false;
}
]]>
</SCRIPT>
<IF COND="Variables.op=front">
<THEN>
	<STRING.ENCODE VARIABLE="PostPage" VARNAME="PostPage"/> 
	<INPUT TYPE="hidden" NAME="pagename" VALUE="OpenMarket/Xcelerate/Actions/Variables.PostPage" REPLACEALL="Variables.PostPage"/>
	<ASSET.LOAD NAME="theCurrentAsset" TYPE="SiteEntry" OBJECTID="Variables.id"/>
	<IF COND="IsError.Variables.errno=true">
	<THEN>
        <XLAT.STREAM KEY="dvin/AT/Forms/ErrorLoadingSiteEntryAsset" errno="Variables.errno" EVALALL="false"/>
	    <THROWEXCEPTION/>
	</THEN>
	</IF>
	<ASSET.SCATTER NAME="theCurrentAsset" PREFIX="ContentDetails" EXCLUDE="true" FIELDLIST="Association-named,Association-unnamed,Publist"/>
	<IF COND="IsError.Variables.errorno=true">
	<THEN>
        <XLAT.STREAM KEY="dvin/AT/Forms/ErrorScatteringSiteEntryAsset" errno="Variables.errno" EVALALL="false"/>
	    <THROWEXCEPTION/>
	</THEN>
	</IF>
	<ASSET.LOAD NAME="theCSElement" TYPE="CSElement" OBJECTID="Variables.ContentDetails:cselement_id" EDITABLE="true"/>
	<IF COND="IsError.Variables.errno=true">
	<THEN>
        <XLAT.STREAM KEY="dvin/AT/Forms/ErrorLoadingSiteEntryAsset" errno="Variables.errno" EVALALL="false"/>
	    <THROWEXCEPTION/>
	</THEN>
	</IF>
	        
	<table class="width-outer-70" border="0" cellpadding="0" cellspacing="0">
	<tr>
	<td><span class="title-text"><XLAT.STREAM KEY="dvin/AT/Forms/InspectSiteEntryWithArguments"/></span><span class="title-value-text"></span></td>
	</tr>
	<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/TitleBar"/>
	<tr>
	<td>
	<table>
		<!-- Beginning of Group 1 -->
		<!--<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacerBar">
		<argument NAME="SpaceAbove" VALUE="No"/>
		</callelement>-->
		<tr>
			<td class="form-label-text"><XLAT.STREAM KEY="dvin/Common/Name"/>:</td>
			<td></td>
		    <td class="form-inset">
		    <STRING.STREAM VARIABLE="ContentDetails:name"/>                            
		    </td>
		</tr>

		<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
		<tr>
			<td valign="top" class="form-label-text"><XLAT.STREAM KEY="dvin/AT/Common/Description"/>:</td>
			<td></td>
			<td class="form-inset" valign="top">			
			    <STRING.STREAM  VARIABLE="ContentDetails:description"/>	
			</td>
		</tr>
		
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
			<tr>
				<td class="form-label-text"><XLAT.STREAM KEY="dvin/Common/AT/Rootelement"/>:</td>
				<td></td>
				<td class="form-inset">
					<STRING.STREAM VARIABLE="ContentDetails:rootelement"/>
				<STRING.ENCODE VARIABLE="ContentDetails:rootelement" VARNAME="ContentDetails:rootelementEnc"/>
            	<INPUT TYPE="hidden" NAME="rootelement" VALUE="Variables.ContentDetails:rootelementEnc" REPLACEALL="Variables.ContentDetails:rootelementEnc"/>  
				</td>
  			</tr>

			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
			<tr>
				<td class="form-label-text"><XLAT.STREAM KEY="dvin/Common/AT/Pagename"/>:</td>
				<td></td>
				<td class="form-inset">
				   <STRING.STREAM VARIABLE="ContentDetails:pagename"/>
				   <STRING.ENCODE VARIABLE="ContentDetails:pagename" VARNAME="ContentDetails:pagenameEnc"/>
				   <INPUT TYPE="hidden" NAME="SiteEntry:pagename" VALUE="Variables.ContentDetails:pagenameEnc" REPLACEALL="Variables.ContentDetails:pagenameEnc"/>  
				</td>
  			</tr>

			<!--<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacerBar"/>-->
			<!-- find all the PageCriteria -->
			<IF COND="Variables.ContentDetails:pagecriteria:Total!=0">
			<THEN>
				<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
				<!-- description of systemPageCriteria will come from SystemLocaleString -->
  				<STRINGLIST NAME="systemParameters" STR="rendermode,seid,site,c,cid,p" DELIM=","/>
 		    	<tr>
					<td CLASS="form-label-text"><XLAT.STREAM KEY="dvin/Common/AT/DefaultArgumentsforInspect"/>:</td>
					<td></td>
					<td class="form-inset">
						<table border="0" cellpadding="0" cellspacing="0">
							<SETCOUNTER NAME="nthCrit" VALUE="0"/>
							<LOOP COUNT="Variables.ContentDetails:pagecriteria:Total">
								<ICS.RESOLVEVARIABLES NAME="$(Variables.ContentDetails:pagecriteria:$(Counters.nthCrit))" DELIMITED="true" OUTPUT="parameter"/> 
								<STRING.ENCODE VARIABLE="parameter" VARNAME="parameter"/> 
								<!-- ft_ss is for intyernal use only and should not be included -->
								<IF COND="Variables.parameter!=ft_ss">
								<THEN>
									<tr>
									<td valign="top">
										<DIV class="form-label-inset" style="margin:0;">
										<STRING.STREAM VARIABLE="parameter"/>
										</DIV>
										<!-- argument description - if a systemPageCriteria look up the description in SystemLocaleString
										for user arguments, check the CSElement-->
										<ISINLIST ITEM="Variables.parameter" LIST="systemParameters"/>
										<if COND="Variables.errno=1">
										<then>
											<XLAT.LOOKUP KEY="dvin/AT/SiteEntry/systemparameterdescription-Variables.parameter" VARNAME="argDescription"/>
										</then>
										<else>
											<arguableinstance.GetArgumentDescription NAME="theCSElement" ARGUMENT="parameters.ITEM" VARNAME="argDescription"/>
										</else>
										</if>
										<if COND="Variables.argDescription!=Variables.empty">
										<then>
											<DIV class="small-text-inset">
											<STRING.STREAM VARIABLE="argDescription"/>
											</DIV>
										</then>
										</if>
									</td>
									<td><br/></td>
									<td valign="top">
										<arguableinstance.GetLegalValues NAME="theCSElement" ARGUMENT="parameters.ITEM" VARNAME="legalValues"/>
										<if COND="IsVariable.legalValues=true">
										<then>
											<STRINGLIST NAME="lvals" STR="Variables.legalValues" DELIM=","/>
											<SELECT NAME="parameters.ITEM" REPLACEALL="parameters.ITEM">
												<OPTION VALUE=""/>- <XLAT.STREAM KEY="dvin/AT/SiteEntry/nooverride"/> -
												<LOOP LIST="lvals">
													<arguableinstance.GetValueDescription NAME="theCSElement" ARGUMENT="parameters.ITEM" VALUE="lvals.ITEM" VARNAME="valDescription"/>
													<if COND="Variables.valDescription=Variables.empty">
													<then>
														<OPTION VALUE="lvals.ITEM" REPLACEALL="lvals.ITEM"/><STRING.STREAM VALUE="lvals.ITEM"/>
													</then>
													<else>													
														<OPTION VALUE="lvals.ITEM" REPLACEALL="lvals.ITEM"/><STRING.STREAM VARIABLE="valDescription"/>
													</else>
													</if>
												</LOOP>
											</SELECT>
										</then>
										<else>
											<!-- see if there is a setting in the default arguments -->
											<SETVAR NAME="argvalue" VALUE="Variables.empty"/>
											<IF COND="Variables.ContentDetails:defaultarguments:Total!=0">
											<THEN>
												<SETCOUNTER NAME="nthArg" VALUE="0"/>
												<LOOP COUNT="Variables.ContentDetails:defaultarguments:Total">
													<ICS.RESOLVEVARIABLES NAME="$(Variables.ContentDetails:defaultarguments:$(Counters.nthArg):name)" DELIMITED="true" OUTPUT="argname"/>
													<IF COND="Variables.argname=Variables.parameter">
													<THEN>
														<ICS.RESOLVEVARIABLES NAME="$(Variables.ContentDetails:defaultarguments:$(Counters.nthArg):value)" DELIMITED="true" OUTPUT="argvalue"/>
													</THEN>
													</IF>
													<INCCOUNTER NAME="nthArg" VALUE="1"/>
												</LOOP>
											</THEN>
											</IF>	
											<STRING.ENCODE VARIABLE="argvalue" VARNAME="argvalue"/> 
											<INPUT class="form-inset" TYPE="text" NAME="Variables.parameter" VALUE="Variables.argvalue" REPLACEALL="Variables.parameter,Variables.argvalue"/>
										</else>
										</if>
									</td>
									</tr>
									<input type="hidden" name="criteria" value="Variables.parameter" REPLACEALL="Variables.parameter"/>
								</THEN>
								</IF>
								<INCCOUNTER NAME="nthCrit" VALUE="1"/>
							</LOOP>
						</table>
					</td>
				</tr>
			</THEN>
			</IF>
				
 			<!--<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacerBar"/>-->
 			<tr><td>
 			<XLAT.LOOKUP KEY="dvin/Common/Preview" ESCAPE="true" VARNAME="_XLAT_"/>
			<XLAT.LOOKUP KEY="dvin/Common/Preview" VARNAME="_ALT_"/>
			<A HREF="javascript:void(0)" onclick="return checkfields();" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true" REPLACEALL="Variables.ContentDetails:rootelement,Variables._XLAT_"><CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/Preview_"/></CALLELEMENT></A>
  			</td><td></td>
  			</tr>
	  			
		</table>
	<!-- End of body -->
	</td>
	</tr>
	
	<CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/FooterBar"/>
	<tr>
	<STRING.ENCODE VARIABLE="cs_imagedir" VARNAME="cs_imagedir"/> 
	<td><img height="10" width="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>
	</tr>
	</table>
</THEN>
</IF>


<IF COND="Variables.op=post">
<THEN>
    <SETVAR NAME="packedArgs" VALUE="Variables.empty"/>
    <IF COND="IsVariable.criteria=true">
    <THEN>
		<STRINGLIST NAME="parameters" STR="Variables.criteria" DELIM=";"/>
      <LOOP LIST="parameters">
      	<setvar NAME="varname" VALUE="parameters.ITEM"/>
      	<if COND="IsVariable.Variables.varname=true">
      	<then>
	        <!-- pass the variables to the render.satellitepage -->
				<IF COND="Variables.packedArgs=Variables.empty">
				<THEN>
					<SETVAR NAME="packedArgs" VALUE="parameters.ITEM=Variables.parameters.ITEM"/>
				</THEN>
				<ELSE>
	        		<SETVAR NAME="packedArgs" VALUE="Variables.packedArgs&#38;parameters.ITEM=Variables.parameters.ITEM"/>       	
				</ELSE>
				</IF>
			</then>
			</if>
      </LOOP>
   </THEN>
   </IF>
  
    <IF COND="IsVariable.SiteEntry:pagename!=Variables.empty">
    <THEN>
         <RENDER.SATELLITEPAGE  PAGENAME="Variables.SiteEntry:pagename"   PACKEDARGS="Variables.packedArgs"/>     
    </THEN>
    <ELSE>
        <XLAT.STREAM KEY="dvin/Common/AT/NoPagename"/>
        <THROWEXCEPTION/>
    </ELSE>
    </IF>
</THEN>
</IF>
	
	
	
</FTCS> 
