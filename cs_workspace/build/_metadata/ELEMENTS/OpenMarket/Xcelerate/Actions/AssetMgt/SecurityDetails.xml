<?xml version="1.0" ?>
<!DOCTYPE ftcs SYSTEM "futuretense_cs.dtd">
<ftcs version="1.2">
<!-- OpenMarket/Xcelerate/Actions/AssetMgt/SecurityDetails
-
- INPUT
-		Variables.workflowobject - workflowobject
- 		Variables.functionlist - comma seprated list of function to display, 
-							if the variable is missing or empty, we will display all functions
-		Variables.canedit	- if true, user can edit privileges, otherwise can only view them
-		Variables.ViewBy	- optional, role or function, default is function 
- OUTPUT
-
-->
<STRING.ENCODE VARIABLE="cs_imagedir" VARNAME="cs_imagedir"/>
<STRING.ENCODE VARIABLE="ThisPage" VARNAME="ThisPage"/>
<SCRIPT LANGUAGE="JavaScript" DEFER="DEFER">
<![CDATA[
function showPrivilegesByRole() 
{ 
 	obj = document.forms[0].elements[0];
	var roles = obj.form.elements['roles'];
 	var inherited = obj.form.elements['inherited'];
 	iblankrow = new Option( inherited.options[inherited.length-1].text, -1 );
 	inherited.options.length = 0;
 	inherited.options[0] = iblankrow;

	var granted = obj.form.elements['granted'];
  	gblankrow = new Option( granted.options[granted.length-1].text, -1 );
 	granted.options.length = 0;
 	granted.options[0] = gblankrow;

	var denied = obj.form.elements['denied'];
  	dblankrow = new Option( denied.options[denied.length-1].text, -1 );
 	denied.options.length = 0;
 	denied.options[0] = dblankrow;

	var rolename = roles.options[roles.selectedIndex].value;
 	var fname = "privrole-" + rolename;
 	var functionids = obj.form.elements[fname].value;
 	var a = functionids.split(',');
 	var g = 0;
 	var d = 0; 
 	var h = 0; 
 	for ( var i = 0 ; i < a.length ; i++ ) {
 		var privfield = rolename + "-" + a[i];
 		if (obj.form.elements[privfield] != null ) {
			var text = obj.form.elements['functionid-'+a[i]].value;
			if (obj.form.elements[privfield].value=="true") {
				granted.options[granted.length] = new Option( granted.options[granted.length-1].text, -1 );
				granted.options[g] = new Option( text, a[i] );
				g++;
			}
			else if (obj.form.elements[privfield].value=="false") {
				denied.options[denied.length] = new Option( denied.options[denied.length-1].text, -1 );
				denied.options[d] = new Option( text, a[i] );
				d++;
			}
			else {
				inherited.options[inherited.length] = new Option( inherited.options[inherited.length-1].text, -1 );
				inherited.options[h] = new Option( text, a[i] );
				h++;
			}
	   }
	}
}				 		
function showPrivilegesByFunction() 
{ 
 	obj = document.forms[0].elements[0];
	var functions = obj.form.elements['functions'];
 	var inherited = obj.form.elements['inherited'];
 	iblankrow = new Option( inherited.options[inherited.length-1].text, -1 );
 	inherited.options.length = 0;
 	inherited.options[0] = iblankrow;

	var granted = obj.form.elements['granted'];
  	gblankrow = new Option( granted.options[granted.length-1].text, -1 );
 	granted.options.length = 0;
 	granted.options[0] = gblankrow;

	var denied = obj.form.elements['denied'];
  	dblankrow = new Option( denied.options[denied.length-1].text, -1 );
 	denied.options.length = 0;
 	denied.options[0] = dblankrow;

	var functionid = functions.options[functions.selectedIndex].value;
	var fname = "privfunction-"+functions.options[functions.selectedIndex].value
	var roles = obj.form.elements[fname].value;
	var a = roles.split(',');
 	var g = 0;
 	var d = 0; 
  	var h = 0; 
	for ( var i = 0 ; i < a.length ; i++ ) {
  		var privfield = a[i] + "-" + functionid;
 		if (obj.form.elements[privfield] != null ) {
			if (obj.form.elements[privfield].value=="true") {
				granted.options[granted.length] = new Option( granted.options[granted.length-1].text, -1 );
				granted.options[g] = new Option( a[i], a[i] );
				g++;
			}
			else if (obj.form.elements[privfield].value=="false") {
				denied.options[denied.length] = new Option( denied.options[denied.length-1].text, -1 );
				denied.options[d] = new Option( a[i], a[i] );
				d++;
			}
			else {
				inherited.options[inherited.length] = new Option( inherited.options[inherited.length-1].text, -1 );
				inherited.options[h] = new Option( a[i], a[i] );
				h++;
			}
		}
	}
 	
}

function grantdenyPrivilegeOnFunction(formfield) 
{ 
 	obj = document.forms[0].elements[0];
	var functions = obj.form.elements['functions'];
	if ( functions.selectedIndex == -1 ) {
		]]>
		alert("<XLAT.STREAM KEY="dvin/UI/AssetMgt/SelectAFunction" ESCAPE="true" ENCODE="false"/>");
		<![CDATA[
		return;
	}
	var inherited = obj.form.elements['inherited'];
	if ( inherited.selectedIndex == -1 ) {
		]]>
		alert("<XLAT.STREAM KEY="dvin/UI/AssetMgt/SelectOneOrMoreRole" ESCAPE="true" ENCODE="false"/>");
		<![CDATA[
		return;
	}
	var functionid = functions.options[functions.selectedIndex].value;
	for ( var i=0 ; i < inherited.options.length ; i++ ) {
		if ( inherited.options[i].selected && inherited.options[i].value!=-1) {
			var o = inherited.options[i];
			var tofield = obj.form.elements[formfield];
			var oldtolength = tofield.options.length;
 			tofield.options[tofield.length] = new Option( tofield.options[tofield.length-1].text, -1 );
			tofield.options[oldtolength-1] = new Option( o.text,o.value);
			var privfield = o.value + "-" + functionid;
			if ( formfield=='granted')
				obj.form.elements[privfield].value='true';
			else
				obj.form.elements[privfield].value='false';
		}
	}
	while ( i>0 ) {
		i--;
		if ( inherited.options[i].selected && inherited.options[i].value!=-1) {
			inherited.options[i]=null;
		}
	}
	return;
}

function grantdenyPrivilegeOnRole(formfield) 
{ 
 	obj = document.forms[0].elements[0];
	var roles = obj.form.elements['roles'];
	if ( roles.selectedIndex == -1 )
	{
		]]>
		alert("<XLAT.STREAM KEY="dvin/UI/AssetMgt/SelectARole" ESCAPE="true" ENCODE="false"/>");
		<![CDATA[
		return;
	} 
	var inherited = obj.form.elements['inherited'];
	if ( inherited.selectedIndex == -1 ) {
		]]>
		alert("<XLAT.STREAM KEY="dvin/UI/AssetMgt/SelectOneOrMoreFunctions" ESCAPE="true" ENCODE="false"/>");
		<![CDATA[
		return;
	}
	var role = roles.options[roles.selectedIndex].value;
	for ( var i=0 ; i < inherited.options.length ; i++ ) {
		if ( inherited.options[i].selected && inherited.options[i].value!=-1) {
			var o = inherited.options[i];
			var tofield = obj.form.elements[formfield];
			var oldtolength = tofield.options.length;
 			tofield.options[tofield.length] = new Option( tofield.options[tofield.length-1].text, -1 );
			tofield.options[oldtolength-1] = new Option( o.text,o.value);
			var privfield = role + "-" + o.value;
			if ( formfield=='granted')
				obj.form.elements[privfield].value='true';
			else
				obj.form.elements[privfield].value='false';
		}
	}
	while ( i>0 ) {
		i--;
		if ( inherited.options[i].selected && inherited.options[i].value!=-1) {
			inherited.options[i]=null;
		}
	}
	return;
}


function removeOnRole(formfield) 
{ 
 	obj = document.forms[0].elements[0];
	var roles = obj.form.elements['roles'];
	var privs = obj.form.elements[formfield];
	if (roles.selectedIndex == -1 || privs.selectedIndex == -1 || privs.options[privs.selectedIndex].value == '-1') {
		]]>
		alert("<XLAT.STREAM KEY="dvin/UI/AssetMgt/NoItemsToRemove" ESCAPE="true" ENCODE="false"/>");
		<![CDATA[
	} else {
		var role = roles.options[roles.selectedIndex].value;
		var inherited = obj.form.elements['inherited'];
		for ( var i  = 0 ; i < privs.options.length ; i++ ) {
			if ( privs.options[i].selected && privs.options[i].value!=-1 ) {
			  var oldlength = inherited.length;
 			  inherited.options[inherited.length] = new Option( inherited.options[inherited.length-1].text, -1 );
           var o=privs.options[i]
			  inherited.options[oldlength-1] = new Option( o.text, o.value, false, true );
				var privfield = role + "-" + o.value;
				obj.form.elements[privfield].value='notset';
			}
		}
		for ( var i  = privs.options.length-1 ; i >=0 ; i-- ) {
			if ( privs.options[i].selected && privs.options[i].value!=-1) {
				privs.options[i]=null;
			}
		}
	}
}

function removeOnFunction(formfield) 
{ 
 	obj = document.forms[0].elements[0];
	var functions = obj.form.elements['functions'];
	var privs = obj.form.elements[formfield];
	if (functions.selectedIndex == -1 || privs.selectedIndex == -1 || privs.options[privs.selectedIndex].value == '-1') {
		]]>
		alert("<XLAT.STREAM KEY="dvin/UI/AssetMgt/NoItemsToRemove" ESCAPE="true" ENCODE="false"/>");
		<![CDATA[
	} else {
		var functionid = functions.options[functions.selectedIndex].value;
		var inherited = obj.form.elements['inherited'];
		for ( var i  = 0 ; i < privs.options.length ; i++ ) {
			if ( privs.options[i].selected && privs.options[i].value!=-1 ) {
			  var oldlength = inherited.length;
 			  inherited.options[inherited.length] = new Option( inherited.options[inherited.length-1].text, -1 );
           var o=privs.options[i]
			  inherited.options[oldlength-1] = new Option( o.text, o.value, false, true );
				var privfield = o.value + "-" + functionid;
				obj.form.elements[privfield].value='notset';
			}
		}
		for ( var i  = privs.options.length-1 ; i >=0 ; i-- ) {
			if ( privs.options[i].selected && privs.options[i].value!=-1) {
				privs.options[i]=null;
			}
		}
	}
}

function repost(thispage,viewby)
{
	var obj = document.forms[0].elements[0];
	obj.form.elements['ViewBy'].value = viewby;
	obj.form.pagename.value = "OpenMarket/Xcelerate/Actions/" + thispage;
	obj.form.submit();
	return false;
}

]]>
</SCRIPT>

<!-- get the workflow privs for this object -->
<SETVAR NAME="hasPrivs" VALUE="true"/>
<WORKFLOWENGINE.GETOBJECTPRIVS OBJECT="Variables.workflowobject" OBJVARNAME="wfprivs"/>
<IF COND="IsError.Variables.errno=true">
<THEN>
	<SETVAR NAME="hasPrivs" VALUE="false"/>
</THEN>
</IF>

<!-- Get all the roles -->
<ROLEMANAGER.GETALLROLES PREFIX="role:"/>

<!-- if no functionlist supplied, set a flag saying to include all functions -->
<SETVAR NAME="allfunctions" VALUE="false"/>
<IF COND="IsVariable.functionlist=false">
<THEN>
	<SETVAR NAME="allfunctions" VALUE="true"/>
</THEN>
<ELSE>
	<IF COND="Variables.functionlist=Variables.empty">
	<THEN>
		<SETVAR NAME="allfunctions" VALUE="true"/>
	</THEN>
	</IF>
</ELSE>
</IF>

<!-- get all the functions, and create a list of only those we care about -->
<SETVAR NAME="funcobjnames" VALUE="Variables.empty"/>
<WORKFLOWENGINE.GETALLFUNCTIONS PREFIX="functions:"/>
<SETCOUNTER NAME="nthFunction" VALUE="0"/>
<LOOP COUNT="Variables.functions:Total">
	<WORKFLOWFUNCTION.GETNAME NAME="functions:Counters.nthFunction" VARNAME="functions:name"/>
	<XLAT.LOOKUP KEY="dvin/UI/Security/CCFunction/Variables.functions:name" VARNAME="functions:description" />
	<WORKFLOWFUNCTION.GETID NAME="functions:Counters.nthFunction" VARNAME="functions:id"/>
	<STRING.ENCODE VARIABLE="functions:description" VARNAME="functions:descriptionEnc"/>
	<input type="hidden" NAME="functionid-Variables.functions:id" VALUE="Variables.functions:descriptionEnc" REPLACEALL="Variables.functions:id,Variables.functions:descriptionEnc"/>
	
	<!-- include this function in the UI? -->
	<SETVAR NAME="include" VALUE="false"/>
	<IF COND="Variables.allfunctions=true">
	<THEN>
		<SETVAR NAME="include" VALUE="true"/>
	</THEN>
	<ELSE>
		<ISINLIST ITEM="Variables.functions:name" STR="Variables.functionlist"/>
		<IF COND="Variables.errno=1">
		<THEN>
			<SETVAR NAME="include" VALUE="true"/>
		</THEN>
		</IF>
	</ELSE>
	</IF>
		
	<IF COND="Variables.include=true">
	<THEN>
		<IF COND="Variables.funcobjnames=Variables.empty">
		<THEN>
			<SETVAR NAME="funcobjnames" VALUE="functions:Counters.nthFunction"/>
		</THEN>
		<ELSE>
			<SETVAR NAME="funcobjnames" VALUE="Variables.funcobjnames,functions:Counters.nthFunction"/>
		</ELSE>
		</IF>
		<SETVAR NAME="proles-Variables.functions:id" VALUE="Variables.empty"/>
	</THEN>
	</IF>
	<INCCOUNTER NAME="nthFunction" VALUE="1"/>
</LOOP>
<STRINGLIST NAME="funcobjlist" STR="Variables.funcobjnames" DELIM=","/>

<!-- get the privileges for each function/role -->
<IF COND="Variables.role:Total!=0">
<THEN>
	<SETCOUNTER NAME="nthRole" VALUE="0"/>
	<LOOP COUNT="Variables.role:Total">
		<ROLE.GETNAME NAME="role:Counters.nthRole" VARNAME="role:name"/>
		<SETVAR NAME="privfuncs" VALUE="Variables.empty"/>
		<LOOP LIST="funcobjlist">
			<WORKFLOWFUNCTION.GETID NAME="funcobjlist.ITEM" VARNAME="functions:id"/>
			<WORKFLOWFUNCTION.GETNAME NAME="funcobjlist.ITEM" VARNAME="funcName"/>
            <XLAT.LOOKUP KEY="dvin/UI/Security/CCFunction/Variables.funcName" VARNAME="functions:description" />
			<!-- if this is a repost - use those variables, if they exist -->
			<ICS.RESOLVEVARIABLES NAME="$(Variables.$(Variables.role:name)-$(Variables.functions:id))" DELIMITED="true" OUTPUT="privallowed"/>
			<IF COND="Variables.errno=-106">
			<THEN>

				<SETVAR NAME="privallowed" VALUE="Variables.empty"/>
				<IF COND="Variables.hasPrivs=true">
				<THEN>
					<WORKFLOWPRIVS.GETPRIV NAME="wfprivs" ROLE="Variables.role:name" FUNCTIONID="Variables.functions:id" OBJVARNAME="priv"/>
					<IF COND="IsError.Variables.errno=false">
					<THEN>
						<WORKFLOWPRIV.GETALLOWED NAME="priv" VARNAME="privallowed"/>
					</THEN>
					</IF>
				</THEN>
				</IF>
			</THEN>
			</IF>
			<STRING.ENCODE VARIABLE="privallowed" VARNAME="privallowed"/>
			<IF COND="Variables.privfuncs=Variables.empty">
			<THEN>
				<SETVAR NAME="privfuncs" VALUE="Variables.functions:id"/>
			</THEN>
			<ELSE>
				<SETVAR NAME="privfuncs" VALUE="Variables.privfuncs,Variables.functions:id"/>
			</ELSE>
			</IF>
			<ICS.RESOLVEVARIABLES NAME="$(Variables.proles-$(Variables.functions:id))" DELIMITED="true" OUTPUT="p1roles"/>
			<IF COND="Variables.p1roles=Variables.empty">
			<THEN>
				<SETVAR NAME="proles-Variables.functions:id" VALUE="Variables.role:name"/>
			</THEN>
			<ELSE>
				<SETVAR NAME="proles-Variables.functions:id" VALUE="Variables.p1roles,Variables.role:name"/>
			</ELSE>
			</IF>			
			<input type="hidden" name="Variables.role:name-Variables.functions:id" value="Variables.privallowed" REPLACEALL="Variables.functions:id,Variables.role:name,Variables.privallowed"/>
		</LOOP>
		<STRING.ENCODE VARIABLE="privfuncs" VARNAME="privfuncsEnc"/>
		<input TYPE="hidden" NAME="privrole-Variables.role:name" VALUE="Variables.privfuncsEnc" REPLACEALL="Variables.role:name,Variables.privfuncsEnc"/>
		<INCCOUNTER NAME="nthRole" VALUE="1"/>
	</LOOP>
</THEN>
</IF>

			
<LOOP LIST="funcobjlist">
	<WORKFLOWFUNCTION.GETID NAME="funcobjlist.ITEM" VARNAME="functions:id"/>
	<ICS.RESOLVEVARIABLES NAME="$(Variables.proles-$(Variables.functions:id))" DELIMITED="true" OUTPUT="p1roles"/>
	<STRING.ENCODE VARIABLE="p1roles" VARNAME="p1rolesEnc"/>
	<input TYPE="hidden" NAME="privfunction-Variables.functions:id" VALUE="Variables.p1rolesEnc" REPLACEALL="Variables.functions:id,Variables.p1rolesEnc" />
</LOOP>

<IF COND="Variables.ViewBy=role">
<THEN>
	<table border="0" cellpadding="0" cellspacing="0">
	<tr>
		<td>
			<input type="radio" style="margin-left:0px" name="view" value="role" checked="true" onclick="repost('Variables.ThisPage','role');" REPLACEALL="Variables.ThisPage"/><XLAT.STREAM KEY="dvin/UI/AssetMgt/ViewByRole"/>
		</td>
      
	</tr>
	<tr>
 		<td>
			<input type="radio" style="margin-left:0px" name="view" value="function" onclick="repost('Variables.ThisPage','function');" REPLACEALL="Variables.ThisPage"/><XLAT.STREAM KEY="dvin/UI/AssetMgt/ViewByFunction"/>
		</td>
	</tr>
	<CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
	<CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
	</table>
	<table border="0" cellpadding="0" cellspacing="0">
	
	
	<tr>
    
	  <td><fieldset style=" height: 264px;border: 1px solid #E6E6E6;"><legend align="center"><span style="font-weight:bold;"><XLAT.STREAM KEY="dvin/Common/Roles"/></span></legend><table><tr><td width="40%" class="form-label-text"  style="text-align:center;"><BR/></td></tr><tr><td style="text-align:center;">
		<SELECT style="width: 100px" NAME="roles" SIZE="10" onChange="return showPrivilegesByRole()">
			<SETCOUNTER NAME="nthRole" VALUE="0"/>
			<LOOP COUNT="Variables.role:Total">
				<ROLE.GETNAME NAME="role:Counters.nthRole" VARNAME="role:name"/>
				<OPTION VALUE="Variables.role:name" REPLACEALL="Variables.role:name"><STRING.STREAM VARIABLE="role:name"/></OPTION>
				<INCCOUNTER NAME="nthRole" VALUE="1"/>
			</LOOP>
		</SELECT>
		</td></tr></table></fieldset>
	</td>
	
	
	  <td>
	  <fieldset style=" height: 264px;border: 1px solid #E6E6E6;"><legend align="center"><span style="font-weight:bold;"><XLAT.STREAM KEY="dvin/Common/Functions"/></span></legend><table><tr><td></td><td width="40%" class="form-label-text"  style="text-align:center;">
			<XLAT.STREAM KEY="dvin/UI/AssetMgt/Inherited"/>
		</td><td></td><td class="form-label-text"  style="text-align:center;">
			<XLAT.STREAM KEY="dvin/UI/AssetMgt/Granted"/>
		</td><td></td><td class="form-label-text"  style="text-align:center;">
			<XLAT.STREAM KEY="dvin/UI/AssetMgt/Denied"/>
		</td><td></td></tr><tr>
	  <td><img height="1" width="5" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>
	<td valign="top" style="text-align:center;">
			<SELECT style="width: 100px" NAME="inherited" SIZE="10" MULTIPLE="yes">
				<OPTION VALUE="-1"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			</SELECT><br/>
		</td>
	 <td style="text-align:center;"><IF COND="Variables.canedit=true">

			<THEN>	
			<table><tr><td>
        <XLAT.LOOKUP KEY="dvin/UI/AssetMgt/Grantprivilege" VARNAME="_XLAT_"/>
        <XLAT.LOOKUP KEY="dvin/UI/AssetMgt/Grantprivilege" VARNAME="mouseover" ESCAPE="true"/>
        <A HREF="javascript:grantdenyPrivilegeOnRole('granted')" onmouseover="window.status='Variables.mouseover';return true;" onmouseout="window.status='';return true" REPLACEALL="Variables.mouseover">
          <CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/Grant"/></CALLELEMENT>
        </A>
        </td></tr><tr><td>
        <XLAT.LOOKUP KEY="dvin/UI/AssetMgt/Denyprivilege" VARNAME="_XLAT_"/>
        <XLAT.LOOKUP KEY="dvin/UI/AssetMgt/Denyprivilege" VARNAME="mouseover" ESCAPE="true"/>
        <A HREF="javascript:grantdenyPrivilegeOnRole('denied')" onmouseover="window.status='Variables.mouseover';return true;" onmouseout="window.status='';return true" REPLACEALL="Variables.mouseover">
         <CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/Deny"/></CALLELEMENT>
        </A>
         </td></tr><tr style="height:40px;"><td colspan="2"></td></tr></table>
			</THEN>
			</IF>
		</td>
      
		<td valign="top" style="text-align:center;">
			<SELECT style="width: 100px" NAME="granted" SIZE="10" MULTIPLE="yes">
				<OPTION VALUE="-1"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			</SELECT><br/>
			<IF COND="Variables.canedit=true">
			<THEN>	
				<XLAT.LOOKUP KEY="dvin/UI/AssetMgt/RemoveGrantPrivilege" VARNAME="_XLAT_"/>
				<XLAT.LOOKUP KEY="dvin/UI/AssetMgt/RemoveGrantPrivilege" VARNAME="mouseover" ESCAPE="true"/>
				<A style="margin-top: 10px;" HREF="javascript:removeOnRole('granted' )" onmouseover="window.status='Variables.mouseover';return true;" onmouseout="window.status='';return true" REPLACEALL="Variables.mouseover">
					<CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/Remove"/></CALLELEMENT>
				</A>
			</THEN>
			</IF>
		</td>
      <td><img height="1" width="5" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>
      <td valign="top" style="text-align:center;">
			<SELECT style="width: 100px" NAME="denied" SIZE="10" MULTIPLE="yes">
				<OPTION VALUE="-1"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			</SELECT><br/>
			<IF COND="Variables.canedit=true">
			<THEN>	
				<XLAT.LOOKUP KEY="dvin/UI/AssetMgt/RemoveDenyPrivilege" VARNAME="_XLAT_"/>
				<XLAT.LOOKUP KEY="dvin/UI/AssetMgt/RemoveDenyPrivilege" VARNAME="mouseover" ESCAPE="true"/>
				<A style="margin-top: 10px;" HREF="javascript:removeOnRole('denied' )" onmouseover="window.status='Variables.mouseover';return true;" onmouseout="window.status='';return true" REPLACEALL="Variables.mouseover">
					<CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/Remove"/></CALLELEMENT>
				</A>
			</THEN>
			</IF>
		</td>		
 <td><img height="1" width="5" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>
	
		</tr>
		</table></fieldset></td>	</tr>
	</table>
</THEN>
<ELSE>
	<table border="0" cellpadding="0" cellspacing="0">
		<tr>
				<td>
			<input type="radio" style="margin-left:0px" name="view" value="role"onclick="repost('Variables.ThisPage','role');" REPLACEALL="Variables.ThisPage"/><XLAT.STREAM KEY="dvin/UI/AssetMgt/ViewByRole"/>
		</td>
	</tr>		
	
	<tr>
			<td>
			<input type="radio" style="margin-left:0px" name="view" value="function"  checked="true" onclick="repost('Variables.ThisPage','function');" REPLACEALL="Variables.ThisPage"/><XLAT.STREAM KEY="dvin/UI/AssetMgt/ViewByFunction"/>
		</td>
	</tr>
	<CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
	<CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
	</table>
	<table border="0" cellpadding="0" cellspacing="0">
	<tr>
	  <td><fieldset style=" height: 264px;border: 1px solid #E6E6E6;"><legend align="center"><span style="font-weight:bold;"><XLAT.STREAM KEY="dvin/Common/Functions"/></span></legend><table><tr><td width="40%" class="form-label-text"  style="text-align:center;"><BR/></td></tr><tr><td style="text-align:center;">
		<SELECT style="width: 100px" NAME="functions" SIZE="10" onChange="return showPrivilegesByFunction()">
			<LOOP LIST="funcobjlist">
				<WORKFLOWFUNCTION.GETID NAME="funcobjlist.ITEM" VARNAME="functions:id"/>
				<WORKFLOWFUNCTION.GETNAME NAME="funcobjlist.ITEM" VARNAME="funcName"/>
                <XLAT.LOOKUP KEY="dvin/UI/Security/CCFunction/Variables.funcName" VARNAME="functions:description" />
				<STRING.ENCODE VARIABLE="functions:description" VARNAME="functionsdescription"/>
				<STRING.ENCODE VARIABLE="functions:id" VARNAME="functions:id"/>
				<OPTION title="Variables.functionsdescription" VALUE="Variables.functions:id" REPLACEALL="Variables.functions:id,Variables.functionsdescription"><STRING.STREAM VARIABLE="functions:description"/></OPTION>
			</LOOP>
		</SELECT>
		</td></tr></table></fieldset></td>
      
	  <td>
	  <fieldset style=" height: 264px;border: 1px solid #E6E6E6;"><legend align="center"><span style="font-weight:bold;"><XLAT.STREAM KEY="dvin/Common/Roles"/></span></legend><table><tr><td></td><td width="40%" class="form-label-text"  style="text-align:center;">
			<XLAT.STREAM KEY="dvin/UI/AssetMgt/Inherited"/>
		</td><td></td><td class="form-label-text"  style="text-align:center;">
			<XLAT.STREAM KEY="dvin/UI/AssetMgt/Granted"/>
		</td><td></td><td class="form-label-text"  style="text-align:center;">
			<XLAT.STREAM KEY="dvin/UI/AssetMgt/Denied"/>
		</td><td></td></tr><tr>
	  <td><img height="1" width="5" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>
		<td valign="top" style="text-align:center;">
			<SELECT style="width: 100px" NAME="inherited" SIZE="10" MULTIPLE="yes">
				<OPTION VALUE="-1"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			</SELECT><br/>
		</td>
     <td style="text-align:center;"><IF COND="Variables.canedit=true">
			<THEN>	
			<table><tr><td style="text-align:center;">
        <XLAT.LOOKUP KEY="dvin/UI/AssetMgt/Grantprivilege" VARNAME="_XLAT_"/>
        <XLAT.LOOKUP KEY="dvin/UI/AssetMgt/Grantprivilege" VARNAME="mouseover" ESCAPE="true"/>
        <A HREF="javascript:grantdenyPrivilegeOnFunction('granted')" onmouseover="window.status='Variables.mouseover';return true;" onmouseout="window.status='';return true" REPLACEALL="Variables.mouseover">
					<CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/Grant"/></CALLELEMENT>
				</A>
                 </td></tr><tr><td style="text-align:center;">
                <XLAT.LOOKUP KEY="dvin/UI/AssetMgt/Denyprivilege" VARNAME="_XLAT_"/>
				<XLAT.LOOKUP KEY="dvin/UI/AssetMgt/Denyprivilege" VARNAME="mouseover" ESCAPE="true"/>
                <A HREF="javascript:grantdenyPrivilegeOnFunction('denied')" onmouseover="window.status='Variables.mouseover';return true;" onmouseout="window.status='';return true" REPLACEALL="Variables.mouseover">
					<CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/Deny"/></CALLELEMENT>
				</A>
				</td></tr><tr style="height:40px;"><td colspan="2"></td></tr></table>
			</THEN>
			</IF></td>
		<td valign="top" style="text-align:center;">
			<SELECT style="width: 100px" NAME="granted" SIZE="10" MULTIPLE="yes">
				<OPTION VALUE="-1"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			</SELECT><br/>
			<IF COND="Variables.canedit=true">
			<THEN>	
				<XLAT.LOOKUP KEY="dvin/UI/AssetMgt/RemoveGrantPrivilege" VARNAME="_XLAT_"/>
				<XLAT.LOOKUP KEY="dvin/UI/AssetMgt/RemoveGrantPrivilege" VARNAME="mouseover" ESCAPE="true"/>
				<A style="margin-top: 10px;" HREF="javascript:removeOnFunction('granted' )" onmouseover="window.status='Variables.mouseover';return true;" onmouseout="window.status='';return true" REPLACEALL="Variables.mouseover">
					<CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/Remove"/></CALLELEMENT>
				</A>
			</THEN>
			</IF>
		</td>
		      <td><img height="1" width="5" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>
      <td valign="top" style="text-align:center;">
			<SELECT style="width: 100px" NAME="denied" SIZE="10" MULTIPLE="yes">
				<OPTION VALUE="-1"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			</SELECT><br/>
			<IF COND="Variables.canedit=true">
			<THEN>	
				<XLAT.LOOKUP KEY="dvin/UI/AssetMgt/RemoveDenyPrivilege" VARNAME="_XLAT_"/>
				<XLAT.LOOKUP KEY="dvin/UI/AssetMgt/RemoveDenyPrivilege" VARNAME="mouseover" ESCAPE="true"/>
				<A style="margin-top: 10px;" HREF="javascript:removeOnFunction('denied' )" onmouseover="window.status='Variables.mouseover';return true;" onmouseout="window.status='';return true" REPLACEALL="Variables.mouseover">
					<CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/Remove"/></CALLELEMENT>
				</A>
			</THEN>
			</IF>
		</td>		
    <td><img height="1" width="5" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>
	
		</tr>
		</table></fieldset></td>
	</tr>
	</table>
</ELSE>
</IF>				
<STRING.ENCODE VARIABLE="ViewBy" VARNAME="ViewBy"/>
<input type="hidden" NAME="ViewBy" VALUE="Variables.ViewBy" REPLACEALL="Variables.ViewBy"/>

</ftcs>
