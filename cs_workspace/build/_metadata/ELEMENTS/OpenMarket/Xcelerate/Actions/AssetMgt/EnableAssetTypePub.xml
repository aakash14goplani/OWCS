<?xml version="1.0" ?>
<!DOCTYPE FTCS SYSTEM "futuretense_cs.dtd">

<FTCS Version="1.1">
<!--
$Logfile: /VerticalApps/XcelerateC/install/Xcelerate/Populate/ElementCatalog/OpenMarket/Xcelerate/Actions/AssetMgt/EnableAssetTypePub.xml $
$Revision: 23 $
$Modtime: 1/16/04 3:42p $
-->

<!--
- Confidential and Proprietary Information of Open Market, Inc.
-					All Rights Reserved.
-
- DESCRIPTION
-   All functions to deal with access to the AssetTypePub
-   table
-
-   Inputs:
-       upcommand:          name of the command
		assettype:    name of the asset type
		pubid:          	pubid of the publication
-->


<!-- Load the publication -->

	<PUBLICATION.LOAD NAME="site" OBJECTID="Variables.pubid"/>

<!-- List all enabled assets -->
	<IF COND="Variables.upcommand=ListEnabledAssetTypes">
		<THEN>
			<PUBLICATION.CHILDREN NAME="site" LIST="Variables.list" OBJECTTYPE="AssetType" ORDER="description"/>
		</THEN>
	</IF>
		
<!-- Check for the IsAssetTypeEnabled command -->

	<IF COND="Variables.upcommand=IsAssetTypeEnabled">
		<THEN>
	
<!-- Load the asset type and get the asset type id -->

			<ASSETTYPE.LOAD NAME="type" TYPE="Variables.assettype"/>
			<ASSETTYPE.GET NAME="type" FIELD="id" OUTPUT="typeid"/>

<!-- Assume that the asset type is not authorized -->

			<SETVAR NAME="IsAuthorized" VALUE="false"/>

<!-- Check to see if the asset type is a child of the publication -->

			<PUBLICATION.CHILDREN NAME="site" LIST="list" OBJECTTYPE="AssetType" OBJECTID="Variables.typeid"/>
			<IF COND="IsError.Variables.errno!=true">
				<THEN>
					<SETVAR NAME="IsAuthorized" VALUE="true"/>
				</THEN>
			</IF>
		</THEN>
	</IF>

<!-- Check for the EnableAssetType command -->

	<IF COND="Variables.upcommand=EnableAssetType">
		<THEN>
			<PUBLICATION.ENABLEASSETTYPE NAME="site" ASSETTYPE="Variables.assettype"/>
		</THEN>
	</IF>

<!-- Check for the DisableAssetType command -->

	<IF COND="Variables.upcommand=DisableAssetType">
		<THEN>
			<PUBLICATION.DISABLEASSETTYPE NAME="site" ASSETTYPE="Variables.assettype"/>
		</THEN>
	</IF>

</FTCS>
