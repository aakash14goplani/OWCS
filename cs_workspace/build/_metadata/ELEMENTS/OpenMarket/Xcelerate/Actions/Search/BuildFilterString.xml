<?xml version="1.0" ?>
<!DOCTYPE FTCS SYSTEM "futuretense_cs.dtd">
<FTCS Version="1.2">
<!-- OpenMarket/Xcelerate/Actions/Search/BuildFilterString
-
- INPUT
-
- OUTPUT
-
-->

<if COND="IsVariable.Name=true">
	<then>
         <XLAT.LOOKUP  KEY="dvin/AT/Common/NameContainsNoColon"  VARNAME="_XLAT_"/>
		<SETVAR NAME="filterstring" VALUE="Variables.filterstring : Variables._XLAT_ 'Variables.Name'"/>
	</then>
</if>

<!-- note that template is a lowercase variable name -->
<if COND="IsVariable.template=true">
    <then>
     <XLAT.LOOKUP  KEY="dvin/UI/Search/displaystyle" VARNAME="_XLAT_"/>
	<SETVAR NAME="filterstring" VALUE="Variables.filterstring : Variables._XLAT_ = 'Variables.template'"/>
   </then>
</if>

<if COND="IsVariable.Status=true">
    <then>
		<XLAT.LOOKUP KEY="dvin/AT/Common/StatusCode-Variables.Status" VARNAME="_statuscodedescription_"/>
        <XLAT.LOOKUP  KEY="dvin/AT/Common/statusis" VARNAME="_XLAT_"/>
	    <SETVAR NAME="filterstring" VALUE="Variables.filterstring Variables._XLAT_ 'Variables._statuscodedescription_'"/>
   </then>
</if>


<if COND="IsVariable.Source=true">
    <then>
  	<SETVAR NAME="source" VALUE="Variables.Source"/>
	<SETVAR NAME="errno" VALUE="0"/>
	<SELECTTO LIST="SourceDesc" WHAT="description" FROM="Source" WHERE="source"/>
	<IF COND="IsError.Variables.errno!=true">
	<THEN>
         <XLAT.LOOKUP  KEY="dvin/UI/Search/sourceis" VARNAME="_XLAT_"/>
	    <SETVAR NAME="filterstring" VALUE="Variables.filterstring : Variables._XLAT_ 'SourceDesc.description'"/>
	</THEN>
	<ELSE>
          <XLAT.LOOKUP  KEY="dvin/UI/Search/sourceequals" VARNAME="_XLAT_"/>
		<SETVAR NAME="filterstring" VALUE="Variables.filterstring : Variables._XLAT_ 'Variables.Source'"/>
	</ELSE>
	</IF>
   </then>
</if>

<if COND="IsVariable.Align=true">
    <then>
    
      <XLAT.LOOKUP  KEY="dvin/UI/Search/alignequals" VARNAME="_XLAT_"/>
      <SETVAR NAME="filterstring" VALUE="Variables.filterstring : Variables._XLAT_  'Variables.Align'"/>
    </then>
</if>


<if COND="IsVariable.Subtype=true">
    <then>
     <XLAT.LOOKUP  KEY="dvin/UI/Search/subtypeis" VARNAME="_XLAT_"/>
	<SETVAR NAME="filterstring" VALUE="Variables.filterstring : Variables._XLAT_ 'Variables.Subtype'"/>
   </then>
</if>

<if COND="IsVariable.Category=true">
    <then>
    
 	<SETVAR NAME="category" VALUE="Variables.Category"/>
	<SETVAR NAME="assettype" VALUE="Variables.AssetType"/>
	<SETVAR NAME="errno" VALUE="0"/>
	<SELECTTO LIST="CategoryDesc" WHAT="description" FROM="Category" WHERE="category,assettype"/>
	<IF COND="IsError.Variables.errno!=true">
	<THEN>
    
         <XLAT.LOOKUP  KEY="dvin/UI/Search/categoryis" VARNAME="_XLAT_"/>
	    <SETVAR NAME="filterstring" VALUE="Variables.filterstring : Variables._XLAT_ 'CategoryDesc.description'"/>
	</THEN>
	<ELSE>
    
         <XLAT.LOOKUP  KEY="dvin/UI/Search/categoryequals" VARNAME="_XLAT_"/>
		<SETVAR NAME="filterstring" VALUE="Variables.filterstring : Variables._XLAT_ 'Variables.Category'"/>
	</ELSE>
	</IF>
   </then>
</if>

<if COND="IsVariable.Width=true">
    <then>
     <XLAT.LOOKUP  KEY="dvin/UI/Search/widthequals" VARNAME="_XLAT_"/>
 	<SETVAR NAME="filterstring" VALUE="Variables.filterstring : Variables._XLAT_ Variables.Width"/>
    </then>
</if>

<if COND="IsVariable.Height=true">
    <then>
     <XLAT.LOOKUP  KEY="dvin/UI/Search/heightequals" VARNAME="_XLAT_"/>
   	<SETVAR NAME="filterstring" VALUE="Variables.filterstring : Variables._XLAT_ Variables.Height"/>
    </then>
</if>

<if COND="IsVariable.Artist=true">
	<then>
     <XLAT.LOOKUP  KEY="dvin/UI/Search/artistcontains" VARNAME="_XLAT_"/>
		<SETVAR NAME="filterstring" VALUE="Variables.filterstring : Variables._XLAT_"/>
	</then>
</if>
    
<if COND="IsVariable.Description=true">
	<then>
         <IF COND="Variables.AssetType=Image">
         <THEN>
            <XLAT.LOOKUP KEY="dvin/UI/Search/captioncontains" VARNAME="_XLAT_"/>
          </THEN>
         <ELSE>
            <IF COND="Variables.AssetType=Article">
            <THEN>
                <XLAT.LOOKUP KEY="dvin/Common/Headlinecontains" VARNAME="_XLAT_"/>
            </THEN>
             <ELSE>
                <XLAT.LOOKUP KEY="dvin/UI/Search/descriptioncontains" ENCODE="false" VARNAME="_XLAT_"/>
             </ELSE>
             </IF>
         </ELSE>
         </IF>
		<SETVAR NAME="filterstring" VALUE="Variables.filterstring : Variables._XLAT_"/>
	</then>
</if>

<IF COND="IsVariable.ttype=true">
<THEN>
    <XLAT.LOOKUP KEY="dvin/AT/Common/ttype" VARNAME="_XLAT_" ENCODE="false"/>
    <if cond="Variables.ttype=b">
        <then>
              <XLAT.LOOKUP KEY="dvin/Common/AT/ElementCalledWithinHTML" VARNAME="usage"/>
        </then>
        <else>
            <if cond="Variables.ttype=x">
            <then>
                  <XLAT.LOOKUP KEY="dvin/Common/AT/ElementCanbecalledExternally" VARNAME="usage"/>
            </then>
                <else>
                    <if cond="Variables.ttype=r">
                    <then>
                          <XLAT.LOOKUP KEY="dvin/Common/AT/ElementStreamedAsRawData" VARNAME="usage"/>
                    </then>
                    <else>
                         <XLAT.LOOKUP KEY="dvin/Common/AT/ElementUsageUnspecified" VARNAME="usage"/>
                    </else>
                    </if>
                </else>
            </if>
        </else>
    </if>
    <SETVAR NAME="filterstring" VALUE="Variables.filterstring : Variables._XLAT_ Variables.usage"/>
</THEN>
</IF>

<if COND="IsVariable.Alttext=true">
	<then>
         <XLAT.LOOKUP KEY="dvin/UI/Search/alttextcontains" VARNAME="_XLAT_"/>
  		<SETVAR NAME="filterstring" VALUE="Variables.filterstring : Variables._XLAT_"/>
	</then>
</if>


<if COND="IsVariable.Abstract=true">
	<then>
         <XLAT.LOOKUP KEY="dvin/UI/Search/abstractcontains" VARNAME="_XLAT_"/>
 		<SETVAR NAME="filterstring" VALUE="Variables.filterstring : Variables._XLAT_"/>
	</then>
</if>

<if COND="IsVariable.Body=true">
	<then>
        <XLAT.LOOKUP KEY="dvin/UI/Search/bodycontains" VARNAME="_XLAT_"/>
 		<SETVAR NAME="filterstring" VALUE="Variables.filterstring : Variables._XLAT_"/>
	</then>
</if>

<if COND="IsVariable.Byline=true">
	<then>
         <XLAT.LOOKUP KEY="dvin/UI/Search/bylinecontains" VARNAME="_XLAT_"/>
 		<SETVAR NAME="filterstring" VALUE="Variables.filterstring : Variables._XLAT_"/>
	</then>
</if>

<if COND="IsVariable.Keyword=true">
	<then>
         <XLAT.LOOKUP KEY="dvin/UI/Search/keywordscontain" VARNAME="_XLAT_"/>
 		<SETVAR NAME="filterstring" VALUE="Variables.filterstring : Variables._XLAT_"/>
	</then>
</if>

<if COND="IsVariable.Id=true">
    <then>
    <XLAT.LOOKUP KEY="dvin/UI/Search/IDis" VARNAME="_XLAT_"/>
    <SETVAR NAME="filterstring" VALUE="Variables.filterstring : Variables._XLAT_ 'Variables.Id'"/>
    </then>
</if>

<if COND="IsVariable.UpdatedBefore=true">
    <then>
	<if COND="Variables.UpdatedBefore!=Variables.null">
		<then>
        <XLAT.LOOKUP KEY="dvin/FlexibleAssets/Common/UpdatedBeforeTextValue" VARNAME="_XLAT_" ENCODE="false"/>
		<SETVAR NAME="filterstring" VALUE="Variables.filterstring : Variables._XLAT_"/>
		</then>
	</if>	
    </then>
</if>

<if COND="IsVariable.UpdatedAfter=true">
    <then>
	<if COND="Variables.UpdatedAfter!=Variables.null">
		<then> 
        <XLAT.LOOKUP KEY="dvin/FlexibleAssets/Common/UpdatedAfterTextValue" VARNAME="_XLAT_" ENCODE="false"/>
		<SETVAR NAME="filterstring" VALUE="Variables.filterstring : Variables._XLAT_"/>
		</then>
	</if>	
    </then>
</if>

<if COND="IsVariable.UpdatedBy=true">
    <then>
    <XLAT.LOOKUP KEY="dvin/UI/Search/updatedby" VARNAME="_XLAT_"/>
	<SETVAR NAME="filterstring" VALUE="Variables.filterstring : Variables._XLAT_ 'Variables.UpdatedBy'"/>
    </then>
</if>

<if COND="IsVariable.HREF=true">
	<then>    
        <XLAT.LOOKUP KEY="dvin/Common/AT/HREFcontains" VARNAME="_XLAT_"/>
		<SETVAR NAME="filterstring" VALUE="Variables.filterstring : Variables._XLAT_ 'Variables.HREF'"/>
	</then>
</if>

<if COND="IsVariable.LinkText=true">
	<then>
        <XLAT.LOOKUP KEY="dvin/UI/Search/linktextcontains" VARNAME="_XLAT_"/>
		<SETVAR NAME="filterstring" VALUE="Variables.filterstring : Variables._XLAT_"/>
	</then>
</if>

<if COND="IsVariable.LinkType=true">
    <then>    <XLAT.LOOKUP KEY="dvin/UI/Search/linktypecontains" VARNAME="_XLAT_"/>
		<SETVAR NAME="filterstring" VALUE="Variables.filterstring : Variables._XLAT_"/>
	</then>
</if>

<IF COND="IsVariable.dimensionssearch=true">
<THEN>
    <XLAT.LOOKUP KEY="dvin/AT/Common/localeis" VARNAME="_XLAT_" ENCODE="false"/>
    <SETVAR NAME="filterstring" VALUE="Variables.filterstring : Variables._XLAT_ 'Variables.selectedDim'"/>
</THEN>
</IF> 

</FTCS>