<?xml version="1.0" ?>
<!DOCTYPE FTCS SYSTEM "futuretense_cs.dtd">
<FTCS Version="1.1">
<!-- OpenMarket/Xcelerate/Actions/CreateWorkflowGroupFront
-
- INPUT
-
- OUTPUT
-
- HISTORY
 [2007-09-17 KGF]
 * XSS fixes (adapted from 6.3 fixes):
   * isCleanString function usage
   * CSVAR -> STRING.STREAM
 * changed definitions of 'obj' to just forms[0] (not .elements[0])
 [2008-02-26 KGF]
 * further XSS fix: encode HTML special chars in description field
-->
<STRING.ENCODE VARIABLE="pdeadline" VARNAME="pdeadline"/>

<CALLELEMENT NAME="OpenMarket/Xcelerate/Scripts/ValidateInputForXSS" />
<CALLELEMENT NAME="OpenMarket/Xcelerate/Scripts/FormatDate" />

<SETVAR NAME="listwg" VALUE=""/>
<EXECSQL LIST="listWorkflowGroup" SQL="SELECT name FROM WorkflowGroups"  TABLE="WorkflowGroups"/>
<LOOP LIST="listWorkflowGroup">
<IF COND="Variables.listwg=Variables.empty">
<THEN>
	<SETVAR NAME="listwg" VALUE="listWorkflowGroup.name"/>
</THEN>
<ELSE>
	<SETVAR NAME="listwg" VALUE="Variables.listwg;listWorkflowGroup.name"/>
</ELSE>
</IF>
</LOOP>
<callelement NAME="OpenMarket/Xcelerate/Util/ClientoffsetInMillis"/>
<SCRIPT LANGUAGE="JavaScript">
var clientOffset = <CSVAR NAME="Variables.clientOffset" />
<![CDATA[

function SaveGroup() 
{ 
	var obj = document.forms[0];

	var isclean = isCleanString(obj.elements['name'].value ,'&');	
	if (!isclean) {
		alert("]]><XLAT.STREAM KEY="dvin/FlexibleAssets/Attributes/ApostropheNotAllowed" ESCAPE="true" ENCODE="false"/><![CDATA[");
		return false;
	}
	if ( (obj.elements['name'].value.length == 0) ||
         (obj.elements['name'].value.match(/^[\s]/) != null) ) {
	
	//Here means something is wrong, let us figure out what
	
			if (obj.elements['name'].value.length == 0) {
                ]]>
                alert("<XLAT.STREAM KEY="dvin/UI/Error/specifygroupname" ESCAPE="true" ENCODE="false"/>");
                <![CDATA[
			}
			
			if ( obj.elements['name'].value.match(/^[\s]/) != null ) {
                ]]>
                alert("<XLAT.STREAM KEY="dvin/UI/Error/GroupNameCanNotStartWithSpace" ESCAPE="true" ENCODE="false"/>");
                <![CDATA[
			}

			obj.name.focus();
			return false;
	}
	if (obj.elements['description'].value=="")
	{
		]]>
        alert("<XLAT.STREAM KEY="dvin/UI/Error/YouMustSpecifyGroupDescription" ESCAPE="true" ENCODE="false"/>");
        <![CDATA[
		obj.description.focus();
		return false;
	}
	if (obj.elements['addremove'][1].checked==true && obj.editroles.options.selectedIndex=="-1")
	{
        ]]>
        alert("<XLAT.STREAM KEY="dvin/UI/Error/specifyrolesaddremoveassetsgroup" ESCAPE="true" ENCODE="false"/>");
        <![CDATA[
		obj.editroles.focus();
		return false;
	}	
	if (obj.editdelete[1].checked==true && obj.removeroles.options.selectedIndex=="-1")
	{
        ]]>
        alert("<XLAT.STREAM KEY="dvin/UI/Error/specifyroleseditdeletegroup" ESCAPE="true" ENCODE="false"/>");
        <![CDATA[
		obj.removeroles.focus();
		return false;
	}

	if (obj.process.options.selectedIndex=="-1" || obj.process.options.selectedIndex=="0")
	{
		]]>
        alert("<XLAT.STREAM KEY="dvin/UI/Error/specifyworkflowprocessgroup" ESCAPE="true" ENCODE="false"/>");
        <![CDATA[
   		obj.process.focus();
		return false;
	}
	if (obj.elements['participants'].value=="")
	{
        ]]>
        alert("<XLAT.STREAM KEY="dvin/UI/Error/specifyparticipantsgroupClickcont" ENCODE="false" ESCAPE="true"/>");
        <![CDATA[
		return false;
	}
    if(obj.elements['dosetpdeadline'].value=="true")
    {
    if (obj.elements['donotsetProcessDeadline'][1].checked) 
    {
        var deadline_date = document.getElementById('deadlineFieldDiv').innerHTML;
        if (deadline_date == "" || deadline_date=="0")
        {
            ]]>
            alert("<XLAT.STREAM KEY="dvin/UI/Error/processdeadlineenterednotvaliddate" ESCAPE="true" ENCODE="false"/>");
            <![CDATA[
            return false;
        }

        var now = new Date();
		var cur_date = new Date(now.getTime() + clientOffset + now.getTimezoneOffset()*60*1000 );
        pdeadlineVal = dateToObject(deadline_date).valueOf();
        if (pdeadlineVal < cur_date.valueOf())
        {
           ]]>
           alert("<XLAT.STREAM KEY="dvin/UI/Error/processdeadlineearliercurrenttime" ESCAPE="true" ENCODE="false"/>");
           <![CDATA[
           return false;
         }   

        obj.elements['pdeadline'].value = pdeadlineVal;
    }
    }
	obj.elements['pagename'].value = "OpenMarket/Xcelerate/Actions/EditWorkflowGroupPost";
	obj.elements['action'].value = "save";
	obj.submit();
}

function reloadThisPage()
{
    var obj = document.forms[0];
    //retain process date if already set. 
    var isclean = isCleanString(obj.elements['name'].value, '&');	
	if (!isclean) {
		alert("]]><XLAT.STREAM KEY="dvin/FlexibleAssets/Attributes/ApostropheNotAllowed" ESCAPE="true" ENCODE="false"/><![CDATA[");
		return false;
	}
    if(obj.elements[0].form.elements['dosetpdeadline'].value=="true")
    {
        if (obj.elements[0].form.elements['donotsetProcessDeadline'][1].checked)
        {
            document.getElementById('pdeadline').value = document.getElementById('deadlineFieldDiv').innerHTML;
        }
    }
	obj.elements['pagename'].value = "OpenMarket/Xcelerate/Actions/CreateWorkflowGroupFront";
	obj.submit();
	return true;
}

function SetParticipants() 
{ 
	var obj = document.forms[0];
	var isclean = isCleanString(obj.elements['name'].value, '&');
	if (!isclean) {
		alert("]]><XLAT.STREAM KEY="dvin/FlexibleAssets/Attributes/ApostropheNotAllowed" ESCAPE="true" ENCODE="false"/><![CDATA[");
		return false;
	}
	if ( (obj.elements['name'].value.length == 0) ||
		 (obj.elements['name'].value.match(/^[\s]/) != null) ) {
	
	//Here means something is wrong, let us figure out what
	
			if (obj.elements['name'].value.length == 0) {
                ]]>
                alert("<XLAT.STREAM KEY="dvin/UI/Error/specifygroupname" ESCAPE="true" ENCODE="false"/>");
                <![CDATA[
				
			}
			
			if ( obj.elements['name'].value.match(/^[\s]/) != null ) {
                ]]>
                alert("<XLAT.STREAM KEY="dvin/UI/Error/GroupNameCanNotStartWithSpace" ESCAPE="true" ENCODE="false"/>");
                <![CDATA[
			}

			obj.name.focus();
			return false;
	}
	
	]]> var listwg = '<STRING.STREAM VALUE="Variables.listwg"/>'; <![CDATA[
	var listwgs = listwg.split(';');
	for(var i = 0 ; i < listwgs.length; i++){
		if(listwgs[i] == obj.elements['name'].value){
		 	]]>
            alert("<XLAT.STREAM KEY="dvin/UI/Wf/WorkflowGroupNameAlreadyExists" ESCAPE="true" ENCODE="false"/>");
            <![CDATA[
			obj.name.focus();
			return false;
		}
	}
	
	if (obj.elements['description'].value=="")
	{
		]]>
        alert("<XLAT.STREAM KEY="dvin/UI/Error/YouMustSpecifyGroupDescription" ESCAPE="true" ENCODE="false"/>");
        <![CDATA[
		obj.description.focus();
		return false;
	}

	if (obj.pdlinetype.value=="ask")
	{
		if (obj.elements['donotsetProcessDeadline'][1].checked) 
		{
			var deadline_date = document.getElementById('deadlineFieldDiv').innerHTML;
            if (deadline_date == "" || deadline_date=="0")
			{
				]]>
				alert("<XLAT.STREAM KEY="dvin/UI/Error/processdeadlineenterednotvaliddate" ESCAPE="true" ENCODE="false"/>");
				<![CDATA[
				return false;
			}
        
            var now = new Date();
			var cur_date = new Date(now.getTime() + clientOffset + now.getTimezoneOffset()*60*1000 );
			pdeadlineVal = dateToObject(deadline_date).valueOf();
            if (pdeadlineVal < cur_date.valueOf())
			{
				]]>
				alert("<XLAT.STREAM KEY="dvin/UI/Error/processdeadlineearliercurrenttime" ESCAPE="true" ENCODE="false"/>");
				<![CDATA[
				return false;
			}
			obj.elements['pdeadline'].value = pdeadlineVal;
		}
	}
	if (obj.pdlinetype.value=="none")
	{
		obj.elements['pdeadline'].value = 0;
	}

	if (obj.process.options.selectedIndex=="-1" || obj.process.options.selectedIndex=="0")
	{
        ]]>
        alert("<XLAT.STREAM KEY="dvin/UI/Error/specifyworkflowprocessgroup" ESCAPE="true" ENCODE="false"/>");
        <![CDATA[
		obj.process.focus();
		return false;
	}
	obj.elements['pagename'].value = "OpenMarket/Xcelerate/Actions/SetGroupParticipants";
	obj.elements['action'].value = "create";
	
	return true;
}
function donotsetPDeadline()
{
    var obj = document.getElementById('pdeadline_div');
    obj.style.visibility='hidden';
    return true;
}
function setProcessDeadline()
{
    var obj = document.getElementById('pdeadline_div');
    obj.style.visibility='visible';
}
]]>
</SCRIPT>

<table class="width-outer-70" cellspacing="0" cellpadding="0" border="0">
	<tr><td>
		<span class="title-text"><XLAT.STREAM KEY="dvin/UI/CreateWorkflowGroup"/></span>
	</td></tr>
	<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/TitleBar"/>
</table>

	<INPUT TYPE="HIDDEN" NAME="new" VALUE="true"/>
	<WORKFLOWENGINE.CREATENEWGROUP OBJVARNAME="newgroup"/>
	<WORKFLOWGROUP.SCATTER PREFIX="wfg:" NAME="newgroup"/>
<if COND="IsVariable.donotsetProcessDeadline!=true">
<then>
    <setvar NAME="donotsetProcessDeadline" VALUE="true" />
</then>
</if>	
<!-- Table header -->
<table class="width-outer-50" BORDER="0" CELLSPACING="0" CELLPADDING="0">
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
			<tr>
				<td class="form-label-text" VALIGN="TOP">
					<span class="alert-color">*</span><XLAT.STREAM KEY="dvin/Common/GroupName"/>:
				</td>
				<td class="form-inset" VALIGN="TOP">
					<if COND="IsVariable.name!=true">
					<then>
					<INPUT TYPE="TEXT" SIZE="32" MAXLENGTH="24" NAME="name" VALUE=""/>
					</then>
					<else>
					<STRING.ENCODE VARIABLE="name" VARNAME="name"/>
					<INPUT TYPE="TEXT" SIZE="32" MAXLENGTH="24" NAME="name" VALUE="Variables.name" REPLACEALL="Variables.name"/>
					</else>
					</if>
				</td>
			</tr>
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
			<tr>
				<td class="form-label-text" VALIGN="TOP">
					<span class="alert-color">*</span><XLAT.STREAM KEY="dvin/AT/Common/Description"/>:
				</td>
				<td class="form-inset">
					<if COND="IsVariable.description!=true">
					<then>
						<INPUT TYPE="TEXT" SIZE="32" MAXLENGTH="64" NAME="description" VALUE=""/>
					</then>
					<else>
						<SETVAR NAME="OutputQString" VALUE="Variables.empty"/>
						<STRING.ENCODE VARIABLE="description" VARNAME="OutputQString"/>
						<INPUT TYPE="TEXT" SIZE="32" MAXLENGTH="64" NAME="description" VALUE="Variables.OutputQString" REPLACEALL="Variables.OutputQString"/>
					</else>
					</if>
				</td>
			</tr>
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
			<tr>
				<td class="form-label-text" VALIGN="TOP">
					<span class="alert-color">*</span><XLAT.STREAM KEY="dvin/Common/WorkflowProcess"/>:
				</td>
				<td class="form-inset" VALIGN="top" >
					<SELECT class="inline-left" NAME="process" SIZE="1" ONCHANGE="return reloadThisPage();">
						<OPTION VALUE=""/>--<XLAT.STREAM KEY="dvin/Common/SelectWorkflowProcess"/>--
					<WORKFLOWENGINE.GETALLPROCESSES PUBID="SessionVariables.pubid" NAME="processes" PREFIX="wfe:"/>
					<setcounter NAME="NPROCESSES" VALUE="0"/>
					<if COND="IsVariable.wfe:Total=true">
					<then>
					<if COND="Variables.wfe:Total!=0">
					<then>
						<loop FROM="0" COUNT="Variables.wfe:Total">
							<WORKFLOWPROCESS.GETPROCESSNAME NAME="wfe:Counters.NPROCESSES" VARNAME="processname"/>
							<WORKFLOWPROCESS.GETID NAME="wfe:Counters.NPROCESSES" VARNAME="processid"/>
							<if COND="Variables.processid=Variables.process">
							<then>
								<OPTION VALUE="Variables.processid" REPLACEALL="Variables.processid" SELECTED="yes"/><STRING.STREAM VARIABLE="processname"/>
								<WORKFLOWPROCESS.GETDEADLINETYPE NAME="wfe:Counters.NPROCESSES" VARNAME="pdlinetype"/>
								<!-- determine if user is workflowadmin for the process selected -->
								<setvar NAME="userisworkflowadmin" VALUE="false"/>
								<WorkflowProcess.GetAdminRoles NAME="wfe:Counters.NPROCESSES" OBJVARNAME="adminrolesobj"/>
								<ROLELIST.ISALL NAME="adminrolesobj" VARNAME="roleisall"/>
								<!-- roleisall=true means Any role -->

								<if COND="Variables.roleisall=true">
								<then>
									<setvar NAME="userisworkflowadmin" VALUE="true"/>
								</then>
								<else>
									<ROLELIST.GETALL NAME="adminrolesobj" VARNAME="admnroles"/>
									<if COND="Variables.admnroles!=Variables.empty">
									<then>
										<STRINGLIST NAME="rlist" STR="Variables.admnroles" DELIM=","/>
										<loop LIST="rlist">
											<setvar NAME="errno" VALUE="0"/>
											<isinlist STR="SessionVariables.currentpubACLs" ITEM="rlist.ITEM"/>
											<if COND="Variables.errno=1">
											<then>
												<setvar NAME="userisworkflowadmin" VALUE="true"/>
											</then>
											</if>
										</loop>
									</then>
									</if>
								</else>
								</if> <!-- userisadmin-->
                                
                                <if COND="Variables.userisworkflowadmin=false">
                                <then>
                                      <setvar NAME="pdlinetype" VALUE="none" />
                                </then>
                                </if>
							</then>
							<else>
								<OPTION VALUE="Variables.processid" REPLACEALL="Variables.processid"/><STRING.STREAM VARIABLE="processname"/>
							</else>
							</if>
							<inccounter NAME="NPROCESSES" VALUE="1"/>
			  			</loop>
					</then>
					</if>
					</then>
					</if>	
						</SELECT>
                        <setvar NAME="requiresParticipants" VALUE="false"/>
                        <if COND="IsVariable.process=true">
                        <then>
                            <WORKFLOWENGINE.GETPROCESSID OBJVARNAME="chosenwf" ID="Variables.process"/>
                            <WORKFLOWPROCESS.CHECKPROCESSREQUIRESPARTICIPANTS NAME="chosenwf" VARNAME="requiresParticipants"/>
                        </then>
                        </if>
                            <XLAT.LOOKUP KEY="dvin/UI/SetParticipantsforthisworkflowprocess" VARNAME="_XLAT_" ESCAPE="true"/>
                            <A HREF="javascript:void(0);" onClick="if(SetParticipants()!=false){document.forms['AppForm'].submit(); return false;}" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true;" REPLACEALL="Variables._XLAT_"><CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/SetParticipants_"/></CALLELEMENT></A>
					<INPUT TYPE="HIDDEN" NAME="participants" VALUE=""/>
				</td>
			</tr>    
            <STRING.ENCODE VALUE="Variables.pdlinetype" VARNAME="plt"/>
            <INPUT TYPE="hidden" NAME="pdlinetype" VALUE="Variables.plt" REPLACEALL="Variables.plt"/>
            <setvar NAME="dosetpdeadline" VALUE="false"/>
            <if COND="Variables.pdlinetype=ask">
            <then>
                <callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
                <setvar NAME="dosetpdeadline" VALUE="true"/>
                <tr>
                    <td class="form-label-text" VALIGN="TOP">
                    	<XLAT.STREAM KEY="dvin/UI/Common/ProcessDeadline"/>:
                    </td>
                    <td class="form-inset" nowrap="nowrap">
                           <if COND="Variables.donotsetProcessDeadline=true">
                           <then>
                                <INPUT style="margin-left:0px" TYPE="RADIO" NAME="donotsetProcessDeadline" VALUE="true" CHECKED="true" OnClick="donotsetPDeadline();"/><XLAT.STREAM KEY="dvin/Common/Donotset"/>
                                <br/>
                                <INPUT style="margin-left:0px" TYPE="RADIO" NAME="donotsetProcessDeadline" VALUE="false" OnClick="setProcessDeadline()"/><XLAT.STREAM KEY="dvin/Common/Set"/>
                                <setvar NAME="pdeadline_vis" VALUE="hidden"/>
                           </then>
                           <else>
                                <INPUT style="margin-left:0px" TYPE="RADIO" NAME="donotsetProcessDeadline" VALUE="true" OnClick="donotsetPDeadline();"/><XLAT.STREAM KEY="dvin/Common/Donotset"/>
                                <br/>
                                <INPUT style="margin-left:0px" TYPE="RADIO" NAME="donotsetProcessDeadline" VALUE="false" CHECKED="true" OnClick="setProcessDeadline()"/><XLAT.STREAM KEY="dvin/Common/Set"/>
                                <setvar NAME="pdeadline_vis" VALUE="visible"/>
                           </else>
                           </if>
							
						   <STRING.ENCODE VARIABLE="cs_imagedir" VARNAME="cs_imagedir"/>
                           <IMG WIDTH="4" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/>
                           <CALLELEMENT NAME="OpenMarket/Xcelerate/Util/GetLocalizedDate">
                                <ARGUMENT NAME="inputDate" VALUE="Variables.pdeadline" />
                                <ARGUMENT NAME="outputVar" VALUE="localizedDeadlineValue" />
                           </CALLELEMENT>
                           <XLAT.LOOKUP KEY="fatwire/Alloy/UI/PickADate" VARNAME="pickADateString" />
						   <STRING.ENCODE VARIABLE="localizedDeadlineValue" VARNAME="localizedDeadlineValue"/>
                           <span ID="pdeadline_div" style="visibility:Variables.pdeadline_vis" REPLACEALL="Variables.pdeadline_vis">
                               <div id="deadlineFieldId" name="deadlineField" dojoType="fw.dijit.UIInput"  clearButton="true" readonly="true" VALUE="Variables.localizedDeadlineValue" REPLACEALL="Variables.localizedDeadlineValue"></div>
							   
								<DIV ID="deadlineFieldDiv" STYLE="display:none"><ICS.GETVAR NAME="pdeadline"/></DIV>
								<CALLELEMENT NAME="OpenMarket/Xcelerate/Scripts/DateTimeWidget">
									<ARGUMENT NAME="inputFieldId" value="deadlineFieldId"/>
									<ARGUMENT NAME="inputDivId" value="deadlineFieldDiv"/>
								</CALLELEMENT>
							</span>
                    </td>
                </tr>
            </then>
            </if>

			
			<ROLEMANAGER.GETROLENAMES LISTVARNAME="ACLList"/>
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
			<tr>
				<td class="form-label-text" VALIGN="TOP"><XLAT.STREAM KEY="dvin/UI/AddRemoveAssets"/>:</td>
				<td class="form-inset">
					<INPUT style="margin-left:0px" TYPE="radio" NAME="addremove" VALUE="any" checked="checked"/><XLAT.STREAM KEY="dvin/Common/AnyUser"/><BR/>
					<INPUT style="margin-left:0px" TYPE="radio" NAME="addremove" VALUE="role" onClick="editroles.selectedIndex==-1 ? editroles.options[0].selected=true : void(0)"/><XLAT.STREAM KEY="dvin/Common/AllUsersFollowingRoles"/>:<BR/>
					<SELECT NAME="editroles" MULTIPLE="yes" SIZE="5" onChange="this.form.elements['addremove'][1].checked=true">
 	  					<LOOP LIST="ACLList">
                     			<OPTION VALUE="ACLList.aclname" REPLACEALL="ACLList.aclname"/><STRING.STREAM VALUE="ACLList.aclname"/>
                   	  </LOOP>
					</SELECT>
				</td>
			</tr>
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
				<ROLEMANAGER.GETROLENAMES LISTVARNAME="ACLList"/>
			<tr>
				<td class="form-label-text" VALIGN="TOP"><XLAT.STREAM KEY="dvin/UI/EditDeleteGroup"/>:</td>
				<td class="form-inset">
					<INPUT style="margin-left:0px" TYPE="radio" NAME="editdelete" VALUE="any" checked="checked"/><XLAT.STREAM KEY="dvin/Common/AnyUser"/><BR/>
					<INPUT style="margin-left:0px" TYPE="radio" NAME="editdelete" VALUE="role" onClick="removeroles.selectedIndex==-1 ? removeroles.options[0].selected=true : void(0)"/><XLAT.STREAM KEY="dvin/Common/AllUsersFollowingRoles"/>:<BR/>
					<SELECT NAME="removeroles" MULTIPLE="yes" SIZE="5" onChange="this.form.elements['editdelete'][1].checked=true">
					<LOOP LIST="ACLList">
						<OPTION VALUE="ACLList.aclname" REPLACEALL="ACLList.aclname"/><STRING.STREAM VALUE="ACLList.aclname"/>
					</LOOP>
					</SELECT>
				</td>
			</tr>
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
			<tr>
				<td class="form-label-text" VALIGN="TOP"><XLAT.STREAM KEY="dvin/UI/GroupDeadlockActions"/>:</td>
				<td class="form-inset">
					<WORKFLOWENGINE.GETAVAILABLEGROUPACTIONS NAME="grpactionss" PREFIX="wfgactions:"/>
					<setcounter NAME="NGROUPS" VALUE="0"/>
					<if COND="IsVariable.wfgactions:Total=true">
					<then>
					<if COND="Variables.wfgactions:Total!=0">
					<then>
					<SELECT NAME="grpactions" MULTIPLE="yes" SIZE="3">
						<loop FROM="0" COUNT="Variables.wfgactions:Total">
							<WORKFLOWACTION.GETNAME NAME="wfgactions:Counters.NGROUPS" VARNAME="groupname"/>
							<WORKFLOWACTION.GETID NAME="wfgactions:Counters.NGROUPS" VARNAME="groupid"/>
							<OPTION VALUE="Variables.groupid" REPLACEALL="Variables.groupid"/><STRING.STREAM VARIABLE="groupname"/>
							<inccounter NAME="NGROUPS" VALUE="1"/>
			  			</loop>
			  			</SELECT>
					</then>
					<else><span class="small-text"><XLAT.STREAM KEY="dvin/UI/Nogroupdeadlockactionsavailable"/></span>
					</else>
					</if>
					</then>
					</if>		
				</td>
			</tr>
			
			<if COND="IsVariable.dosetpdeadline!=true">
			<then>
				<setvar NAME="dosetpdeadline" VALUE="false"/>
			</then>
			</if>
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/FooterBar" />
			<tr><td><br/></td><td>
			<STRING.ENCODE VARIABLE="dosetpdeadline" VARNAME="dosetpdeadline"/>
			<INPUT TYPE="hidden" NAME="dosetpdeadline" VALUE="Variables.dosetpdeadline" REPLACEALL="Variables.dosetpdeadline"/>
			<INPUT TYPE="hidden" ID="pdeadline" NAME="pdeadline" VALUE="0" />
			<INPUT TYPE="hidden" NAME="action" VALUE="save"/>
			<XLAT.LOOKUP KEY="dvin/UI/CancelCreatingNewGroup" VARNAME="alt_cancel" ESCAPE="true"/>
			<STRING.ENCODE VARIABLE="WorkflowFrontURL" VARNAME="WorkflowFrontURL"/>
			<A HREF="Variables.WorkflowFrontURL" REPLACEALL="Variables.WorkflowFrontURL"><CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/Cancel"/></CALLELEMENT></A>
			
			<XLAT.LOOKUP KEY="dvin/UI/CreateWorkflowGroup" VARNAME="_XLAT_" ESCAPE="true"/>
			<A HREF="javascript:void(0);" onClick="return SaveGroup();" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true;" REPLACEALL="Variables._XLAT_"><CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/Save"/></CALLELEMENT></A>
			</td></tr>
			
</table>
<STRING.ENCODE VARIABLE="PostPage" VARNAME="PostPage"/>
<INPUT type="hidden" name="pagename" value="OpenMarket/Xcelerate/Actions/Variables.PostPage" REPLACEALL="Variables.PostPage"/>

</FTCS> 
