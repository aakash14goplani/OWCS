<?xml version="1.0" ?>
<!DOCTYPE FTCS SYSTEM "futuretense_cs.dtd">

<FTCS Version="1.1">
<!-- 
$Logfile: /VerticalApps/XcelerateC/install/Xcelerate/Populate/ElementCatalog/OpenMarket/Xcelerate/Actions/Util/ShowTemplates.xml $ 
$Revision: 40 $ 
$Modtime: 6/12/03 9:41a $ 
-->

<!--
- Confidential and Proprietary Information of FutureTense Inc.
-					All Rights Reserved.
-
- ShowTemplates.xml
-
- DESCRIPTION
-	Display list of templates for current content item
-
- HISTORY 
-->
<IF COND="IsVariable.Prefix=true">
<THEN>
	<SETVAR NAME="Fieldname" VALUE="Variables.Prefix:template"/>
</THEN>
<ELSE>
	<SETVAR NAME="Fieldname" VALUE="template"/>
</ELSE>
</IF>


<!-- if we are build ContentForm updatetype will be set, if building advanced search it won't -->
<!-- when building ContentForm, we want to use subtype as part of the criteria for retrieving subtypes -->
<if COND="IsVariable.updatetype=true">
<then>
	<IF COND="Variables.ContentDetails:subtype!=Variables.empty">
	<THEN>
		<!-- use the current subtype -->
		<SETVAR NAME="subtype" VALUE="Variables.ContentDetails:subtype"/>
	</THEN>
	<ELSE>
		<ASSET.ISNEW NAME="theCurrentAsset" VARNAME="isNew"/>
		<if COND="Variables.isNew=true">
		<then>
			<!-- use the first subtype we get (we can't know if this is set to empty or not) -->
			<ASSET.GetLegalSubtypes TYPE="Variables.AssetType" LIST="subtypes" PUBID="SessionVariables.pubid"/>
			<SETVAR NAME="subtype" VALUE="subtypes.subtype"/>
		</then>
		<else>
			<SETVAR NAME="subtype" VALUE="Variables.ContentDetails:subtype"/>
		</else>
		</if>
	</ELSE>
	</IF>
	<TEMPLATEMANAGER.GetTemplateNames LISTVARNAME="templates" ASSETTYPES="Variables.AssetType" SUBTYPE="Variables.subtype" PUBID="SessionVariables.pubid" EXCLUDEVARIANTS="true"/>
</then>
<else>
	<TEMPLATEMANAGER.GetTemplateNames LISTVARNAME="templates" ASSETTYPES="Variables.AssetType" PUBID="SessionVariables.pubid" EXCLUDEVARIANTS="true"/>
</else>
</if>

<if COND="Variables.errno!=-101">
<then>
    <SELECT name="Variables.Fieldname" size="1" REPLACEALL="Variables.Fieldname">
    <IF COND="Variables.showDummy=true">
    <THEN>
    	<OPTION VALUE=""/>-- <XLAT.STREAM KEY="dvin/UI/Util/choosedisplaystyle"/> --
    </THEN>
    </IF>
    <LOOP LIST="templates">
        <if COND="Variables.ContentDetails:template=templates.tname">
        <then>
            <OPTION VALUE="templates.tname" SELECTED="yes" REPLACEALL="templates.tname"/><STRING.STREAM VALUE="templates.name"/>
        </then>
        <else>
            <OPTION VALUE="templates.tname" REPLACEALL="templates.tname"/><STRING.STREAM VALUE="templates.name"/>
        </else>
        </if>
     </LOOP>
     </SELECT>
</then>
<else>
   <SELECT name="Variables.Fieldname" size="1" REPLACEALL="Variables.Fieldname">
    	<OPTION VALUE="" SELECTED=""/><XLAT.STREAM KEY="dvin/UI/Util/Notemplatesavailable"/>
   </SELECT>
</else>
</if>

</FTCS>



