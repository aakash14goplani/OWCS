<?xml version="1.0" ?>
<!DOCTYPE FTCS SYSTEM "futuretense_cs.dtd">
<FTCS Version="1.2">
<!-- OpenMarket/Xcelerate/Actions/SBSearchFront
-
- INPUT
-
- OUTPUT
-
-->

<!-- Load the search engine specific strings -->

	<CALLELEMENT NAME="OpenMarket/Xcelerate/Actions/Search/seDescription"/>
     
     <if COND="IsVariable.frompage!=true">
    <then>
		<STRING.ENCODE VARIABLE="ThisPage" VARNAME="ThisPage"/>
        <INPUT type="hidden" name="frontpage" VALUE="Variables.ThisPage" REPLACEALL="Variables.ThisPage"/>
		<STRING.ENCODE VARIABLE="PostPage" VARNAME="PostPage"/>
        <INPUT type="hidden" name="postpage" VALUE="Variables.PostPage" REPLACEALL="Variables.PostPage"/>
    </then>
    <else>
		<STRING.ENCODE VARIABLE="frontpage" VARNAME="frontpage"/>
        <INPUT type="hidden" name="frontpage" VALUE="Variables.frontpage" REPLACEALL="Variables.frontpage"/>
		<STRING.ENCODE VARIABLE="postpage" VARNAME="postpage"/>
        <INPUT type="hidden" name="postpage" VALUE="Variables.postpage" REPLACEALL="Variables.postpage"/>
    </else>
    </if>
          
 
<!-- Load the asset type -->

	<ASSETTYPE.LOAD NAME="type" TYPE="Variables.AssetType"/>
	<ASSETTYPE.SCATTER NAME="type" PREFIX="AssetTypeObj"/>

<!--
    If this content category does not use a search engine, then define the
    traditional Javascript functions for creating SQL query fragments.
-->

<IF COND="Variables.AssetTypeObj:usesearchindex!=1">
  <THEN>
    <callelement NAME="OpenMarket/Xcelerate/Scripts/FormatDate"/>
  </THEN>
  <ELSE>
    <SCRIPT LANGUAGE="JavaScript1.2">
    function formatSetDate(datestr, obj, formfield) {
        dijit.byId(formfield).set('value',datestr);
    }
    </SCRIPT>
  </ELSE>
</IF>
<table class="width-outer-70">
	<tr><td><span class="title-text"><XLAT.STREAM KEY="dvin/UI/SearchforAssetTypeObjplural"/></span></td></tr>
	<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/TitleBar"/>
</table>

<callelement NAME="OpenMarket/Xcelerate/Actions/Search/SimpleSearch"/>
			
<ics.literal table="AssetPublication" column="assettype" string="Variables.AssetType"
    output="literal"/>
<setvar NAME="tablename" VALUE="Variables.AssetType"/>
<EXECSQL LIST="ContentCount" SQL="SELECT count(*) as thecount FROM AssetPublication,Variables.AssetType WHERE (AssetPublication.pubid=SessionVariables.pubid OR AssetPublication.pubid=0) AND AssetPublication.assettype=Variables.literal AND AssetPublication.assetid=Variables.AssetType.id AND Variables.AssetType.status!='VO'" TABLE="Variables.AssetType,AssetPublication"/>

<table class="width-outer-70">
	<tr>
		<td class="form-inset"><XLAT.STREAM KEY="dvin/UI/TotalAssetTypeObjplural"/>: <CSVAR NAME="ContentCount.thecount"/></td>
	</tr>
</table>

<input type="hidden" name="action" value="search" />
<if COND="Variables.cs_environment=popup">
<then>
	<STRING.ENCODE VARIABLE="idwhere" VARNAME="idwhere"/>
    <input type="hidden" name="idwhere" value="Variables.idwhere" replaceall="Variables.idwhere" />
	<STRING.ENCODE VARIABLE="where" VARNAME="where"/>
    <input type="hidden" name="where" value="Variables.where" replaceall="Variables.where" />
</then>
</if>

<if COND="Variables.cs_environment=addref">
<then>
	<STRING.ENCODE VARIABLE="parentid" VARNAME="parentid"/>
    <input type="hidden" name="parentid" value="Variables.parentid" replaceall="Variables.parentid" />
	<STRING.ENCODE VARIABLE="parenttype" VARNAME="parenttype"/>
    <input type="hidden" name="parenttype" value="Variables.parenttype" replaceall="Variables.parenttype" />
	<STRING.ENCODE VARIABLE="parentfield" VARNAME="parentfield"/>
    <input type="hidden" name="parentfield" value="Variables.parentfield" replaceall="Variables.parentfield" />
</then>
</if>

<if COND="Variables.cs_environment=changeref">
<then>
	<STRING.ENCODE VARIABLE="parentid" VARNAME="parentid"/>
    <input type="hidden" name="parentid" VALUE="Variables.parentid" replaceall="Variables.parentid" />
	<STRING.ENCODE VARIABLE="parenttype" VARNAME="parenttype"/>
    <input type="hidden" name="parenttype" VALUE="Variables.parenttype" replaceall="Variables.parenttype" />
	<STRING.ENCODE VARIABLE="parentfield" VARNAME="parentfield"/>
    <input type="hidden" name="parentfield" VALUE="Variables.parentfield" replaceall="Variables.parentfield" />
	<STRING.ENCODE VARIABLE="memberid" VARNAME="memberid"/>
    <input type="hidden" name="memberid" VALUE="Variables.memberid" replaceall="Variables.memberid" />
</then>
</if>

</FTCS>