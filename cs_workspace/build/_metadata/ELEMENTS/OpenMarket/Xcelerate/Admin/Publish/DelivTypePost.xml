<?xml version="1.0" ?>
<!DOCTYPE FTCS SYSTEM "futuretense_cs.dtd">
<FTCS Version="1.1">
<!-- 
$Logfile: /VerticalApps/XcelerateB/install/Xcelerate/Populate/ElementCatalog/OpenMarket/Xcelerate/Admin/Publish/DelivTypePost.xml $ 
$Revision: 12 $ 
$Modtime: 11/06/02 4:07p $ 
-->

<!--
- Confidential and Proprietary Information of FutureTense Inc.
-					All Rights Reserved.
-
- DESCRIPTION
-	Display form for edit or new a DeliveryType.
-
- HISTORY 
-->

<!-- New/Edit this class -->
<SETVAR NAME="class" VALUE="com.openmarket.xcelerate.publish.DeliveryType"/>
<STRING.ENCODE VARIABLE="id" VARNAME="id"/>
<STRING.ENCODE VARIABLE="action" VARNAME="action"/>
<IF COND="Variables.action=edit">
<THEN>
    <OBJECT.LOAD CLASS="Variables.class" OBJECTID="Variables.id" NAME="a"/>
    <if COND="Variables.errno=0"><then>
    <CALLJAVA CLASS="com.openmarket.framework.commands.SetDefault">
	<ARGUMENT NAME="dt:description" VALUE="Variables.empty"/>
    </CALLJAVA>
    <OBJECT.GATHER NAME="a" PREFIX="dt"/>
    <if COND="Variables.errno=0"><then>
    <OBJECT.SAVE NAME="a"/>
    <if COND="Variables.errno=0"><then>
    <OBJECT.SCATTER NAME="a" PREFIX="b"/>
    </then></if>
    </then></if>
    </then></if>
    <if COND="Variables.errno=0">
    <then>
<!--	    <span class="title-text"><XLAT.STREAM KEY="dvin/UI/Admin/ChangedDeliveryType"/></span><P/> -->
		<SETVAR NAME="list" VALUE="true"/>
    </then>
    <else>
    	<table class="width-outer-70" cellspacing="0" cellpadding="0" border="0">
			<tr><td>
				<span class="title-text"><XLAT.STREAM KEY="dvin/Common/Error"/></span>
			</td></tr>
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/TitleBar"/>
		</table>
	    <P/>
	    <div class="width-outer-70">
		<XLAT.LOOKUP KEY="dvin/UI/Admin/Error/notsavechangesdeliverytypeobjiderrno" EVALALL="false" errno="Variables.errno" VARNAME="msgtext"/>
		<CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/ShowMessage">
			<ARGUMENT NAME="severity" VALUE="error"/>
		</CALLELEMENT>
		</div>
		<SETVAR NAME="list" VALUE="false"/>
    </else>
    </if>
</THEN>
<ELSE>
	<IF COND="Variables.action=new">
	<THEN>
	    <OBJECT.CREATE CLASS="Variables.class" NAME="a"/>
	    <if COND="Variables.errno=0"><then>
	    <CALLJAVA CLASS="com.openmarket.framework.commands.SetDefault">
		<ARGUMENT NAME="dt:description" VALUE="Variables.empty"/>
	    </CALLJAVA>
	    <OBJECT.GATHER NAME="a" PREFIX="dt"/>
	    <if COND="Variables.errno=0"><then>
	    <OBJECT.SAVE NAME="a"/>
	    <if COND="Variables.errno=0"><then>
	    <OBJECT.SCATTER NAME="a" PREFIX="b"/>
	    </then></if>
	    </then></if>
	    </then></if>
	    <if COND="Variables.errno=0">
	    <then>
		   <!-- <span class="title-text"><XLAT.STREAM KEY="dvin/UI/Admin/AddedNewDeliveryType"/></span><P/> -->
			<SETVAR NAME="id" VALUE="Variables.b:id"/>
		<SETVAR NAME="list" VALUE="true"/>
	    </then>
	    <else>
		<table class="width-outer-70" cellspacing="0" cellpadding="0" border="0">
			<tr><td>
				<span class="title-text"><XLAT.STREAM KEY="dvin/Common/Error"/></span>
			</td></tr>
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/TitleBar"/>
		</table>
		<P/>
		<div class="width-outer-70">
		<XLAT.LOOKUP KEY="dvin/UI/Admin/Error/notaddnewdeliverytypeerrno" errno="Variables.errno" EVALALL="false" VARNAME="msgtext"/>
		<CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/ShowMessage">
			<ARGUMENT NAME="severity" VALUE="error"/>
		</CALLELEMENT>
		</div>
		<SETVAR NAME="list" VALUE="false"/>
	    </else>
	    </if>
	</THEN>
	<ELSE><IF COND="Variables.action=delete">
<THEN>
    <setvar NAME="errno" VALUE="0"/>
    <OBJECT.LOAD CLASS="Variables.class" OBJECTID="Variables.id" NAME="a"/>
    <if COND="Variables.errno=0"><then>
     <OBJECT.SCATTER NAME="a" PREFIX="b"/>
     <if COND="Variables.errno=0"><then>
      <OBJECT.DELETE NAME="a"/>
      </then></if>
     </then></if>
    <if COND="Variables.errno=0">
    <then>
		<table class="width-outer-70" cellspacing="0" cellpadding="0" border="0">
			<tr><td>
				<span class="title-text"><XLAT.STREAM KEY="dvin/UI/Admin/DeletedDeliveryType"/></span>
			</td></tr>
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/TitleBar"/>
		</table>
		<P/>
                    <callelement NAME="OpenMarket/Xcelerate/Admin/Publish/DelivTypeEdit">
                        <argument NAME="pagetype" VALUE="front"/>
                        <argument NAME="action" VALUE="list"/>
                        <argument NAME="showheader" VALUE="true"/>
                    </callelement>    
    </then>
    <else>
        <FONT FACE="Arial, Helvetica" SIZE="2">
	<XLAT.STREAM KEY="dvin/UI/Admin/Error/whiledeleteobjiderrno" errno="Variables.errno" id="Variables.id" EVALALL="false"/>
	</FONT>
	<SETVAR NAME="list" VALUE="false"/>
    </else>
    </if>
</THEN>
<ELSE>
    <XLAT.STREAM KEY="dvin/UI/Admin/TBDimpossibleaction"/>
    <SETVAR NAME="list" VALUE="false"/>
</ELSE>
</IF>
</ELSE>
</IF>
</ELSE>
</IF>

<IF COND="Variables.list=true">
<THEN>
	<callelement NAME="OpenMarket/Xcelerate/Admin/Publish/DelivTypeEdit">
		<argument NAME="pagetype" VALUE="front"/>
		<argument NAME="action" VALUE="details"/>
		<argument NAME="id" VALUE="Variables.id"/>
		<argument NAME="showheader" VALUE="true"/>
	</callelement>    

</THEN>
</IF>
	<PROPERTY.GET PARAM="xcelerate.treeType" INIFILE="futuretense_xcel.ini" VARNAME="proptreetype"/>
	<if  COND="IsElement.OpenMarket/Xcelerate/UIFramework/UpdateTreeVariables.proptreetype=true">
	<then>
		<callelement NAME="OpenMarket/Xcelerate/UIFramework/UpdateTreeVariables.proptreetype">
			<argument NAME="__TreeRefreshKeys__" VALUE="Self:PublishDelivery"/>
		</callelement>		
	</then>
	</if>
</FTCS>
