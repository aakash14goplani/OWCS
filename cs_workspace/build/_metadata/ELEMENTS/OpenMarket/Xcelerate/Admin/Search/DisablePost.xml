<?xml version="1.0" ?>
<!DOCTYPE FTCS SYSTEM "futuretense_cs.dtd">
<FTCS Version="1.1">
<!-- 
$Logfile: /VerticalApps/XcelerateB/install/Xcelerate/Populate/ElementCatalog/OpenMarket/Xcelerate/Admin/Search/DisablePost.xml $ 
$Revision: 13 $ 
$Modtime: 10/28/02 4:37p $ 
-->

<!--
- Confidential and Proprietary Information of FutureTense Inc.
-					All Rights Reserved.
-
- Admin/Search/DisablePost.xml
-
- DESCRIPTION
-	Disable command confirmed, disable SE flag and delete search engine
-	index.
-
- HISTORY 
-->



<!-- Load the search engine specific strings -->

<CALLELEMENT NAME="OpenMarket/Xcelerate/Actions/Search/seDescription"/>

<!-- Load the asset type -->

<ASSETTYPE.LOAD NAME="type" TYPE="Variables.AssetType"/>
<ASSETTYPE.SCATTER NAME="type" PREFIX="AssetType"/>

<table class="width-outer-70" cellspacing="0" cellpadding="0" border="0">
	<tr><td>
		<span class="title-text"><XLAT.STREAM KEY="dvin/UI/Admin/DisabledSearchEngineforATdesc"/></span>
	</td></tr>
	<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/TitleBar"/>
</table>
<P/>

<SETVAR NAME="ccIndexfile" VALUE="Variables.AssetType:indexfile"/>

<!-- Disable the search engine -->

<ASSETTYPE.SET NAME="type" FIELD="usesearchindex" VALUE="0"/>
<ASSETTYPE.SAVE NAME="type"/>

<IF COND="Variables.errno!=0">
  <THEN>
     <CALLELEMENT NAME="OpenMarket/Xcelerate/Actions/Util/ShowError">
		<ARGUMENT NAME="error" VALUE="SqlCantDisableSe"/>
		<ARGUMENT NAME="oldErrno" VALUE="Variables.errno"/>
     </CALLELEMENT>
     <THROWEXCEPTION/>
  </THEN>
  <ELSE>

		<!--
		    Delete the index to reclaim unwanted file space.
		-->

		<SETVAR NAME="errno" VALUE="0"/>
		<INDEXDESTROY INDEX="Variables.ccIndexfile"/>

		<!--
		    Report how we done good (or not so good)
		-->
		<p><XLAT.STREAM KEY="dvin/UI/Admin/DoneSearchesdoneSQLsearchingitems"/></p>

		<IF COND="Variables.errno!=0">
		  <THEN>
		    <p><XLAT.STREAM KEY="dvin/UI/Admin/WarningUnabledeletesearchengidxATDiskspace" ENCODE="false"/></p>

		    <p><XLAT.STREAM KEY="dvin/UI/Admin/SuggestedRemediesDelindexbyhand"/></p>
		  </THEN>
		</IF>
  
  </ELSE>
</IF>

<CALLELEMENT NAME="OpenMarket/Xcelerate/Admin/Search/List">
	<ARGUMENT NAME="AssetType" VALUE="Variables.AssetType"/>
</CALLELEMENT>
	<PROPERTY.GET PARAM="xcelerate.treeType" INIFILE="futuretense_xcel.ini" VARNAME="proptreetype"/>
	<if  COND="IsElement.OpenMarket/Xcelerate/UIFramework/UpdateTreeVariables.proptreetype=true">
	<then>
		<callelement NAME="OpenMarket/Xcelerate/UIFramework/UpdateTreeVariables.proptreetype">
			<argument NAME="__TreeRefreshKeys__" VALUE="Self:Searching"/>
		</callelement>		
	</then>
	</if>



</FTCS>
