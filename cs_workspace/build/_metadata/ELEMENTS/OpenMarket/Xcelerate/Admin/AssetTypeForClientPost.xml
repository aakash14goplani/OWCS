<?xml version="1.0" ?>
<!DOCTYPE FTCS SYSTEM "futuretense_cs.dtd">

<FTCS Version="1.1">
<!--
$Logfile: /VerticalApps/XcelerateD/install/Xcelerate/Populate/ElementCatalog/OpenMarket/Xcelerate/Admin/AssetTypeForClientPost.xml $

-->

<!--
 Confidential and Proprietary Information of Open Market, Inc.
					All Rights Reserved.

 DESCRIPTION
	Admin control of enabling or disabling one more assettypes
     for Word Integration

 INPUT
   action - grant/revoke
   pagetype - front/post
   clientapp -  MSWord  
-->


<CALLELEMENT NAME="OpenMarket/Xcelerate/Admin/AssetTypeForClientCommon"/>

<!--  process posted form for Enable or Disable  -->


	<!-- process enabling of things -->
	<IF COND="Variables.action=grant">
	<THEN>
		<span class="title-text"><XLAT.STREAM KEY="dvin/UI/Admin/EnableAssetTypesForclientapp"/></span>
			<IF COND="IsVariable.ContCategory=true">
				<THEN>
					<STRINGLIST NAME="EnableAssetType" STR="Variables.ContCategory" DELIM=";"/>
					<LOOP LIST="EnableAssetType">
						<ASSETTYPE.LOAD  NAME="atype" FIELD="assettype" VALUE="EnableAssetType.ITEM" />
						<ASSETTYPE.GET NAME="atype" FIELD="description" OUTPUT="atdesc"/>
						<ASSETTYPE.GET NAME="atype" FIELD="assettype" OUTPUT="aType"/>
						<SETVAR NAME="errno" VALUE="0"/>
						<CALLELEMENT NAME="OpenMarket/Xcelerate/Actions/AssetMgt/EnableAssetTypeForClient">
							<ARGUMENT NAME="upcommand" VALUE="EnableAssetType"/>
							<ARGUMENT NAME="assetType" VALUE="Variables.aType"/>
							<ARGUMENT NAME="pubid" VALUE="Variables.pubid"/>
							<ARGUMENT NAME="clientapp" VALUE="Variables.clientapp"/>
						</CALLELEMENT>
						<IF COND="IsError.Variables.errno=true">
						<THEN>
							<XLAT.LOOKUP KEY="dvin/UI/Admin/Error/enablingassettypeatdescerrorno"  errno="Variables.errno" atdesc="Variables.atdesc" EVALALL="false" VARNAME="msgtext"/>
							<div class="width-outer-70">
							<CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/ShowMessage">
								<ARGUMENT NAME="severity" VALUE="error"/>
							</CALLELEMENT>
						</div>
						</THEN>
						<ELSE>
							<XLAT.LOOKUP KEY="dvin/UI/Admin/EnabledassettypeatdescforclientappInt" VARNAME="msgtext"/>
							<div class="width-outer-70">
							<CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/ShowMessage">
								<ARGUMENT NAME="severity" VALUE="info"/>
							</CALLELEMENT>
						</div>
						</ELSE>
						</IF>
						
					</LOOP>
				</THEN>
				<ELSE>
						<XLAT.STREAM KEY="dvin/UI/Admin/Noassettypesselected"/><BR/>
				</ELSE>
				</IF>
		<CALLELEMENT NAME="OpenMarket/Xcelerate/Admin/AssetTypeForClientFront">
			<ARGUMENT NAME="action" VALUE="list"/>
			<ARGUMENT NAME="pubid" VALUE="Variables.pubid"/>
			<ARGUMENT NAME="clientapp" VALUE="Variables.clientapp"/>
		</CALLELEMENT>
	</THEN>
	</IF>

	<!-- process disabling of things -->
	<IF COND="Variables.action=revoke">
	<THEN>
				<table class="width-outer-70" cellspacing="0" cellpadding="0" border="0">
					<tr><td>
						<span class="title-text"><XLAT.STREAM KEY="dvin/UI/Admin/DisableAssetTypesForclientapp"/></span>
					</td></tr>
					<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/TitleBar"/>
				</table>
				<IF COND="IsVariable.ContCategory=true">
				<THEN>
					<STRINGLIST NAME="DisableAssetType" STR="Variables.ContCategory" DELIM=";"/>
					<LOOP LIST="DisableAssetType">

						<ASSETTYPE.LOAD  NAME="atype" FIELD="assettype" VALUE="DisableAssetType.ITEM" />
						<ASSETTYPE.GET NAME="atype" FIELD="description" OUTPUT="atdesc"/>
						<ASSETTYPE.GET NAME="atype" FIELD="assettype" OUTPUT="aType"/>
						<CALLELEMENT NAME="OpenMarket/Xcelerate/Actions/AssetMgt/EnableAssetTypeForClient">
							<ARGUMENT NAME="upcommand" VALUE="DisableAssetType"/>
							<ARGUMENT NAME="assetType" VALUE="Variables.aType"/>
							<ARGUMENT NAME="pubid" VALUE="Variables.pubid"/>
							<ARGUMENT NAME="clientapp" VALUE="Variables.clientapp"/>
						</CALLELEMENT>

						<IF COND="IsError.Variables.errno=true">
						<THEN>
							<XLAT.LOOKUP KEY="dvin/UI/Admin/Error/disablingassettypeatdescerrno"  errno="Variables.errno" atdesc="Variables.atdesc" EVALALL="false" VARNAME="msgtext"/>
							<div class="width-outer-70">
							<CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/ShowMessage">
								<ARGUMENT NAME="severity" VALUE="error"/>
							</CALLELEMENT>
							</div>
						</THEN>					
						<ELSE>
							<XLAT.LOOKUP KEY="dvin/UI/Admin/DisabledassettypeatdescclientappInt" VARNAME="msgtext"/>
							<CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/ShowMessage">
								<ARGUMENT NAME="severity" VALUE="info"/>
							</CALLELEMENT>
						</ELSE>
						</IF>
				
					</LOOP>
				</THEN>
				<ELSE>
					<FONT FACE="Arial, Helvetica" SIZE="2">
						<XLAT.STREAM KEY="dvin/UI/Admin/Noassettypesselected"/><BR/>
					</FONT>
				</ELSE>
				</IF>
				
		<CALLELEMENT NAME="OpenMarket/Xcelerate/Admin/AssetTypeForClientFront">
			<ARGUMENT NAME="action" VALUE="list"/>
			<ARGUMENT NAME="pubid" VALUE="Variables.pubid"/>
			<ARGUMENT NAME="clientapp" VALUE="Variables.clientapp"/>
		</CALLELEMENT>
	</THEN>  
	</IF>  <!--if  action=revoke -->
	
	<PROPERTY.GET PARAM="xcelerate.treeType" INIFILE="futuretense_xcel.ini" VARNAME="proptreetype"/>
	<if  COND="IsElement.OpenMarket/Xcelerate/UIFramework/UpdateTreeVariables.proptreetype=true">
	<then>
		<callelement NAME="OpenMarket/Xcelerate/UIFramework/UpdateTreeVariables.proptreetype">
			<argument NAME="__TreeRefreshKeys__" VALUE="Self:Variables.pubid_Variables.clientapp"/>
		</callelement>		
	</then>
	</if>
	
      <!-- if pagetype=post -->
</FTCS>
