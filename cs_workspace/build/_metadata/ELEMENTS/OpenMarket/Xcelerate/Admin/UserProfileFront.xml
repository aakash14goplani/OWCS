<?xml version="1.0" ?>
<!DOCTYPE FTCS SYSTEM "futuretense_cs.dtd">
<FTCS Version="1.1">
<PROPERTY.GET PARAM="xcelerate.charset" INIFILE="futuretense_xcel.ini" VARNAME="charset"/>
<SETVAR NAME="cs.contenttype" VALUE="text/html; charset=Variables.charset"/>
<!-- 
$Logfile: /VerticalApps/XcelerateC/install/Xcelerate/Populate/ElementCatalog/OpenMarket/Xcelerate/Admin/UserProfileFront.xml $ 

-->

<!--
- Confidential and Proprietary Information of Oracle Corp.
-					All Rights Reserved.
-
- UserProfileFront.xml
-
- DESCRIPTION
-	Allow an administrator to set the profile for users (email and locale preferences)
-
- HISTORY 
-->
<script language="javascript">
    function passwdBox(){
        var obj = document.forms[0];

        if (obj.elements['modifyPassword'].checked == true)
        {
			obj.elements['oldpassword'].disabled = false;
            obj.elements['password'].disabled = false;
            obj.elements['password2'].disabled = false;
        }
        else
        {	
			obj.elements['oldpassword'].disabled = true;
            obj.elements['oldpassword'].value = "";
            obj.elements['password'].disabled = true;
            obj.elements['password'].value = "";
            obj.elements['password2'].disabled = true;
            obj.elements['password2'].value = "";
        }
    }
</script>
<!-- first check to see if the user is logged in or not -->
 <CALLELEMENT NAME="OpenMarket/Xcelerate/Admin/UserProfileCommon"/>
<!-- type is either front or post -->
<!-- java script function to validate the password -->
<script language="javascript">
function validatePassword(form, isLdap)
{ 
	var doSubmit=true;
    if (form.password)
	{ 
		if ( (form.password.value == "") && (form.modifyPassword.checked) )
		{
			alert('You must enter a password.' );
			doSubmit=false;
		}

		if (!form.modifyPassword.checked)
		{	
			form.oldpassword.value = "";
			form.password.value = "";
			form.password2.value = "";
		}		
		else if (form.password.value != form.password2.value)
		{
			window.alert('The second password does not match the original. Please try again.');
			doSubmit=false;
		}
		else if (form.password.value.length > 0 && form.oldpassword.value.length === 0)
		{
			window.alert('The old password must be entered.');
			doSubmit=false;
		}
	}
	
	if (isLdap === true && !form.modifyPassword.checked) {
		doSubmit=false;
		window.alert('The user is not modified to save');
	}
	if (doSubmit)
	{
		form.submit();
	}

	return false;
}
</script>


    <setvar NAME="doform" VALUE="false"/>
	<STRING.ENCODE VARIABLE="username" VARNAME="username" />
	<STRING.ENCODE VARIABLE="userEmail" VARNAME="userEmail" />
	<STRING.ENCODE VARIABLE="cs_imagedir" VARNAME="cs_imagedir"/>
    <if COND="Variables.action=details">
    <then>
	    <table class="width-outer-70" cellspacing="0" cellpadding="0" border="0">
		<tr><td>
			<span class="title-text"><XLAT.STREAM KEY="dvin/UI/Admin/UserProfileManagement"/></span>
		</td></tr>
		<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/TitleBar"/>
		</table>
		
        <USERMANAGER.GETUSERFROMNAME OBJVARNAME="myUserObj" USERNAME="Variables.username"/>
        <IF COND="Variables.errno!=-13051">
        <THEN>
          <CCUSER.GETEMAIL NAME="myUserObj"  VARNAME="userEmail"/>
          <CCUSER.GETTIMEZONE NAME="myUserObj"  VARNAME="timezone"/>     
	      <CCUSER.GETLOCALE NAME="myUserObj" VARNAME="userLocalePref"/>    
         </THEN>
        </IF>
		
        <IF COND="IsVariable.userEmail!=true">
        <THEN>
             <setvar NAME="userEmail"  VALUE="Variables.empty"/>
        </THEN>
        </IF>
        <IF COND="IsVariable.timezone!=true">
        <THEN>
             <setvar NAME="timezone"  VALUE="Variables.empty"/>
        </THEN>
        </IF>
        <IF COND="IsVariable.userLocalePref!=true">
        <THEN>
             <setvar NAME="userLocalePref"  VALUE="Variables.empty"/>
        </THEN>
        </IF>
 	<table class="width-outer-30 margin-top-zero" BORDER="0" CELLSPACING="0" CELLPADDING="0">
	<tr><td>
		<table class="width-inner-100" cellpadding="0" cellspacing="0" border="0" bgcolor="#ffffff">
			<tr>
				<td class="form-label-text" colspan="3">
						<table border="0" cellpadding="0" cellspacing="0">
						<tr>
							<td>
								<ics.encode base="ContentServer" session="true" output="inspectURL">
									<ics.argument name="pagename" value="OpenMarket/Xcelerate/Admin/UserProfileFront"/>
									<ics.argument name="action" value="details"/>
									<ics.argument name="username" value="Variables.username"/>
									<ics.argument name="manageprofile" value="Variables.manageprofile"/>
								</ics.encode>
								<XLAT.LOOKUP KEY="dvin/Common/Inspect" VARNAME="_XLAT_" ESCAPE="true"/>
								<XLAT.LOOKUP KEY="dvin/UI/Admin/InspectThisUserProfile" VARNAME="_ALT_"/>
								<A HREF="Variables.inspectURL" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true" REPLACEALL="Variables.inspectURL,Variables._XLAT_"><img height="14" width="14" hspace="2" src="Variables.cs_imagedir/graphics/common/icon/iconInspectContentUp.gif"  border="0" alt="Variables._ALT_" REPLACEALL="Variables.cs_imagedir,Variables._ALT_"/></A>
							</td>
							<td>
								<A HREF="Variables.inspectURL" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true" REPLACEALL="Variables.inspectURL,Variables._XLAT_"><span class="action-text"><XLAT.STREAM KEY="dvin/Common/Inspect"/></span></A>
							</td>
							<td>&nbsp;&nbsp;&nbsp;&nbsp;</td>
							<td>
								<ics.encode base="ContentServer" session="true" output="editURL">
									<ics.argument name="pagename" value="OpenMarket/Xcelerate/Admin/UserProfileFront"/>
									<ics.argument name="action" value="edit"/>
									<ics.argument name="username" value="Variables.username"/>
									<ics.argument name="manageprofile" value="Variables.manageprofile"/>
								</ics.encode>
								<XLAT.LOOKUP KEY="dvin/Common/Edit" VARNAME="_XLAT_" ESCAPE="true"/>
								<XLAT.LOOKUP KEY="dvin/UI/Admin/EditThisUserProfile" VARNAME="_ALT_"/>
								<A HREF="Variables.editURL" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true" REPLACEALL="Variables.editURL,Variables._XLAT_"><img height="14" width="14" src="Variables.cs_imagedir/graphics/common/icon/iconEditContentUp.gif" hspace="2" border="0" alt="Variables._ALT_" REPLACEALL="Variables.cs_imagedir,Variables._ALT_"/></A>
							</td>
							<td>
								<A HREF="Variables.editURL" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true" REPLACEALL="Variables.editURL,Variables._XLAT_"><span class="action-text"><XLAT.STREAM KEY="dvin/Common/Edit"/></span></A>
							</td>

							<td>&nbsp;&nbsp;&nbsp;&nbsp;</td>
								<XLAT.LOOKUP KEY="dvin/Common/Delete" VARNAME="_XLAT_" ESCAPE="true"/>
								<XLAT.LOOKUP KEY="dvin/UI/Admin/DeleteThisUserProfile" VARNAME="_ALT_"/>
							<if COND="Variables.manageprofile=true">
							<then>
							    <td>
								<img height="14" width="14" src="Variables.cs_imagedir/graphics/common/icon/iconDeleteContentUp.gif" hspace="2" border="0" alt="Variables._ALT_" REPLACEALL="Variables.cs_imagedir,Variables._ALT_"/>
								</td>
							    <td>
							    <span class="action-text"><XLAT.STREAM KEY="dvin/Common/Delete"/></span>
							   </td>
							</then>
							<else>
							    <td>
								<ics.encode base="ContentServer" session="true" output="deleteURL">
									<ics.argument name="pagename" value="OpenMarket/Xcelerate/Admin/UserProfileFront"/>
									<ics.argument name="action" value="confirmdelete"/>
									<ics.argument name="username" value="Variables.username"/>
								</ics.encode>
								<A HREF="Variables.deleteURL" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true" REPLACEALL="Variables.deleteURL,Variables._XLAT_"><img height="14" width="14" src="Variables.cs_imagedir/graphics/common/icon/iconDeleteContentUp.gif" hspace="2" border="0" alt="Variables._ALT_" REPLACEALL="Variables.cs_imagedir,Variables._ALT_"/></A>
								</td>
							  <td>
								<A HREF="Variables.deleteURL" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true" REPLACEALL="Variables.deleteURL,Variables._XLAT_"><span class="action-text"><XLAT.STREAM KEY="dvin/Common/Delete"/></span></A>
							 </td>
								</else>
								</if>

							<td>&nbsp;&nbsp;&nbsp;&nbsp;</td>

						</tr>
						</table>
				</td>
			</tr>
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
			<tr>
				<td class="form-label-text">
					<XLAT.STREAM KEY="dvin/UI/UserName"/>:
				</td>
				<td class="form-inset">
						<STRING.STREAM VALUE="Variables.username"/>
				</td><td></td>
			</tr>
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
			<tr>
				<td class="form-label-text">
					<XLAT.STREAM KEY="dvin/Common/Email"/>:
				</td>
				<td class="form-inset">
						<STRING.STREAM VALUE="Variables.userEmail"/>
				</td><td></td>
			</tr>
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
			<tr>
				<td class="form-label-text">
					<XLAT.STREAM KEY="dvin/Common/LocalePreference"/>:
				</td>
				<td class="form-inset">
						<!-- get list of available server locales -->
						<IF COND="IsVariable.userLocalePref=true">
						<THEN>
							<SETVAR NAME="tablename" VALUE="LocaleMap"/>
							<CALLELEMENT NAME="OpenMarket/Xcelerate/Util/validateFields">
								<ARGUMENT NAME="columnvalue" VALUE="Variables.userLocalePref"/>
								<ARGUMENT NAME="type" VALUE="String"/>
							</CALLELEMENT>
							<IF COND="Variables.validatedstatus=true">
							<THEN>
								<EXECSQL SQL="SELECT * FROM LocaleMap WHERE id='Variables.userLocalePref'" LIST="lUserPref"/>
							</THEN>
							</IF>
							<if COND="lUserPref.#numRows!=0">
							<then>
								<STRING.STREAM LIST="lUserPref" COLUMN="language"/>
							</then>
							<else>
								<XLAT.STREAM KEY="dvin/UI/Admin/Nopreference"/>
							</else>
							</if>
						</THEN>
						<ELSE>
							<XLAT.STREAM KEY="dvin/UI/Admin/Nopreference"/>
						</ELSE>
						</IF>
				</td><td><BR /></td>
			</tr> 
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
			<tr>
				<td class="form-label-text">
					<XLAT.STREAM KEY="dvin/Common/TimeZone"/>:
				</td>
				<td class="form-inset">
					<STRING.STREAM VALUE="Variables.timezone"/>
				</td><td></td>
			</tr>
			</table>
	</td></tr>
</table>
     
    </then>
    </if>

        <if COND="Variables.action=edit">
        <then>
             <USERMANAGER.GETUSERFROMNAME OBJVARNAME="myUserObj" USERNAME="Variables.username"/>
            <IF COND="Variables.errno!=-13051">
            <THEN>
                  <CCUSER.GETEMAIL NAME="myUserObj"  VARNAME="userEmail"/>
                  <CCUSER.GETTIMEZONE NAME="myUserObj"  VARNAME="timezone"/>
				  <CCUSER.GETLOCALE NAME="myUserObj" VARNAME="userLocalePref"/>         
                   <IF COND="IsVariable.userEmail!=true">
                    <THEN>
                         <setvar NAME="userEmail"  VALUE="Variables.empty"/>
                    </THEN>
                    </IF>
                    <IF COND="IsVariable.timezone!=true">
                    <THEN>
                         <setvar NAME="timezone"  VALUE="Variables.empty"/>
                    </THEN>
                    </IF>
            </THEN>
            </IF>
 
    <table class="width-outer-70" cellspacing="0" cellpadding="0" border="0">
	<tr><td>
		<span class="title-text"><XLAT.STREAM KEY="dvin/UI/Admin/EditUserProfile"/></span>
	</td></tr>
	<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/TitleBar"/>
	</table>
    
    <table class="width-outer-30" BORDER="0" CELLSPACING="0" CELLPADDING="0">
	<tr><td>
		<table  cellpadding="0" cellspacing="0" border="0" bgcolor="#ffffff">
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
			<tr>
				<td class="form-label-text">
					<XLAT.STREAM KEY="dvin/UI/UserName"/>:
				</td>
				<td class="form-inset">
                    	<INPUT TYPE="HIDDEN" NAME="username" VALUE="Variables.username" REPLACEALL="Variables.username"/>
                 		<STRING.STREAM VALUE="Variables.username"/>
				</td><td><BR /></td>
			</tr>
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
			
			<!-- bug 14403558: for LDAP install certain fields on user profile screen are not supported -->
			<ICS.GETPROPERTY NAME="cs.manageUser" OUTPUT="cs_manageuser"/>
			<STRING.LENGTH VALUE="Variables.cs_manageuser" VARNAME="stringLength" />
			<IF COND="Variables.stringLength=0">
			<THEN>
				<SETVAR NAME="isLdap" VALUE="false" /> 
			</THEN>
			<ELSE>
				<SETVAR NAME="isLdap" VALUE="true" />
			</ELSE>
			</IF>
			
			<tr>
				<td class="form-label-text">
					<XLAT.STREAM KEY="dvin/Common/Email"/>:
				</td>
				<td class="form-inset">
						<IF COND="Variables.isLdap=true">
						<THEN>
							<INPUT TYPE="TEXT" SIZE="32" MAXLENGTH="64" NAME="email" VALUE="Variables.userEmail" REPLACEALL="Variables.userEmail" disabled="disabled" />
						</THEN>
						<ELSE>
							<INPUT TYPE="TEXT" SIZE="32" MAXLENGTH="64" NAME="email" VALUE="Variables.userEmail" REPLACEALL="Variables.userEmail" />
						</ELSE>
						</IF>
				</td><td><BR /></td>
			</tr>
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
			<tr>
				<td class="form-label-text">
					<XLAT.STREAM KEY="dvin/Common/LocalePreference"/>:
				</td>
				<td class="form-inset">
                   	<PROPERTY.GET PARAM="xcelerate.localeattr" INIFILE="futuretense_xcel.ini" VARNAME="proplocaleattr"/>
			<IF COND="Variables.proplocaleattr=Variables.empty">
			<THEN>
				<XLAT.STREAM KEY="dvin/UI/Admin/Error/PreferenceNotEnabled"/>
			</THEN>
			<ELSE>
            <SETVAR NAME="tablename" VALUE="LocaleMap"/>
				<EXECSQL SQL="SELECT * FROM LocaleMap ORDER BY language" LIST="lServerLocales"/>
				<IF COND="Variables.isLdap=true">
				<THEN>
					<SELECT NAME="selectedLocale" SIZE="1" DISABLED="disabled">
		 				<OPTION VALUE="None"><XLAT.STREAM KEY="dvin/UI/Admin/Nopreference"/></OPTION>
						<LOOP LIST="lServerLocales">
							<STRING.ENCODE LIST="lServerLocales" COLUMN="id" VARNAME="lServerLocalesid"/>
							<IF COND="lServerLocales.id=Variables.userLocalePref">
							<THEN>
								<OPTION VALUE="Variables.lServerLocalesid" SELECTED="yes" REPLACEALL="Variables.lServerLocalesid">
								<STRING.STREAM LIST="lServerLocales" COLUMN="language"/>
								</OPTION>
							</THEN>
							<ELSE>
								<OPTION VALUE="Variables.lServerLocalesid" REPLACEALL="Variables.lServerLocalesid">
								<STRING.STREAM LIST="lServerLocales" COLUMN="language"/>
								</OPTION>
							</ELSE>
							</IF>
						</LOOP>
					</SELECT>
				</THEN>
				<ELSE>
					<SELECT NAME="selectedLocale" SIZE="1">
		 				<OPTION VALUE="None"><XLAT.STREAM KEY="dvin/UI/Admin/Nopreference"/></OPTION>
						<LOOP LIST="lServerLocales">
						<STRING.ENCODE LIST="lServerLocales" COLUMN="id" VARNAME="lServerLocalesid"/>
							<IF COND="lServerLocales.id=Variables.userLocalePref">
							<THEN>
								<OPTION VALUE="Variables.lServerLocalesid" SELECTED="yes" REPLACEALL="Variables.lServerLocalesid">
								<STRING.STREAM LIST="lServerLocales" COLUMN="language"/>
								</OPTION>
							</THEN>
							<ELSE>
								<OPTION VALUE="Variables.lServerLocalesid" REPLACEALL="Variables.lServerLocalesid">
								<STRING.STREAM LIST="lServerLocales" COLUMN="language"/>
								</OPTION>
							</ELSE>
							</IF>
						</LOOP>
					</SELECT>
				</ELSE>
				</IF>
			</ELSE>
			</IF>

				</td><td><BR /></td>
			</tr>
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
			<tr>
				<td class="form-label-text">
					<XLAT.STREAM KEY="dvin/Common/TimeZone"/>:
				</td>
				<td class="form-inset">
					<CALLELEMENT NAME="OpenMarket/Xcelerate/Admin/User/ShowAvailableTimeZones" >
						<ARGUMENT NAME="prevSelectedTimeZone" VALUE="Variables.timezone"/>
					</CALLELEMENT>
				</td><td></td>
			</tr>
			<if cond="Variables.manageprofile=true">
			<then>
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
			<tr>
				<td class="form-label-text">
					<XLAT.STREAM KEY="dvin/Common/Roles"/>:
				</td>
				<td class="form-inset">
						<STRINGLIST NAME="userRoles" STR="SessionVariables.currentpubACLs" DELIM=","/>
                    	<LOOP LIST="userRoles">
						 <STRING.STREAM VALUE="userRoles.ITEM"/> <BR/>
						 </LOOP>
				</td><td><BR /></td>
			</tr>
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
			<tr>
				<td class="form-label-text">
					<XLAT.STREAM KEY="dvin/AdminForms/ModifyPassword"/>:
				</td>
				<td class="form-inset">
						<USERMANAGER.GETLOGINUSER VARNAME="userid"/>
						<STRING.ENCODE VARIABLE="userid" VARNAME="userid"/>
						<INPUT TYPE="hidden" NAME="userid" VALUE="Variables.userid" REPLACEALL="Variables.userid" />
                    	<INPUT TYPE="checkbox" NAME="modifyPassword" onclick="passwdBox()" />
						<INPUT TYPE="hidden" NAME="manageprofile" VALUE="true" />
				</td><td><BR /></td>
			</tr>
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
			<tr>
				<td class="form-label-text">
					<XLAT.STREAM KEY="fatwire/admin/common/fields/OldPassword"/> :
				</td>
				<td class="form-inset">
                    	<INPUT TYPE="PASSWORD" NAME="oldpassword" SIZE="32" VALUE="" disabled="true" />
				</td><td><BR /></td>
			</tr>
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
			<tr>
				<td class="form-label-text">
					<XLAT.STREAM KEY="dvin/UI/Password"/> :
				</td>
				<td class="form-inset">
                    	<INPUT TYPE="PASSWORD" NAME="password" SIZE="32" VALUE="" disabled="true" />
				</td><td><BR /></td>
			</tr>
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
			<tr>
				<td class="form-label-text">
					<XLAT.STREAM KEY="dvin/AdminForms/ReenterPassword"/>:
				</td>
				<td class="form-inset">
                    	<INPUT TYPE="PASSWORD" NAME="password2" SIZE="32" VALUE="" disabled="true"/>
				</td><td><BR /></td>
			</tr>
			</then>
			</if>
			<ics.encode base="ContentServer" session="true" output="UserInspectURL">
			<ics.argument name="pagename" value="OpenMarket/Xcelerate/Admin/UserProfileFront"/>
			<ics.argument name="action" value="details"/>
			<ics.argument name="username" value="Variables.username"/>
			<ics.argument name="manageprofile" value="Variables.manageprofile"/>
			</ics.encode>
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/FooterBar"/>
			<TR>
				<TD class="form-label-text"></TD><TD class="form-inset">
				<XLAT.LOOKUP KEY="dvin/UI/Cancel" VARNAME="_XLAT_" ESCAPE="true"/>
				<A HREF="Variables.UserInspectURL" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true" REPLACEALL="Variables.UserInspectURL,Variables._XLAT_"><CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/Cancel"/></CALLELEMENT></A>
				<XLAT.LOOKUP KEY="dvin/UI/Save" VARNAME="_XLAT_" ESCAPE="true"/>
				<IF COND="Variables.isLdap=true">
				<THEN>
					<if cond="Variables.manageprofile=true">
					<then>
						<A HREF="javascript:void(0);" onclick="return validatePassword(document.forms['AppForm'], Variables.isLdap);" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true;" REPLACEALL="Variables._XLAT_, Variables.isLdap"><CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/Save"/></CALLELEMENT></A>
					</then>
					</if>					
				</THEN>
				<ELSE>
					<A HREF="javascript:void(0);" onclick="return validatePassword(document.forms['AppForm'], Variables.isLdap);" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true;" REPLACEALL="Variables._XLAT_,Variables.isLdap"><CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/Save"/></CALLELEMENT></A>
				</ELSE>
				</IF>
				
				</TD>
			</TR>
			
		</table>

	</td></tr>
</table>

<INPUT TYPE="hidden" NAME="pagename" VALUE="OpenMarket/Xcelerate/Admin/UserProfilePost"/>
<INPUT TYPE="hidden" NAME="action" VALUE="edit"/>

	
	
    </then>
    </if>    

	
	<!-- ------------------ action=confirmdelete --------------------- -->
	<IF COND="Variables.action=confirmdelete">
	<THEN>
    	<table class="width-outer-70" cellspacing="0" cellpadding="0" border="0">
			<tr><td>
				<span class="title-text"><XLAT.STREAM KEY="dvin/UI/Admin/UserProfileManagement"/></span>
			</td></tr>
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/TitleBar"/>
		</table>
    	
        <USERMANAGER.GETUSERFROMNAME OBJVARNAME="myUserObj" USERNAME="Variables.username"/>
        <IF COND="Variables.errno!=-13051">
        <THEN>
              <CCUSER.GETEMAIL NAME="myUserObj"  VARNAME="userEmail"/>     
              <CCUSER.GETTIMEZONE NAME="myUserObj"  VARNAME="timezone"/>
              <CCUSER.GETLOCALE NAME="myUserObj" VARNAME="userLocalePref"/>  
         </THEN>
        </IF>

        
        <IF COND="IsVariable.userEmail!=true">
        <THEN>
             <setvar NAME="userEmail"  VALUE="Variables.empty"/>
        </THEN>
        </IF>
        <IF COND="IsVariable.timezone!=true">
        <THEN>
             <setvar NAME="timezone"  VALUE="Variables.empty"/>
        </THEN>
        </IF>
        <IF COND="IsVariable.userLocalePref!=true">
        <THEN>
             <setvar NAME="userLocalePref"  VALUE="Variables.empty"/>
        </THEN>
        </IF>

		<XLAT.LOOKUP KEY="dvin/UI/Admin/DeleteUserProfileWarning" ENCODE="false" VARNAME="msgtext"/>
		<div class="width-outer-70">
		<CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/ShowMessage">
			<ARGUMENT NAME="msgtext" VALUE="Variables.msgtext"/>
			<ARGUMENT NAME="severity" VALUE="warning"/>
		</CALLELEMENT>					
 		</div>
 	
	 	<table class="width-outer-30" BORDER="0" CELLSPACING="0" CELLPADDING="0">
		<tr><td>
			<table class="width-inner-100" cellpadding="0" cellspacing="0" border="0" bgcolor="#ffffff">	
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
			<tr>
				<td class="form-label-text">
					<XLAT.STREAM KEY="dvin/UI/UserName"/>:
				</td>
				<td class="form-inset">
						<STRING.STREAM VALUE="Variables.username"/>
				</td><td></td>
			</tr>
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
			<tr>
				<td class="form-label-text">
					<XLAT.STREAM KEY="dvin/Common/Email"/>:
				</td>
				<td class="form-inset">
						<STRING.STREAM VALUE="Variables.userEmail"/>
				</td><td></td>
			</tr>
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
			<tr>
			<td class="form-label-text">
				<XLAT.STREAM KEY="dvin/Common/LocalePreference"/>:
			</td>
			<td class="form-inset">
					<!-- get list of available server locales -->
					<IF COND="IsVariable.userLocalePref=true">
					<THEN>
						<SETVAR NAME="tablename" VALUE="LocaleMap"/>
						<CALLELEMENT NAME="OpenMarket/Xcelerate/Util/validateFields">
							<ARGUMENT NAME="columnvalue" VALUE="Variables.userLocalePref"/>
							<ARGUMENT NAME="type" VALUE="String"/>
						</CALLELEMENT>
						<IF COND="Variables.validatedstatus=true">
						<THEN>
							<EXECSQL SQL="SELECT * FROM LocaleMap WHERE id='Variables.userLocalePref'" LIST="lUserPref"/>
						</THEN>
						</IF>
						<if COND="lUserPref.#numRows!=0">
						<then>
							<STRING.STREAM LIST="lUserPref" COLUMN="language"/>
						</then>
						<else>
							<XLAT.STREAM KEY="dvin/UI/Admin/Nopreference"/>
						</else>
						</if>
					</THEN>
					<ELSE>
						<XLAT.STREAM KEY="dvin/UI/Admin/Nopreference"/>
					</ELSE>
					</IF>
			</td><td><BR /></td>
			</tr>
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
			<tr>
				<td class="form-label-text">
					<XLAT.STREAM KEY="dvin/Common/TimeZone"/>:
				</td>
				<td class="form-inset">
					<STRING.STREAM VALUE="Variables.timezone"/>
				</td><td></td>
			</tr>
			<ics.encode base="ContentServer" session="true" output="inspectURL">
			<ics.argument name="pagename" value="OpenMarket/Xcelerate/Admin/UserProfileFront"/>
			<ics.argument name="action" value="details"/>
			<ics.argument name="username" value="Variables.username"/>
			</ics.encode>
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/FooterBar"/>
			<TR>
				<TD class="form-label-text"></TD><TD class="form-inset">

				<XLAT.LOOKUP KEY="dvin/UI/Cancel" VARNAME="_XLAT_" ESCAPE="true"/>
				<A HREF="Variables.inspectURL" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true" REPLACEALL="Variables.inspectURL,Variables._XLAT_"><CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/Cancel"/></CALLELEMENT></A>
				<XLAT.LOOKUP KEY="dvin/UI/Admin/DeleteThisUserProfile" VARNAME="_XLAT_" ESCAPE="true"/>
				<A HREF="javascript:void(0);" onclick="document.forms['AppForm'].submit();return false;" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true;" REPLACEALL="Variables._XLAT_"><CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/DeleteUserProfile"/></CALLELEMENT></A>
				</TD>
			</TR>
		</table>
	</td></tr>
	</table>
	<INPUT TYPE="hidden" NAME="pagename" VALUE="OpenMarket/Xcelerate/Admin/UserProfilePost"/>
	<INPUT TYPE="hidden" NAME="username" VALUE="Variables.username" REPLACEALL="Variables.username"/>
	<INPUT TYPE="hidden" NAME="action" VALUE="delete"/>
	
	
	</THEN>
	</IF>



</FTCS>
