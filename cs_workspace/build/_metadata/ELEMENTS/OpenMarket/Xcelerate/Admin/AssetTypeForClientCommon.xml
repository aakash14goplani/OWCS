<?xml version="1.0" ?>
<!DOCTYPE FTCS SYSTEM "futuretense_cs.dtd">

<FTCS Version="1.1">
<!--
 /VerticalApps/XcelerateD/install/Xcelerate/Populate/ElementCatalog/OpenMarket/Xcelerate/Admin/AssetTypeForClientCommon.xml 

-->

<!--
 Confidential and Proprietary Information of Open Market, Inc.
					All Rights Reserved.

 DESCRIPTION
	Admin control of enabling or disabling one more assettypes
     for Word Integration

 INPUT
   action - grant/revoke
   pagetype - front/post
   clientapp -  MSWord  
-->



<!-- will be a parameter for future applications  -->

<XLAT.LOOKUP KEY="dvin/UI/Admin/Variables.clientapp" VARNAME="NiceClientName"/>
<STRING.ENCODE VARIABLE="clientapp" VARNAME="clientapp"/>
<!-- type is either front or post -->
<IF COND="Variables.action=list">
<THEN>
<table class="width-outer-70" cellspacing="0" cellpadding="0" border="0">
	<tr><td>
	<PUBLICATION.LOAD NAME="publication" OBJECTID="Variables.pubid"/>
	<PUBLICATION.SCATTER NAME="publication" PREFIX="Publication"/>
	<SETVAR NAME="sitename" VALUE="Variables.Publication:name"/>
<span class="title-text"><XLAT.STREAM KEY="dvin/UI/Admin/clientappconfigurationforsite"/>:
<XLAT.LOOKUP KEY="dvin/UI/Admin/InspectThisSite" VARNAME="_XLAT_" ESCAPE="true"/>
<SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Admin/SiteFront" outstring="urlsitefront">
    <satellite.argument name="cs_environment" value="Variables.cs_environment"/>
    <satellite.argument name="cs_formmode" value="Variables.cs_formmode"/>
                                         <satellite.argument name="action" value="details"/>
                                         <satellite.argument name="pubid" value="Variables.pubid"/>
                                          </SATELLITE.LINK>
<A HREF="Variables.urlsitefront" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true" REPLACEALL="Variables.urlsitefront,Variables._XLAT_"><IMG src="Variables.cs_imagedir/graphics/common/icon/doubleArrow.gif" WIDTH="15" HEIGHT="12" BORDER="0" REPLACEALL="Variables.cs_imagedir"/><STRING.STREAM VALUE="Variables.sitename"/></A></span>
	</td></tr>
	<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/TitleBar"/>
</table>
		<EXTERNALCLIENTSMANAGER.GetEnabledAssetTypesForAClient SITE="Variables.pubid" LISTVARNAME="EnabledAssetTypes" CLIENTAPP="Variables.clientapp"/>
		<IF COND="EnabledAssetTypes.#numRows=0">
		<THEN>
			<XLAT.LOOKUP KEY="dvin/UI/Admin/Error/Noassettypesenabledforclientapp" VARNAME="msgtext"/>
			<div class="width-outer-70">
			<CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/ShowMessage">
				<ARGUMENT NAME="severity" VALUE="info"/>
			</CALLELEMENT>
			</div>
			<SETVAR NAME="showDisable" VALUE="false"/>
		</THEN>
		<ELSE>
			<SETVAR NAME="showDisable" VALUE="true"/>
			<table class="width-outer-30" BORDER="0" CELLSPACING="0" CELLPADDING="0">
				<tr>
					<td></td><td class="tile-dark" HEIGHT="1"><IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td><td></td>
				</tr>
				<tr>
					<td class="tile-dark" VALIGN="top" WIDTH="1"><IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>
					<td >
						<table class="width-inner-100" cellpadding="0" cellspacing="0" border="0" bgcolor="#ffffff"><tr><td colspan="9" class="tile-highlight"><IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td></tr>
							<tr><td class="tile-a" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;</td>
					            <td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;</td>
					            <td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;</td><td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir"><DIV class="new-table-title"><XLAT.STREAM KEY="dvin/AT/Common/Name"/></DIV></td>
					            <td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;&nbsp;&nbsp;&nbsp;</td><td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir"><DIV class="new-table-title"><XLAT.STREAM KEY="dvin/Common/Subtype"/></DIV></td>
					            <td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;&nbsp;&nbsp;&nbsp;</td><td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir"><DIV class="new-table-title"><XLAT.STREAM KEY="dvin/UI/Admin/Client"/></DIV></td>
								<td class="tile-c" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;</td>
							</tr>
							<tr><td colspan="9" class="tile-dark"><IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td></tr>
							<!-- Loop over all search results. -->
					   			<setvar NAME="rowStyle" VALUE="tile-row-normal"/>
								<SETVAR NAME="separatorLine" VALUE="0"/>
	
							<LOOP LIST="EnabledAssetTypes">
									<IF COND="Variables.separatorLine=1">
									<THEN>
										<!--<tr>
											<td colspan="9" class="light-line-color"><img height="1" width="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>
										</tr>-->
									</THEN>
									</IF>


					<ASSET.GETLEGALSUBTYPES TYPE="EnabledAssetTypes.assettype" LIST="subList" PUBID="Variables.pubid"/>
					<SETVAR NAME="errno" VALUE="0"/>
					<IF COND="IsList.subList=true">
					<THEN>
						<IF COND="subList.#numRows!=0">
						<THEN>

						<SETVAR NAME="separatorLine" VALUE="1"/>
						
						<LOOP LIST="subList">
							<tr class="Variables.rowStyle"  REPLACEALL="Variables.rowStyle"><td><BR /></td>
							<td>
							<SETVAR NAME="ConfigPage" VALUE="AssetTypeClientConfigFront"/>
							<IF COND="Variables.clientapp=CSDocLink">
							<THEN>
								<SETVAR NAME="ConfigPage" VALUE="AssetTypeDocLinkConfigFront"/>
							</THEN>
							</IF>
							<XLAT.LOOKUP KEY="dvin/Common/Inspect" VARNAME="_XLAT_" ESCAPE="true"/>
                            <SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Admin/Variables.ConfigPage" outstring="urlconfigpage">
                                <satellite.argument name="cs_environment" value="Variables.cs_environment"/>
                                <satellite.argument name="cs_formmode" value="Variables.cs_formmode"/>
                                         <satellite.argument name="action" value="list"/>
                                         <satellite.argument name="clientid" value="EnabledAssetTypes.id"/>
                                         <satellite.argument name="subtype" value="subList.subtype"/>
                                          </SATELLITE.LINK>
							<A HREF="Variables.urlconfigpage" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true" REPLACEALL="Variables.urlconfigpage,Variables._XLAT_,Variables.ConfigPage"><img height="14" width="14" hspace="2" vspace="4" src="Variables.cs_imagedir/graphics/common/icon/iconInspectContent.gif"  border="0" alt="Variables._XLAT_" title="Variables._XLAT_" REPLACEALL="Variables.cs_imagedir,Variables._XLAT_"/></A>
							<XLAT.LOOKUP KEY="dvin/Common/Edit" VARNAME="_XLAT_" ESCAPE="true"/>
                            <SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Admin/Variables.ConfigPage" outstring="urlconfigpage">
                                <satellite.argument name="cs_environment" value="Variables.cs_environment"/>
                                <satellite.argument name="cs_formmode" value="Variables.cs_formmode"/>
                                         <satellite.argument name="action" value="edit"/>
                                         <satellite.argument name="clientid" value="EnabledAssetTypes.id"/>
                                         <satellite.argument name="subtype" value="subList.subtype"/>
                                          </SATELLITE.LINK>
							<A HREF="Variables.urlconfigpage" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true" REPLACEALL="Variables.urlconfigpage,Variables._XLAT_,Variables.ConfigPage"><img height="14" width="14" hspace="2" vspace="4" src="Variables.cs_imagedir/graphics/common/icon/iconEditContent.gif"  border="0" alt="Variables._XLAT_" title="Variables._XLAT_"  REPLACEALL="Variables.cs_imagedir,Variables._XLAT_"/></A>

							</td>
					                <td><BR /></td><td VALIGN="TOP" NOWRAP="NOWRAP" ALIGN="LEFT">
					                    <DIV class="small-text-inset"><XLAT.LOOKUP KEY="dvin/Common/Inspect" VARNAME="_XLAT_" ESCAPE="true"/>
										<SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Admin/Variables.ConfigPage" outstring="urlconfigpage">
                                            <satellite.argument name="cs_environment" value="Variables.cs_environment"/>
                                            <satellite.argument name="cs_formmode" value="Variables.cs_formmode"/>
                                         <satellite.argument name="action" value="list"/>
                                         <satellite.argument name="clientid" value="EnabledAssetTypes.id"/>
                                         <satellite.argument name="subtype" value="subList.subtype"/>
                                          </SATELLITE.LINK>
                                        <A HREF="Variables.urlconfigpage" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true" REPLACEALL="Variables.urlconfigpage,Variables._XLAT_,Variables.ConfigPage"><STRING.STREAM VALUE="EnabledAssetTypes.assettype"/></A>
										</DIV>
									</td>
									<td><BR /></td><td VALIGN="TOP" ALIGN="LEFT">
					                    <DIV class="small-text-inset">
												<if COND="subList.subtype=Variables.empty">
												<then>
													<XLAT.STREAM KEY="dvin/UI/Util/Standardnosubtype"/>
												</then>
												<else>
													<STRING.STREAM LIST="subList" COLUMN="subtype"/>
												</else>
												</if>
					                    </DIV>
					                 </td>
					                 <td><BR /></td>
					                 <td>
					                 <DIV class="small-text-inset">
					                 	<STRING.STREAM VALUE="EnabledAssetTypes.clientapp"/>
					                 	</DIV>
					                 	</td>
					                 	<td><BR /></td></tr>
										<!--<tr>
											<td colspan="9" class="light-line-color"><img height="1" width="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>
										</tr>-->					                 	
								<IF COND="Variables.rowStyle=tile-row-normal">
					            <THEN><SETVAR NAME="rowStyle" VALUE="tile-row-highlight"/>
					            </THEN>
					            <ELSE><SETVAR NAME="rowStyle" VALUE="tile-row-normal"/>
					            </ELSE>
					            </IF>

						</LOOP>
						<SETVAR NAME="separatorLine" VALUE="0"/>
						</THEN>

						</IF>
					</THEN>
					</IF>



							</LOOP>
							</table>
						</td>
						<td class="tile-dark" VALIGN="top" WIDTH="1"><IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>
						</tr>
					<tr>
					<td colspan="3" class="tile-dark" VALIGN="TOP" HEIGHT="1"><IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>
					</tr>
					<tr>
					<td></td><td background="Variables.cs_imagedir/graphics/common/screen/shadow.gif" REPLACEALL="Variables.cs_imagedir"><IMG WIDTH="1" HEIGHT="5" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td><td></td>
					</tr>
					</table> 
			</ELSE>
			</IF>
<div class="width-outer-70">
    <SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Admin/AssetTypeClientFront" outstring="clientappURL">
        <satellite.argument name="cs_environment" value="Variables.cs_environment"/>
        <satellite.argument name="cs_formmode" value="Variables.cs_formmode"/>
                                         <satellite.argument name="clientapp" value="Variables.clientapp"/>
                                         <satellite.argument name="pubid" value="Variables.pubid"/>
                                         <satellite.argument name="action" value="grant"/>
                                          </SATELLITE.LINK>
<A HREF="Variables.clientappURL" REPLACEALL="Variables.clientappURL"><CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/EnableAssetTypes"/></CALLELEMENT></A>
<IF COND="Variables.showDisable=true"><THEN>
                                          <SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Admin/AssetTypeClientFront" outstring="clientappURL">
                                              <satellite.argument name="cs_environment" value="Variables.cs_environment"/>
                                              <satellite.argument name="cs_formmode" value="Variables.cs_formmode"/>
                                         <satellite.argument name="clientapp" value="Variables.clientapp"/>
                                         <satellite.argument name="pubid" value="Variables.pubid"/>
                                         <satellite.argument name="action" value="revoke"/>
                                          </SATELLITE.LINK>
                                          <A HREF="Variables.clientappURL" REPLACEALL="Variables.clientappURL"><CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/DisableAssetTypes"/></CALLELEMENT></A></THEN></IF>

<!-- we don't want to execute grant/revoke, so we'll set the pagetype to something other than front or post -->
<SETVAR NAME="pagetype" VALUE="list"/>
</div>
</THEN>
</IF>


</FTCS>
