<?xml version="1.0" ?>
<!DOCTYPE FTCS SYSTEM "futuretense_cs.dtd">
<FTCS Version="1.1">
<!-- OpenMarket/Xcelerate/Admin/AssetSubtypeFront

 INPUT
	Variables.assettype
 Variables.action
 OUTPUT

-->


<CALLELEMENT NAME="OpenMarket/Xcelerate/Admin/AssetSubtypeCommon"/>
<STRING.ENCODE VARIABLE="cs_environment" VARNAME="cs_environment"/>
<STRING.ENCODE VARIABLE="cs_imagedir" VARNAME="cs_imagedir"/>
<STRING.ENCODE VARIABLE="cs_formmode" VARNAME="cs_formmode"/>
<SCRIPT LANGUAGE="JavaScript">
<![CDATA[
function checkfields()
{
	var obj = document.forms[0].elements[0];
    if (dojo.trim(obj.form.elements['subtype'].value).length == 0)
    {
        ]]>
        alert("<XLAT.STREAM KEY="dvin/Assetmaker/SpecifyUniqueName" ESCAPE="true" ENCODE="false"/>");
        <![CDATA[
		obj.form.elements['subtype'].focus();
		return false;
	}
	if ( ( obj.form.elements['subtype'].value.search(/['"?;:&<>]/) != -1 ) ||
       ( obj.form.elements['subtype'].value.match(/^[\s]/) != null ) ) {
	
	//Here means something is wrong, let us figure out what
	
			if ( ( obj.form.elements['subtype'].value.search(/['"?;:&<>]/) != -1 ) ) {
				]]>
				alert("<XLAT.STREAM KEY="dvin/UI/Admin/Error/Invalidcharacterinsubtypename" ESCAPE="true" ENCODE="false"/>");
				<![CDATA[
			}
	
			obj.form.elements['subtype'].focus();
			return false;
	}
					
	if (obj.form.elements['sites'].selectedIndex==-1)
	{
		]]>
		alert("<XLAT.STREAM KEY="dvin/UI/Admin/Error/specifyoneormoresites" ESCAPE="true"/>");
		<![CDATA[
		obj.form.elements['sites'].focus();
		return false;
	}
	return true;
}
]]>
</SCRIPT>



	<!-- get the list of publications for which this asset is enabled -->
	<SETVAR NAME="pubstochoose" VALUE="Variables.empty"/>
	<PUBLICATION.LIST LIST="publist"/>
	<IF COND="publist.#numRows!=0">
	<THEN>
	<!-- get the lsit of publications that this asset type is enabled in -->
		<LOOP LIST="publist">
			<!-- if the asset type enabled in this site? -->
			<PUBLICATION.LOAD NAME="apub" OBJECTID="publist.id"/>
			<PUBLICATION.CHILDREN NAME="apub" LIST="child" OBJECTTYPE="AssetType" OBJECTID="Variables.at:id"/>
			<IF COND="IsError.Variables.errno=false">
			<THEN>
				<IF COND="Variables.pubstochoose=Variables.empty">
				<THEN>
					<SETVAR NAME="pubstochoose" VALUE="publist.id,publist.name"/>
				</THEN>
				<ELSE>
					<SETVAR NAME="pubstochoose" VALUE="Variables.pubstochoose;publist.id,publist.name"/>
				</ELSE>
				</IF>
	  		</THEN>
	 		</IF>
	 	</LOOP>
	 </THEN>
	 </IF>
 
	<IF COND="Variables.action=list">
	<THEN>
	
        <SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Admin/AssetTypeFront" outstring="urlassettypefront">
            <satellite.argument name="cs_environment" value="Variables.cs_environment"/>
            <satellite.argument name="cs_formmode" value="Variables.cs_formmode"/>
                                         <satellite.argument name="action" value="details"/>
                                         <satellite.argument name="assettype" value="Variables.assettype"/>
                                          </SATELLITE.LINK>
		<table class="width-outer-70" cellspacing="0" cellpadding="0" border="0">
			<tr><td>
				<span class="title-text"><XLAT.STREAM KEY="dvin/UI/Admin/SubtypesForAssetType"/>: 
		        <A HREF="Variables.urlassettypefront" REPLACEALL="Variables.urlassettypefront"><IMG src="Variables.cs_imagedir/graphics/common/icon/doubleArrow.gif" WIDTH="15" HEIGHT="12" BORDER="0" REPLACEALL="Variables.cs_imagedir"/><STRING.STREAM VALUE="Variables.at:description"/></A></span>
			</td></tr>
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/TitleBar"/>
		</table>
    	
		<SUBTYPES.GETSUBTYPES LISTVARNAME="Subtypes" ASSETTYPE="Variables.assettype" DISTINCT="true"/>
    	<IF COND="IsList.Subtypes=true">
    	<THEN>
    		
    					
				<table class="width-outer-30" BORDER="0" CELLSPACING="0" CELLPADDING="0">
					<tr>
						<td></td><td class="tile-dark" HEIGHT="1"><IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td><td></td>
					</tr>
					<tr>
						<td class="tile-dark" VALIGN="top" WIDTH="1" NOWRAP="nowrap"><BR /></td>
						<td >
							<table width="100%" cellpadding="0" cellspacing="0" border="0" bgcolor="#ffffff"><tr><td colspan="7" class="tile-highlight"><IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td></tr>
							<tr><td class="tile-a" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;</td>
								<td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;</td>
					            <td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;</td><td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">
                                       <SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Admin/AssetSubtypeFront" outstring="urlassetsubtypefront">
                                           <satellite.argument name="cs_environment" value="Variables.cs_environment"/>
                                            <satellite.argument name="cs_formmode" value="Variables.cs_formmode"/>
                                         <satellite.argument name="action" value="list"/>
                                         <satellite.argument name="assettype" value="Variables.assettype"/>
                                         <satellite.argument name="orderby" value="subtype"/>
                                          </SATELLITE.LINK>
                                       <A HREF="Variables.urlassetsubtypefront" REPLACEALL="Variables.urlassetsubtypefront"><DIV class="new-table-title"><XLAT.STREAM KEY="dvin/Common/Name"/></DIV></A></td>
					            <td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;&nbsp;&nbsp;&nbsp;</td><td class="tile-b" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir"><DIV class="new-table-title"><XLAT.STREAM KEY="dvin/Common/Sites"/></DIV></td>
								<td class="tile-c" background="Variables.cs_imagedir/graphics/common/screen/grad.gif" REPLACEALL="Variables.cs_imagedir">&nbsp;</td>
							</tr>
							<tr><td colspan="7" class="tile-dark"><IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td></tr>
							<!-- Loop over all search results. -->
					   			<setvar NAME="rowStyle" VALUE="tile-row-normal"/>
								<SETVAR NAME="separatorLine" VALUE="0"/>
							<LOOP LIST="Subtypes">

									<IF COND="Variables.separatorLine=1">
									<THEN>
										<tr>
											<!--<td colspan="7" class="light-line-color"><img height="1" width="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>-->
										</tr>
									</THEN>
									</IF>
									<SETVAR NAME="separatorLine" VALUE="1"/>
			
							<tr class="Variables.rowStyle"  REPLACEALL="Variables.rowStyle"><td><BR /></td>
							<td VALIGN="TOP" NOWRAP="NOWRAP" ALIGN="LEFT">
							<XLAT.LOOKUP KEY="dvin/UI/Admin/InspectThisSubtype" VARNAME="alt"/>
							<XLAT.LOOKUP KEY="dvin/Common/Inspect" VARNAME="statustxt" ESCAPE="true"/>
	    <!--construct encoded urls -->
            <ics.encode base="ContentServer" session="true" output="inspect">
                <ics.argument name="pagename" value="OpenMarket/Xcelerate/Admin/AssetSubtypeFront"/>
                <ics.argument name="action" value="details"/>
                <ics.argument name="assettype" value="Variables.assettype"/>
                <ics.argument name="subtype" value="Subtypes.subtype"/>
            </ics.encode>
            <ics.encode base="ContentServer" session="true" output="edit">
                <ics.argument name="pagename" value="OpenMarket/Xcelerate/Admin/AssetSubtypeFront"/>
                <ics.argument name="action" value="edit"/>
                <ics.argument name="assettype" value="Variables.assettype"/>
                <ics.argument name="subtype" value="Subtypes.subtype"/>
            </ics.encode>
            <ics.encode base="ContentServer" session="true" output="delete">
                <ics.argument name="pagename" value="OpenMarket/Xcelerate/Admin/AssetSubtypeFront"/>
                <ics.argument name="action" value="confirmdelete"/>
                <ics.argument name="assettype" value="Variables.assettype"/>
                <ics.argument name="subtype" value="Subtypes.subtype"/>
            </ics.encode>
 								<A HREF="Variables.inspect" onmouseover="window.status='Variables.statustxt';return true;" onmouseout="window.status='';return true" REPLACEALL="Variables.inspect,Variables.statustxt"><img height="14" width="14" hspace="2" vspace="4" src="Variables.cs_imagedir/graphics/common/icon/iconInspectContent.gif"  border="0" alt="Variables.alt" title="Variables.alt"  REPLACEALL="Variables.cs_imagedir,Variables.alt"/></A>

									<XLAT.LOOKUP KEY="dvin/UI/Admin/EditThisSubtype" VARNAME="alt"/>
									<XLAT.LOOKUP KEY="dvin/Common/Edit" VARNAME="statustxt" ESCAPE="true"/>
									<A HREF="Variables.edit" onmouseover="window.status='Variables.statustxt';return true;" onmouseout="window.status='';return true" REPLACEALL="Variables.edit,Variables.statustxt"><img height="14" width="14" hspace="2" vspace="4" src="Variables.cs_imagedir/graphics/common/icon/iconEditContent.gif"  border="0" alt="Variables.alt" title="Variables.alt"  REPLACEALL="Variables.cs_imagedir,Variables.alt"/></A>
									<XLAT.LOOKUP KEY="dvin/Common/Delete" VARNAME="statustxt" ESCAPE="true"/>
									<XLAT.LOOKUP KEY="dvin/UI/Admin/DeleteThisSubtype" VARNAME="alt"/>
									<A HREF="Variables.delete" onmouseover="window.status='Variables.statustxt';return true;" onmouseout="window.status='';return true" REPLACEALL="Variables.delete,Variables.statustxt"><img height="14" width="14" hspace="2" vspace="4" src="Variables.cs_imagedir/graphics/common/icon/iconDeleteContent.gif"  border="0" alt="Variables.alt" title="Variables.alt"  REPLACEALL="Variables.cs_imagedir,Variables.alt"/></A>

							</td>
					                <td><BR /></td><td VALIGN="TOP" NOWRAP="NOWRAP" ALIGN="LEFT">
					                    <DIV class="small-text-inset">
										<XLAT.LOOKUP KEY="dvin/UI/Admin/InspectThisSubtype" VARNAME="alt"/>
										<XLAT.LOOKUP KEY="dvin/Common/Inspect" VARNAME="statustxt" ESCAPE="true"/>
										<A HREF="Variables.inspect" onmouseover="window.status='Variables.statustxt';return true;" onmouseout="window.status='';return true" REPLACEALL="Variables.inspect,Variables.statustxt">
											<IF COND="Subtypes.subtype=Variables.empty">
											<THEN>
												<XLAT.STREAM KEY="dvin/UI/Util/Standardnosubtype"/>
											</THEN>
											<ELSE>
												<STRING.STREAM LIST="Subtypes" COLUMN="subtype"/>
											</ELSE>
											</IF>
										</A>
										</DIV>
									</td>
									<td><BR /></td><td VALIGN="TOP" ALIGN="LEFT">
					                    <DIV class="small-text-inset">
										<SUBTYPES.GETSUBTYPE LISTVARNAME="sites" ASSETTYPE="Variables.assettype" SUBTYPE="Subtypes.subtype"/>
										<LOOP LIST="sites">
		                	  <PUBLICATION.LOAD NAME="pub" OBJECTID="sites.pubid"/>
		                	  <if COND="IsError.Variables.errno=false">
		                	  <then>
		                	  		<PUBLICATION.GET NAME="pub" FIELD="description"/>
		                	  		<STRING.STREAM VALUE="Variables.description"/>
		                	  	</then>
		                	  	<else>
		                	  		<STRING.STREAM VALUE="subtypes.pubid"/>
		                	  	</else>
		                	  	</if><BR />
		                	  	</LOOP>
					                    </DIV>
					                 </td>
					                 	<td><BR /></td></tr>
					            <IF COND="Variables.rowStyle=tile-row-normal">
					            <THEN><SETVAR NAME="rowStyle" VALUE="tile-row-highlight"/>
					            </THEN>
					            <ELSE><SETVAR NAME="rowStyle" VALUE="tile-row-normal"/>
					            </ELSE>
					            </IF>
							</LOOP>
							</table>
						</td>
						<td class="tile-dark" VALIGN="top" WIDTH="1" NOWRAP="nowrap"><BR /></td>
						</tr>
					<tr>
					<td colspan="3" class="tile-dark" VALIGN="TOP" HEIGHT="1"><IMG WIDTH="1" HEIGHT="1" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td>
					</tr>
					<tr>
					<td></td><td background="Variables.cs_imagedir/graphics/common/screen/shadow.gif" REPLACEALL="Variables.cs_imagedir"><IMG WIDTH="1" HEIGHT="5" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/></td><td></td>
					</tr>
					</table> 

	    <!--construct encoded url -->
            <ics.encode base="ContentServer" session="true" output="create">
                <ics.argument name="pagename" value="OpenMarket/Xcelerate/Admin/AssetSubtypeFront"/>
                <ics.argument name="action" value="new"/>
                <ics.argument name="assettype" value="Variables.assettype"/>
            </ics.encode>			
	<div class="width-outer-70">
				<A HREF="Variables.create" REPLACEALL="Variables.create"><CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/AddNewSubtype"/></CALLELEMENT></A>
    </div>		
    	</THEN>
    	<ELSE>
    	
    	</ELSE>
    	</IF>
	
	</THEN>
	</IF>

	 <if COND="Variables.action=details">
	 <then>
	 
	<table class="width-outer-70" cellspacing="0" cellpadding="0" border="0">
	<tr><td>
		<span class="title-text"><STRING.STREAM VALUE="Variables.at:description "/> <XLAT.STREAM KEY="dvin/Common/Subtype"/>: 
			<IF COND="IsVariable.subtype=false">
			<THEN>
				<setvar NAME="subtype" VALUE="Variables.empty"/>
			</THEN>
			</IF>
			<IF COND="Variables.subtype=Variables.empty">
			<THEN>
				<XLAT.STREAM KEY="dvin/UI/Util/Standardnosubtype"/>
			</THEN>
			<ELSE>
				<STRING.STREAM VARIABLE="subtype"/>
			</ELSE>
			</IF>
		</span>
	 	</td></tr>
	<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/TitleBar"/>
	</table>
	
    <table class="width-outer-30 margin-top-zero" BORDER="0" CELLSPACING="0" CELLPADDING="0">
	<tr><td>
		<table width="100%" cellpadding="0" cellspacing="0" border="0" bgcolor="#ffffff">
			<tr>
				<td class="form-label-text" colspan="3">
				<table class="legacyAbar" border="0" cellpadding="0" cellspacing="0">
				<tr>		<XLAT.LOOKUP KEY="dvin/UI/Admin/InspectThisSubtype" VARNAME="alt"/>
							<XLAT.LOOKUP KEY="dvin/Common/Inspect" VARNAME="statustxt" ESCAPE="true"/>
	    <!--construct encoded urls -->
            <ics.encode base="ContentServer" session="true" output="inspect">
                <ics.argument name="pagename" value="OpenMarket/Xcelerate/Admin/AssetSubtypeFront"/>
                <ics.argument name="action" value="details"/>
                <ics.argument name="assettype" value="Variables.assettype"/>
                <ics.argument name="subtype" value="Variables.subtype"/>
            </ics.encode>
            <ics.encode base="ContentServer" session="true" output="edit">
                <ics.argument name="pagename" value="OpenMarket/Xcelerate/Admin/AssetSubtypeFront"/>
                <ics.argument name="action" value="edit"/>
                <ics.argument name="assettype" value="Variables.assettype"/>
                <ics.argument name="subtype" value="Variables.subtype"/>
            </ics.encode>
            <ics.encode base="ContentServer" session="true" output="delete">
                <ics.argument name="pagename" value="OpenMarket/Xcelerate/Admin/AssetSubtypeFront"/>
                <ics.argument name="action" value="confirmdelete"/>
                <ics.argument name="assettype" value="Variables.assettype"/>
                <ics.argument name="subtype" value="Variables.subtype"/>
            </ics.encode>
					<td><A HREF="Variables.inspect" onmouseover="window.status='Variables.statustxt';return true;" onmouseout="window.status='';return true" REPLACEALL="Variables.inspect,Variables.statustxt"><img height="14" width="14" hspace="2" src="Variables.cs_imagedir/graphics/common/icon/iconInspectContentUp.gif"  border="0" alt="Variables.alt" REPLACEALL="Variables.cs_imagedir,Variables.alt"/></A></td>
					<td><A HREF="Variables.inspect" onmouseover="window.status='Variables.statustxt';return true;" onmouseout="window.status='';return true" REPLACEALL="Variables.inspect,Variables.statustxt"><span class="action-text"><XLAT.STREAM KEY="dvin/Common/Inspect"/></span></A></td>
					<td>&nbsp;&nbsp;&nbsp;&nbsp;</td>

						<XLAT.LOOKUP KEY="dvin/UI/Admin/EditThisSubtype" VARNAME="alt"/>
						<XLAT.LOOKUP KEY="dvin/Common/Edit" VARNAME="statustxt" ESCAPE="true"/>
						<td><A HREF="Variables.edit" onmouseover="window.status='Variables.statustxt';return true;" onmouseout="window.status='';return true" REPLACEALL="Variables.edit,Variables.statustxt"><img height="14" width="14" src="Variables.cs_imagedir/graphics/common/icon/iconEditContentUp.gif" hspace="2" border="0" alt="Variables.alt" REPLACEALL="Variables.cs_imagedir,Variables.alt"/></A></td>
						<td><A HREF="Variables.edit" onmouseover="window.status='Variables.statustxt';return true;" onmouseout="window.status='';return true" REPLACEALL="Variables.edit,Variables.statustxt"><span class="action-text"><XLAT.STREAM KEY="dvin/Common/Edit"/></span></A></td>

						<td>&nbsp;&nbsp;&nbsp;&nbsp;</td>
						<XLAT.LOOKUP KEY="dvin/UI/Admin/DeleteThisSubtype" VARNAME="alt"/>
						<XLAT.LOOKUP KEY="dvin/Common/Delete" VARNAME="statustxt" ESCAPE="true"/>
						<td><A HREF="Variables.delete" onmouseover="window.status='Variables.statustxt';return true;" onmouseout="window.status='';return true" REPLACEALL="Variables.delete,Variables.statustxt"><img height="14" width="14" src="Variables.cs_imagedir/graphics/common/icon/iconDeleteContentUp.gif" hspace="2" border="0" alt="Variables.alt" REPLACEALL="Variables.cs_imagedir,Variables.alt"/></A></td>
						<td><A HREF="Variables.delete" onmouseover="window.status='Variables.statustxt';return true;" onmouseout="window.status='';return true" REPLACEALL="Variables.delete,Variables.statustxt"><span class="action-text"><XLAT.STREAM KEY="dvin/Common/Delete"/></span></A></td>
				<td>&nbsp;&nbsp;&nbsp;&nbsp;</td>
				</tr>
				</table>
				</td>
			</tr>
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
			<tr>
				<td class="form-label-text">
					<XLAT.STREAM KEY="dvin/Common/Name"/>:
				</td>
				<td class="form-inset">
					<STRING.STREAM VARIABLE="subtype"/>
				</td>
			</tr>
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
			<tr>
				<td class="form-label-text" NOWRAP="NOWRAP">
					<XLAT.STREAM KEY="dvin/Common/Sites"/>:
				</td>
				<td class="form-inset">
					<NOBR>
					<SUBTYPES.GETSUBTYPE LISTVARNAME="sites" ASSETTYPE="Variables.assettype" SUBTYPE="Variables.subtype"/>
					<LOOP LIST="sites">
		                <PUBLICATION.LOAD NAME="pub" OBJECTID="sites.pubid"/>
		                <if COND="IsError.Variables.errno=false">
		                <then>
		                	<PUBLICATION.GET NAME="pub" FIELD="description"/>
		                	<STRING.STREAM VALUE="Variables.description"/>
		               	</then>
		               	<else>
		                	<STRING.STREAM VALUE="subtypes.pubid"/>
		               	</else>
		              	</if><BR />
		             </LOOP>
					</NOBR>
				</td>
			</tr>			
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>		
			<tr>
				<td class="form-label-text">
					<NOBR><XLAT.STREAM KEY="dvin/UI/AssetType"/>:</NOBR>
				</td>
				<td class="form-inset">
                        <SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Admin/AssetTypeFront" outstring="urlassettypefront">
                            <satellite.argument name="cs_environment" value="Variables.cs_environment"/>
                            <satellite.argument name="cs_formmode" value="Variables.cs_formmode"/>
                        	<satellite.argument name="action" value="details"/>
                        	<satellite.argument name="assettype" value="Variables.assettype"/>
                         </SATELLITE.LINK>
						<A HREF="Variables.urlassettypefront" REPLACEALL="Variables.urlassettypefront"><STRING.STREAM VALUE="Variables.at:description"/></A>
				</td><td><BR /></td>
			</tr>
		</table>
	</td></tr>
</table>

    <SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Admin/AssetSubtypeFront" outstring="urlassetsubtypefront">
        <satellite.argument name="cs_environment" value="Variables.cs_environment"/>
        <satellite.argument name="cs_formmode" value="Variables.cs_formmode"/>
                                         <satellite.argument name="action" value="list"/>
                                         <satellite.argument name="assettype" value="Variables.assettype"/>
                                          </SATELLITE.LINK>
<DIV class="width-outer-70"><A HREF="Variables.urlassetsubtypefront" REPLACEALL="Variables.urlassetsubtypefront"><IMG src="Variables.cs_imagedir/graphics/common/icon/doubleArrow.gif" WIDTH="15" HEIGHT="12" BORDER="0" REPLACEALL="Variables.cs_imagedir"/><XLAT.STREAM KEY="dvin/UI/Admin/ListallsubtypesforATdesc"/></A>
</DIV>
	 </then>
	 </if>
	 
	<if COND="Variables.action=new">
	<then>
       
    	<IF COND="Variables.pubstochoose!=Variables.empty">
    	<THEN>

		<IF COND="Variables.showheader!=false">
		<THEN>  
			<table class="width-outer-70" cellspacing="0" cellpadding="0" border="0">
				<tr><td>
					<span class="title-text"><XLAT.STREAM KEY="dvin/UI/Admin/AddNewAssetTypeSubtype"/></span>
				</td></tr>
				<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/TitleBar"/>
			</table>
		</THEN>
		</IF>
		<table class="width-outer-70" cellpadding="0" cellspacing="0" border="0" bgcolor="#ffffff">
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
			<tr>
				<td class="form-label-text">
					<span class="alert-color">*</span><XLAT.STREAM KEY="dvin/Common/Name"/>:
				</td>
				<td class="form-inset">
                    <INPUT TYPE="TEXT" SIZE="32" MAXLENGTH="32" NAME="subtype" VALUE=""/>
				</td>
			</tr>
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
			<tr>
				<td class="form-label-text" NOWRAP="NOWRAP">
					<span class="alert-color">*</span><XLAT.STREAM KEY="dvin/Common/Sites"/>:
				</td>
				<td class="form-inset">
					<SUBTYPES.GETSUBTYPE LISTVARNAME="subsites" ASSETTYPE="Variables.assettype" SUBTYPE="Variables.subtype"/>
					<LOOP LIST="subsites">
					<SETVAR NAME="sitelist" VALUE="Variables.sitelist,subsites.pubid"/>
					</LOOP>

             		<STRINGLIST NAME="publist" STR="Variables.pubstochoose" DELIM=";"/>
            		<SELECT NAME="sites" SIZE="8" MULTIPLE="YES">
            			<LOOP LIST="publist">
            				<STRINGLIST NAME="apub" STR="publist.ITEM" DELIM=","/>
	            			<OPTION VALUE="apub.ITEM" REPLACEALL="apub.ITEM"/>
	            			<GOTOROW LIST="apub" ROWNUM="2"/>
            				<STRING.STREAM VALUE="apub.ITEM"/>
             			</LOOP>
             		</SELECT>
				</td>
			</tr>	
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>		
			<tr>
				<td class="form-label-text">
					<XLAT.STREAM KEY="dvin/UI/AssetType"/>:
				</td>
				<td class="form-inset">
                   <INPUT TYPE="HIDDEN" NAME="assettype" VALUE="Variables.assettype" REPLACEALL="Variables.assettype"/>
					<STRING.STREAM VALUE="Variables.at:description"/>
				</td><td><BR /></td>
			</tr>
			<INPUT TYPE="HIDDEN" NAME="pagename" VALUE="OpenMarket/Xcelerate/Admin/AssetSubtypePost"/>
			<INPUT TYPE="HIDDEN" NAME="action" VALUE="new"/>
			<XLAT.LOOKUP KEY="dvin/UI/Admin/AddNewSubtype" VARNAME="_XLAT_" ESCAPE="true"/>
			<SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Admin/AssetSubtypeFront" outstring="AssetSubtypeFrontURL">
			<satellite.argument name="cs_environment" value="Variables.cs_environment"/>
			<satellite.argument name="cs_formmode" value="Variables.cs_formmode"/>
			<satellite.argument name="action" value="list"/>
			<satellite.argument name="assettype" value="Variables.assettype"/>
			</SATELLITE.LINK>
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/FooterBar"/>
			<TR>
				<TD class="form-label-text"></TD><TD class="form-inset">
					<A HREF="Variables.AssetSubtypeFrontURL" REPLACEALL="Variables.AssetSubtypeFrontURL"><CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/Cancel"/></CALLELEMENT></A>
					<A HREF="javascript:void(0);" onClick="if(checkfields()!=false){document.forms['AppForm'].submit(); return false;}" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true;" REPLACEALL="Variables._XLAT_"><CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/AddNewSubtype"/></CALLELEMENT></A>
				</TD>
			</TR>
		</table>
	


</THEN>
<ELSE>
<div class="width-outer-70">
<XLAT.LOOKUP KEY="dvin/Admin/AssetTypeEnabledInNoSites" VARNAME="msgtext" ENCODE="false"/>
<CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/ShowMessage">
 <ARGUMENT NAME="severity" VALUE="error"/>
</CALLELEMENT> 
<SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Admin/AssetSubtypeFront" outstring="AssetSubtypeFrontURL">
<satellite.argument name="cs_environment" value="Variables.cs_environment"/>
<satellite.argument name="cs_formmode" value="Variables.cs_formmode"/>
<satellite.argument name="action" value="list"/>
<satellite.argument name="assettype" value="Variables.assettype"/>
</SATELLITE.LINK>
<A HREF="Variables.AssetSubtypeFrontURL" REPLACEALL="Variables.AssetSubtypeFrontURL"><CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/Cancel"/></CALLELEMENT></A>
</div>
</ELSE>           
</IF>
	
	</then>
	</if><!-- end action=new -->
	
	
	 <if COND="Variables.action=edit">
	 <then>

    	<IF COND="Variables.pubstochoose!=Variables.empty">
    	<THEN>
			<IF COND="IsVariable.subtype=false">
			<THEN>
				<setvar NAME="subtype" VALUE="Variables.empty"/>
			</THEN>
			</IF>
			<IF COND="Variables.showheader!=false">
			<THEN>   
			<table class="width-outer-70" cellspacing="0" cellpadding="0" border="0">
			<tr><td>                                       
				<span class="title-text"><XLAT.STREAM KEY="dvin/UI/Admin/EditATdescsubtype"/>: 
					<IF COND="Variables.subtype=Variables.empty">
					<THEN>
						<XLAT.STREAM KEY="dvin/UI/Util/Standardnosubtype"/>
					</THEN>
					<ELSE>
						<STRING.STREAM VARIABLE="subtype"/>
					</ELSE>
					</IF>
				</span>
				</td></tr>
				<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/TitleBar"/>
			</table>	
			</THEN>
			</IF>
	
		<ASSET.LIST LIST="assetsUsingSubtype" TYPE="Variables.assettype" FIELD1="subtype" VALUE1="Variables.subtype" EXCLUDEVOIDED="true"/>
		<if COND="assetsUsingSubtype.#numRows!=0">
		<then>
		<div class="width-outer-70">
			<XLAT.LOOKUP KEY="dvin/UI/Admin/AssetSubtypeInUse" VARNAME="msgtext"/>
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/ShowMessage">
				<argument NAME="severity" VALUE="info"/>
			</callelement>		
		</div>					
		</then>
		</if>
		 
	    <table class="width-outer-30" BORDER="0" CELLSPACING="0" CELLPADDING="0">
		<tr><td>
			<table width="100%" cellpadding="0" cellspacing="0" border="0" bgcolor="#ffffff">
				<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
				<tr>
					<td class="form-label-text">
						<span class="alert-color">*</span><XLAT.STREAM KEY="dvin/Common/Name"/>:
					</td>
					<td class="form-inset">
					  <STRING.ENCODE VARIABLE="subtype" VARNAME="subtype"/>
	                  <INPUT TYPE="TEXT" SIZE="32" MAXLENGTH="32" NAME="subtype" VALUE="Variables.subtype" REPLACEALL="Variables.subtype"/>
					</td>
				</tr>
				<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
				<tr>
					<td class="form-label-text" NOWRAP="NOWRAP">
						<span class="alert-color">*</span><XLAT.STREAM KEY="dvin/Common/Sites"/>:
					</td>
					<td class="form-inset">
						<SUBTYPES.GETSUBTYPE LISTVARNAME="subsites" ASSETTYPE="Variables.assettype" SUBTYPE="Variables.subtype"/>
						<LOOP LIST="subsites">
							<if COND="IsVariable.sitelist=true">
							<then>
								<SETVAR NAME="sitelist" VALUE="Variables.sitelist,subsites.pubid"/>
							</then>
							<else>
								<SETVAR NAME="sitelist" VALUE="subsites.pubid"/>
							</else>
							</if>
							<STRING.ENCODE LIST="subsites" COLUMN="id" VARNAME="ssid"/>
			              	<INPUT TYPE="HIDDEN" NAME="deletesubtype" VALUE="Variables.ssid" REPLACEALL="Variables.ssid"/>
						</LOOP>
             		<STRINGLIST NAME="publist" STR="Variables.pubstochoose" DELIM=";"/>
            		<SELECT NAME="sites" SIZE="8" MULTIPLE="YES">
            			<LOOP LIST="publist">
            				<STRINGLIST NAME="apub" STR="publist.ITEM" DELIM=","/>
             				<SETVAR NAME="errno" VALUE="0"/>                				
             				<ISINLIST STR="Variables.sitelist" ITEM="apub.ITEM"/>
             				<IF COND="Variables.errno=0">
             				<THEN>
	            				<OPTION VALUE="apub.ITEM" REPLACEALL="apub.ITEM"/>
	            			</THEN>
	            			<ELSE>
	            				<OPTION VALUE="apub.ITEM" REPLACEALL="apub.ITEM" SELECTED="SELECTED"/>
	            			</ELSE>
	            			</IF>
	            			<GOTOROW LIST="apub" ROWNUM="2"/>
            				<STRING.STREAM VALUE="apub.ITEM"/>
             			</LOOP>
             		</SELECT>
					</td>
				</tr>	
				<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>		
							
				<tr>
					<td class="form-label-text">
						<XLAT.STREAM KEY="dvin/UI/AssetType"/>:
					</td>
					<td class="form-inset">
	                    <INPUT TYPE="HIDDEN" NAME="assettype" VALUE="Variables.assettype" REPLACEALL="Variables.assettype"/>
						<STRING.STREAM VALUE="Variables.at:description"/>
					</td><td><BR /></td>
				</tr>
				<INPUT TYPE="HIDDEN" NAME="pagename" VALUE="OpenMarket/Xcelerate/Admin/AssetSubtypePost"/>
				<INPUT TYPE="HIDDEN" NAME="action" VALUE="edit"/>
				<!--construct encoded url -->
	            <ics.encode base="ContentServer" session="true" output="inspect">
	                <ics.argument name="pagename" value="OpenMarket/Xcelerate/Admin/AssetSubtypeFront"/>
	                <ics.argument name="action" value="details"/>
	                <ics.argument name="assettype" value="Variables.assettype"/>
	                <ics.argument name="subtype" value="Variables.subtype"/>
	            </ics.encode>
	
				<XLAT.LOOKUP KEY="dvin/UI/Admin/SaveSubtype" VARNAME="statustxt" ESCAPE="true"/>
				<XLAT.LOOKUP KEY="dvin/UI/Cancel" VARNAME="_XLAT_" ESCAPE="true"/>
				<XLAT.LOOKUP KEY="dvin/UI/Cancel" VARNAME="_ALT_"/>
				<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/FooterBar"/>
				<TR>
					<TD class="form-label-text"></TD><TD class="form-inset">
					<A HREF="Variables.inspect" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true;" REPLACEALL="Variables._XLAT_,Variables.inspect"><CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/Cancel"/></CALLELEMENT></A>
					<A HREF="javascript:void(0);" onClick="if(checkfields()!=false){document.forms['AppForm'].submit(); return false;}" onmouseover="window.status='Variables.statustxt';return true;" onmouseout="window.status='';return true;" REPLACEALL="Variables.statustxt"><CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/Save"/></CALLELEMENT></A>
				</TD>
			</TR>
			</table>
		</td></tr>
	</table>
     
	</THEN>
	<ELSE>
		<div class="width-outer-70">
		<XLAT.LOOKUP KEY="dvin/Admin/AssetTypeEnabledInNoSites" VARNAME="msgtext" ENCODE="false"/>
		<CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/ShowMessage">
		 <ARGUMENT NAME="severity" VALUE="error"/>
		</CALLELEMENT> 
		<SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Admin/AssetSubtypeFront" outstring="AssetSubtypeFrontURL">
		<satellite.argument name="cs_environment" value="Variables.cs_environment"/>
		<satellite.argument name="cs_formmode" value="Variables.cs_formmode"/>
		<satellite.argument name="action" value="list"/>
		<satellite.argument name="assettype" value="Variables.assettype"/>
		</SATELLITE.LINK>
		<A HREF="Variables.AssetSubtypeFrontURL" REPLACEALL="Variables.AssetSubtypeFrontURL"><CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/Cancel"/></CALLELEMENT></A>
		</div>
	</ELSE>
	</IF>
         
	</then>
	</if><!-- end action=edit -->
	
	 <if COND="Variables.action=confirmdelete">
	 <then>
	<table class="width-outer-70" cellspacing="0" cellpadding="0" border="0">
		<tr><td>	
			<span class="title-text"><XLAT.STREAM KEY="dvin/UI/Admin/DeleteATdescsubtype"/>: 
				<IF COND="IsVariable.subtype=false">
				<THEN>
					<setvar NAME="subtype" VALUE="Variables.empty"/>
					<XLAT.STREAM KEY="dvin/UI/Util/Standardnosubtype"/>
				</THEN>
				<ELSE>
					<STRING.STREAM VARIABLE="subtype"/>
				</ELSE>
				</IF>
			</span>
		</td></tr>
		<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/TitleBar"/>
	</table>
<div class="width-outer-70">	
	<ASSET.LIST LIST="assetsUsingSubtype" TYPE="Variables.assettype" FIELD1="subtype" VALUE1="Variables.subtype" EXCLUDEVOIDED="true"/>
	<if COND="assetsUsingSubtype.#numRows!=0">
	<then>
		<XLAT.LOOKUP KEY="dvin/UI/Admin/AssetSubtypeInUse" VARNAME="msgtext"/>
		<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/ShowMessage">
			<argument NAME="severity" VALUE="warning"/>
		</callelement>							
	</then>
	</if>
	 
	<XLAT.LOOKUP KEY="dvin/UI/Admin/AreyousuredeletesubtypeQ" VARNAME="msgtext"/>
	<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/ShowMessage">
		<argument NAME="severity" VALUE="warning"/>
	</callelement>							
</div>								 
	 
    <table class="width-outer-30" BORDER="0" CELLSPACING="0" CELLPADDING="0">
	<tr><td>
		<table width="100%" cellpadding="0" cellspacing="0" border="0" bgcolor="#ffffff">
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
			<tr>
				<td class="form-label-text">
					<XLAT.STREAM KEY="dvin/Common/Name"/>:
				</td>
				<td class="form-inset">
					<STRING.STREAM VARIABLE="subtype"/>
				</td>
			</tr>
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
			<tr>
				<td class="form-label-text" NOWRAP="NOWRAP">
					<XLAT.STREAM KEY="dvin/Common/Sites"/>:
				</td>
				<td class="form-inset">
				<NOBR>
					<SUBTYPES.GETSUBTYPE LISTVARNAME="sites" ASSETTYPE="Variables.assettype" SUBTYPE="Variables.subtype"/>
					<LOOP LIST="sites">
		                <PUBLICATION.LOAD NAME="pub" OBJECTID="sites.pubid"/>
		                <if COND="IsError.Variables.errno=false">
		                <then>
		                	<PUBLICATION.GET NAME="pub" FIELD="description"/>
		                	<STRING.STREAM VALUE="Variables.description"/>
		               	</then>
		               	<else>
		                	<STRING.STREAM VALUE="sites.pubid"/>
		               	</else>
		              	</if><BR />
						<STRING.ENCODE LIST="sites" COLUMN="id" VARNAME="sid"/>
		              	<INPUT TYPE="HIDDEN" NAME="deletesubtype" VALUE="Variables.sid" REPLACEALL="Variables.sid"/>
		             </LOOP>
				</NOBR>
				</td>
			</tr>			
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>		
			<tr>
				<td class="form-label-text">
					<XLAT.STREAM KEY="dvin/UI/AssetType"/>:
				</td>
				<td class="form-inset">
					<STRING.STREAM VALUE="Variables.at:description"/>
				</td><td><BR /></td>
			</tr>
			
			 <!--construct encoded url -->
            <ics.encode base="ContentServer" session="true" output="inspect">
                <ics.argument name="pagename" value="OpenMarket/Xcelerate/Admin/AssetSubtypeFront"/>
                <ics.argument name="action" value="details"/>
                <ics.argument name="assettype" value="Variables.assettype"/>
                <ics.argument name="subtype" value="Variables.subtype"/>
            </ics.encode>
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/FooterBar"/>
			<TR>
				<TD class="form-label-text"></TD><TD class="form-inset">	    
				<XLAT.LOOKUP KEY="dvin/UI/Cancel" VARNAME="_XLAT_" ESCAPE="true"/>
				<A HREF="Variables.inspect" onmouseover="window.status='Variables._XLAT_';return true;" onmouseout="window.status='';return true;" REPLACEALL="Variables._XLAT_,Variables.inspect"><CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/Cancel"/></CALLELEMENT></A>
				<XLAT.LOOKUP KEY="dvin/UI/Admin/DeleteThisSubtype" VARNAME="statustxt" ESCAPE="true"/>
				<A HREF="javascript:void(0);" onclick="document.forms['AppForm'].submit(); return false;" onmouseover="window.status='Variables.statustxt';return true;" onmouseout="window.status='';return true;" REPLACEALL="Variables.statustxt"><CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/TextButton"><ARGUMENT NAME="buttonkey" VALUE="UI/Forms/DeleteSubtype"/></CALLELEMENT></A>
				</TD>
			</TR>
		</table>
	</td></tr>
</table>

<INPUT TYPE="HIDDEN" NAME="pagename" VALUE="OpenMarket/Xcelerate/Admin/AssetSubtypePost"/>
<INPUT TYPE="HIDDEN" NAME="action" VALUE="delete"/>
<INPUT TYPE="HIDDEN" NAME="assettype" VALUE="Variables.assettype" REPLACEALL="Variables.assettype"/>
	   
</then>
</if> <!-- end action=confirmdelete -->



</FTCS> 
