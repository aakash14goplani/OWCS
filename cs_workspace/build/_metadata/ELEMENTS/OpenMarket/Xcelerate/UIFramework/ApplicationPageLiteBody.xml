<?xml version="1.0" ?>
<!DOCTYPE FTCS SYSTEM "futuretense_cs.dtd">
<FTCS Version="1.2">
<!-- OpenMarket/Xcelerate/UIFramework/ApplicationPageLiteBody
- Single frame application page - assumes no tree frame, no banner
- This does the core work of ApplicationPageLite without the standard variables and codepage stuff.  It's called
- by ApplicationPageLite and by ApplicationPage itself.
- INPUT
-
- OUTPUT
-
-->
<!--
$Logfile: /VerticalApps/XcelerateD/install/Xcelerate/Populate/ElementCatalog/OpenMarket/Xcelerate/UIFramework/ApplicationPageLiteBody.xml $
$Revision: 6 $
$Modtime: 7/29/04 9:51a $
-->

<HTML>
<HEAD>

		<CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/StandardHeader"/>

        <!--callelement NAME="OpenMarket/Xcelerate/Scripts/SetTitle"/-->
		<SCRIPT Language="JavaScript">
		<![CDATA[
		var isNew = 0;
		var isNS4 = 0;
		var isIE4 = 0;
		var isIE5 = 0;
		var isNS5 = 0;
		var isID  = 0;
		var docObj = "";
		var styleObj = "";

		// Determine browser versions
		var brow = ((navigator.appName) + (parseInt(navigator.appVersion)));
		var isat = navigator.userAgent.indexOf("MSIE");
		var ieVer = -1;
		if (isat > -1)
		{
			// IE
			isat += 5;
			var end = navigator.userAgent.indexOf(";", isat);
			if (end > isat)
				ieVer = parseInt(navigator.userAgent.substring(isat, end));
		}

		if (ieVer == 4)
		{isIE4 = 1;}
		if (ieVer == 5)
		{isIE5 = 1;}
		if (ieVer == 6)
		{isIE5 = 1;}
		if (ieVer > 6)
		{isNew = 1;}

		if (parseInt(navigator.appVersion) >= 5) { isNew=1; }
		else if (brow=="Netscape4") {isNS4=1;}

		if (brow=="Netscape5") {isNS5=1;}

		// Set docObj and styleObj
		if (isNS4 || isIE4 || isIE5 ||isNew) {
			docObj = (isNS4) ? 'document' : 'document.all';
			styleObj = (isNS4) ? '' : '.style';
			if (isIE5 || isNS5 || isNew) {isID=1;}
		}
		]]>
		</SCRIPT>
		<CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/LoadDojo" />
		<CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/SetStylesheet"/>
</HEAD>
<SUBSTITUTE STR="Variables.pagename" OUTSTR="CSSbodyid" WHAT="/" WITH="-"/>
<BODY class="AdvForms fw" id="Variables.CSSbodyid" REPLACEALL="Variables.CSSbodyid">
<!-- first check to see if the user is logged in or not -->

	<SETVAR NAME="errno" VALUE="0"/>
	<USERISMEMBER GROUP="xceleditor"/>
	<if COND="Variables.errno=0">
		<then>
		    <SATELLITE.LINK ASSEMBLER="query" pagename="OpenMarket/Xcelerate/Actions/Security/TimeoutError" outstring="urltimeouterror">
				<satellite.argument name="cs_environment" value="Variables.cs_environment"/>
			</SATELLITE.LINK>
			<REPLACE STR="Variables.urltimeouterror">
				<script LANGUAGE="JavaScript">
					parent.parent.location="Variables.urltimeouterror";
				</script>
			</REPLACE>
			<throwexception/>
		</then>
	</if>

    <!-- set the publication name if it has not been done -->
    <if COND="SessionVariables.PublicationName=Not Selected">
        <then>
            <setssvar NAME="pubid" VALUE="Variables.pubid"/>
            <callelement NAME="OpenMarket/Xcelerate/Actions/Security/SetPublicationName"/>
        </then>
    </if>

    <setvar NAME="showSiteTree" VALUE="false" />

	<SATELLITE.FORM ASSEMBLER="query" NAME="AppForm" METHOD="POST">
    <STRING.ENCODE VARIABLE="charset" VARNAME="OutputQString"/>
    <INPUT TYPE="HIDDEN" NAME="_charset_" VALUE="Variables.OutputQString" REPLACEALL="Variables.OutputQString"/>
    <STRING.ENCODE VARIABLE="cs_environment" VARNAME="OutputQString"/>
    <INPUT TYPE="HIDDEN" NAME="cs_environment" VALUE="Variables.OutputQString" REPLACEALL="Variables.OutputQString"/>
    <STRING.ENCODE VARIABLE="cs_formmode" VARNAME="OutputQString"/>
    <INPUT TYPE="HIDDEN" NAME="cs_formmode" VALUE="Variables.OutputQString" REPLACEALL="Variables.OutputQString"/>
	<INPUT TYPE="HIDDEN" NAME="PubName" VALUE="SessionVariables.PublicationName" REPLACEALL="SessionVariables.PublicationName"/>
	
    <!-- create a default dateformat object for use by all child elements -->

    <IF COND="IsSessionVariable.locale=true">
        <THEN>
            <LOCALE.CREATE VARNAME="LocaleName" LOCALENAME="SessionVariables.locale"/>
            <DATEFORMAT.CREATE NAME="_FormatDate_" DATESTYLE="FULL" TIMESTYLE="FULL" LOCALE="LocaleName" TIMEZONEID="SessionVariables.time.zone"/>
        </THEN>
        <ELSE>
            <DATEFORMAT.CREATE NAME="_FormatDate_" DATESTYLE="FULL" TIMESTYLE="FULL" TIMEZONEID="SessionVariables.time.zone"/>
        </ELSE>
    </IF>

	<!-- Save off variables used in toolbar generation, since the asset toolbar is rendered AFTER
		executing the action of the current page, and the variables may be changed by the executing page
	-->
	<IF COND="IsVariable.AssetType=true"><THEN>
	<setvar NAME="InAssetType" VALUE="Variables.AssetType"/></THEN></IF>

	<IF COND="IsVariable.id=true">
	<THEN>
		<setvar NAME="Inid" VALUE="Variables.id"/>

		<IF COND="Variables.cs_environment=portal">
      	<THEN>
      		<callelement NAME="OpenMarket/Flame/Common/AddToPortalHistory">
				<argument NAME="assettype" VALUE="Variables.AssetType"/>
				<argument NAME="id" VALUE="Variables.id"/>
			</callelement>
      	</THEN>
		</IF>
	</THEN>
	</IF>

	<if COND="IsVariable.ThisPage=true">
	<then>
		<if COND="IsElement.OpenMarket/Xcelerate/PrologActions/Variables.ThisPage=true">
	        <then>
	            <callelement NAME="OpenMarket/Xcelerate/PrologActions/Variables.ThisPage"/>
	        </then>
	        <else>
		        <span class="alert-color"><XLAT.STREAM KEY="dvin/Error/UI/NoPrologActionsElement"/></span><BR/>
			</else>
	    </if>

		<callelement NAME="OpenMarket/Xcelerate/Actions/Variables.ThisPage"/>
	</then>
	<else>
		<!-- Display an informational message. -->
		<CALLELEMENT NAME="OpenMarket/Xcelerate/UIFramework/Util/ShowMessage">
			<ARGUMENT NAME="elem" VALUE="NoActionSpecified"/>
			<ARGUMENT NAME="severity" VALUE="error"/>
		</CALLELEMENT>
	</else>
	</if>


	<SCRIPT LANGUAGE="JavaScript">
		<![CDATA[
			var num = document.AppForm.length;
			document.AppForm.encoding="application/x-www-form-urlencoded";
			for (i=0; i < num; i++)
			{
				if (document.AppForm.elements[i].type=="file") document.AppForm.encoding="multipart/form-data";
			}
		]]>
	</SCRIPT>


</SATELLITE.FORM>

</BODY>
</HTML>
</FTCS>

