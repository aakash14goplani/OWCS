<?xml version="1.0" ?>
<!DOCTYPE FTCS SYSTEM "futuretense_cs.dtd">
<FTCS Version="1.1">
<!-- 
$Logfile: /VerticalApps/XcelerateC/install/Xcelerate/Populate/ElementCatalog/OpenMarket/Xcelerate/PrologActions/NewContentFront.xml $ 
$Revision: 35 $ 
$Modtime: 3/18/04 10:23a $ 
-->

<!--
- Confidential and Proprietary Information of FutureTense Inc.
-					All Rights Reserved.
-
- NewContentFront.xml
-
- DESCRIPTION
-	Required input variables: AssetType
-->

	<setvar NAME="doproceed" VALUE="true"/>
<!-- Include the JavaScript validation functions -->

	<callelement NAME="OpenMarket/Xcelerate/Scripts/ValidateInput">
	</callelement>

<!-- Set the name of the asset object -->

	<setvar NAME="assetname" VALUE="theCurrentAsset"/> 
	<setvar NAME="assetObjectName" VALUE="theCurrentAsset"/>

<!-- Attempt to create an instance of the asset type to use for defaults -->

	<ASSET.CREATE TYPE="Variables.AssetType" NAME="Variables.assetObjectName"/>
	<IF COND="IsError.Variables.errno!=true">
		<THEN>
			<IF COND="IsVariable.id=true">
				<THEN>
					<ASSET.SET NAME="Variables.assetObjectName" FIELD="id" VALUE="Variables.id"/>
				</THEN>
			</IF>
			<!-- Retrieve the id so it's around for the next post -->
			<ASSET.GET NAME="Variables.assetObjectName" FIELD="id" OUTPUT="id"/>
			<IF COND="Variables.id=Variables.empty">
			<THEN>
				<REMOVEVAR NAME="id"/>
			</THEN>
			</IF>

<!-- Handle setting defaults to display in asset specific form -->

			<callelement NAME="OpenMarket/Xcelerate/AssetType/Variables.AssetType/PreUpdate">
				<argument NAME="updatetype" VALUE="setformdefaults"/>
			</callelement>

<!-- Build lists needed for the content form -->

			<callelement NAME="OpenMarket/Xcelerate/Actions/AssetMgt/GetContentDetails">
		    	<argument NAME="getaux" VALUE="true"/>
    			<argument NAME="qryprefix" VALUE="ContentDetails"/>
    			<argument NAME="assetObjectName" VALUE="Variables.assetObjectName"/>
			</callelement>

		</THEN>
		<ELSE>
			<setvar NAME="doproceed" VALUE="CanNotCreateAsset"/>
		</ELSE>
	</IF>
</FTCS>
