<?xml version="1.0" ?>
<!DOCTYPE FTCS SYSTEM "futuretense_cs.dtd">
<FTCS Version="1.2">
<!-- OpenMarket/Xcelerate/PrologActions/Publish/Export/AssetCanEdit
-  DESCRIPTION - This element is called when a publish for this delivery type is in progress
-      and a user tries to edit an asset. This element can be modified if the 
-      restriction on what can be edited is either too restrictive or not restrictive 
-      enough. If this element is not present for a delivery type the, assets or 
-      references which are involved in the publish and whose current version 
-      has not been published are not allowed to be edited.
-      For mirror, this is a safe restriction level. For export, depending
-      on how the templates are written and how many assets
-      are embedded in the pages and do not have references of their own, this may be
-      not restrictive enough.  
-      In this element for export, we prohibit edits on assets for where the last publish
-      date is not the same as the current asset date. For assets which are in an approved
-      state for the export target but whose publish date matches the last publish date, we
-		 put up a warning. 
- INPUT
-	Variables.assetid - is of asset for which we are asking "can this asset be edited?"
-  Variables.assettype - type of asset for which we are asking "can this asset be edited?"
-  Variables.objectversion - not used
-  Variables.assetdate - updateddate of asset for which we are asking "can this asset be edited?"
-  Variables.target - id of publish target of publish which is progress
- OUTPUT
-	Variables._canEdit_ - set to 0 if it is o.k. to edit aset
-						- set to -12034 if edit on asset should be prohibited
-						- set to -12069 if edit is allowed but warning should be displayed
-->


<!-- if the asset is approved for this target we will set a warning or error -->
<ApprovedAssets.GetAssetStatus TARGET="Variables.target" ID="Variables.assetid" TYPE="Variables.assettype" LISTVARNAME="approvedList"/>
<if COND="approvedList.status=A">
<then>
	<!-- assume at least a warning -->
	<setvar NAME="_canEdit_" VALUE="-12069"/>
	<!-- if the last published date is not the same as the asset's date, then we want to prohibit edit of this asset -->
	<if COND="approvedList.lastdate!=Variables.assetdate">
	<then>
		<setvar NAME="_canEdit_" VALUE="-12034"/>
	</then>
	</if>
</then>
</if>

</FTCS>